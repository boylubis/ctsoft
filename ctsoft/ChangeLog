2009-12-17  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0

2009-12-09  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-rc8

2009-12-08 18:33 +0000 [r233731]  Tilghman Lesher <tlesher@digium.com>

	* res/res_musiconhold.c, /: Merged revisions 233718 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r233718 | tilghman | 2009-12-08 12:22:44 -0600 (Tue, 08 Dec 2009)
	  | 8 lines Find another ref leak and change how we manage module
	  references. (closes issue #16388) Reported by: parisioa Patches:
	  20091208__issue16388.diff.txt uploaded by tilghman (license 14)
	  Tested by: parisioa, tilghman Review:
	  https://reviewboard.asterisk.org/r/442/ ........

2009-12-08 18:04 +0000 [r233694]  Russell Bryant <russell@digium.com>

	* formats/format_sln16.c, formats/format_wav_gsm.c,
	  formats/format_siren7.c, formats/format_ilbc.c,
	  formats/format_vox.c, formats/format_pcm.c,
	  formats/format_h263.c, formats/format_g723.c,
	  formats/format_h264.c, formats/format_siren14.c,
	  formats/format_jpeg.c, formats/format_g726.c,
	  formats/format_gsm.c, formats/format_g729.c, /,
	  formats/format_sln.c, formats/format_wav.c,
	  formats/format_ogg_vorbis.c: Merged revisions 233692 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r233692 | russell | 2009-12-08 12:00:16 -0600 (Tue, 08 Dec 2009)
	  | 16 lines Set a module load priority for format modules. A
	  recent change to app_voicemail made it such that the module now
	  assumes that all format modules are available while processing
	  voicemail configuration. However, when autoloading modules, it
	  was possible that app_voicemail was loaded before the format
	  modules. Since format modules don't depend on anything, set a
	  module load priority on them to ensure that they get loaded first
	  when autoloading. This fix applies to trunk, 1.6.1, and 1.6.2.
	  The fix for 1.4 and 1.6.0 will require a different approach since
	  the module load priority functionality is not present in the
	  module API. (issue #16412) Reported by: jiddings ........

2009-12-08 07:41 +0000 [r233689]  TransNexus OSP Development <support@transnexus.com>

	* apps/app_osplookup.c: Fixed compile error with OSP Toolkit 3.6.

2009-12-07 23:54 +0000 [r233615]  Atis Lezdins <atis@iq-labs.net>

	* contrib/valgrind.supp, /: Merged revisions 233577 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r233577 | atis | 2009-12-08 01:10:13 +0200 (Tue, 08 Dec 2009) | 8
	  lines Fix compatibility with valgrind 3.3 and older. (noticed in
	  issue #16388) Reported by: parisioa Patches: valgrind.supp
	  uloaded by atis (license 242) Tested by: atis, parisioa ........

2009-12-07 23:29 +0000 [r233473-233612]  David Vossel <dvossel@digium.com>

	* /, main/utils.c: Merged revisions 233611 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r233611 |
	  dvossel | 2009-12-07 17:28:51 -0600 (Mon, 07 Dec 2009) | 4 lines
	  fixes incorrect logic in ast_uri_encode issue #16299 ........

	* /, channels/chan_sip.c: Merged revisions 233472 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r233472 | dvossel | 2009-12-07 12:08:46 -0600 (Mon, 07 Dec 2009)
	  | 15 lines Merged revisions 233471 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r233471 | dvossel | 2009-12-07 12:07:38 -0600 (Mon, 07 Dec 2009)
	  | 9 lines fixes missing Contact header angle brackets (closes
	  issue #16298) Reported by: mgernoth Patches:
	  reg_parse_issue_1.4.diff uploaded by dvossel (license 671) Tested
	  by: dvossel ........ ................

2009-12-07 16:16 +0000 [r233396]  Matthew Nicholson <mnicholson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 233394 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r233394 |
	  mnicholson | 2009-12-07 10:14:42 -0600 (Mon, 07 Dec 2009) | 8
	  lines Do not reject SDP packets describing only non audio
	  streams. (closes issue #16387) Reported by: zalex1953 Patches:
	  media-level-c-fix1.diff uploaded by mnicholson (license 96)
	  Tested by: mnicholson, zalex1953 ........

2009-12-04 21:55 +0000 [r233281]  David Vossel <dvossel@digium.com>

	* configs/iax.conf.sample, /: Merged revisions 233280 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r233280 | dvossel | 2009-12-04 15:54:44 -0600
	  (Fri, 04 Dec 2009) | 14 lines Merged revisions 233279 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r233279 | dvossel | 2009-12-04 15:54:01 -0600 (Fri, 04 Dec 2009)
	  | 7 lines clarify requirecalltoken option in iax.sample.conf
	  (closes issue #16223) Reported by: bklang Patches:
	  clarify-iax-requirecalltoken.patch uploaded by bklang (license
	  919) ........ ................

2009-12-04 21:07 +0000 [r233240]  Matthias Nick <mnick@digium.com>

	* pbx/pbx_config.c, /: Merged revisions 233093 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r233093 |
	  mnick | 2009-12-04 11:15:47 -0600 (Fri, 04 Dec 2009) | 8 lines
	  Parse global variables or expressions in hint extensions Parse
	  global variables or expressions in hint extensions. Like: exten
	  => 400,hint,DAHDI/i2/${GLOBAL(var)} (closes issue #16166)
	  Reported by: rmudgett Tested by: mnick, rmudgett ........

2009-12-04 17:36 +0000 [r233165]  David Vossel <dvossel@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 233121 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r233121 | dvossel | 2009-12-04 11:22:31 -0600
	  (Fri, 04 Dec 2009) | 12 lines Merged revisions 233116 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r233116 | dvossel | 2009-12-04 11:21:34 -0600 (Fri, 04 Dec 2009)
	  | 6 lines document and rename strip_control() in app_voicemail
	  (closes issue #16291) Reported by: wdoekes ........
	  ................

2009-12-04 17:23 +0000 [r233130]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 233100 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r233100 | russell | 2009-12-04 11:18:22 -0600 (Fri, 04 Dec 2009)
	  | 14 lines Merged revisions 233092 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r233092 | russell | 2009-12-04 11:12:47 -0600 (Fri, 04 Dec 2009)
	  | 7 lines Only do frame payload check for HOLD frames. This code
	  was added for helping to debug the source of invalid HOLD frames.
	  However, a side effect of this is that it will incorrectly report
	  errors for frames that have an integer payload. Make the check
	  for this block specific to the HOLD frame case. ........
	  ................

2009-12-04 15:57 +0000 [r233049]  Matthias Nick <mnick@digium.com>

	* main/dsp.c, /: Merged revisions 233046 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r233046 | mnick | 2009-12-04 09:38:33 -0600 (Fri, 04 Dec 2009) |
	  17 lines Merged revisions 233014 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r233014 | mnick | 2009-12-04 09:17:03 -0600 (Fri, 04 Dec 2009) |
	  11 lines Warning message gets displayed only once Added
	  additional field 'int display_inband_dtmf_warning', which when
	  set to '1' displays the warning ('Inband DTMF is not supported on
	  codec %s. Use RFC2833'), and when set to '0' doesn't display the
	  warning. Otherwise you would get hundreds of warnings every
	  second. (closes issue #15769) Reported by: falves11 Patches:
	  patch_15769_14.txt uploaded by mnick (license 874) Tested by:
	  mnick, falves11 ........ ................

2009-12-03 21:03 +0000 [r232866]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 232854 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r232854 | tilghman | 2009-12-03 14:47:07 -0600
	  (Thu, 03 Dec 2009) | 15 lines Merged revisions 232820 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r232820 | tilghman | 2009-12-03 14:10:19 -0600 (Thu, 03 Dec 2009)
	  | 8 lines Deprecate "cz" in favor of "cs". Also, change the use
	  of language codes so that language registers as a prefix, rather
	  than an exact match. (closes issue #16272) Reported by: patrol-cz
	  Patches: 20091203__issue16272.diff.txt uploaded by tilghman
	  (license 14) ........ ................

2009-12-03 15:14 +0000 [r232813]  David Ruggles <thedavidfactor@gmail.com>

	* apps/app_externalivr.c: Merged revisions 232587 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r232587 |
	  diruggles | 2009-12-02 17:17:22 -0500 (Wed, 02 Dec 2009) | 12
	  lines Prevent double closing of FDs by EIVR This caused a problem
	  when asterisk was under heavy load and running both AGI and EIVR
	  applications. EIVR would close an FD at which point it would be
	  considered freed and be used by a new AGI instance the second
	  close would then close the FD now in use by AGI. (closes issue
	  #16305) Reported by: diLLec Tested by: thedavidfactor, diLLec
	  Review: https://reviewboard.asterisk.org/r/436/ ........

2009-12-03 00:20 +0000 [r232675-232678]  Tilghman Lesher <tlesher@digium.com>

	* res/res_musiconhold.c: Oops, really remove it this time

	* res/res_musiconhold.c, /: Recorded merge of revisions
	  232660-232661 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r232660 |
	  tilghman | 2009-12-02 18:08:55 -0600 (Wed, 02 Dec 2009) | 19
	  lines Fix multiple issues with musiconhold, which led to classes
	  not getting destroyed properly. * Classes are now tracked past
	  removal from the core container, and module removal is actively
	  prevented until all references are freed. * A hanging reference
	  stored in the channel has been removed. This could have caused a
	  mismatch and the music state not properly cleared, if two or more
	  reloads occurred between MOH being stopped and MOH being
	  restarted. * In certain circumstances, duplicate classes were
	  possible. * A race existed at reload time between a process being
	  killed and the thread responsible for reading from the related
	  pipe respawning that process. * Several reference counts have
	  also been corrected. At least one could have caused deleted
	  classes to stick around forever, consuming resources. This
	  originally manifested as MOH external processes that were not
	  killed at reload time. (closes issue #16279, closes issue #16207)
	  Reported by: parisioa, dcabot Patches:
	  20091202__issue16279__2.diff.txt uploaded by tilghman (license
	  14) Tested by: parisioa, tilghman ........ r232661 | tilghman |
	  2009-12-02 18:09:36 -0600 (Wed, 02 Dec 2009) | 2 lines Remove
	  debugging line ........

2009-12-02 23:28 +0000 [r232658]  David Vossel <dvossel@digium.com>

	* CHANGES, /, UPGRADE.txt: Merged revisions 232657 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r232657 | dvossel | 2009-12-02 17:27:45 -0600 (Wed, 02 Dec 2009)
	  | 6 lines update CHANGES and UPGRADE.txt for early media behavior
	  change between 1.6.1 and 1.6.2 (closes issue #16212) Reported by:
	  miki ........

2009-12-02 22:05 +0000 [r232579-232585]  Jeff Peeler <jpeeler@digium.com>

	* main/manager.c, /: Merged revisions 232582 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r232582 | jpeeler | 2009-12-02 16:02:43 -0600 (Wed, 02 Dec 2009)
	  | 14 lines Merged revisions 232581 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r232581 | jpeeler | 2009-12-02 15:57:42 -0600 (Wed, 02 Dec 2009)
	  | 7 lines Send ack (response/message) after receiving manager
	  action userevent (closes issue #16264) Reported by: dimas
	  Patches: event-ack.patch uploaded by dimas (license 88) ........
	  ................

	* main/manager.c, /: Merged revisions 232576 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r232576 |
	  jpeeler | 2009-12-02 15:32:50 -0600 (Wed, 02 Dec 2009) | 8 lines
	  Make manager response to "Action: events" finish with empty line
	  (closes issue #16275) Reported by: vnovy Patches: manager.c.diff
	  uploaded by vnovy (license 922) ........

2009-12-02 17:11 +0000 [r232359]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_amd.c: Merged revisions 232356 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r232356 | file | 2009-12-02 13:06:54 -0400 (Wed, 02 Dec 2009) |
	  12 lines Merged revisions 232355 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r232355 | file | 2009-12-02 13:04:52 -0400 (Wed, 02 Dec 2009) | 5
	  lines Fix a bug where if you hung up very quickly after calling
	  AMD it would overwrite the AMDSTATUS of HANGUP with TOOLONG.
	  (closes issue #16239) Reported by: CGMChris ........
	  ................

2009-12-02 17:01 +0000 [r232352]  David Vossel <dvossel@digium.com>

	* /, main/acl.c: Merged revisions 232351 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r232351 | dvossel | 2009-12-02 11:00:15 -0600 (Wed, 02 Dec 2009)
	  | 12 lines Merged revisions 232350 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r232350 | dvossel | 2009-12-02 10:59:18 -0600 (Wed, 02 Dec 2009)
	  | 6 lines ast_outaddrfor doesn't do htons() on port, looks odd in
	  strace. (closes issue #16290) Reported by: wdoekes ........
	  ................

2009-12-02 16:43 +0000 [r232348]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 232345 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r232345 |
	  file | 2009-12-02 12:40:14 -0400 (Wed, 02 Dec 2009) | 7 lines Add
	  support for handling the 415 Unsupported media type response like
	  we do for a 488 Not acceptable here response. (closes issue
	  #16186) Reported by: atis Patches: sip_t38_response_415.patch
	  uploaded by atis (license 242) ........

2009-12-02 15:43 +0000 [r232270]  David Vossel <dvossel@digium.com>

	* funcs/func_groupcount.c, /: Merged revisions 232269 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r232269 | dvossel | 2009-12-02 09:42:54 -0600
	  (Wed, 02 Dec 2009) | 15 lines Merged revisions 232268 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r232268 | dvossel | 2009-12-02 09:41:36 -0600 (Wed, 02 Dec 2009)
	  | 9 lines fixes segfault in func_groupcount closes issue #16337)
	  Reported by: Parantido Patches: issue_16337.diff uploaded by
	  dvossel (license 671) Tested by: Parantido, dvossel ........
	  ................

2009-12-02 14:55 +0000 [r232232]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 232230 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r232230 |
	  file | 2009-12-02 10:54:28 -0400 (Wed, 02 Dec 2009) | 5 lines Fix
	  a bug where a scheduled item ID would get retained on
	  registrations in a certain scenario causing code to execute
	  during reload that should not. (issue AST-263) ........

2009-12-02 00:52 +0000 [r232094]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 232091 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r232091 | jpeeler | 2009-12-01 18:45:18 -0600
	  (Tue, 01 Dec 2009) | 17 lines Merged revisions 232090 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r232090 | jpeeler | 2009-12-01 18:42:58 -0600 (Tue, 01 Dec 2009)
	  | 10 lines Do not modify the gain settings on data calls. (The
	  digital flag actually represents a data call.) (closes issue
	  #15972) Reported by: udosw Patches: transcap_digital_fix.diff.txt
	  uploaded by alecdavis (license 585) Tested by: alecdavis ........
	  ................

2009-12-01 23:40 +0000 [r232011-232015]  Russell Bryant <russell@digium.com>

	* /, funcs/func_lock.c: Merged revisions 232012 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r232012 |
	  russell | 2009-12-01 17:38:34 -0600 (Tue, 01 Dec 2009) | 2 lines
	  Fix a build error on FreeBSD. ........

	* /, main/file.c: Merged revisions 232008 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r232008 | russell | 2009-12-01 17:27:53 -0600 (Tue, 01 Dec 2009)
	  | 9 lines Merged revisions 232007 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r232007 | russell | 2009-12-01 17:25:36 -0600 (Tue, 01 Dec 2009)
	  | 2 lines Fix a warning pointed out by buildbot. ........
	  ................

2009-12-01 22:03 +0000 [r231930]  Jeff Peeler <jpeeler@digium.com>

	* main/channel.c, /: Merged revisions 231927 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r231927 | jpeeler | 2009-12-01 15:54:21 -0600 (Tue, 01 Dec 2009)
	  | 19 lines Merged revisions 231911 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r231911 | jpeeler | 2009-12-01 15:29:31 -0600 (Tue, 01 Dec 2009)
	  | 12 lines Fix crash with invalid frame data The crash was
	  happening as a result of a frame containing an invalid data
	  pointer, but was set with data length of zero. The few times the
	  issue was reproduced it _seemed_ that the frame was queued
	  properly, that is the data pointer was set to NULL. I never could
	  reproduce the crash so as a last resort the crash has been fixed,
	  but a check in __ast_read has been added to give as much
	  information about the source of problematic frames in the future.
	  (closes issue #16058) Reported by: atis ........ ................

2009-12-01 21:21 +0000 [r231870]  David Vossel <dvossel@digium.com>

	* main/pbx.c, /: Merged revisions 231867 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r231867 | dvossel | 2009-12-01 15:20:19 -0600 (Tue, 01 Dec 2009)
	  | 9 lines Merged revisions 231853 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r231853 | dvossel | 2009-12-01 15:14:31 -0600 (Tue, 01 Dec 2009)
	  | 3 lines WaitExten m option with no parameters generates frame
	  with zero datalen but non-null data ptr ........ ................

2009-12-01  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-rc7

2009-12-01 15:48 +0000 [r231743]  Matthew Nicholson <mnicholson@digium.com>

	* /, main/file.c: Merged revisions 231741 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r231741 | mnicholson | 2009-12-01 09:47:36 -0600 (Tue, 01 Dec
	  2009) | 9 lines Merged revisions 231740 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r231740 | mnicholson | 2009-12-01 09:34:57 -0600 (Tue, 01 Dec
	  2009) | 2 lines Ignore unknown formats in ast_format_str_reduce()
	  and return an error if no know formats are found. ........
	  ................

2009-11-30 21:59 +0000 [r231695-231696]  Kevin P. Fleming <kpfleming@digium.com>

	* main/udptl.c, /, channels/chan_sip.c, include/asterisk/udptl.h:
	  Merged revisions 231692 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r231692 |
	  kpfleming | 2009-11-30 15:47:42 -0600 (Mon, 30 Nov 2009) | 22
	  lines Another round of UDPTL stack fixes/improvements: 1) Allow
	  users of UDPTL stack to associate a character-string tag with a
	  UDPTL session, so that log/error/debug messages generated by the
	  UDPTL stack can be 'connected' to the endpoint that caused them
	  to be generated. 2) Improve comments (and process) of calculating
	  the far end's maximum IFP size when redundancy mode is in use for
	  error correction. 3) When an IFP larger than the calculated 'far
	  max IFP' size is presented for writing, truncate it rather than
	  putting in the buffer and allowing the buffer to overflow; this
	  will cause the ends to retrain to a lower bit rate that produces
	  IFPs of an appropriate size if possible, and if not possible, the
	  FAX transfer will fail completely. In these cases, it is due to
	  the one endpoint supplying a T38FaxMaxDatagram value that is
	  improperly calculated and is too low to be of use; we have
	  configuration options available to override this behavior. 4)
	  Eliminate use of T38FaxMaxDatagram value in udptl.conf; it is no
	  longer needed. ........

	* pbx/pbx_config.c: Backport a tiny fix from trunk that makes GCC
	  4.4.x happier.

2009-11-30 21:36 +0000 [r231689]  Matthew Nicholson <mnicholson@digium.com>

	* apps/app_voicemail.c, include/asterisk/file.h, /, main/file.c,
	  main/app.c: Merged revisions 231688 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r231688 | mnicholson | 2009-11-30 15:31:55 -0600 (Mon, 30 Nov
	  2009) | 15 lines Merged revisions 231614 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r231614 | mnicholson | 2009-11-30 15:11:44 -0600 (Mon, 30 Nov
	  2009) | 8 lines Remove duplicate entries from voicemail format
	  lists. This prevents app_voicemail from entering an infinite loop
	  when the same format is specified twice in the format list.
	  (closes issue #15625) Reported by: Shagg63 Tested by: mnicholson
	  Review: https://reviewboard.asterisk.org/r/429/ ........
	  ................

2009-11-30 20:47 +0000 [r231605]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 231602 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r231602 |
	  file | 2009-11-30 16:44:30 -0400 (Mon, 30 Nov 2009) | 5 lines
	  When receiving SDP that matches the version of the last one do
	  not treat it as a fatal error. (closes issue #16238) Reported by:
	  seandarcy ........

2009-11-30 18:57 +0000 [r231505-231558]  David Vossel <dvossel@digium.com>

	* apps/app_queue.c, /: Merged revisions 231556 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r231556 |
	  dvossel | 2009-11-30 12:55:07 -0600 (Mon, 30 Nov 2009) | 11 lines
	  app_queue crashes randomly, often during call-transfers This
	  patch adds a ref to the queue_ent object's parent call_queue in
	  queue_exec() so the call_queue won't be destroyed while the the
	  queue_ent still holds a pointer to it. (closes issue 0015686)
	  Tested by: dvossel, aragon ........

	* main/rtp.c, /: Merged revisions 231491 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r231491 | dvossel | 2009-11-30 11:28:28 -0600 (Mon, 30 Nov 2009)
	  | 17 lines Merged revisions 231441 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r231441 | dvossel | 2009-11-30 11:14:08 -0600 (Mon, 30 Nov 2009)
	  | 11 lines fixes crash caused by RTP comfort noise payload
	  greater than 24 bytes AST-2009-010 (closes issue #16242) Reported
	  by: amorsen Patches: issue16242.diff uploaded by oej (license
	  306) Tested by: amorsen, oej, dvossel ........ ................

2009-11-25 22:34 +0000 [r231302]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /: Merged revisions 231299 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r231299 | tilghman | 2009-11-25 16:33:02 -0600 (Wed, 25 Nov 2009)
	  | 9 lines Merged revisions 231298 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r231298 | tilghman | 2009-11-25 16:31:57 -0600 (Wed, 25 Nov 2009)
	  | 2 lines After a frame duplication failure, unlock the channel
	  before returning. ........ ................

2009-11-25 15:48 +0000 [r231191]  Matthew Nicholson <mnicholson@digium.com>

	* /, pbx/pbx_lua.c: Merged revisions 231189 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r231189 |
	  mnicholson | 2009-11-25 09:42:48 -0600 (Wed, 25 Nov 2009) | 4
	  lines Load pbx_lua with global symbols to allow linking with
	  other lua libraries. Found by Maxim Litnitskiy. ........

2009-11-24 20:36 +0000 [r231136]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_queue.c, /: Merged revisions 231134 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r231134 |
	  tilghman | 2009-11-24 14:31:28 -0600 (Tue, 24 Nov 2009) | 7 lines
	  Found a few places where queue refcounts were counted
	  incorrectly. Also add debug statements. (closes issue #15982,
	  closes issue #15984) Reported by: atis Patches:
	  20091111__issue15982.diff.txt uploaded by tilghman (license 14)
	  Tested by: atis ........

2009-11-24 18:54 +0000 [r231098]  Jeff Peeler <jpeeler@digium.com>

	* /, main/features.c: Merged revisions 231095 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r231095 |
	  jpeeler | 2009-11-24 12:50:36 -0600 (Tue, 24 Nov 2009) | 11 lines
	  Fix erroneous hangup extension execution ast_spawn_extension
	  behaves differently from 1.4 in that hangups and extensions that
	  do not exist do not return an error, whereas in 1.6 it does. This
	  is now taken into account so that the AST_FLAG_BRIDGE_HANGUP_RUN
	  flag gets set properly. (closes issue #16106) Reported by:
	  ajohnson Tested by: ajohnson ........

2009-11-23 15:48 +0000 [r230884]  Joshua Colp <jcolp@digium.com>

	* configs/sip.conf.sample, /, channels/chan_sip.c: Merged revisions
	  230881 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r230881 |
	  file | 2009-11-23 09:45:45 -0600 (Mon, 23 Nov 2009) | 7 lines
	  Change fax detection in chan_sip so it behaves as one would
	  expect. Internally the way T.38 is negotiated has changed and the
	  option no longer reflects a behavior that is valid. It will now
	  look for a CNG tone on received calls and if present send the
	  call to the 'fax' extension. It is then up to the application or
	  channel to request the switch over to T.38. ........

2009-11-23 15:38 +0000 [r230796-230880]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c: Merged revisions 230877 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r230877 | kpfleming | 2009-11-23 09:34:16 -0600 (Mon, 23 Nov
	  2009) | 9 lines Merged revisions 230839 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r230839 | kpfleming | 2009-11-23 09:09:24 -0600 (Mon, 23 Nov
	  2009) | 1 line Correct fix for issue #16268... the reporter's
	  original patch was very close to correct. ........
	  ................

	* /, channels/chan_sip.c: Merged revisions 230773 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r230773 | kpfleming | 2009-11-23 08:15:48 -0600 (Mon, 23 Nov
	  2009) | 12 lines Merged revisions 230772 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r230772 | kpfleming | 2009-11-23 08:13:56 -0600 (Mon, 23 Nov
	  2009) | 5 lines Ensure that SDP parsing does not ignore the last
	  line of the SDP. (closes issue #16268) Reported by: sgimeno
	  ........ ................

2009-11-20 22:36 +0000 [r230727]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 230726 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r230726 | dvossel | 2009-11-20 16:35:54 -0600 (Fri, 20 Nov 2009)
	  | 7 lines fixes iax2 show cache locking error, thanks alecdavis!
	  (closes issue #16094) Reported by: alecdavis Patches:
	  bug16094.diff.txt uploaded by alecdavis (license 585) Tested by:
	  alecdavis, dvossel ........

2009-11-20 21:07 +0000 [r230629]  Matthew Nicholson <mnicholson@digium.com>

	* /, main/features.c: Merged revisions 230628 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r230628 | mnicholson | 2009-11-20 15:01:10 -0600 (Fri, 20 Nov
	  2009) | 15 lines Merged revisions 230627 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r230627 | mnicholson | 2009-11-20 14:53:06 -0600 (Fri, 20 Nov
	  2009) | 8 lines Copy the peer CDR's userfield to the bridge CDR
	  if it exists. This is necessary for the recordagentcalls option
	  in chan_agent to store the recorded file name in the bridge CDR.
	  (closes issue #14590) Reported by: msetim Patches:
	  queue_agent_userfield.patch uploaded by Laureano (license 265)
	  Tested by: Laureano, mnicholson ........ ................

2009-11-20 17:31 +0000 [r230510-230585]  David Vossel <dvossel@digium.com>

	* main/audiohook.c, /, include/asterisk/audiohook.h: Merged
	  revisions 230583 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r230583 |
	  dvossel | 2009-11-20 11:26:20 -0600 (Fri, 20 Nov 2009) | 6 lines
	  audiohook signal trigger on every status change (issue #14618)
	  Review: https://reviewboard.asterisk.org/r/434/ ........

	* apps/app_mixmonitor.c, /: Merged revisions 230509 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r230509 | dvossel | 2009-11-19 15:26:21 -0600
	  (Thu, 19 Nov 2009) | 17 lines Merged revisions 230508 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r230508 | dvossel | 2009-11-19 15:22:46 -0600 (Thu, 19 Nov 2009)
	  | 10 lines fixes MixMonitor thread not exiting when
	  StopMixMonitor is used (closes issue #16152) Reported by: AlexMS
	  Patches: stopmixmonitor_1.4.diff uploaded by dvossel (license
	  671) Tested by: dvossel, AlexMS Review:
	  https://reviewboard.asterisk.org/r/424/ ........ ................

2009-11-16 16:41 +0000 [r230250-230384]  Kevin P. Fleming <kpfleming@digium.com>

	* /, apps/app_fax.c: Merged revisions 230381 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r230381 |
	  kpfleming | 2009-11-16 10:40:25 -0600 (Mon, 16 Nov 2009) | 1 line
	  Fix another buglet in T.38 session teardown at the end of FAX
	  sessions. ........

	* /, apps/app_fax.c: Merged revisions 230343 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r230343 |
	  kpfleming | 2009-11-16 06:51:59 -0600 (Mon, 16 Nov 2009) | 2
	  lines Ensure that only one end of a T.38 session initiates
	  teardown at completion. ........

	* channels/chan_iax2.c, /: Merged revisions 230247 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r230247 | kpfleming | 2009-11-15 11:23:02 -0600
	  (Sun, 15 Nov 2009) | 12 lines Merged revisions 230246 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r230246 | kpfleming | 2009-11-15 11:19:06 -0600 (Sun, 15 Nov
	  2009) | 6 lines Correct mistaken option name in error message.
	  The configuration option for allowing hosts to make
	  non-token-based calls is 'calltokenoptional', not
	  'calltokenignore'. (reported on asterisk-users) ........
	  ................

2009-11-13 22:01 +0000 [r229969-230148]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 230145 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r230145 | file | 2009-11-13 16:00:44 -0600 (Fri, 13 Nov 2009) |
	  15 lines Merged revisions 230144 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r230144 | file | 2009-11-13 16:00:19 -0600 (Fri, 13 Nov 2009) | 8
	  lines Respect the maddr parameter in the Via header. (closes
	  issue #14446) Reported by: frawd Patches: via_maddr.patch
	  uploaded by frawd (license 610) Tested by: frawd ........
	  ................

	* channels/chan_local.c, /: Merged revisions 230039 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r230039 | file | 2009-11-13 13:44:53 -0600 (Fri,
	  13 Nov 2009) | 16 lines Merged revisions 230038 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r230038 | file | 2009-11-13 13:44:07 -0600 (Fri, 13 Nov 2009) | 9
	  lines Fix a crash caused by two threads thinking they should both
	  free the chan_local private structure when only one should.
	  (closes issue #15314) Reported by: sroberts Patches:
	  Issue15314_Move_Nulling_owner.patch uploaded by davidw (license
	  780) Tested by: davidw, lottc ........ ................

	* configs/extensions.conf.sample, /, apps/app_chanisavail.c: Merged
	  revisions 229966 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r229966 | file | 2009-11-13 11:20:26 -0600 (Fri, 13 Nov 2009) |
	  13 lines Merged revisions 229965 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229965 | file | 2009-11-13 11:19:59 -0600 (Fri, 13 Nov 2009) | 6
	  lines Document a limitation in the AVAILSTATUS variable from
	  ChanIsAvail and provide a workaround for it that does not change
	  existing behavior. (closes issue #14426) Reported by: macli
	  ........ ................

2009-11-13  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-rc6

2009-11-13 15:57 +0000 [r229915]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 229912 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r229912 |
	  file | 2009-11-13 09:56:16 -0600 (Fri, 13 Nov 2009) | 2 lines Fix
	  T.38 negotiation regression introduced with the SDP parser
	  changes. ........

2009-11-12 23:31 +0000 [r229752]  Jason Parker <jparker@digium.com>

	* channels/chan_oss.c, /: Merged revisions 229750 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r229750 |
	  qwell | 2009-11-12 17:30:10 -0600 (Thu, 12 Nov 2009) | 1 line Fix
	  mute toggling on OSS channels. ........

2009-11-12 16:47 +0000 [r229671]  David Vossel <dvossel@digium.com>

	* funcs/func_audiohookinherit.c, /: Merged revisions 229670 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r229670 | dvossel | 2009-11-12 10:44:39 -0600
	  (Thu, 12 Nov 2009) | 12 lines Merged revisions 229669 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229669 | dvossel | 2009-11-12 10:41:49 -0600 (Thu, 12 Nov 2009)
	  | 6 lines fixes merging error, datastore was being freed in the
	  wrong function. (closes issue #16219) Reported by: aragon
	  ........ ................

2009-11-11 20:49 +0000 [r229570]  David Ruggles <thedavidfactor@gmail.com>

	* doc/externalivr.txt: Merged revisions 229568 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r229568 |
	  diruggles | 2009-11-11 15:47:06 -0500 (Wed, 11 Nov 2009) | 9
	  lines Remove non-functional feature from ExternalIVR
	  documentation Remove non-functional socket implementation of
	  ExternalIVR from documentation (closes issue #16225) Reported by:
	  thedavidfactor Patches: externalivr.txt.20091111.1542.patch
	  uploaded by thedavidfactor (license 903) ........

2009-11-11 19:56 +0000 [r229492-229502]  David Brooks <dbrooks@digium.com>

	* main/pbx.c, /: Merged revisions 229499 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r229499 | dbrooks | 2009-11-11 13:48:18 -0600 (Wed, 11 Nov 2009)
	  | 15 lines Merged revisions 229498 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229498 | dbrooks | 2009-11-11 13:46:19 -0600 (Wed, 11 Nov 2009)
	  | 8 lines Solaris doesn't like NULL going to ast_log Solaris will
	  crash if NULL is passed to ast_log. This simple patch simply uses
	  S_OR to get around this. (closes issue #15392) Reported by:
	  yrashk ........ ................

	* /, apps/app_softhangup.c: Merged revisions 229460 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r229460 | dbrooks | 2009-11-11 12:13:56 -0600 (Wed, 11 Nov 2009)
	  | 7 lines Flags not initialized in app_softhangup.c, causing
	  undefined behavior Trivial patch [kobaz] to initialize an
	  ast_flags = {0} (closes issue #16129) Reported by: kobaz ........

2009-11-10 22:17 +0000 [r229366]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 229361 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r229361 | tilghman | 2009-11-10 16:14:22 -0600 (Tue, 10 Nov 2009)
	  | 19 lines Merged revisions 229360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229360 | tilghman | 2009-11-10 16:09:16 -0600 (Tue, 10 Nov 2009)
	  | 12 lines If two pattern classes start with the same digit and
	  have the same number of characters, they will compare equal. The
	  example given in the issue report is that of [234] and [246],
	  which have these characteristics, yet they are clearly not
	  equivalent. The code still uses these two characteristics, yet
	  when the two scores compare equal, an additional check will be
	  done to compare all characters within the class to verify
	  equality. (closes issue #15421) Reported by: jsmith Patches:
	  20091109__issue15421__2.diff.txt uploaded by tilghman (license
	  14) Tested by: jsmith, thedavidfactor ........ ................

2009-11-10 22:04 +0000 [r229359]  David Ruggles <thedavidfactor@gmail.com>

	* doc/externalivr.txt: Merged revisions 229356 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r229356 | diruggles | 2009-11-10 17:01:50 -0500 (Tue, 10 Nov
	  2009) | 16 lines Merged revisions 229355 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229355 | diruggles | 2009-11-10 16:45:15 -0500 (Tue, 10 Nov
	  2009) | 9 lines Fix ExternalIVR Documentation Remove
	  documentation for event that doesn't function (closes issue
	  #16220) Reported by: thedavidfactor Patches:
	  externalivr.txt.20091110.1622.patch uploaded by thedavidfactor
	  (license 903) ........ ................

2009-11-10 21:33 +0000 [r229354]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_stack.c, /: Merged revisions 229351 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r229351 |
	  tilghman | 2009-11-10 15:22:50 -0600 (Tue, 10 Nov 2009) | 7 lines
	  When GOSUB is invoked within an AGI, it may not exit correctly.
	  (closes issue #16216) Reported by: atis Patches:
	  20091110__atis_work.diff.txt uploaded by tilghman (license 14)
	  Tested by: atis ........

2009-11-10 20:09 +0000 [r229285]  Joshua Colp <jcolp@digium.com>

	* /, codecs/codec_g726.c: Merged revisions 229282 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r229282 | file | 2009-11-10 16:06:13 -0400 (Tue, 10 Nov 2009) |
	  15 lines Merged revisions 229281 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229281 | file | 2009-11-10 16:03:14 -0400 (Tue, 10 Nov 2009) | 8
	  lines Remove broken support for direct transcoding between G.726
	  RFC3551 and G.726 AAL2. On some systems the translation core
	  would actually consider g726aal2 -> g726 -> signed linear to be a
	  quicker path then g726aal2 -> signed linear which exposed this
	  problem. (closes issue #15504) Reported by: globalnetinc ........
	  ................

2009-11-10 17:52 +0000 [r229232]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 229168 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r229168 | dvossel | 2009-11-10 11:16:49 -0600
	  (Tue, 10 Nov 2009) | 15 lines Merged revisions 229167 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229167 | dvossel | 2009-11-10 11:15:57 -0600 (Tue, 10 Nov 2009)
	  | 9 lines don't crash on log message in solaris AST-2009-006
	  (closes issue #16206) Reported by: bklang Tested by: bklang
	  ........ ................

2009-11-10 17:39 +0000 [r229231]  David Ruggles <thedavidfactor@gmail.com>

	* doc/externalivr.txt: Merged revisions 229228 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r229228 | diruggles | 2009-11-10 12:33:47 -0500 (Tue, 10 Nov
	  2009) | 18 lines Merged revisions 229191 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r229191 | diruggles | 2009-11-10 12:23:59 -0500 (Tue, 10 Nov
	  2009) | 11 lines Document ExternalIVR event tag collision
	  ExternalIVR uses the D tag for two different event types. This
	  documents that behavior and how to differentiate between the two
	  cases. Also includes a minor spelling fix and clarification
	  (closes issue #16211) Reported by: thedavidfactor Patches:
	  externalivr.txt.20091109.1507.patch uploaded by thedavidfactor
	  (license 903) ........ ................

2009-11-10 15:47 +0000 [r229101]  Matthew Nicholson <mnicholson@digium.com>

	* UPGRADE-1.6.txt, main/editline/makelist.in, UPGRADE.txt: Reset
	  props that were accidently deleted in 229088.

2009-11-10 15:28 +0000 [r229094]  David Vossel <dvossel@digium.com>

	* res/res_config_pgsql.c, /: Merged revisions 229093 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r229093 | dvossel | 2009-11-10 09:27:45 -0600 (Tue, 10 Nov 2009)
	  | 11 lines fixes pgsql double free of threadstorage A thread
	  storage variable was being freed incorrectly, which resulted in a
	  double free if two queries were made in the same thread. (closes
	  issue #16011) Reported by: cristiandimache Patches:
	  issue16011.diff uploaded by dvossel (license 671) ........

2009-11-10 15:16 +0000 [r229088]  Matthew Nicholson <mnicholson@digium.com>

	* UPGRADE-1.6.txt, main/editline/makelist.in, channels/chan_sip.c,
	  UPGRADE.txt: Reverted revision 202007. (closes issue #16175)
	  Reported by: paul-tg Tested by: paul-tg

2009-11-10 11:25 +0000 [r229078]  Gavin Henry <ghenry@suretecsystems.com>

	* contrib/scripts/asterisk.ldap-schema, /: Merged revisions 229050
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r229050 | ghenry | 2009-11-10 11:16:10 +0000 (Tue, 10
	  Nov 2009) | 20 lines Schema file additions * Added
	  AsteriskDialplan, AsteriskAccount and AsteriskMailbox
	  objectClasses to allow standalone dialplan, account and mailbox
	  entries (STRUCTURAL) * Added new Fields: - AstAccountLanguage,
	  AstAccountTransport, AstAccountPromiscRedir, -
	  AstAccountAccountCode, AstAccountSetVar, AstAccountAllowOverlap,
	  - AstAccountVideoSupport, AstAccountIgnoreSDPVersion * Removed
	  redundant IPaddr (there's already IPAddress) - Gives more
	  configuration Flags for SIP-Users available (tested) - Allows to
	  create Asterisk Attributes in defined Asterisk ObjectClasses
	  without extensibleObject (which really should be the last
	  resort); gives also additional possibilities for LDAP-filter
	  (closes issue #15874) Reported by: Medozas Patches:
	  asterisk.ldap-schema.patch uploaded by Medozas (license 41)
	  Tested by: Medozas, suretec ........

2009-11-09 22:59 +0000 [r229017]  Terry Wilson <twilson@digium.com>

	* channels/chan_local.c, /: Merged revisions 229015 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r229015 | twilson | 2009-11-09 16:50:22 -0600 (Mon, 09 Nov 2009)
	  | 8 lines Don't crash when bridge->tech_pvt == NULL This is a
	  similar solution to what is in place for chan_agent (closes issue
	  #16003) Reported by: atis Tested by: twilson ........

2009-11-09 22:17 +0000 [r229012]  David Vossel <dvossel@digium.com>

	* channels/chan_sip.c: fixes segfault when transferring a queue
	  caller In sip_hangup we attempted to lock p->owner after we set
	  it to NULL. Thanks to fhackenberger for reporting the issue and
	  submitting a patch. (closes issue #15848) Reported by:
	  fhackenberger Patches: digium_bug_0015848 uploaded by
	  fhackenberger (license 592) Tested by: fhackenberger, lmadsen,
	  TomS, shin-shoryuken, dvossel

2009-11-09  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-rc5

2009-11-09 15:40 +0000 [r228900]  Leif Madsen <lmadsen@digium.com>

	* main/channel.c: Merged revisions 228897 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r228897 | lmadsen | 2009-11-09 09:38:38 -0600 (Mon, 09 Nov 2009)
	  | 14 lines Merged revisions 228896 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228896 | lmadsen | 2009-11-09 09:37:43 -0600 (Mon, 09 Nov 2009)
	  | 6 lines Update WARNING message. Update a WARNING message to
	  give a suggested fix when encountered. (closes issue #16198)
	  Reported by: atis Tested by: atis ........ ................

2009-11-09 14:48 +0000 [r228859]  Matthew Nicholson <mnicholson@digium.com>

	* /, include/asterisk/lock.h: Merged revisions 228858 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r228858 | mnicholson | 2009-11-09 08:37:07 -0600
	  (Mon, 09 Nov 2009) | 15 lines Merged revisions 228827 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228827 | mnicholson | 2009-11-09 08:16:03 -0600 (Mon, 09 Nov
	  2009) | 8 lines Perform limited bounds checking when destroying
	  ast_mutex_t structures to make sure we don't try to use negative
	  indices. (closes issue #15588) Reported by: zerohalo Patches:
	  20090820__issue15588.diff.txt uploaded by tilghman (license 14)
	  Tested by: zerohalo ........ ................

2009-11-06 22:37 +0000 [r228694]  David Vossel <dvossel@digium.com>

	* main/channel.c, /: Merged revisions 228693 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r228693 | dvossel | 2009-11-06 16:35:44 -0600 (Fri, 06 Nov 2009)
	  | 16 lines Merged revisions 228692 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228692 | dvossel | 2009-11-06 16:33:27 -0600 (Fri, 06 Nov 2009)
	  | 9 lines fixes audiohook write crash occuring in chan_spy
	  whisper mode. After writing to the audiohook list in ast_write(),
	  frames were being freed incorrectly. Under certain conditions
	  this resulted in a double free crash. (closes issue #16133)
	  Reported by: wetwired ........ ................

2009-11-06 20:26 +0000 [r228649]  Matthew Nicholson <mnicholson@digium.com>

	* funcs/func_base64.c, /, main/utils.c: Merged revisions 228620 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r228620 | mnicholson | 2009-11-06 13:47:11 -0600
	  (Fri, 06 Nov 2009) | 15 lines Merged revisions 228378 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228378 | mnicholson | 2009-11-06 10:26:59 -0600 (Fri, 06 Nov
	  2009) | 8 lines Properly handle '=' while decoding base64
	  messages and null terminate strings returned from BASE64_DECODE.
	  (closes issue #15271) Reported by: chappell Patches:
	  base64_fix.patch uploaded by chappell (license 8) Tested by:
	  kobaz ........ ................

2009-11-06 18:43 +0000 [r228551]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 228548 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r228548 | file | 2009-11-06 14:37:59 -0400 (Fri, 06 Nov 2009) |
	  11 lines Merged revisions 228547 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228547 | file | 2009-11-06 14:32:58 -0400 (Fri, 06 Nov 2009) | 4
	  lines Don't overwrite caller ID name on a trunk with the
	  configured fullname when using users.conf (issue ABE-1989)
	  ........ ................

2009-11-06  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-rc4

2009-11-06 17:54 +0000 [r228504]  Joshua Colp <jcolp@digium.com>

	* doc/tex/localchannel.tex, /: Merged revisions 228499 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r228499 | file | 2009-11-06 13:52:00 -0400 (Fri, 06 Nov 2009) | 2
	  lines Fix the localchannel.tex file. ........

2009-11-06 17:24 +0000 [r228421-228447]  David Vossel <dvossel@digium.com>

	* codecs/codec_ilbc.c, /: Merged revisions 228441 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r228441 |
	  dvossel | 2009-11-06 11:22:31 -0600 (Fri, 06 Nov 2009) | 3 lines
	  Fixes merging issue from 1.4, frame data is held in data.ptr in
	  trunk ........

	* codecs/codec_ilbc.c, /: Merged revisions 228420 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r228420 | dvossel | 2009-11-06 11:09:01 -0600 (Fri, 06 Nov 2009)
	  | 19 lines Merged revisions 228418 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228418 | dvossel | 2009-11-06 11:07:13 -0600 (Fri, 06 Nov 2009)
	  | 13 lines fixes segfault in iLBC For reasons not yet known, it
	  appears possible for an ast_frame to have a datalen greater than
	  zero while the actual data is NULL during Packet Loss
	  Concealment. Most codecs don't support PLC so this doesn't affect
	  them. This patch catches the malformed frame and prevents the
	  crash from occuring. Additional efforts to determine why it is
	  possible for a frame to look like this are still being
	  investigated. (issue #16979) ........ ................

2009-11-06 16:44 +0000 [r228413]  Joshua Colp <jcolp@digium.com>

	* /, main/abstract_jb.c: Merged revisions 228410 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r228410 | file | 2009-11-06 12:42:23 -0400 (Fri, 06 Nov 2009) |
	  14 lines Merged revisions 228409 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228409 | file | 2009-11-06 12:41:20 -0400 (Fri, 06 Nov 2009) | 7
	  lines Fix a bug caused by a partially invalid frame (from the
	  jitterbuffer) passing through the Asterisk core. (closes issue
	  #15560) Reported by: jvandal (closes issue #15709) Reported by:
	  covici ........ ................

2009-11-06 15:43 +0000 [r228269-228340]  David Vossel <dvossel@digium.com>

	* /, main/astfd.c: Merged revisions 228339 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r228339 | dvossel | 2009-11-06 09:42:46 -0600 (Fri, 06 Nov 2009)
	  | 12 lines Merged revisions 228338 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228338 | dvossel | 2009-11-06 09:41:41 -0600 (Fri, 06 Nov 2009)
	  | 5 lines fixes crash in astfd.c (closes issue #15981) Reported
	  by: slavon ........ ................

	* funcs/func_audiohookinherit.c, /: Merged revisions 228268 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r228268 | dvossel | 2009-11-06 09:04:24 -0600 (Fri, 06
	  Nov 2009) | 9 lines fixes memory leak in func_audiohookinherit.c
	  (closes issue #15394) Reported by: boroda Patches:
	  bug15394_memoryleak_diff2.txt uploaded by dbrooks (license 790)
	  Tested by: dbrooks, boroda ........

2009-11-05 22:13 +0000 [r228198]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_meetme.c: Merged revisions 228196 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r228196 |
	  tilghman | 2009-11-05 16:12:45 -0600 (Thu, 05 Nov 2009) | 2 lines
	  Yet another error message in the dialplan (thanks,
	  rmudgett/russellb) ........

2009-11-05 21:27 +0000 [r228195]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_chanspy.c, /: Merged revisions 228189 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r228189 |
	  jpeeler | 2009-11-05 15:23:06 -0600 (Thu, 05 Nov 2009) | 11 lines
	  Fix the fix for chanspy option o In 224178, I assumed the
	  uploaded patch was correct as it had received positive feedback.
	  The flags were being checked in the incorrect location. Upon
	  testing the fix this time it was also found that the flags from
	  the dialplan weren't being copied to the
	  chanspy_translation_helper. (closes issue #16167) Reported by:
	  marhbere ........

2009-11-05 21:27 +0000 [r228194]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_meetme.c: Merged revisions 228191 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r228191 |
	  tilghman | 2009-11-05 15:24:21 -0600 (Thu, 05 Nov 2009) | 7 lines
	  MEETME_INFO should not return a literal error message to the
	  dialplan. (closes issue #15450) Reported by: JimVanM Patches:
	  meetmeinfopatch.diff.txt uploaded by dbrooks (license 790) Tested
	  by: JimVanM ........

2009-11-05 19:42 +0000 [r228148]  David Brooks <dbrooks@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 228145 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r228145 | dbrooks | 2009-11-05 13:34:50 -0600
	  (Thu, 05 Nov 2009) | 16 lines Merged revisions 228078 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228078 | dbrooks | 2009-11-05 12:59:41 -0600 (Thu, 05 Nov 2009)
	  | 9 lines chan_misdn Asterisk 1.4.27-rc2 crash Crash related to
	  chan_misdn connection. Patch submitted by gknispel_proformatique,
	  tested by francesco_r. "I have many crash since i have upgraded
	  to Asterisk 1.4.27-rc2. Attached a full bt." This patch zeros out
	  an ast_frame. (closes issue #16041) Reported by: francesco_r
	  ........ ................

2009-11-05 19:20 +0000 [r228093]  Jason Parker <jparker@digium.com>

	* channels/chan_vpb.cc, /: Merged revisions 228080 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r228080 | qwell | 2009-11-05 13:16:29 -0600
	  (Thu, 05 Nov 2009) | 15 lines Merged revisions 228079 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r228079 | qwell | 2009-11-05 13:14:25 -0600 (Thu, 05 Nov 2009) |
	  8 lines Fix crash on VPB exception when no hardware is present.
	  (closes issue #14970) Reported by: tzafrir Patches:
	  vpb_exception.diff uploaded by tzafrir (license 46) Tested by:
	  markwaters ........ ................

2009-11-05 17:14 +0000 [r228017]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_externalivr.c, /: Merged revisions 228015 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r228015 | tilghman | 2009-11-05 11:08:02 -0600 (Thu, 05 Nov 2009)
	  | 4 lines Don't crash if no arguments are passed. (closes issue
	  #16119) Reported by: thedavidfactor ........

2009-11-04 23:53 +0000 [r227947]  Jeff Peeler <jpeeler@digium.com>

	* res/res_monitor.c, /: Merged revisions 227945 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r227945 | jpeeler | 2009-11-04 17:50:59 -0600 (Wed, 04 Nov 2009)
	  | 21 lines Merged revisions 227944 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r227944 | jpeeler | 2009-11-04 17:47:08 -0600 (Wed, 04 Nov 2009)
	  | 14 lines Fix incorrect filename comparsion after monitor file
	  change The logic to detect if a requested file is indeed a
	  different file from the current file was incorrect. The main
	  issue being confusion of the use of filename_base which was
	  previously set without pathing information and then compared to
	  another full path. Robust file comparison logic has been added to
	  properly check if two files are the same even if symlinks are
	  used. (closes issue #15313) Reported by: caspy Patches:
	  20091103__issue15313__1.4.diff.txt uploaded by jpeeler (license
	  325) but mostly tilghman's work ........ ................

2009-11-04 21:09 +0000 [r227760-227831]  Matthew Nicholson <mnicholson@digium.com>

	* apps/app_dial.c, /: Merged revisions 227829 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r227829 | mnicholson | 2009-11-04 15:03:33 -0600 (Wed, 04 Nov
	  2009) | 17 lines Merged revisions 227827 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r227827 | mnicholson | 2009-11-04 14:52:27 -0600 (Wed, 04 Nov
	  2009) | 10 lines This patch modifies the Dial application to
	  monitor the calling channel for hangups while playing back
	  announcements. (closes issue #16005) Reported by: falves11
	  Patches: dial-announce-hangup-fix1.diff uploaded by mnicholson
	  (license 96) Tested by: mnicholson, falves11 Review:
	  https://reviewboard.asterisk.org/r/407/ ........ ................

	* channels/chan_sip.c: Modify the SDP parsing code to parse session
	  and media level items separately. With the new code, media level
	  proprieties should no longer be confused with session level
	  proprieties. This change also reorganizes some of the SDP parsing
	  code which should make it easier to manage in the future. (closes
	  issue #14994) Reported by: frawd

2009-11-04 19:28 +0000 [r227733-227748]  Joshua Colp <jcolp@digium.com>

	* /, static-http/prototype.js: Merged revisions 227739 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r227739 | file | 2009-11-04 15:26:19 -0400 (Wed,
	  04 Nov 2009) | 12 lines Merged revisions 227735 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r227735 | file | 2009-11-04 15:25:37 -0400 (Wed, 04 Nov 2009) | 5
	  lines Fix a security issue where it may be possible for someone
	  to execute a cross-site AJAX request exploit. (AST-2009-009)
	  ........ ................

	* /, channels/chan_sip.c: Merged revisions 227712 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r227712 | file | 2009-11-04 15:20:46 -0400 (Wed, 04 Nov 2009) |
	  12 lines Merged revisions 227700 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r227700 | file | 2009-11-04 15:17:39 -0400 (Wed, 04 Nov 2009) | 5
	  lines Fix a security issue where sending a REGISTER with a
	  differing username in the From URI and Authorization header would
	  reveal whether it was valid or not. (AST-2009-008) ........
	  ................

2009-11-03 20:01 +0000 [r227375]  Jason Parker <jparker@digium.com>

	* Makefile, /, main/Makefile: Merged revisions 227372 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r227372 | qwell | 2009-11-03 13:59:46 -0600 (Tue, 03 Nov 2009) |
	  9 lines Fix some build issues on Solaris. (closes issue #14517)
	  (SWP-109) Reported by: asgaroth Patches: bug_14517.diff uploaded
	  by snuffy (license 35) Tested by: asgaroth, snuffy, dougm, qwell
	  ........

2009-11-03 19:49 +0000 [r227364-227371]  Leif Madsen <lmadsen@digium.com>

	* apps/app_controlplayback.c, /: Merged revisions 227368 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r227368 | lmadsen | 2009-11-03 13:48:53 -0600 (Tue, 03
	  Nov 2009) | 8 lines Change warning message to debug message.
	  app_controlplayback outputs a warning, when in fact it is normal.
	  (closes issue #16071) Reported by: atis Patches:
	  controlplayback_warning.patch uploaded by atis (license 242)
	  ........

	* configs/extensions.conf.sample, /: Merged revisions 227361 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r227361 | lmadsen | 2009-11-03 13:25:18 -0600 (Tue, 03
	  Nov 2009) | 11 lines Additional fixes to the
	  extensions.conf.sample file. Update the extensions.conf.sample
	  [stdexten] context so that we use the variable instead of
	  requiring it to be passed explicitly. Also updated uses of the
	  [stdexten] context throughout. (closes issue #15858) Reported by:
	  pprindeville Patches: stdexten-context-update.txt uploaded by
	  lmadsen (license 10) Tested by: pprindeville ........

2009-11-03 18:15 +0000 [r227280]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c: Merged revisions 227275 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r227275 | rmudgett | 2009-11-03 11:55:47 -0600 (Tue, 03 Nov 2009)
	  | 4 lines Make sure the outgoing flag is cleared if a new channel
	  fails to get created for outgoing calls. This is the relevant
	  portion of asterisk/trunk -r226648 ........

2009-11-03 17:14 +0000 [r227239]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 227238 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r227238 |
	  dvossel | 2009-11-03 11:12:52 -0600 (Tue, 03 Nov 2009) | 5 lines
	  user.conf entries in SIP were not having their peer type set.
	  (closes issue #16120) Reported by: jsmith ........

2009-11-03 15:40 +0000 [r227170]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 227167 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r227167 | file | 2009-11-03 11:37:08 -0400 (Tue, 03 Nov 2009) |
	  12 lines Merged revisions 227166 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r227166 | file | 2009-11-03 11:36:16 -0400 (Tue, 03 Nov 2009) | 5
	  lines Fix a bug where an RPID header could be generated with a
	  blank username in the URI. (closes issue #15909) Reported by:
	  kobaz ........ ................

2009-11-03 15:25 +0000 [r227165]  Leif Madsen <lmadsen@digium.com>

	* configs/extensions.conf.sample, /: Merged revisions 227162 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r227162 | lmadsen | 2009-11-03 09:19:47 -0600 (Tue, 03
	  Nov 2009) | 7 lines Update extensions.conf.sample file to fix
	  incorrect extensions. (closes issue #15857) Reported by:
	  pprindeville Patches: stdexten.patch#2 uploaded by pprindeville
	  (license 347) Tested by: pprindeville ........

2009-11-03 13:51 +0000 [r227156]  Olle Johansson <oej@edvina.net>

	* Makefile, /, channels/chan_sip.c: Merged revisions 227091 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r227091 | oej | 2009-11-03 12:11:15 +0100 (Tis,
	  03 Nov 2009) | 15 lines Merged revisions 227088 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r227088 | oej | 2009-11-03 11:29:59 +0100 (Tis, 03 Nov 2009) | 7
	  lines Use proper response code when violating Contact ACL's.
	  https://reviewboard.asterisk.org/r/415/ Thanks kpfleming for a
	  quick review. (EDVX-003) ........ ................

2009-11-02 21:06 +0000 [r226978]  David Brooks <dbrooks@digium.com>

	* channels/chan_sip.c: SIP channel name uniqueness SIP channel
	  names were supposed to be unique by way of a name suffix derived
	  from the pointer to the channel's private data. Uniqueness was
	  preserved on 32-bit systems, but not on 64-bit systems. This
	  patch, as suggested by kpfleming, replaces this suffix with a
	  simple incremented unsigned int. (closes issue #15152) Reported
	  by: palbrecht Review: https://reviewboard.asterisk.org/r/420/

2009-11-02 18:12 +0000 [r226893]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 226890 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r226890 | file | 2009-11-02 14:08:54 -0400 (Mon, 02 Nov 2009) |
	  18 lines Merged revisions 226889 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r226889 | file | 2009-11-02 14:08:11 -0400 (Mon, 02 Nov 2009) |
	  11 lines Fix a bug where the recorded privacy introduction file
	  would not get removed if the caller hung up while the called
	  party had not yet answered. This was fixed by introducing an
	  argument to the 'n' option which, when enabled, removes the
	  introduction file under all scenarios. This was done to preserve
	  the behavior that has existed for quite some time. (closes issue
	  #14674) Reported by: ulogic Patches: bug14674.patch uploaded by
	  jpeeler (license 325) ........ ................

2009-11-02 17:17 +0000 [r226815]  Tilghman Lesher <tlesher@digium.com>

	* /, contrib/init.d/rc.redhat.asterisk: Merged revisions 226812 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r226812 | tilghman | 2009-11-02 11:15:31 -0600
	  (Mon, 02 Nov 2009) | 15 lines Merged revisions 226811 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r226811 | tilghman | 2009-11-02 11:14:20 -0600 (Mon, 02 Nov 2009)
	  | 8 lines Don't allow two separate instances of safe_asterisk
	  when restarting from the init script. (closes issue #14562)
	  Reported by: davidw Patches: Initially
	  20091022__issue14562.diff.txt uploaded by tilghman (license 14)
	  Modified to 20091030__Issue14562_diff.txt uploaded by davidw
	  (license 780) Tested by: davidw ........ ................

2009-10-29 18:18 +0000 [r226540]  Joshua Colp <jcolp@digium.com>

	* doc/tex/localchannel.tex, channels/chan_local.c, /: Merged
	  revisions 226532 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r226532 | file | 2009-10-29 15:13:42 -0300 (Thu, 29 Oct 2009) |
	  13 lines Merged revisions 226531 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r226531 | file | 2009-10-29 15:11:26 -0300 (Thu, 29 Oct 2009) | 6
	  lines Add an option to enabling passing music on hold start and
	  stop requests through instead of acting on them in chan_local.
	  (closes issue #14709) Reported by: dimas ........
	  ................

2009-10-28 21:32 +0000 [r226486]  Tzafrir Cohen <tzafrir.cohen@xorcom.com>

	* build_tools/get_documentation, /: remove empty awk pattern (//)
	  Solaris 10 nawk doesn't like the empty pattern such as '//' for
	  'always'. Just remove that. No pattern at all always matches.
	  Merged revisions 226453 via svnmerge from
	  http://svn.digium.com/svn/asterisk/trunk

2009-10-28 20:13 +0000 [r226379-226385]  Leif Madsen <lmadsen@digium.com>

	* configs/sip.conf.sample: Merged revisions 226384 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r226384 | lmadsen | 2009-10-28 15:11:07 -0500
	  (Wed, 28 Oct 2009) | 17 lines Merged revisions 226382 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r226382 | lmadsen | 2009-10-28 15:06:13 -0500 (Wed, 28 Oct 2009)
	  | 9 lines Update documentation in sip.conf.sample. Update the
	  documentation in sip.conf.sample in order to make it more clear
	  that directmedia/canreinvite do not cause Asterisk to ignore
	  reINVITEs. It is only used to stop Asterisk from generating a
	  reINVITE, but does not stop it from accepting them if necessary.
	  (closes issue #15644) Reported by: lmadsen ........
	  ................

	* doc/tex/channelvariables.tex: Merged revisions 226378 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r226378 | lmadsen | 2009-10-28 14:50:00 -0500
	  (Wed, 28 Oct 2009) | 15 lines Merged revisions 226377 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r226377 | lmadsen | 2009-10-28 14:48:29 -0500 (Wed, 28 Oct 2009)
	  | 7 lines Update CALLINGSUBADDR channel variable documentation.
	  (closes issue #15734) Reported by: alecdavis Patches:
	  channelvariables.tex.diff.txt uploaded by alecdavis (license 585)
	  Tested by: alecdavis ........ ................

2009-10-28 18:06 +0000 [r226170-226308]  Tilghman Lesher <tlesher@digium.com>

	* /, include/asterisk/linkedlists.h: Merged revisions 226305 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r226305 | tilghman | 2009-10-28 13:04:05 -0500
	  (Wed, 28 Oct 2009) | 9 lines Merged revisions 226304 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r226304 | tilghman | 2009-10-28 13:02:25 -0500 (Wed, 28
	  Oct 2009) | 2 lines Fix documentation (pointed out by
	  TheDavidFactor on #-dev) ........ ................

	* main/manager.c, /: Merged revisions 226159 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r226159 | tilghman | 2009-10-27 15:22:07 -0500 (Tue, 27 Oct 2009)
	  | 14 lines Merged revisions 226138 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r226138 | tilghman | 2009-10-27 15:16:49 -0500 (Tue, 27 Oct 2009)
	  | 7 lines Manager output is not always NULL-terminated, so force
	  a NULL at the end of the filestream. (closes issue #15495)
	  Reported by: pdf Patches: 20090916__issue15495.diff.txt uploaded
	  by tilghman (license 14) Tested by: pdf ........ ................

2009-10-27 17:12 +0000 [r226101]  Terry Wilson <twilson@digium.com>

	* res/res_http_post.c, /: Merged revisions 226099 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r226099 |
	  twilson | 2009-10-27 11:48:54 -0500 (Tue, 27 Oct 2009) | 2 lines
	  Don't prepend the URI prefix to the post directory ........

2009-10-27 00:16 +0000 [r226055]  Tzafrir Cohen <tzafrir.cohen@xorcom.com>

	* /, configure, configure.ac: detect ARM Linux EABI OSARCH as
	  linux-gnu instead of linux-gnueabi * Set OSARCH to linux-gnu even
	  if host_os is linux-gnueabi * When checking if we are Linux,
	  check OSARCH rather than host_os The newer ARM ABI ("EABI") shows
	  the OS name 'linux-gnueabi' rather than 'linux-gnu' . This patch
	  sets OSARCH to be 'linux-gnu' even in such a case. OSARCH is
	  tested for the value of 'linux-gnu' in one or two places in the
	  tree. This patch also fixes the check libcap to check for $OSARCH
	  rather than $host_os . See also:
	  http://wiki.debian.org/ArmEabiPort Merged revisions 225957 via
	  svnmerge from http://svn.digium.com/svn/asterisk/branches/1.4
	  Merged revisions 226018 via svnmerge from
	  http://svn.digium.com/svn/asterisk/trunk

2009-10-26 19:42 +0000 [r225914]  Jeff Peeler <jpeeler@digium.com>

	* /, channels/chan_sip.c: Merged revisions 225912 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r225912 |
	  jpeeler | 2009-10-26 14:40:26 -0500 (Mon, 26 Oct 2009) | 12 lines
	  ACL check not present for verifying SIP INVITEs The ACL check in
	  check_peer_ok was missing and has now been restored. The missing
	  check allowed for calls to be made on prohibited networks where
	  an ACL was defined in sip.conf and the allowguest option was set
	  to off. See the AST security advisory below for more information.
	  Merge code associated with AST-2009-007. (closes issue #16091)
	  Reported by: thom4fun ........

2009-10-26 15:56 +0000 [r225871]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_fax.c: Backport audio handling loop fixes from trunk
	  version of app_fax. This backport resolves some issues handling
	  audio frames during FAX processing, and ensures that the FAX
	  application doesn't accidentally get notified of a T.38
	  switchover at the end of a successful FAX. (closes issue #16127)

2009-10-23 14:46 +0000 [r225651]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 225650 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r225650 |
	  dvossel | 2009-10-23 09:41:50 -0500 (Fri, 23 Oct 2009) | 3 lines
	  Fixes an iterator memory leak and uninitialized memory ........

2009-10-23 14:08 +0000 [r225585]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, /: Merged revisions 225582 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r225582 | kpfleming | 2009-10-23 09:02:42 -0500 (Fri, 23 Oct
	  2009) | 17 lines Merged revisions 225581 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r225581 | kpfleming | 2009-10-23 09:00:01 -0500 (Fri, 23 Oct
	  2009) | 10 lines Don't force menuselect.makeopts to be rebuilt on
	  every build. For some reason the menuselect.makeopts file was
	  listed as PHONY in the Makefile, resulting in 'make' needing to
	  rebuild it for every build. This then resulted in the embedded
	  module rules being rebuilt on every build, which can be slow and
	  is unnecessary. This patch fixes the problem by properly allowing
	  'make' to know when the menuselect.makeopts file needs to be
	  rebuilt (defining the proper dependencies). ........
	  ................

2009-10-22 22:24 +0000 [r225516]  Leif Madsen <lmadsen@digium.com>

	* README, /: Merged revisions 225515 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r225515 |
	  lmadsen | 2009-10-22 17:24:03 -0500 (Thu, 22 Oct 2009) | 8 lines
	  Update README documentation. Update the README documentation to
	  correctly describe which CLI command you should use when
	  attempting to get help from the CLI. (closes issue #16064)
	  Reported by: thedavidfactor Patches: readme.patch uploaded by
	  thedavidfactor (license 903) ........

2009-10-22 21:55 +0000 [r225489]  David Vossel <dvossel@digium.com>

	* apps/app_externalivr.c, include/asterisk/tcptls.h, main/tcptls.c,
	  /, channels/chan_sip.c: Merged revisions 225445 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r225445 |
	  dvossel | 2009-10-22 14:55:51 -0500 (Thu, 22 Oct 2009) | 50 lines
	  SIP TCP/TLS: move client connection setup/write into tcp helper
	  thread, various related locking/memory fixes. What this patch
	  fixes 1.Moves sip TCP/TLS connection setup into the TCP helper
	  thread: Connection setup takes awhile and before this it was
	  being done while holding the monitor lock. 2.Moves TCP/TLS
	  writing to the TCP helper thread: Through the use of a packet
	  queue and an alert pipe, the TCP helper thread can now be woken
	  up to write data as well as read data. 3.Locking error: sip_xmit
	  returned an XMIT_ERROR without giving up the tcptls_session lock.
	  This lock has been completely removed from sip_xmit and placed in
	  the new sip_tcptls_write() function. 4.Memory leak: When creating
	  a tcptls_client the tls_cfg was alloced but never freed unless
	  the tcptls_session failed to start. Now the session_args for a
	  sip client are an ao2 object which frees the tls_cfg on
	  destruction. 5.Pointer to stack variable: During
	  sip_prepare_socket the creation of a client's
	  ast_tcptls_session_args was done on the stack and stored as a
	  pointer in the newly created tcptls_session. Depending on the
	  events that followed, there was a slight possibility that pointer
	  could have been accessed after the stack returned. Given the new
	  changes, it is always accessed after the stack returns which is
	  why I found it. Notable code changes 1.I broke tcptls.c's
	  ast_tcptls_client_start() function into two functions. One for
	  creating and allocating the new tcptls_session, and a separate
	  one for starting and handling the new connection. This allowed me
	  to create the tcptls_session, launch the helper thread, and then
	  establish the connection within the helper thread. 2.Writes to a
	  tcptls_session are now done within the helper thread. This is
	  done by using an alert pipe to wake up the thread if new data
	  needs to be sent. The thread's sip_threadinfo object contains the
	  alert pipe as well as the packet queue. 3.Since the threadinfo
	  object contains the alert pipe, it must now be accessed outside
	  of the helper thread for every write (queuing of a packet). For
	  easy lookup, I moved the threadinfo objects from a linked list to
	  an ao2_container. (closes issue #13136) Reported by: pabelanger
	  Tested by: dvossel, whys (closes issue #15894) Reported by:
	  dvossel Tested by: dvossel Review:
	  https://reviewboard.asterisk.org/r/380/ ........

2009-10-22 21:54 +0000 [r225488]  Leif Madsen <lmadsen@digium.com>

	* doc/valgrind.txt, contrib/valgrind.supp (added): Merged revisions
	  225485 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r225485 | lmadsen | 2009-10-22 16:52:30 -0500 (Thu, 22 Oct 2009)
	  | 19 lines Merged revisions 225484 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r225484 | lmadsen | 2009-10-22 16:51:52 -0500 (Thu, 22 Oct 2009)
	  | 11 lines Clean valgrind output by suppressing false errors.
	  Update valgrind.txt documentation and add valgrind.supp file in
	  order to allow those who are creating valgrind output to have
	  less false errors in the logfile. (closes issue #16007) Reported
	  by: atis Patches: valgrind.txt.diff uploaded by atis (license
	  242) asterisk2.supp uploaded by atis (license 242) Tested by:
	  atis, amorsen ........ ................

2009-10-22 17:14 +0000 [r225363]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /, apps/app_meetme.c, include/asterisk/channel.h:
	  Merged revisions 225360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r225360 | tilghman | 2009-10-22 12:11:23 -0500 (Thu, 22 Oct 2009)
	  | 11 lines Merged revisions 225105 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r225105 | tilghman | 2009-10-21 11:02:12 -0500 (Wed, 21 Oct 2009)
	  | 4 lines Fix documentation for ast_softhangup() and correct the
	  misuse thereof. (closes issue #16103) Reported by: majorbloodnok
	  ........ ................

2009-10-21 22:00 +0000 [r225035-225308]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 225307 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r225307 | dvossel | 2009-10-21 16:58:46 -0500
	  (Wed, 21 Oct 2009) | 20 lines Merged revisions 225243 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r225243 | dvossel | 2009-10-21 15:58:08 -0500 (Wed, 21 Oct 2009)
	  | 13 lines IAX2: VNAK loop caused by signaling frames with no
	  destination call number It is possible for the PBX thread to
	  queue up signaling frames before a destination call number is
	  received. This can result in signaling frames being sent out with
	  no destination call number. Since recent versions of Asterisk
	  require accurate destination callnumbers for all Full Frames,
	  this can cause a VNAK loop to occur. To resolve this no signaling
	  frames are sent until a destination callnumber is received, and
	  destination call numbers are now only required for iax_pvt
	  matching when the frame is an ACK. Review:
	  https://reviewboard.asterisk.org/r/413/ ........ ................

	* configs/sip.conf.sample, channels/chan_iax2.c,
	  configs/iax.conf.sample, /, channels/chan_sip.c: Merged revisions
	  225033 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r225033 | dvossel | 2009-10-21 09:39:10 -0500 (Wed, 21 Oct 2009)
	  | 27 lines Merged revisions 225032 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r225032 | dvossel | 2009-10-21 09:37:04 -0500 (Wed, 21 Oct 2009)
	  | 20 lines IAX/SIP shrinkcallerid option The shrinking of caller
	  id removes '(', ' ', ')', non-trailing '.', and '-' from the
	  string. This means values such as 555.5555 and test-test result
	  in 555555 and testtest. There are instances, such as Skype
	  integration, where a specific value is passed via caller id that
	  must be preserved unmodified. This patch makes the shrinking of
	  caller id optional in chan_sip and chan_iax in order to support
	  such cases. By default this option is on to preserve previous
	  expected behavior. (closes issue #15940) Reported by: dimas
	  Patches: v2-15940.patch uploaded by dimas (license 88)
	  15940_shrinkcallerid_trunk.c uploaded by dvossel (license 671)
	  Tested by: dvossel Review:
	  https://reviewboard.asterisk.org/r/408/ ........ ................

2009-10-20 22:11 +0000 [r224859]  Tilghman Lesher <tlesher@digium.com>

	* main/audiohook.c, funcs/func_speex.c, /: Merged revisions 224856
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r224856 | tilghman | 2009-10-20 17:09:07 -0500
	  (Tue, 20 Oct 2009) | 12 lines Merged revisions 224855 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r224855 | tilghman | 2009-10-20 17:07:11 -0500 (Tue, 20 Oct 2009)
	  | 5 lines Pay attention to the return value of the manipulate
	  function. While this looks like an optimization, it prevents a
	  crash from occurring when used with certain audiohook callbacks
	  (diagnosed with SVN trunk, backported to 1.4 to keep the source
	  consistent across versions). ........ ................

2009-10-20 17:50 +0000 [r224777]  Joshua Colp <jcolp@digium.com>

	* /, main/features.c: Merged revisions 224774 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r224774 | file | 2009-10-20 14:47:34 -0300 (Tue, 20 Oct 2009) |
	  12 lines Merged revisions 224773 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r224773 | file | 2009-10-20 14:46:37 -0300 (Tue, 20 Oct 2009) | 5
	  lines Add support for relaying early media in the features
	  attended transfer option. (closes issue #14828) Reported by:
	  licedey ........ ................

2009-10-20 00:00 +0000 [r224674]  Kevin P. Fleming <kpfleming@digium.com>

	* main/rtp.c, /: Merged revisions 224671 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r224671 | kpfleming | 2009-10-19 18:47:39 -0500 (Mon, 19 Oct
	  2009) | 14 lines Merged revisions 224670 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r224670 | kpfleming | 2009-10-19 18:44:07 -0500 (Mon, 19 Oct
	  2009) | 7 lines Correct timestamp calculations when RTP sample
	  rates over 8kHz are used. While testing some endpoints that
	  support 16kHz and 32kHz sample rates, some log messages were
	  generated due to calc_rxstamp() computing timestamps in a way
	  that produced odd results, so this patch sanitizes the result of
	  the computations. ........ ................

2009-10-19 19:54 +0000 [r224571]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 224567 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r224567 | file | 2009-10-19 16:49:09 -0300 (Mon, 19 Oct 2009) |
	  12 lines Merged revisions 224565 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r224565 | file | 2009-10-19 16:47:50 -0300 (Mon, 19 Oct 2009) | 5
	  lines Do not attempt early media bridging (ie: direct RTP setup)
	  if options are enabled that should prevent it. (closes issue
	  #14763) Reported by: cupotka ........ ................

2009-10-19 19:41 +0000 [r224563]  Kevin P. Fleming <kpfleming@digium.com>

	* formats/format_siren14.c, /: Merged revisions 224562 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r224562 | kpfleming | 2009-10-19 14:40:26 -0500 (Mon, 19 Oct
	  2009) | 1 line Remove useless debugging message. ........

2009-10-19 00:13 +0000 [r224447-224451]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 224448 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r224448 | tilghman | 2009-10-18 19:05:56 -0500 (Sun, 18 Oct 2009)
	  | 3 lines Allow ODBC storage to be queried with multiple
	  mailboxes, and remove multiple goto's. This corrects an issue
	  reported on the -users list. ........

	* configs/res_odbc.conf.sample, /: Merged revisions 224446 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r224446 | tilghman | 2009-10-18 18:41:30 -0500 (Sun, 18
	  Oct 2009) | 2 lines Clarify that "forcecommit" is NOT an alias
	  for "autocommit", but instead controls the default disposition of
	  uncommitted transactions. ........

2009-10-17 01:58 +0000 [r224334]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 224331 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r224331 | jpeeler | 2009-10-16 20:36:08 -0500
	  (Fri, 16 Oct 2009) | 20 lines Merged revisions 224330 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r224330 | jpeeler | 2009-10-16 20:32:47 -0500 (Fri, 16 Oct 2009)
	  | 13 lines Fix stale caller id data from being reported in AMI
	  NewChannel event The problem here is that chan_dahdi is designed
	  in such a way to set certain values in the dahdi_pvt only once.
	  One of those such values is the configured caller id data in
	  chan_dahdi.conf. For PRI, the configured caller id data could be
	  overwritten during a call. Instead of saving the data and
	  restoring, it was decided that for all non-analog channels it was
	  simply best to not set the configured caller id in the first
	  place and also clear it at the end of the call. (closes issue
	  #15883) Reported by: jsmith ........ ................

2009-10-16 20:58 +0000 [r224264]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 224261 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r224261 | rmudgett | 2009-10-16 15:40:57 -0500
	  (Fri, 16 Oct 2009) | 25 lines Merged revisions 224260 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r224260 | rmudgett | 2009-10-16 15:25:23 -0500 (Fri, 16 Oct 2009)
	  | 18 lines Never released PRI channels when using Busy() or
	  Congestion() dialplan apps. When the Busy() or Congestion()
	  application is used towards ISDN (an ISDN progress is sent), the
	  responding ISDN Disconnect or Release may contain the ISDN cause
	  user busy or one of the congestion causes. In chan_dahdi.c these
	  causes will only set the needbusy or needcongestion flags and not
	  activate the softhangup procedure. Unfortunately only the latter
	  can interrupt the endless wait loop of Busy()/Congestion().
	  Result: PRI channels staying in state busy for the rest of
	  asterisk life or until the other end times out and forces the
	  call to clear. (in issue 0014292) Reported by: tomaso Patches:
	  disc_rel_userbusy.patch uploaded by tomaso (license 564) (This
	  patch is unrelated to the issue.) ........ ................

2009-10-15 15:58 +0000 [r224181]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_chanspy.c, /: Merged revisions 224178 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r224178 |
	  jpeeler | 2009-10-15 10:57:14 -0500 (Thu, 15 Oct 2009) | 11 lines
	  Readd removed ability to allow listening to one side of the call
	  in app_chanspy (Option o) (closes issue #15675) Reported by:
	  john8675309 Patches: issue15675patchtrunk.txt uploaded by dbrooks
	  (license 790) Tested by: jgutierrez on users list:
	  http://lists.digium.com/pipermail/asterisk-users/2009-October/239155.html
	  ........

2009-10-12 23:55 +0000 [r223835]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_dial.c, /: Merged revisions 223832 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r223832 | jpeeler | 2009-10-12 18:48:09 -0500 (Mon, 12 Oct 2009)
	  | 15 lines Merged revisions 223804 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r223804 | jpeeler | 2009-10-12 18:12:50 -0500 (Mon, 12 Oct 2009)
	  | 8 lines Ensure ringing continues for branched calls after
	  progress is received While waiting for an answer, don't send
	  progress for branched calls for which ringing was sent. (closes
	  issue #15028) Reported by: fnordian ........ ................

2009-10-12 21:01 +0000 [r223757]  David Vossel <dvossel@digium.com>

	* configs/iax.conf.sample, /: Merged revisions 223756 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r223756 | dvossel | 2009-10-12 15:58:27 -0500 (Mon, 12 Oct 2009)
	  | 5 lines Clarifies trunkmaxsize, trunkfreq, and trunkmtu iax2
	  options SWP-151 ........

2009-10-12 14:37 +0000 [r223655]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c, apps/app_fax.c: Merged revisions 223652
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r223652 | kpfleming | 2009-10-12 09:25:29 -0500 (Mon, 12
	  Oct 2009) | 13 lines Remove automatic switching from T.38 to
	  voice mode in chan_sip. chan_sip has some code to automatically
	  switch from T.38 mode to voice mode when a voice frame is written
	  to the channel while it is in T.38 mode; this was intended to
	  handle the situation when a FAX transmission has ended and the
	  channel is not yet hung up, but is causing problems at the
	  beginning of FAX sessions as well when there are still voice
	  frames 'in flight' at the time the T.38 negotiation completes.
	  This patch removes the automatic switchover, and changes app_fax
	  to explicitly switch off T.38 mode when the FAX transmission
	  process ends. (closes issue #16025) Reported by: jamicque
	  ........

2009-10-11 17:32 +0000 [r223490]  Russell Bryant <russell@digium.com>

	* main/autoservice.c, /: Merged revisions 223487 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r223487 | russell | 2009-10-11 12:25:42 -0500 (Sun, 11 Oct 2009)
	  | 17 lines Merged revisions 223485-223486 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r223485 | russell | 2009-10-11 12:22:52 -0500 (Sun, 11 Oct 2009)
	  | 6 lines Don't use data outside of its scope. The purpose of
	  this code was to have a hangup frame put on the list of deferred
	  frames. However, the code that read the hangup frame was outside
	  of the scope of where the hangup frame was declared. ........
	  r223486 | russell | 2009-10-11 12:25:06 -0500 (Sun, 11 Oct 2009)
	  | 2 lines Remove some unnecessary code. ........ ................

2009-10-09 23:12 +0000 [r223406]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, channels/chan_h323.c: Fix interpretation
	  of PRIREDIRECTIONREASON set by chan_sip. This commit is the
	  simplest way to solve a problem that has already been solved in
	  trunk with the "COLP/CONP and Redirecting party information into
	  Asterisk" commit. In trunk the redirection reason is translated
	  into a generic redirect reason. I would have had to do the same
	  fix except chan_sip never reads PRIREDIRECTREASON. So both
	  chan_dahdi and chan_h323 have been modified to interpret the one
	  different redirect reason of "no-answer" properly and set the
	  ISDN reason code 2 of "no reply". (closes issue #15033) Reported
	  by: steinwej

2009-10-09 21:01 +0000 [r223333]  Kevin P. Fleming <kpfleming@digium.com>

	* /, apps/app_fax.c: Merged revisions 223330 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r223330 |
	  kpfleming | 2009-10-09 15:58:44 -0500 (Fri, 09 Oct 2009) | 10
	  lines Initiate T.38 switchover when acting as called party,
	  regardless of FAX direction. SendFAX() and ReceiveFAX() can be
	  given options to indicate whether they should act as the calling
	  or called party; this mode should be used to decide whether to
	  initiate a switchover to T.38, not the direction that the FAX
	  transfer will take place. (closes issue #16039) Reported by:
	  jamicque ........

2009-10-09 18:53 +0000 [r223286]  Matthew Nicholson <mnicholson@digium.com>

	* main/channel.c, /: Merged revisions 223273 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r223273 | mnicholson | 2009-10-09 13:34:08 -0500 (Fri, 09 Oct
	  2009) | 14 lines Merged revisions 223225 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r223225 | mnicholson | 2009-10-09 13:20:11 -0500 (Fri, 09 Oct
	  2009) | 8 lines Signal timeouts by returning AST_CONTROL_RINGING
	  when originating calls. (closes issue #15104) Reported by:
	  nblasgen Patches: manager-timeout1.diff uploaded by mnicholson
	  (license 96) Tested by: nblasgen, mnicholson ........
	  ................

2009-10-09 18:29 +0000 [r223257]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, /: Merged revisions 223215 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r223215 | mmichelson | 2009-10-09 13:17:34 -0500 (Fri, 09 Oct
	  2009) | 9 lines Recorded merge of revisions 223213 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r223213 | mmichelson | 2009-10-09 13:17:12 -0500 (Fri,
	  09 Oct 2009) | 3 lines Fix potential memory leak in app_dial.c
	  ........ ................

2009-10-09 17:55 +0000 [r223208]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 223206 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r223206 | dvossel | 2009-10-09 12:53:37 -0500 (Fri, 09 Oct 2009)
	  | 16 lines Merged revisions 223205 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r223205 | dvossel | 2009-10-09 12:52:35 -0500 (Fri, 09 Oct 2009)
	  | 10 lines fixes sip registration using authuser in user.conf
	  (closes issue #14954) Reported by: tornblad Tested by:
	  mmichelson, tornblad, dvossel ........ ................

2009-10-09 17:27 +0000 [r223173]  Matthew Nicholson <mnicholson@digium.com>

	* cdr/cdr_sqlite3_custom.c, /: Merged revisions 223136 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r223136 | mnicholson | 2009-10-09 12:14:38 -0500 (Fri, 09 Oct
	  2009) | 8 lines Don't close the sqlite database when reloading.
	  Only close the database when unloading. (closes issue #15953)
	  Reported by: frawd Patches: sqlite3_rev220097.diff uploaded by
	  frawd (license 610) Tested by: frawd ........

2009-10-09 17:09 +0000 [r223089-223133]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 223132 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r223132 |
	  dvossel | 2009-10-09 11:54:02 -0500 (Fri, 09 Oct 2009) | 9 lines
	  'auth=' did not parse md5 secret correctly (closes issue #15949)
	  Reported by: ebroad Patches: authparsefix.patch uploaded by
	  ebroad (license 878) 15949_trunk.diff uploaded by dvossel
	  (license 671) Tested by: ebroad ........

	* /, channels/chan_sip.c: Merged revisions 223088 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r223088 |
	  dvossel | 2009-10-09 10:49:30 -0500 (Fri, 09 Oct 2009) | 14 lines
	  p->peerauth is always empty in transmit_register() When using
	  callbackextension or specifing the peer name in a registration
	  string, the peer's specific auth settings set by the "auth="
	  strings within the peer definition are not used by the
	  registration. Thanks to ebroad for reporting the issue and
	  providing the patch. (closes issue #15955) Reported by: ebroad
	  Patches: regauthfix.patch uploaded by ebroad (license 878)
	  ........

2009-10-08 20:00 +0000 [r222883]  Russell Bryant <russell@digium.com>

	* include/asterisk/frame.h, include/asterisk/file.h, main/frame.c,
	  /, main/file.c: Merged revisions 222880 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r222880 | russell | 2009-10-08 14:52:03 -0500 (Thu, 08 Oct 2009)
	  | 51 lines Merged revisions 222878 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r222878 | russell | 2009-10-08 14:45:47 -0500 (Thu, 08 Oct 2009)
	  | 44 lines Make filestream frame handling safer by isolating
	  frames before returning them. This patch is related to a number
	  of issues on the bug tracker that show crashes related to freeing
	  frames that came from a filestream. A number of fixes have been
	  made over time while trying to figure out these problems, but
	  there re still people seeing the crash. (Note that some of these
	  bug reports include information about other problems. I am
	  specifically addressing the filestream frame crash here.) I'm
	  still not clear on what the exact problem is. However, what is
	  _very_ clear is that we have seen quite a few problems over time
	  related to unexpected behavior when we try to use embedded frames
	  as an optimization. In some cases, this optimization doesn't
	  really provide much due to improvements made in other areas. In
	  this case, the patch modifies filestream handling such that the
	  embedded frame will not be returned. ast_frisolate() is used to
	  ensure that we end up with a completely mallocd frame. In
	  reality, though, we will not actually have to malloc every time.
	  For filestreams, the frame will almost always be allocated and
	  freed in the same thread. That means that the thread local frame
	  cache will be used. So, going this route doesn't hurt. With this
	  patch in place, some people have reported success in not seeing
	  the crash anymore. (SWP-150) (AST-208) (ABE-1834) (issue #15609)
	  Reported by: aragon Patches: filestream_frisolate-1.4.diff2.txt
	  uploaded by russell (license 2) Tested by: aragon, russell
	  (closes issue #15817) Reported by: zerohalo Tested by: zerohalo
	  (closes issue #15845) Reported by: marhbere Review:
	  https://reviewboard.asterisk.org/r/386/ ........ ................

2009-10-08 19:41 +0000 [r222874]  David Vossel <dvossel@digium.com>

	* main/netsock.c, /, include/asterisk/netsock.h: Merged revisions
	  222873 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r222873 |
	  dvossel | 2009-10-08 14:35:30 -0500 (Thu, 08 Oct 2009) | 6 lines
	  fixes an ast_netsock_list memory leak. ABE-1998 Review:
	  https://reviewboard.asterisk.org/r/395/ ........

2009-10-08 16:51 +0000 [r222695-222802]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn_config.c, /: Merged revisions 222799 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r222799 | rmudgett | 2009-10-08 11:44:33 -0500
	  (Thu, 08 Oct 2009) | 19 lines Merged revisions 222797 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r222797 | rmudgett | 2009-10-08 11:33:06 -0500 (Thu, 08 Oct 2009)
	  | 12 lines Fix memory leak if chan_misdn config parameter is
	  repeated. Memory leak when the same config option is set more
	  than once in an misdn.conf section. Why must this be considered?
	  Templates! Defining a template with default port options and
	  later adding to or overriding some of them. Patches:
	  memleak-misdn.patch JIRA ABE-1998 ........ ................

	* channels/chan_misdn.c, /: Merged revisions 222692 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r222692 | rmudgett | 2009-10-07 16:56:36 -0500
	  (Wed, 07 Oct 2009) | 21 lines Merged revisions 222691 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r222691 | rmudgett | 2009-10-07 16:51:24 -0500 (Wed, 07 Oct 2009)
	  | 14 lines chan_misdn.c:process_ast_dsp() memory leak misdn.conf:
	  astdtmf must be set to "yes". With "no", buffer loss does not
	  occur. The translated frame "f2" when passing through
	  ast_dsp_process() is not freed whenever it is not used further in
	  process_ast_dsp(). Then in the end it is never ever freed.
	  Patches: translate.patch JIRA ABE-1993 ........ ................

2009-10-07 18:06 +0000 [r222549]  Jason Parker <jparker@digium.com>

	* /, configs/queues.conf.sample: Merged revisions 222548 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r222548 | qwell | 2009-10-07 13:04:56 -0500 (Wed, 07 Oct
	  2009) | 5 lines Remove 'keepstats' queue option from sample
	  config, as it's no longer used.
	  https://reviewboard.asterisk.org/r/115/ (closes issue #15820)
	  Reported by: kshumard ........

2009-10-07 18:00 +0000 [r222547]  Sean Bright <sean@malleable.com>

	* funcs/func_strings.c: Fix merge error.

2009-10-07 17:45 +0000 [r222544]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 222543 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r222543 | dvossel | 2009-10-07 12:44:52 -0500 (Wed, 07 Oct 2009)
	  | 14 lines Merged revisions 222542 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r222542 | dvossel | 2009-10-07 12:41:21 -0500 (Wed, 07 Oct 2009)
	  | 8 lines crash on transfer handle_invite_replaces() attempts to
	  uplock a pvt's owner channel without first verifing that it
	  exists. (issue #16027) ........ ................

2009-10-06 23:59 +0000 [r222354-222466]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 222463 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r222463 | jpeeler | 2009-10-06 18:56:01 -0500
	  (Tue, 06 Oct 2009) | 14 lines Merged revisions 222462 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r222462 | jpeeler | 2009-10-06 18:51:19 -0500 (Tue, 06 Oct 2009)
	  | 8 lines Add missing unlock(s) in dahdi_read (two cases in
	  trunk, and 1.6.2) (closes issue #15683) Reported by: alecdavis
	  ........ ................

	* channels/chan_dahdi.c: Fix potential crash when entire span
	  request is received. The variable index used in this scenario for
	  accessing the dahdi_pvts was wrong and was most likely copied
	  from the several other places it is used correctly. (closes issue
	  #15998) Reported by: tsearle Patches: dahdi_reset_crash.patch
	  uploaded by tsearle (license 373)

	* channels/chan_dahdi.c, /: Merged revisions 222351 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r222351 | jpeeler | 2009-10-06 15:35:19 -0500 (Tue, 06 Oct 2009)
	  | 9 lines Fix 222298 (crash during destruction of second channel
	  when variable set with setvar). I mistakenly reasoned that setvar
	  would be used on all channels. Since it can be set per channel,
	  give each dahdi channel a copy of the variable. (related to
	  #15899) ........

2009-10-06 19:41 +0000 [r222311]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c, res/res_config_pgsql.c, /: Merged revisions
	  222309 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r222309 |
	  tilghman | 2009-10-06 14:31:39 -0500 (Tue, 06 Oct 2009) | 10
	  lines Change schema query to involve the use of an optional
	  schema parameter. This change is done in such a way as to allow
	  the driver to continue to function with older databases which
	  don't have these features. (closes issue #16000) Reported by:
	  jamicque Patches: 20091002__issue16000.diff.txt uploaded by
	  tilghman (license 14) 20091002__issue16000__1.6.1.diff.txt
	  uploaded by tilghman (license 14) Tested by: jamicque ........

2009-10-06 19:27 +0000 [r222304]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 222298 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r222298 | jpeeler | 2009-10-06 14:24:59 -0500 (Tue, 06 Oct 2009)
	  | 9 lines Fix crash during destruction of second channel when
	  variable set with setvar. The setvar line in chan_dahdi.conf is
	  shared among all the channels, so make sure to only free the
	  resources only when the last channel is destroyed. (closes issue
	  #15899) Reported by: tzafrir ........

2009-10-06 19:22 +0000 [r222289]  Tilghman Lesher <tlesher@digium.com>

	* res/ael/pval.c, /: Merged revisions 222273 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r222273 |
	  tilghman | 2009-10-06 14:17:11 -0500 (Tue, 06 Oct 2009) | 5 lines
	  When we call a gosub routine, the variables should be scoped to
	  avoid contaminating the caller. This affected the ~~EXTEN~~ hack,
	  where a subroutine might have changed the value before it was
	  used in the caller. Patch by myself, tested by ebroad on
	  #asterisk ........

2009-10-06  Leif Madsen <lmadsen@digium.com>

	* Released Asterisk 1.6.2.0-rc3

2009-10-06 01:39 +0000 [r222113-222187]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_console.c, res/res_musiconhold.c, apps/app_queue.c,
	  channels/chan_iax2.c, main/astobj2.c, res/res_odbc.c,
	  res/res_clialiases.c, /, channels/chan_sip.c,
	  funcs/func_dialgroup.c, include/asterisk/astobj2.h,
	  res/res_phoneprov.c: Merged revisions 222176 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r222176 | kpfleming | 2009-10-05 20:24:24 -0500 (Mon, 05 Oct
	  2009) | 27 lines Recorded merge of revisions 222152 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r222152 | kpfleming | 2009-10-05 20:16:36 -0500 (Mon, 05
	  Oct 2009) | 20 lines Fix ao2_iterator API to hold references to
	  containers being iterated. See Mantis issue for details of what
	  prompted this change. Additional notes: This patch changes the
	  ao2_iterator API in two ways: F_AO2I_DONTLOCK has become an enum
	  instead of a macro, with a name that fits our naming policy;
	  also, it is now necessary to call ao2_iterator_destroy() on any
	  iterator that has been created. Currently this only releases the
	  reference to the container being iterated, but in the future this
	  could also release other resources used by the iterator, if the
	  iterator implementation changes to use additional resources.
	  (closes issue #15987) Reported by: kpfleming Review:
	  https://reviewboard.asterisk.org/r/383/ ........ ................

	* configs/sip.conf.sample, main/udptl.c, /, channels/chan_sip.c,
	  configs/udptl.conf.sample, UPGRADE.txt: Merged revisions 222110
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r222110 | kpfleming | 2009-10-05 14:45:00 -0500 (Mon, 05
	  Oct 2009) | 25 lines Allow non-compliant T.38 endpoints to be
	  supportable via configuration option. Many T.38 endpoints
	  incorrectly send the maximum IFP frame size they can accept as
	  the T38FaxMaxDatagram value in their SDP, when in fact this value
	  is supposed to be the maximum UDPTL payload size (datagram size)
	  they can accept. If the value they supply is small enough (a
	  commonly supplied value is '72'), T.38 UDPTL transmissions will
	  likely fail completely because the UDPTL packets will not have
	  enough room for a primary IFP frame and the redundancy used for
	  error correction. If this occurs, the Asterisk UDPTL stack will
	  emit log messages warning that data loss may occur, and that the
	  value may need to be overridden. This patch extends the
	  't38pt_udptl' configuration option in sip.conf to allow the
	  administrator to override the value supplied by the remote
	  endpoint and supply a value that allows T.38 FAX transmissions to
	  be successful with that endpoint. In addition, in any SIP call
	  where the override takes effect, a debug message will be printed
	  to that effect. This patch also removes the T38FaxMaxDatagram
	  configuration option from udptl.conf.sample, since it has not
	  actually had any effect for a number of releases. In addition,
	  this patch cleans up the T.38 documentation in sip.conf.sample
	  (which incorrectly documented that T.38 support was passthrough
	  only). (issue #15586) Reported by: globalnetinc ........

2009-10-02 17:35 +0000 [r222032]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 222030 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r222030 | dvossel | 2009-10-02 12:34:07 -0500
	  (Fri, 02 Oct 2009) | 9 lines Merged revisions 222026 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r222026 | dvossel | 2009-10-02 12:32:13 -0500 (Fri, 02
	  Oct 2009) | 3 lines Removes unnecessary unlock, clarifies a
	  memcpy. ........ ................

2009-10-02 17:01 +0000 [r221923-221974]  Tilghman Lesher <tlesher@digium.com>

	* main/astobj2.c, /: Merged revisions 221971 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r221971 | tilghman | 2009-10-02 11:59:57 -0500 (Fri, 02 Oct 2009)
	  | 9 lines Merged revisions 221970 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221970 | tilghman | 2009-10-02 11:58:03 -0500 (Fri, 02 Oct 2009)
	  | 2 lines Ensure the result of the hash function is positive.
	  Negative array offsets suck. ........ ................

	* /, main/logger.c: Merged revisions 221920 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r221920 |
	  tilghman | 2009-10-01 22:04:34 -0500 (Thu, 01 Oct 2009) | 4 lines
	  Initialize a variable that we check immediately upon startup.
	  (closes issue #15973) Reported by: atis ........

2009-10-02 01:35 +0000 [r221879]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib_intern.h, /:
	  Merged revisions 221844 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r221844 | rmudgett | 2009-10-01 20:09:31 -0500 (Thu, 01 Oct 2009)
	  | 33 lines Merged revisions 221769 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221769 | rmudgett | 2009-10-01 18:18:28 -0500 (Thu, 01 Oct 2009)
	  | 26 lines Occasionally losing use of B channels in chan_misdn. I
	  have not been able to reproduce the problem of losing channels.
	  However, I have seen in the code a reentrancy problem that might
	  give these symptoms. The reentrancy patch does several things: 1)
	  Guards B channel and B channel structure allocation. 2) Makes the
	  B channel structure find routines more precise in locating
	  records. 3) Never leave a B channel allocated if we received
	  cause 44. The last item may cause temporary outgoing call
	  problems, but they should clear when the line becomes idle.
	  (closes issue #15490) Reported by: slutec18 Patches:
	  issue15490_channel_alloc_reentrancy.patch uploaded by rmudgett
	  (license 664) Tested by: rmudgett, slutec18 (closes issue #15458)
	  Reported by: FabienToune Patches:
	  issue15458_channel_alloc_reentrancy.patch uploaded by rmudgett
	  (license 664) Tested by: FabienToune, rmudgett, slutec18 ........
	  ................

2009-10-02 00:07 +0000 [r221744-221780]  Tilghman Lesher <tlesher@digium.com>

	* main/asterisk.c, main/rtp.c, /, main/say.c: Merged revisions
	  221777 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r221777 | tilghman | 2009-10-01 18:59:15 -0500 (Thu, 01 Oct 2009)
	  | 9 lines Merged revisions 221776 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221776 | tilghman | 2009-10-01 18:53:12 -0500 (Thu, 01 Oct 2009)
	  | 2 lines Fix a bunch of off-by-one errors ........
	  ................

	* /, channels/chan_sip.c: Merged revisions 221705 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r221705 |
	  tilghman | 2009-10-01 15:09:46 -0500 (Thu, 01 Oct 2009) | 2 lines
	  Revision 220906 (a merge from 1.4) was not merged correctly,
	  causing a problem with non-dynamic peers. ........

2009-10-01 19:35 +0000 [r221698]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 221697 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r221697 |
	  dvossel | 2009-10-01 14:33:33 -0500 (Thu, 01 Oct 2009) | 9 lines
	  outbound tls connections were not defaulting to port 5061 (closes
	  issue #15854) Reported by: dvossel Patches:
	  sip_port_config_trunk.diff uploaded by dvossel (license 671)
	  Tested by: dvossel ........

2009-10-01 16:57 +0000 [r221660]  Matthew Nicholson <mnicholson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 221554,221589 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r221554 | oej | 2009-10-01 02:00:04 -0500 (Thu,
	  01 Oct 2009) | 3 lines Simplify code for porturi, use TRUE/FALSE
	  constructs when it's just TRUE or FALSE. ................ r221589
	  | mnicholson | 2009-10-01 10:26:20 -0500 (Thu, 01 Oct 2009) | 9
	  lines Merged revisions 221588 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221588 | mnicholson | 2009-10-01 10:24:00 -0500 (Thu, 01 Oct
	  2009) | 2 lines Use unsigned ints for portinuri flags. ........
	  ................

2009-10-01 16:25 +0000 [r221622]  Kevin P. Fleming <kpfleming@digium.com>

	* main/udptl.c, /, configs/udptl.conf.sample, UPGRADE.txt: Merged
	  revisions 221592 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r221592 |
	  kpfleming | 2009-10-01 11:16:09 -0500 (Thu, 01 Oct 2009) | 12
	  lines Remove ability to control T.38 FAX error correction from
	  udptl.conf. chan_sip has had the ability to control T.38 FAX
	  error correction mode on a per-peer (or global) basis for a
	  couple of releases now, which is where it should have been all
	  along. This patch removes the ability to configure it in
	  udptl.conf, but issues a warning if the user tries to do, telling
	  them to look at sip.conf.sample for how to configure it now. For
	  any SIP peers that are T.38 enabled in sip.conf, there is already
	  a default for FEC error correction even if the user does not
	  specify any mode, so this change will not turn off error
	  correction by default, it will have the same default value that
	  has been in the udptl.conf sample file. ........

2009-09-30 23:07 +0000 [r221477-221485]  Matthew Nicholson <mnicholson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 221484 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r221484 |
	  mnicholson | 2009-09-30 18:04:03 -0500 (Wed, 30 Sep 2009) | 2
	  lines Cleaned up merge from r221432 ........

	* configs/sip.conf.sample, /, channels/chan_sip.c: Merged revisions
	  221432 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r221432 | mnicholson | 2009-09-30 15:40:20 -0500 (Wed, 30 Sep
	  2009) | 17 lines Merged revisions 221360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221360 | mnicholson | 2009-09-30 14:36:06 -0500 (Wed, 30 Sep
	  2009) | 10 lines Fix SRV lookup and Request-URI generation in
	  chan_sip. This patch adds a new field "portinuri" to the sip
	  dialog struct and the sip peer struct. That field is used during
	  RURI generation to determine if the port should be included in
	  the RURI. It is also used in some places to determine if an SRV
	  lookup should occur. (closes issue #14418) Reported by: klaus3000
	  Tested by: klaus3000, mnicholson Review:
	  https://reviewboard.asterisk.org/r/369/ ........ ................

2009-09-30 21:46 +0000 [r221371-221472]  Matthias Nick <mnick@digium.com>

	* apps/app_queue.c, /: Merged revisions 221436 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r221436 |
	  mnick | 2009-09-30 16:15:01 -0500 (Wed, 30 Sep 2009) | 2 lines
	  Prevents from division by zero ........

	* configs/cdr_custom.conf.sample, /, funcs/func_strings.c: Merged
	  revisions 221368 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r221368 | mnick | 2009-09-30 14:42:36 -0500 (Wed, 30 Sep 2009) |
	  23 lines Merged revisions 221153,221157,221303 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221153 | mnick | 2009-09-30 10:37:39 -0500 (Wed, 30 Sep 2009) |
	  2 lines check bounds - prevents for buffer overflow ........
	  r221157 | mnick | 2009-09-30 10:41:46 -0500 (Wed, 30 Sep 2009) |
	  8 lines added a new dialplan function 'CSV_QUOTE' and changed the
	  cdr_custom.sample.conf (closes issue #15471) Reported by: dkerr
	  Patches: csv_quote_14.txt uploaded by mnick (license ) Tested by:
	  mnick ........ r221303 | mnick | 2009-09-30 14:02:00 -0500 (Wed,
	  30 Sep 2009) | 2 lines changed the prototype definition of
	  csv_quote ........ ................

2009-09-30 19:15 +0000 [r221304]  Terry Wilson <twilson@digium.com>

	* configs/sip.conf.sample, main/rtp.c, /, channels/chan_sip.c,
	  include/asterisk/rtp.h: Merged revisions 221266 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r221266 | twilson | 2009-09-30 12:52:30 -0500 (Wed, 30 Sep 2009)
	  | 32 lines Merged revisions 221086 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221086 | twilson | 2009-09-30 09:49:11 -0500 (Wed, 30 Sep 2009)
	  | 25 lines Change the SSRC by default when our media stream
	  changes Be default, change SSRC when doing an audio stream
	  changes Asterisk doesn't honor marker bit when reinvited to
	  already-bridged RTP streams,resulting in far-end stack discarding
	  packets with "old" timestamps that areactually part of a new
	  stream. This patch sends AST_CONTROL_SRCUPDATE whenever there is
	  a reinvite, unless the 'constantssrc' is set to true in sip.conf.
	  The original issue reported to Digium support detailed the
	  following situation: ITSP <-> Asterisk 1.4.26.2 <-> SIP-based
	  Application Server Call comes in fromITSP, Asterisk dials the app
	  server which sends a re-invite back toAsterisk--not to negotiate
	  to send media directly to the ITSP, but to indicatethat it's
	  changing the stream it's sending to Asterisk. The app
	  servergenerates a new SSRC, sequence numbers, timestamps, and
	  sets the marker bit on the new stream. Asterisk passes through
	  the teimstamp of the new stream, butdoes not reset the SSRC,
	  sequence numbers, or set the marker bit. When the timestamp on
	  the new stream is older than the timestamp on the originalstream,
	  the ITSP (which doesn't know there has been any change) discards
	  the newframes because it thinks they are too old. This patch
	  addresses this by changing the SSRC on a stream update unless
	  constantssrc=true is set in sip.conf. Review:
	  https://reviewboard.asterisk.org/r/374/ ........ ................

2009-09-30 16:57 +0000 [r221204]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /: Merged revisions 221201 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r221201 | tilghman | 2009-09-30 11:56:42 -0500 (Wed, 30 Sep 2009)
	  | 14 lines Merged revisions 221200 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r221200 | tilghman | 2009-09-30 11:55:21 -0500 (Wed, 30 Sep 2009)
	  | 7 lines Avoid a potential NULL dereference. (closes issue
	  #15865) Reported by: kobaz Patches: 20090915__issue15865.diff.txt
	  uploaded by tilghman (license 14) Tested by: kobaz ........
	  ................

2009-09-30 14:57 +0000 [r221089]  Sean Bright <sean@malleable.com>

	* apps/app_voicemail.c, /: Merged revisions 221085 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r221085 | seanbright | 2009-09-30 10:47:58 -0400 (Wed, 30 Sep
	  2009) | 9 lines Clarify documentation for VoiceMailMain()'s a()
	  option. We require box numbers, not names as the documentation
	  implies. (issue #14740) Reported by: pj Patches:
	  __20090729-app_voicemail-documentation.patch uploaded by lmadsen
	  (license 10) Tested by: seanbright, lmadsen ........

2009-09-30 04:41 +0000 [r221027-221047]  Tilghman Lesher <tlesher@digium.com>

	* /, funcs/func_lock.c: Recorded merge of revisions 221044 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r221044 | tilghman | 2009-09-29 23:32:36 -0500 (Tue, 29
	  Sep 2009) | 8 lines Allow locks to be inherited through a
	  masquerade without causing starvation. (closes issue #14859)
	  Reported by: atis Patches: 20090821__issue14859.diff.txt uploaded
	  by tilghman (license 14) 20090925__issue14859__1.6.1.diff.txt
	  uploaded by tilghman (license 14) Tested by: atis, tilghman
	  ........

	* include/asterisk/smdi.h, include/asterisk/optional_api.h
	  (removed), apps/app_voicemail.c, include/asterisk/agi.h,
	  include/asterisk/monitor.h: Remove optional_api from 1.6.2
	  branch, since it is not currently working. This is a blocking
	  issue for the 1.6.2 release. (closes issue #15914) Reported by:
	  mbeckwell Branch:
	  http://svn.digium.com/svn/asterisk/team/tilghman/optional_api_162
	  Tested by: mbeckwell

	* /, channels/chan_sip.c: Merged revisions 220906 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r220906 | tilghman | 2009-09-29 14:57:37 -0500 (Tue, 29 Sep 2009)
	  | 16 lines Merged revisions 220873 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r220873 | tilghman | 2009-09-29 12:59:26 -0500 (Tue, 29 Sep 2009)
	  | 9 lines Reduce CPU usage related to building a peer merely for
	  devicestates. This fixes a 100% CPU problem in the SIP driver,
	  found by profiling the driver while the problem was occurring.
	  (closes issue #14309) Reported by: pkempgen Patches:
	  20090924__issue14309.diff.txt uploaded by tilghman (license 14)
	  Tested by: pkempgen, vrban ........ ................

2009-09-29 20:24 +0000 [r220905-220934]  Matthew Nicholson <mnicholson@digium.com>

	* apps/app_chanspy.c: Avoid a deadlock in chanspy, just in case the
	  spyee is masqueraded and chanspy_ds_chan_fixup() is called with
	  the channel locked. (closes issue #15965) Reported by: atis
	  Patches: chanspy-deadlock-fix1.diff uploaded by mnicholson
	  (license 96) Tested by: atis

	* /, apps/app_confbridge.c: Merged revisions 220904 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r220904 | mnicholson | 2009-09-29 14:49:02 -0500 (Tue, 29 Sep
	  2009) | 5 lines Fix options 'm' and 's'. They were swapped in the
	  code. Also document the fact that app_confbridge does not
	  automatically answer the channel. (closes issue #15964) Reported
	  by: shrift ........

2009-09-29 17:06 +0000 [r220836]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 220833 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r220833 | jpeeler | 2009-09-29 11:58:29 -0500 (Tue, 29 Sep 2009)
	  | 12 lines Make deletion of temporary greetings work properly
	  with IMAP_STORAGE When imapgreetings was set to yes, the message
	  was being deleted but wasn't actually being expunged. When
	  imapgreetings was set to no, the file based message was not being
	  deleted at all. All good now! (closes issue #14949) Reported by:
	  noahisaac Patches: vm_tempgreeting_removal.patch uploaded by
	  noahisaac (license 748), modified by me ........

2009-09-28 19:13 +0000 [r220725]  Sean Bright <sean@malleable.com>

	* /, Makefile.rules: Merged revisions 220721 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r220721 | seanbright | 2009-09-28 15:11:20 -0400 (Mon, 28 Sep
	  2009) | 10 lines Merged revisions 220717 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r220717 | seanbright | 2009-09-28 15:09:25 -0400 (Mon, 28 Sep
	  2009) | 3 lines When selecting DONT_OPTIMIZE in menuselect,
	  explicitly pass -O0 to the compiler so we override any default
	  optimization levels for a particular install. ........
	  ................

2009-09-28 19:11 +0000 [r220722]  Jeff Peeler <jpeeler@digium.com>

	* /, channels/chan_sip.c: Merged revisions 220718 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r220718 |
	  jpeeler | 2009-09-28 14:10:10 -0500 (Mon, 28 Sep 2009) | 10 lines
	  Fix building of registration entry in build_peer when using
	  callbackextension Check for remotesecret option was
	  unintentionally always true, which therefore caused the secret
	  option to never be used. Thanks to dvossel for pointing out the
	  exact fix. (closes issue #15943) Reported by: tpsast ........

2009-09-27 20:45 +0000 [r220632]  Michiel van Baak <michiel@vanbaak.info>

	* funcs/func_callerid.c, /: Merged revisions 220629 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r220629 | mvanbaak | 2009-09-27 22:40:16 +0200 (Sun, 27 Sep 2009)
	  | 3 lines add name argument for the CALLERID dialplan function to
	  the xml documentation. Pointed out to me on IRC by snuff-home.
	  Thanks ........

2009-09-26 15:12 +0000 [r220589]  Tilghman Lesher <tlesher@digium.com>

	* /, include/asterisk/aes.h: Merged revisions 220586 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r220586 | tilghman | 2009-09-26 10:10:28 -0500 (Sat, 26 Sep 2009)
	  | 2 lines Allow AES to compile, when OpenSSL is not present.
	  ........

2009-09-24 20:38 +0000 [r220369]  David Vossel <dvossel@digium.com>

	* main/tcptls.c, /: Merged revisions 220365 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r220365 |
	  dvossel | 2009-09-24 15:37:20 -0500 (Thu, 24 Sep 2009) | 8 lines
	  fixes tcptls_session memory leak caused by ref count error
	  (closes issue #15939) Reported by: dvossel Review:
	  https://reviewboard.asterisk.org/r/375/ ........

2009-09-24 19:42 +0000 [r220292]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_playback.c, main/pbx.c, /, apps/app_disa.c: Merged
	  revisions 220289 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r220289 | tilghman | 2009-09-24 14:41:02 -0500 (Thu, 24 Sep 2009)
	  | 13 lines Merged revisions 220288 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r220288 | tilghman | 2009-09-24 14:39:41 -0500 (Thu, 24 Sep 2009)
	  | 6 lines Implicitly sending a progress signal breaks some
	  applications. Call Progress() in your dialplan if you explicitly
	  want progress to be sent. (Reverts change 216430, closes issue
	  #15957) Reported by: Pavel Troller on the Asterisk-Dev mailing
	  list
	  http://lists.digium.com/pipermail/asterisk-dev/2009-September/039897.html
	  ........ ................

2009-09-24 18:22 +0000 [r220103-220221]  Sean Bright <sean@malleable.com>

	* Makefile, /: Merged revisions 220217 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r220217 | seanbright | 2009-09-24 14:19:41 -0400 (Thu, 24 Sep
	  2009) | 9 lines Merged revisions 220213 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r220213 | seanbright | 2009-09-24 14:18:18 -0400 (Thu, 24 Sep
	  2009) | 1 line Resolve parallel build warnings. Reported by Klaus
	  Darilion on the asterisk-dev mailing list. ........
	  ................

	* Makefile, build_tools/mkpkgconfig, /: Merged revisions 220100 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r220100 | seanbright | 2009-09-24 10:44:08 -0400
	  (Thu, 24 Sep 2009) | 9 lines Merged revisions 220099 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r220099 | seanbright | 2009-09-24 10:41:57 -0400 (Thu,
	  24 Sep 2009) | 2 lines Remove the remaining bashisms in the
	  Makefile/mkpkgconfig ........ ................

2009-09-24 08:43 +0000 [r220031]  Michiel van Baak <michiel@vanbaak.info>

	* build_tools/mkpkgconfig, /: Merged revisions 220028 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r220028 | mvanbaak | 2009-09-24 10:36:18 +0200
	  (Thu, 24 Sep 2009) | 14 lines Merged revisions 220027 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r220027 | mvanbaak | 2009-09-24 10:33:50 +0200 (Thu, 24 Sep 2009)
	  | 7 lines mkpkgconfig does not need bash so make it use /bin/sh
	  This fixes building on all systems that don't have bash at
	  /bin/bash Reported by _ys on #asterisk-dev Tested by _ys on
	  #asterisk-dev ........ ................

2009-09-24 07:45 +0000 [r219989]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_directory.c, /: Merged revisions 219987 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r219987 | tilghman | 2009-09-24 02:39:44 -0500 (Thu, 24 Sep 2009)
	  | 8 lines Fix two possible crashes, one only in 1.6.1 and one in
	  1.6.1 forward. (closes issue #15739) Reported by: DLNoah, jeffg
	  Patches: 20090914__issue15739.diff.txt uploaded by tilghman
	  (license 14) 20090922__issue15739.diff.txt uploaded by tilghman
	  (license 14) Tested by: DLNoah, jeffg ........

2009-09-22 21:48 +0000 [r219821]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 219818 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r219818 | tilghman | 2009-09-22 16:43:22 -0500
	  (Tue, 22 Sep 2009) | 17 lines Merged revisions 219816 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219816 | tilghman | 2009-09-22 16:37:03 -0500 (Tue, 22 Sep 2009)
	  | 10 lines When IMAP variables were changed during a reload,
	  Voicemail did not use the new values. This change introduces a
	  configuration version variable, which ensures that connections
	  with the old values are not reused but are allowed to expire
	  normally. (closes issue #15934) Reported by: viniciusfontes
	  Patches: 20090922__issue15934.diff.txt uploaded by tilghman
	  (license 14) Tested by: viniciusfontes ........ ................

2009-09-21 17:01 +0000 [r219722]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 219721 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r219721 | dvossel | 2009-09-21 11:59:05 -0500
	  (Mon, 21 Sep 2009) | 9 lines Merged revisions 219720 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r219720 | dvossel | 2009-09-21 11:55:53 -0500 (Mon, 21
	  Sep 2009) | 3 lines Reverting merge 219520. This change was not
	  necessary. ........ ................

2009-09-20 18:21 +0000 [r219669]  Tilghman Lesher <tlesher@digium.com>

	* /, main/file.c: Merged revisions 219654 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r219654 | tilghman | 2009-09-20 12:55:49 -0500 (Sun, 20 Sep 2009)
	  | 15 lines Merged revisions 219653 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219653 | tilghman | 2009-09-20 12:52:05 -0500 (Sun, 20 Sep 2009)
	  | 8 lines Really stop the stream, when ast_closestream() is
	  called. (closes issue #15129) Reported by: bmh Patches:
	  20090918__issue15129.diff.txt uploaded by tilghman (license 14)
	  Review: https://reviewboard.asterisk.org/r/372/ ........
	  ................

2009-09-19 03:14 +0000 [r219590]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 219587 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r219587 | russell | 2009-09-18 21:59:52 -0500
	  (Fri, 18 Sep 2009) | 13 lines Merged revisions 219586 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219586 | russell | 2009-09-18 21:51:13 -0500 (Fri, 18 Sep 2009)
	  | 6 lines Make sure the iax_pvt exists before dereferencing it.
	  This fixes the latest crash posted on issue 15609. (issue #15609)
	  ........ ................

2009-09-18 23:21 +0000 [r219452-219521]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 219520 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r219520 | dvossel | 2009-09-18 18:20:58 -0500
	  (Fri, 18 Sep 2009) | 15 lines Merged revisions 219519 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219519 | dvossel | 2009-09-18 18:19:50 -0500 (Fri, 18 Sep 2009)
	  | 9 lines iax2 frame double free The iax frame's retrans sched id
	  was written over right before iax2_frame_free was called. In
	  iax2_frame_free that retrans id is used to delete the sched item.
	  By writing over the retrans field before the sched item could be
	  deleted, it was possible for a retransmit to occur on a freed
	  frame. ........ ................

	* /, channels/chan_sip.c: Merged revisions 219451 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r219451 | dvossel | 2009-09-18 11:20:41 -0500 (Fri, 18 Sep 2009)
	  | 20 lines Merged revisions 219450 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219450 | dvossel | 2009-09-18 11:19:15 -0500 (Fri, 18 Sep 2009)
	  | 14 lines via-header branches not updated correctly on INVITE
	  INVITE requests must always contain a new unique branch id. When
	  a new branch id is created for an INVITE, the dialog's
	  invite_branch variable must be updated so CANCEL requests use the
	  correct branch id. (closes issue #15262) Reported by: maniax
	  Patches: asterisk-1.6.1.0-sip-branch.patch uploaded by tweety
	  (license 608) invite_new_branch_trunk.diff uploaded by dvossel
	  (license 671) Tested by: maniax, dvossel ........
	  ................

2009-09-18 13:57 +0000 [r219415]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 219412 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r219412 | tilghman | 2009-09-18 08:54:51 -0500 (Fri, 18 Sep 2009)
	  | 6 lines Missing value setting line for maxsecs/maxmessage
	  (closes issue #15696) Reported by: fhackenberger Patches:
	  maxsecs.patch uploaded by fhackenberger (license 592) ........

2009-09-17 22:38 +0000 [r219376]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 219371 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r219371 |
	  dvossel | 2009-09-17 17:37:28 -0500 (Thu, 17 Sep 2009) | 9 lines
	  fixes deadlock when performing directed pickup w Invite/replaces
	  (closes issue #15340) Reported by: lmsteffan Patches:
	  deadlock.patch uploaded by lmsteffan (license 779) Tested by:
	  lmsteffan ........

2009-09-17 22:37 +0000 [r219370]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 219324 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r219324 | mmichelson | 2009-09-17 17:22:01 -0500 (Thu, 17 Sep
	  2009) | 12 lines Merged revisions 219320 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219320 | mmichelson | 2009-09-17 17:20:50 -0500 (Thu, 17 Sep
	  2009) | 6 lines Send a 100 Trying response when we detect a
	  spiral. This was problematic during spiral tests at SIPit...
	  along with some other things as well. ........ ................

2009-09-17 22:06 +0000 [r219307]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 219304 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r219304 | dvossel | 2009-09-17 16:59:21 -0500 (Thu, 17 Sep 2009)
	  | 27 lines Merged revisions 219303 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219303 | dvossel | 2009-09-17 16:29:37 -0500 (Thu, 17 Sep 2009)
	  | 21 lines INVITE w/Replaces deadlock fix This patch cleans up
	  the locking logic in chan_sip.c's handle_invite_replaces()
	  function as well as making use of ast_do_masquerade() rather than
	  forcing the masquerade on an ast_read(). The code had several
	  redundant unlocks that would result in 'freed more times than
	  we've locked!' errors. I cleaned these up as well as moving all
	  the unlock logic to the end of the function. This patch should
	  also resolve the issue people were having with the replacecall
	  channel never being unlocked with one legged calls. (closes issue
	  #15151) Reported by: irroot Patches: invite_w_replaces_1.4.diff
	  uploaded by dvossel (license 671) Tested by: irroot, dvossel
	  Review: https://reviewboard.asterisk.org/r/371/ ........
	  ................

2009-09-17 19:58 +0000 [r219267]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 219264 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r219264 |
	  file | 2009-09-17 14:57:39 -0500 (Thu, 17 Sep 2009) | 2 lines
	  Ensure no spaces exist before "refresher=" when doing the
	  comparison. ........

2009-09-17  Leif Madsen <lmadsen@digium.com>

	* Released Asterisk 1.6.2.0-rc2

2009-09-17 15:38 +0000 [r219194]  Matthew Nicholson <mnicholson@digium.com>

	* main/channel.c, /, include/asterisk/cdr.h,
	  include/asterisk/channel.h: Merged revisions 219139 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r219139 | mnicholson | 2009-09-17 10:18:01 -0500
	  (Thu, 17 Sep 2009) | 17 lines Merged revisions 219136 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219136 | mnicholson | 2009-09-17 09:58:39 -0500 (Thu, 17 Sep
	  2009) | 10 lines Prevent a potential race condition and crash
	  when hanging up a channel by removing the channel from the
	  channel list before begining channel tear down. This fix may
	  potentially cause problems with CDR backends that access the
	  channel a CDR is associated with via the channel list. This fix
	  makes the channel unavabile at the time when the CDR backend is
	  invoked. This has been documented in include/asterisk/cdr.h.
	  (closes issue #15316) Reported by: vmarrone Tested by: mnicholson
	  Review: https://reviewboard.asterisk.org/r/362/ ........
	  ................

2009-09-16 23:52 +0000 [r219063]  Tilghman Lesher <tlesher@digium.com>

	* main/config.c, configs/extensions.conf.sample, /: Merged
	  revisions 219061 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r219061 | tilghman | 2009-09-16 18:42:12 -0500 (Wed, 16 Sep 2009)
	  | 15 lines Merged revisions 219023 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r219023 | tilghman | 2009-09-16 18:21:53 -0500 (Wed, 16 Sep 2009)
	  | 8 lines Properly deal with quotes in the arguments of '#exec'
	  includes. (closes issue #15583) Reported by: pkempgen Patches:
	  20090726__issue15583.diff.txt uploaded by tilghman (license 14)
	  20090726__issue15583-1.4-4.diff.txt uploaded by pkempgen (license
	  169) Tested by: pkempgen ........ ................

2009-09-16 19:40 +0000 [r218938]  David Brooks <dbrooks@digium.com>

	* main/pbx.c, /: Merged revisions 218868 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r218868 | dbrooks | 2009-09-16 13:06:42 -0500 (Wed, 16 Sep 2009)
	  | 20 lines Merged revisions 218867 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218867 | dbrooks | 2009-09-16 13:00:45 -0500 (Wed, 16 Sep 2009)
	  | 13 lines Fixes CID pattern matching behavior to mirror that of
	  extension pattern matching. Pattern matching for extensions uses
	  a type of scoring system, giving values for specificity to each
	  character in the pattern. Unfortunately, this is done character
	  by character, in order. This does lead to some less specific
	  patterns being first in line for matching, but it will usually
	  get the job done. This patch merely brings CID matching to the
	  same level as extension matching. This patch does not attempt to
	  tackle the problem shared by extension matching. (closes issue
	  #14708) Reported by: klaus3000 ........ ................

2009-09-16 19:29 +0000 [r218937]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 218933 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r218933 |
	  mmichelson | 2009-09-16 14:25:36 -0500 (Wed, 16 Sep 2009) | 12
	  lines Reverse order of args to fread. This way, we don't always
	  write a null byte into byte 1 of the buffer (closes issue #15905)
	  Reported by: ebroad Patches: freadfix.patch uploaded by ebroad
	  (license 878) Tested by: ebroad ........

2009-09-16 19:25 +0000 [r218934]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 218918 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r218918 |
	  file | 2009-09-16 13:31:47 -0500 (Wed, 16 Sep 2009) | 5 lines On
	  TCP and TLS connections do not attempt to stop retransmission of
	  the packet internally. This was preventing responses from being
	  properly processed because the packet was not being found causing
	  handle_response to return prematurely. ........

2009-09-16 13:38 +0000 [r218802]  Russell Bryant <russell@digium.com>

	* contrib/firmware/iax/iaxy.bin (removed), /, UPGRADE.txt: Merged
	  revisions 218799 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r218799 | russell | 2009-09-16 08:34:41 -0500 (Wed, 16 Sep 2009)
	  | 16 lines Merged revisions 218798 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218798 | russell | 2009-09-16 08:33:43 -0500 (Wed, 16 Sep 2009)
	  | 9 lines Remove the IAXy firmware from Asterisk. The firmware
	  can now be found on downloads.digium.com, where the rest of our
	  binary downloads live. This was the last part of our Asterisk
	  tarballs that was considered non-free by Debian. :-) (closes
	  issue #15838) Reported by: paravoid ........ ................

2009-09-15 22:46 +0000 [r218733]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 218731 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r218731 | tilghman | 2009-09-15 17:33:10 -0500
	  (Tue, 15 Sep 2009) | 13 lines Merged revisions 218730 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218730 | tilghman | 2009-09-15 17:27:41 -0500 (Tue, 15 Sep 2009)
	  | 6 lines If the user enters the same password as before, don't
	  signal an error when the change does nothing. (closes issue
	  #15492) Reported by: cbbs70a Patches:
	  20090713__issue15492.diff.txt uploaded by tilghman (license 14)
	  ........ ................

2009-09-15 19:24 +0000 [r218688]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 218687 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r218687 |
	  dvossel | 2009-09-15 14:22:37 -0500 (Tue, 15 Sep 2009) | 2 lines
	  upward bound checking for port string to int conversion ........

2009-09-15 16:18 +0000 [r218590]  Matthew Nicholson <mnicholson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 218586 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r218586 | mnicholson | 2009-09-15 11:15:02 -0500 (Tue, 15 Sep
	  2009) | 15 lines Merged revisions 218578 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218578 | mnicholson | 2009-09-15 11:03:54 -0500 (Tue, 15 Sep
	  2009) | 8 lines Send request contact header field with response
	  to registrer queries instead of the address of record. (closes
	  issue #14438) Reported by: ravindrad Patches: regquerypatch
	  uploaded by ravindrad (license 684) Tested by: ravindrad ........
	  ................

2009-09-15 16:06 +0000 [r218582]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_followme.c, /: Merged revisions 218579 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r218579 | tilghman | 2009-09-15 11:04:41 -0500 (Tue, 15 Sep 2009)
	  | 16 lines Merged revisions 218577 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218577 | tilghman | 2009-09-15 11:01:17 -0500 (Tue, 15 Sep 2009)
	  | 9 lines Ensure FollowMe sets language in channels it creates.
	  Also, not in the original bug report, but related fields are
	  accountcode and musicclass, and the inheritance of datastores.
	  (closes issue #15372) Reported by: Romik Patches:
	  20090828__issue15372.diff.txt uploaded by tilghman (license 14)
	  Tested by: cervajs ........ ................

2009-09-15 15:59 +0000 [r218576]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 218430 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r218430 | jpeeler | 2009-09-14 17:38:25 -0500
	  (Mon, 14 Sep 2009) | 18 lines Merged revisions 218401 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218401 | jpeeler | 2009-09-14 16:47:11 -0500 (Mon, 14 Sep 2009)
	  | 11 lines Fix handling of DAHDI_EVENT_REMOVED event to prevent
	  crash in do_monitor. After talking to rmudgett about some of his
	  recent iflist locking changes, it was determined that the only
	  place that would destroy a channel without being explicitly to do
	  so was in handle_init_event. The loop to walk the interface list
	  has been modified to wait to destroy the channel until the
	  dahdi_pvt of the channel to be destroyed is no longer needed.
	  (closes issue #15378) Reported by: samy ........ ................

2009-09-15 15:42 +0000 [r218507-218575]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 218566 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r218566 |
	  mmichelson | 2009-09-15 10:40:14 -0500 (Tue, 15 Sep 2009) | 4
	  lines Use a better method of ensuring null-termination of the
	  buffer while reading the SDP when using TCP. ........

	* /, channels/chan_sip.c: Merged revisions 218499,218504 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r218499 | mmichelson | 2009-09-15 09:59:50 -0500 (Tue,
	  15 Sep 2009) | 3 lines Fix off-by-one error when reading SDP sent
	  over TCP. ........ r218504 | mmichelson | 2009-09-15 10:05:53
	  -0500 (Tue, 15 Sep 2009) | 3 lines Ensure that SDP read from TCP
	  socket is null-terminated. ........

2009-09-15 15:05 +0000 [r218503]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile, /: Merged revisions 218500 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r218500 | kpfleming | 2009-09-15 11:02:21 -0400 (Tue, 15 Sep
	  2009) | 9 lines Merged revisions 218497 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218497 | kpfleming | 2009-09-15 10:55:58 -0400 (Tue, 15 Sep
	  2009) | 1 line Use proper hostname for downloading sound files.
	  ........ ................

2009-09-14 19:49 +0000 [r218364]  Tilghman Lesher <tlesher@digium.com>

	* sounds/Makefile, apps/app_voicemail.c, /,
	  configs/voicemail.conf.sample: Merged revisions 218361 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r218361 | tilghman | 2009-09-14 14:29:48 -0500
	  (Mon, 14 Sep 2009) | 11 lines Recorded merge of revisions 218331
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218331 | tilghman | 2009-09-14 14:16:35 -0500 (Mon, 14 Sep 2009)
	  | 4 lines Don't say "Please try again" if we don't give the user
	  another chance to try again. (issue #15055, SWP-129) Reported by:
	  jthurman ........ ................

2009-09-14 18:18 +0000 [r218300]  Joshua Colp <jcolp@digium.com>

	* /, main/features.c: Merged revisions 218295 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r218295 |
	  file | 2009-09-14 13:16:39 -0500 (Mon, 14 Sep 2009) | 2 lines Do
	  not attempt to add a parking extension if an error occurred while
	  reading the configuration. ........

2009-09-14 15:20 +0000 [r218238]  Matthew Nicholson <mnicholson@digium.com>

	* /, apps/app_directed_pickup.c: Merged revisions 218224 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r218224 | mnicholson | 2009-09-14 09:57:23 -0500
	  (Mon, 14 Sep 2009) | 14 lines Merged revisions 218223 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r218223 | mnicholson | 2009-09-14 09:53:57 -0500 (Mon, 14 Sep
	  2009) | 8 lines Ensure we don't pickup ourselves when doing
	  pickup by exten. (closes issue #15100) Reported by: lmsteffan
	  Patches: (modified) pickup.patch uploaded by lmsteffan (license
	  779) ........ ................

2009-09-13 22:12 +0000 [r218219]  Tzafrir Cohen <tzafrir.cohen@xorcom.com>

	* channels/chan_phone.c, /: gcc 4.4: Remove a nop memset size 0
	  that annoys gcc This memset doesn't write beyond the end of the
	  buffer. (tmpbuf has size of 4). Merged revisions 218184 via
	  svnmerge from http://svn.digium.com/svn/asterisk/trunk

2009-09-13 05:59 +0000 [r218151]  Moises Silva <moises.silva@gmail.com>

	* channels/chan_dahdi.c, /: Merged revisions 218150 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r218150 | moy | 2009-09-13 01:51:46 -0400 (Sun, 13 Sep 2009) | 1
	  line get rid of mfcr2 monitor thread condition, is problematic
	  ........

2009-09-11 06:00 +0000 [r217926-218055]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 218050 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r218050 |
	  tilghman | 2009-09-11 00:58:11 -0500 (Fri, 11 Sep 2009) | 3 lines
	  Check the origination priority for more matches, not the current
	  priority. Found by Pavel Troller on the -dev list. ........

	* apps/app_queue.c, /: Merged revisions 217990 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r217990 | tilghman | 2009-09-10 18:54:51 -0500 (Thu, 10 Sep 2009)
	  | 10 lines Merged revisions 217989 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r217989 | tilghman | 2009-09-10 18:52:22 -0500 (Thu, 10 Sep 2009)
	  | 3 lines Don't ring another channel, if there's not enough time
	  for a queue member to answer. (Fixes AST-228) ........
	  ................

	* channels/chan_iax2.c, contrib/scripts/iax-friends.sql, /,
	  channels/chan_sip.c: Merged revisions 217916 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r217916 |
	  tilghman | 2009-09-10 18:12:16 -0500 (Thu, 10 Sep 2009) | 2 lines
	  Make calltoken support work with realtime users and peers.
	  ........

2009-09-10 21:21 +0000 [r217821]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 217807 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r217807 | dvossel | 2009-09-10 16:07:47 -0500
	  (Thu, 10 Sep 2009) | 28 lines Merged revisions 217806 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r217806 | dvossel | 2009-09-10 16:06:07 -0500 (Thu, 10 Sep 2009)
	  | 22 lines IAX2 encryption regression The IAX2 Call Token
	  security patch inadvertently broke the use of encryption due to
	  the reorganization of code in the socket_process() function. When
	  encryption is used, an incoming full frame must first be
	  decrypted before the information elements can be parsed. The
	  security release mistakenly moved IE parsing before decryption in
	  order to process the new Call Token IE. To resolve this,
	  decryption of full frames is once again done before looking into
	  the frame. This involves searching for an existing callno,
	  checking the pvt to see if encryption is turned on, and
	  decrypting the packet before the internal fields of the full
	  frame are accessed. (closes issue #15834) Reported by: karesmakro
	  Patches: iax2_encryption_fix_1.4.diff uploaded by dvossel
	  (license 671) Tested by: dvossel, karesmakro Review:
	  https://reviewboard.asterisk.org/r/355/ ........ ................

2009-09-10 19:56 +0000 [r217739]  mnick <mnick@localhost>:

	* res/res_musiconhold.c, /: Merged revisions 217730 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r217730 | mnick | 2009-09-10 14:39:41 -0500 (Thu, 10 Sep 2009) |
	  17 lines Sets the correct musicclass after an announcement
	  (closes issue #15279) Reported by: mbeckwell Patches: patch.txt
	  uploaded by mnick (license ) Tested by: mnick (closes issue
	  #15832) Reported by: mbeckwell Patches: patch.txt uploaded by
	  mnick (license 874) Tested by: mnick ........

2009-09-10 18:40 +0000 [r217665]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 216805 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r216805 |
	  oej | 2009-09-07 18:08:08 +0200 (MÃ¥n, 07 Sep 2009) | 2 lines
	  Since it's possible to have more than 999 calls, I'm changing the
	  call counter roof to something higher. ........

2009-09-10 18:19 +0000 [r217647]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_odbc.c, /, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Merged revisions
	  217638 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r217638 |
	  tilghman | 2009-09-10 13:17:14 -0500 (Thu, 10 Sep 2009) | 4 lines
	  Verify support for wide ODBC character types before using them.
	  (closes issue #15870) Reported by: nic_bellamy ........

2009-09-10 15:14 +0000 [r217632]  Moises Silva <moises.silva@gmail.com>

	* channels/chan_dahdi.c, /: Merged revisions 217524 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r217524 | moy | 2009-09-09 17:48:04 -0400 (Wed, 09 Sep 2009) | 1
	  line ast_log replaced for ast_verbose in MFCR2 event
	  notifications ........

2009-09-10 12:09 +0000 [r217594]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 217593 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r217593 |
	  oej | 2009-09-10 14:06:55 +0200 (Tor, 10 Sep 2009) | 8 lines
	  Include ActionID in all events that are responsed to AMI Action
	  SIPShowRegistry (closes issue #15868) Reported by: nic_bellamy
	  Patches: manager_SIPshowregistry_actionid.patch uploaded by nic
	  bellamy (license 299) ........

2009-09-09 20:37 +0000 [r217519]  Tzafrir Cohen <tzafrir.cohen@xorcom.com>

	* /, res/res_phoneprov.c: gcc 4.4 fix: union instead of cast gcc
	  4.4 has more strict rules for aliasing. It doesn't like a struct
	  sockaddr_in pointer pointing to a struct sockaddr. So we make it
	  a union. Merged revisions 217445 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk

2009-09-09 10:58 +0000 [r217369]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 217368 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r217368 |
	  oej | 2009-09-09 12:39:43 +0200 (Ons, 09 Sep 2009) | 2 lines Not
	  having any TLS session to write to is a serious XMIT_ERROR.
	  ........

2009-09-08 22:20 +0000 [r217299]  Sean Bright <sean@malleable.com>

	* /, apps/app_meetme.c: Merged revisions 217286 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r217286 |
	  seanbright | 2009-09-08 18:17:08 -0400 (Tue, 08 Sep 2009) | 4
	  lines Fix compilation of app_meetme. Reported by ebroad in
	  #asterisk-bugs ........

2009-09-08 20:33 +0000 [r217217]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_meetme.c: Merged revisions 217199 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r217199 | tilghman | 2009-09-08 15:28:41 -0500 (Tue, 08 Sep 2009)
	  | 14 lines Merged revisions 217156 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r217156 | tilghman | 2009-09-08 15:01:45 -0500 (Tue, 08 Sep 2009)
	  | 7 lines When MOH is playing on the channel, announcements sent
	  through the conference are not heard. (closes issue #14588)
	  Reported by: voipas Patches: 20090716__issue14588__2.diff.txt
	  uploaded by tilghman (license 14) Tested by: lmadsen, twisted,
	  tilghman ........ ................

2009-09-08 16:39 +0000 [r217077]  Kevin P. Fleming <kpfleming@digium.com>

	* /, configure, include/asterisk/autoconfig.h.in, configure.ac:
	  Merged revisions 217074 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r217074 |
	  kpfleming | 2009-09-08 11:37:28 -0500 (Tue, 08 Sep 2009) | 9
	  lines Ensure that the default autoconf CFLAGS are not used. A
	  recent change to the configure script that allows the user to
	  specify CFLAGS and/or LDFLAGS to the script had the unfortunate
	  side effect of letting autoconf's default CFLAGS (-g -O2) feed in
	  to the rest of the build system, thereby overriding the
	  DONT_OPTIMIZE setting in menuselect. That problem is now
	  corrected. ........

2009-09-08 15:36 +0000 [r217036]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_limit.c: Merged revisions 217033 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r217033 |
	  tilghman | 2009-09-08 10:30:18 -0500 (Tue, 08 Sep 2009) | 4 lines
	  Remove what appears to be an unnecessary define. (closes issue
	  #15851) Reported by: tzafrir ........

2009-09-08 14:27 +0000 [r216994]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 216993 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r216993 |
	  dvossel | 2009-09-08 09:26:30 -0500 (Tue, 08 Sep 2009) | 14 lines
	  caller id number empty parse_uri was not being given the correct
	  scheme's, as a result, uri parsing did not parse the username
	  correctly. One of the side effects of this is an empty caller id.
	  (closes issue #15839) Reported by: ebroad Patches:
	  blank_cidv2.patch uploaded by ebroad (license 878)
	  parse_uri_fix.diff uploaded by dvossel (license 671) Tested by:
	  ebroad, dvossel ........

2009-09-07 16:43 +0000 [r216647-216845]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 216842 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r216842 |
	  oej | 2009-09-07 18:35:12 +0200 (MÃ¥n, 07 Sep 2009) | 2 lines
	  Make sure we reset global_exclude_static at channel reload
	  ........

	* /, channels/chan_sip.c: Merged revisions 216695 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r216695 |
	  oej | 2009-09-07 15:06:19 +0200 (MÃ¥n, 07 Sep 2009) | 8 lines If
	  there is no session timer in the INVITE, set it to default value
	  (not unset minimum = -1) Patch by oej closes issue #15621
	  Reported by: fnordian Tested by: atis ........

	* CHANGES, UPGRADE.txt: Add docs

	* configs/sip.conf.sample, apps/app_playback.c, main/pbx.c, /,
	  channels/chan_sip.c, apps/app_disa.c: Merged revisions 216438 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r216438 | oej | 2009-09-04 16:02:34 +0200 (Fre,
	  04 Sep 2009) | 35 lines Merged revisions 216430 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r216430 | oej | 2009-09-04 15:45:48 +0200 (Fre, 04 Sep 2009) | 27
	  lines Make apps send PROGRESS control frame for early media and
	  fix too early media issue in SIP The issue at hand is that some
	  legacy (dying) PBX systems send empty media frames on PRI links
	  *before* any call progress. The SIP channel receives these frames
	  and by default signals 183 Session progress and starts sending
	  media. This will cause phones to play silence and ignore the
	  later 180 ringing message. A bad user experience. The fix is
	  twofold: - We discovered that asterisk apps that support early
	  media ("noanswer") did not send any PROGRESS frame to indicate
	  early media. Fixed. - We introduce a setting in chan_sip so that
	  users can disable any relay of media frames before the outbound
	  channel actually indicates any sort of call progress. In 1.4,
	  1.6.0 and 1.6.1, this will be disabled for backward
	  compatibility. In later versions of Asterisk, this will be
	  enabled. We don't assume that it will change your Asterisk phone
	  experience - only for the better. We encourage third-party
	  application developers to make sure that if they have
	  applications that wants to send early media, add a PROGRESS
	  control frame transmission to make sure that all channel drivers
	  actually will start sending early media. This has not been the
	  default in Asterisk previous to this patch, so if you got
	  inspiration from our code, you need to update accordingly. Sorry
	  for the trouble and thanks for your support. This code has been
	  running for a few months in a large scale installation (over 250
	  servers with PRI and/or BRI links to old PBX systems). That's no
	  proof that this is an excellent patch, but, well, it's tested :-)
	  ........ ................

2009-09-04 19:42 +0000 [r216598]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 216594 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r216594 |
	  dvossel | 2009-09-04 14:32:07 -0500 (Fri, 04 Sep 2009) | 7 lines
	  sip peer matching by address only with TCP/TLS This patch removes
	  the contact header matching logic and adds logic to match all
	  tcp/tls connections by ip only Review:
	  https://reviewboard.asterisk.org/r/354/ ........

2009-09-04 19:32 +0000 [r216597]  Sean Bright <sean@malleable.com>

	* apps/app_voicemail.c, /: Merged revisions 216593 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r216593 | seanbright | 2009-09-04 15:29:02 -0400 (Fri, 04 Sep
	  2009) | 1 line Use ast_free() instead of free(). ........

2009-09-04 17:53 +0000 [r216550-216553]  Tilghman Lesher <tlesher@digium.com>

	* /, include/asterisk/lock.h: Merged revisions 216551 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r216551 | tilghman | 2009-09-04 12:50:21 -0500 (Fri, 04 Sep 2009)
	  | 2 lines Fix trunk breakage. ........

	* UPGRADE-1.6.txt, main/pbx.c, /: Merged revisions 216547 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r216547 | tilghman | 2009-09-04 12:31:44 -0500 (Fri, 04
	  Sep 2009) | 3 lines Enable turning off the application delimiter
	  warning with the 'dontwarn' option. Suggested on the -dev list,
	  and implemented in an alternate way by me. ........

2009-09-04 15:11 +0000 [r216469-216509]  Michiel van Baak <michiel@vanbaak.info>

	* /, main/utils.c: Merged revisions 216506 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r216506 | mvanbaak | 2009-09-04 17:05:05 +0200 (Fri, 04 Sep 2009)
	  | 9 lines Merged revisions 216435 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r216435 | mvanbaak | 2009-09-04 15:56:10 +0200 (Fri, 04 Sep 2009)
	  | 2 lines make asterisk compile under devmode with DEBUG_THREADS
	  enabled on OpenBSD ........ ................

	* /, include/asterisk/lock.h: Merged revisions 216437 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r216437 | mvanbaak | 2009-09-04 16:00:38 +0200 (Fri, 04 Sep 2009)
	  | 2 lines make sure canlog is set so we can compile with
	  DEBUG_THREADS enabled on OpenBSD ........

2009-09-04 13:57 +0000 [r216267-216436]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 216368 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r216368 |
	  russell | 2009-09-04 08:14:25 -0500 (Fri, 04 Sep 2009) | 12 lines
	  Do not treat every SIP peer as if they were configured with
	  insecure=port. There was a problem in the function responsible
	  for doing peer matching by IP address and port number such that
	  during the second pass for checking for a peer configured with
	  insecure=port, it would end up treating every peer as if it had
	  been configured that way. These changes fix the logic in the peer
	  IP and port comparison callback to handle insecure=port checking
	  properly. This problem was introduced when SIP peers were
	  converted to astobj2. Many thanks to dvossel for noticing this
	  while working on another peer matching issue. ........

	* doc/IAX2-security.txt (added), /: Merged revisions 216264 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r216264 | russell | 2009-09-04 05:48:44 -0500
	  (Fri, 04 Sep 2009) | 16 lines Merged revisions 216263 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r216263 | russell | 2009-09-04 05:48:00 -0500
	  (Fri, 04 Sep 2009) | 9 lines Merged revisions 216262 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r216262 | russell | 2009-09-04 05:47:37 -0500 (Fri, 04
	  Sep 2009) | 2 lines Add a plain text version of the IAX2 security
	  document. ........ ................ ................

2009-09-04 06:14 +0000 [r216225]  Michiel van Baak <michiel@vanbaak.info>

	* main/astobj2.c, /: Merged revisions 216222 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r216222 |
	  mvanbaak | 2009-09-04 08:08:33 +0200 (Fri, 04 Sep 2009) | 3 lines
	  make sure 'start' is always initialized. Makes asterisk compile
	  with --enable-dev-mode ........

2009-09-03 19:44 +0000 [r216014-216099]  Russell Bryant <russell@digium.com>

	* /, UPGRADE.txt: Merged revisions 216092 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r216092 | russell | 2009-09-03 14:38:35 -0500 (Thu, 03 Sep 2009)
	  | 16 lines Merged revisions 216085 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r216085 | russell | 2009-09-03 14:36:46 -0500
	  (Thu, 03 Sep 2009) | 9 lines Merged revisions 216080 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r216080 | russell | 2009-09-03 14:35:23 -0500 (Thu, 03
	  Sep 2009) | 2 lines Add a note about IAX2 to UPGRADE.txt.
	  ........ ................ ................

	* /, doc/IAX2-security.pdf (added): Merged revisions 216009 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r216009 | russell | 2009-09-03 13:45:54 -0500
	  (Thu, 03 Sep 2009) | 16 lines Merged revisions 216008 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r216008 | russell | 2009-09-03 13:44:58 -0500
	  (Thu, 03 Sep 2009) | 9 lines Merged revisions 216005 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r216005 | russell | 2009-09-03 13:42:24 -0500 (Thu, 03
	  Sep 2009) | 2 lines Add IAX2 security document related to
	  AST-2009-006. ........ ................ ................

2009-09-03 18:42 +0000 [r216007]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, channels/iax2-parser.c, main/astobj2.c,
	  configs/iax.conf.sample, include/asterisk/acl.h,
	  channels/iax2-parser.h, /, include/asterisk/astobj2.h,
	  channels/iax2.h, main/acl.c: Merged revisions 215955 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r215955 | dvossel | 2009-09-03 11:31:54 -0500 (Thu, 03 Sep 2009)
	  | 6 lines Merge code associated with AST-2009-006 (closes issue
	  #12912) Reported by: rathaus Tested by: tilghman, russell,
	  dvossel, dbrooks ........

2009-09-03 14:21 +0000 [r215887-215929]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 215891 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215891 |
	  oej | 2009-09-03 15:02:41 +0200 (Tor, 03 Sep 2009) | 10 lines Add
	  known internal IP address when autodomain=yes (closes issue
	  #14573) Reported by: pj Patches: sip-internip-autodomain1.diff
	  uploaded by mnicholson (license 96) modified by oej Tested by: pj
	  ........

	* main/rtp.c, channels/chan_sip.c: Fix bad reports in "sip show
	  channelstats". Not directly mergeable in svn trunk, needs more
	  tests, therefore committed directly to 1.6.2. (closes issue
	  #15819) Reported by: klaus3000 Patches:
	  asterisk-1.6.2-beta4-sipshowchannelstats-patch-0.2.txt uploaded
	  by klaus3000 (license 65) Tested by: klaus3000, oej

2009-09-03 06:02 +0000 [r215841]  Michiel van Baak <michiel@vanbaak.info>

	* doc/manager_1_1.txt, /: Merged revisions 215838 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215838 |
	  mvanbaak | 2009-09-03 07:57:23 +0200 (Thu, 03 Sep 2009) | 5 lines
	  Document that SIPshowpeer and SKINNYshowline now include the
	  configured parkinglot in their response. Prodded by snuff-work on
	  #asterisk-dev IRC channel ........

2009-09-03 03:44 +0000 [r215802]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 215801 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215801 |
	  tilghman | 2009-09-02 22:43:51 -0500 (Wed, 02 Sep 2009) | 5 lines
	  Default the callback extension to "s". This is a regression.
	  (closes issue #15764) Reported by: elguero Change-type: bugfix
	  ........

2009-09-03 00:34 +0000 [r215795]  Terry Wilson <twilson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 215758 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r215758 | twilson | 2009-09-02 18:31:04 -0500 (Wed, 02 Sep 2009)
	  | 25 lines Merged revisions 215682 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r215682 | twilson | 2009-09-02 16:41:22 -0500 (Wed, 02 Sep 2009)
	  | 18 lines Re-send non-100 provisional responses to prevent
	  cancellation From section 13.3.1.1 of RFC 3261: If the UAS
	  desires an extended period of time to answer the INVITE, it will
	  need to ask for an "extension" in order to prevent proxies from
	  canceling the transaction. A proxy has the option of canceling a
	  transaction when there is a gap of 3 minutes between responses in
	  a transaction. To prevent cancellation, the UAS MUST send a
	  non-100 provisional response at every minute, to handle the
	  possibility of lost provisional responses. (closes issue #11157)
	  Reported by: rjain Tested by: twilson Review:
	  https://reviewboard.asterisk.org/r/315/ ........ ................

2009-09-02 21:46 +0000 [r215683]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 215681 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215681 |
	  dvossel | 2009-09-02 16:39:31 -0500 (Wed, 02 Sep 2009) | 10 lines
	  port string to int conversion using sscanf There are several
	  instances where a port is parsed from a uri or some other source
	  and converted to an int value using atoi(), if for some reason
	  the port string is empty, then a standard port is used. This
	  logic is used over and over, so I created a function to handle it
	  in a safer way using sscanf(). ........

2009-09-02 21:37 +0000 [r215647-215680]  Michiel van Baak <michiel@vanbaak.info>

	* /, channels/chan_sip.c, channels/chan_skinny.c: Merged revisions
	  215665 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215665 |
	  mvanbaak | 2009-09-02 23:23:17 +0200 (Wed, 02 Sep 2009) | 5 lines
	  add Parkinglot info to sip show peer <foo> and skinny show line
	  <foo> If we had this from the start, debugging the 'parking not
	  using configured parkinglot' bug would have been easier. ........

	* /, main/features.c: Merged revisions 215622 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215622 |
	  mvanbaak | 2009-09-02 22:21:51 +0200 (Wed, 02 Sep 2009) | 4 lines
	  - lock channel before looking for a channel variable - Init the
	  parkings list member of struct parkinglot. Thanks Sean for the
	  explanation why this should be here. ........

2009-09-02 18:52 +0000 [r215569-215570]  Tilghman Lesher <tlesher@digium.com>

	* /, main/Makefile, main/app.c: Merged revisions 215567 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r215567 | tilghman | 2009-09-02 13:37:25 -0500 (Wed, 02
	  Sep 2009) | 9 lines Close up to the soft open file limit (same on
	  Linux, but varies drastically on OS X). Also, a Makefile fix for
	  Darwin (OS X). (closes issue #14542) Reported by: jtodd Patches:
	  20090901__issue14542.diff.txt uploaded by tilghman (license 14)
	  Tested by: jtodd, tilghman Change-type: bugfix ........

	* /, channels/chan_sip.c: Merged revisions 215222 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215222 |
	  tilghman | 2009-09-01 16:19:40 -0500 (Tue, 01 Sep 2009) | 3 lines
	  Fix register such that lines with a transport string, but without
	  an authuser, parse correctly. (AST-228) ........

2009-09-02 17:35 +0000 [r215523]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 215522 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215522 |
	  dvossel | 2009-09-02 12:26:40 -0500 (Wed, 02 Sep 2009) | 11 lines
	  SIP uri parsing cleanup Now, the scheme passed to parse_uri can
	  either be a single scheme, or a list of schemes ',' delimited.
	  This gets rid of the whole problem of having to create two
	  buffers and calling parse_uri twice to check for separate
	  schemes. Review: https://reviewboard.asterisk.org/r/343/ ........

2009-09-02 16:35 +0000 [r215512]  Michiel van Baak <michiel@vanbaak.info>

	* /, channels/chan_skinny.c: Merged revisions 215479 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r215479 | mvanbaak | 2009-09-02 18:20:23 +0200 (Wed, 02 Sep 2009)
	  | 3 lines like in chan_sip's sip_new skinny should copy the
	  configured parkinglot from a line to the newly created channel.
	  This makes callparking honor the configured parkinglot for skinny
	  lines as well. ........

2009-09-02 16:09 +0000 [r215467]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 215466 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215466 |
	  dvossel | 2009-09-02 11:08:00 -0500 (Wed, 02 Sep 2009) | 16 lines
	  SIP support for keep-alive event keep-alive events are used by
	  Sipura/Linksys for NAT keepalive. There currently don't appear to
	  be any problems with NAT, but everytime a keep-alive event is
	  received, Asterisk responds with a "489 Bad event". This error
	  may indicate to a user that NAT problems exist just because this
	  even is not supported. Now, rather than respond with an error,
	  the packet is consumed and a "200 ok" is sent just to indicate we
	  received the packet. (issue #15084) Patches:
	  chan_sip.keepalive.v1.diff uploaded by IgorG (license 20)
	  ........

2009-09-02 16:07 +0000 [r215465]  Michiel van Baak <michiel@vanbaak.info>

	* /, channels/chan_sip.c: Merged revisions 215462 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215462 |
	  mvanbaak | 2009-09-02 17:56:46 +0200 (Wed, 02 Sep 2009) | 12
	  lines Honor configured parkinglot when parking and retrieving
	  parked calls Thank oej for pointing out the fact that sip_new did
	  not copy parkinglot from the peer into the newly created channel.
	  (closes issue #15538) Reported by: gracedman Patches:
	  2009090100_sipnewparkinglot-161.diff.txt uploaded by mvanbaak
	  (license 7) With mod by me to also fix callparking as well (this
	  uploaded patch only fixed retrieving a parked call) Tested by:
	  gracedman, mvanbaak ........

2009-09-02 01:49 +0000 [r215376]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* /, apps/app_softhangup.c: Merged revisions 215338 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r215338 | dhubbard | 2009-09-01 20:16:59 -0500
	  (Tue, 01 Sep 2009) | 18 lines Merged revisions 215270 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r215270 | dhubbard | 2009-09-01 18:04:52 -0500 (Tue, 01 Sep 2009)
	  | 12 lines Use strrchr() so SoftHangup will correctly truncate
	  multi-hyphen channel names In general channel names are in the
	  form Foo/Bar-Z, but the channel name could have multiple hyphens
	  and look like Foo/B-a-r-Z. Use strrchr to truncate the channel
	  name at the last hyphen. (closes issue #15810) Reported by:
	  dhubbard Patches: dw-softhangup-1.4.patch uploaded by dhubbard
	  (license 733) ........ ................

2009-09-01 20:00 +0000 [r215165]  Kevin P. Fleming <kpfleming@digium.com>

	* main/frame.c, /: Merged revisions 215161 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r215161 |
	  kpfleming | 2009-09-01 14:50:48 -0500 (Tue, 01 Sep 2009) | 3
	  lines Ensure that frame dumps of AST_CONTROL_T38_PARAMETERS
	  frames are properly decoded. ........

2009-08-31 16:22 +0000 [r214822-214960]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_local.c, /: Merged revisions 214945 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r214945 | tilghman | 2009-08-31 11:18:33 -0500
	  (Mon, 31 Aug 2009) | 14 lines Merged revisions 214940 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r214940 | tilghman | 2009-08-31 11:16:52 -0500 (Mon, 31 Aug 2009)
	  | 7 lines Also unlock the "other" channel, when returning, due to
	  glare. (closes issue #15787) Reported by: tim_ringenbach Patches:
	  chan_local.diff uploaded by tim ringenbach (license 540) Tested
	  by: tim_ringenbach ........ ................

	* Makefile, /: Merged revisions 214898 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r214898 |
	  tilghman | 2009-08-30 17:10:35 -0500 (Sun, 30 Aug 2009) | 2 lines
	  Force Darwin on ppc platforms to compile with a target level that
	  supports aliasing. ........

	* /, configure, include/asterisk/autoconfig.h.in, configure.ac,
	  pbx/pbx_lua.c: Merged revisions 214819 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r214819 |
	  tilghman | 2009-08-30 01:43:04 -0500 (Sun, 30 Aug 2009) | 4 lines
	  If lua is detected with the lua5.1 prefix (or not), adjust the
	  include path accordingly. Based upon feedback to a release
	  announcement on the -users list. See
	  http://lists.digium.com/pipermail/asterisk-users/2009-August/236954.html
	  ........

2009-08-29  Leif Madsen <lmadsen@digium.com>

	* Asterisk 1.6.2.0-rc1 released.

2009-08-28 20:17 +0000 [r214707]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /: Merged revisions 214702 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r214702 | tilghman | 2009-08-28 15:14:39 -0500 (Fri, 28 Aug 2009)
	  | 15 lines Merged revisions 214701 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r214701 | tilghman | 2009-08-28 15:13:32 -0500 (Fri, 28 Aug 2009)
	  | 8 lines Modify comment to be a bit more accurate. We have kept
	  this comment around long enough, that it's pretty clear that
	  we're keeping the code, because changing the code would require a
	  pretty fundamental architectural shift. We've also taken
	  criticism in some quarters, because it was believed that it was
	  referring to the code being nasty. No, the code isn't nasty, just
	  the operation itself is rather odd. Fixed for eternity (probably
	  not). ........ ................

2009-08-28 20:05 +0000 [r214700]  Kevin P. Fleming <kpfleming@digium.com>

	* makeopts.in, Makefile, /, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Merged revisions
	  214696 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r214696 |
	  kpfleming | 2009-08-28 15:01:21 -0500 (Fri, 28 Aug 2009) | 9
	  lines Ensure that CFLAGS and/or LDFLAGS provided to configure
	  script are preserved. Cross-compilation environments want to
	  provide 'defaults' for compiler and linker options, and
	  frequently do this by specifying CFLAGS and LDFLAGS in the
	  environment or as command-line arguments to the configure script.
	  This patch modifies the configure script and Makefile to preserve
	  these settings and ensure they are used in the build process.
	  ........

2009-08-28 18:43 +0000 [r214653]  Mark Michelson <mmichelson@digium.com>

	* /, include/asterisk/sched.h: Merged revisions 214650 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r214650 | mmichelson | 2009-08-28 13:41:23 -0500 (Fri, 28 Aug
	  2009) | 3 lines Fix some incorrect documentation of sched_thread
	  functions. ........

2009-08-27 21:49 +0000 [r214202-214521]  Tilghman Lesher <tlesher@digium.com>

	* autoconf/libcurl.m4 (added), /, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Merged revisions
	  214518 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r214518 | tilghman | 2009-08-27 16:46:46 -0500 (Thu, 27 Aug 2009)
	  | 14 lines Merged revisions 214517 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r214517 | tilghman | 2009-08-27 16:45:34 -0500 (Thu, 27 Aug 2009)
	  | 7 lines Use autoconf to detect libcurl, as this enables
	  cross-compilation checks, something we didn't allow before.
	  (closes issue #15714) Reported by: pprindeville Patches:
	  20090813__issue15714.diff.txt uploaded by tilghman (license 14)
	  Tested by: pprindeville ........ ................

	* main/manager.c, /: Merged revisions 214514 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r214514 |
	  tilghman | 2009-08-27 16:26:37 -0500 (Thu, 27 Aug 2009) | 7 lines
	  Ensure that we check for the special value
	  CONFIG_STATUS_FILEINVALID. (closes issue #15786) Reported by:
	  a_villacis Patches:
	  asterisk-1.6.2.0-beta4-manager-fix-crash-on-include-nonexistent-file.patch
	  uploaded by a villacis (license 660) (Plus a few of my own, to
	  catch the remaining places within manager.c where it could have
	  been a problem) ........

	* autoconf/ast_ext_lib.m4, /, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Merged revisions
	  214466 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r214466 | tilghman | 2009-08-27 12:28:01 -0500 (Thu, 27 Aug 2009)
	  | 9 lines Merged revisions 214436 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r214436 | tilghman | 2009-08-27 11:53:58 -0500 (Thu, 27 Aug 2009)
	  | 2 lines One more build system change, to make the descriptions
	  look better, if we have better information. ........
	  ................

	* autoconf/ast_ext_lib.m4, /, configure,
	  include/asterisk/autoconfig.h.in: Merged revisions 214360 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r214360 | tilghman | 2009-08-27 11:12:03 -0500
	  (Thu, 27 Aug 2009) | 10 lines Merged revisions 214357 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r214357 | tilghman | 2009-08-27 11:03:50 -0500 (Thu, 27 Aug 2009)
	  | 3 lines Make autoheader descriptions render correctly in our
	  autoconfig.h file. (Figured out while working with issue #14906)
	  ........ ................

	* /, channels/chan_sip.c: Merged revisions 214199 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r214199 |
	  tilghman | 2009-08-26 11:53:03 -0500 (Wed, 26 Aug 2009) | 6 lines
	  Typo fix ("SIP/2.0 XXX" is 11 chars, not 10) (closes issue
	  #15362) Reported by: klaus3000 Patches:
	  chan_sip.c_logmessagefix_patch.txt uploaded by klaus3000 (license
	  65) ........

2009-08-26 16:39 +0000 [r214196]  David Vossel <dvossel@digium.com>

	* main/channel.c, /: Merged revisions 214195 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r214195 | dvossel | 2009-08-26 11:38:53 -0500 (Wed, 26 Aug 2009)
	  | 25 lines Merged revisions 214194 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r214194 | dvossel | 2009-08-26 11:36:42 -0500 (Wed, 26 Aug 2009)
	  | 19 lines ast_write() ignores ast_audiohook_write() results In
	  ast_write(), if a channel has a list of audiohooks, those lists
	  are written to and the resulting frame is what ast_write() should
	  continue with. The problem was the returned audiohook frame was
	  not being handled at all, and the original frame passed into it
	  did not contain the mixed audio, so essentially audio was being
	  lost. One result of this was chan_spy's whisper mode no longer
	  worked. To complicate the issue, frames passed into ast_write may
	  either be a single frame, or a list of frames. So, as the list of
	  frames is processed in the audiohook_write, the returned frames
	  had to be added to a new list. (closes issue #15660) Reported by:
	  corruptor Tested by: dvossel ........ ................

2009-08-25 22:43 +0000 [r213903-214155]  Tilghman Lesher <tlesher@digium.com>

	* /, configure, include/asterisk/autoconfig.h.in, configure.ac:
	  Merged revisions 214152 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r214152 |
	  tilghman | 2009-08-25 17:39:51 -0500 (Tue, 25 Aug 2009) | 4 lines
	  Not all versions of gnu-linux use glibc, which contains iconv.
	  Some (especially embedded systems) don't have iconv at all.
	  (closes issue #15169) Reported by: pprindeville ........

	* /, main/say.c: Merged revisions 214071 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r214071 | tilghman | 2009-08-25 14:32:48 -0500 (Tue, 25 Aug 2009)
	  | 17 lines Merged revisions 214068-214069 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r214068 | tilghman | 2009-08-25 14:26:50 -0500 (Tue, 25 Aug 2009)
	  | 6 lines Fix pronunciation of German dates. (closes issue
	  #15273) Reported by: Benjamin Kluck Patches: say_c.patch uploaded
	  by Benjamin Kluck (license 803) ........ r214069 | tilghman |
	  2009-08-25 14:28:42 -0500 (Tue, 25 Aug 2009) | 2 lines I should
	  always compile before committing... ........ ................

	* /, pbx/pbx_dundi.c: Merged revisions 213975 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213975 |
	  tilghman | 2009-08-25 01:51:12 -0500 (Tue, 25 Aug 2009) | 6 lines
	  DUNDILOOKUP function in 1.6 should use comma delimiters. (closes
	  issue #15322) Reported by: chappell Patches:
	  dundilookup-0015322.patch uploaded by chappell (license 8)
	  ........

	* main/pbx.c, /: Merged revisions 213971 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r213971 | tilghman | 2009-08-25 01:35:37 -0500 (Tue, 25 Aug 2009)
	  | 14 lines Merged revisions 213970 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r213970 | tilghman | 2009-08-25 01:34:44 -0500 (Tue, 25 Aug 2009)
	  | 7 lines Improve error message by informing user exactly which
	  function is missing a parethesis. (closes issue #15242) Reported
	  by: Nick_Lewis Patches: pbx.c-funcparenthesis.patch2 uploaded by
	  dbrooks (license 790) pbx.c-funcparenthesis-1.4.diff uploaded by
	  loloski (license 68) ........ ................

	* Makefile, /: Merged revisions 213904 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213904 |
	  tilghman | 2009-08-24 21:54:07 -0500 (Mon, 24 Aug 2009) | 6 lines
	  The DTD should be installed in the same path as the rest of the
	  XML documentation. (closes issue #15344) Reported by: tzafrir
	  Patches: makefile_appdocs_dtd.diff uploaded by tzafrir (license
	  46) ........

	* Makefile, /: Merged revisions 213900 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r213900 | tilghman | 2009-08-24 21:41:17 -0500 (Mon, 24 Aug 2009)
	  | 11 lines Merged revisions 213899 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r213899 | tilghman | 2009-08-24 21:40:22 -0500 (Mon, 24 Aug 2009)
	  | 4 lines Use the default runlevels for Debian derivatives,
	  instead of making up our own. (closes issue #14730) Reported by:
	  pkempgen ........ ................

2009-08-24 16:49 +0000 [r213836]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 213833 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r213833 | jpeeler | 2009-08-24 11:43:57 -0500 (Mon, 24 Aug 2009)
	  | 14 lines Fix storage of greetings when using IMAP_STORAGE The
	  store macro was not getting called preventing storage of IMAP
	  greetings at all. This has been corrected along with fixing
	  checking if the imapgreetings option is turned on to store the
	  greeting in IMAP. Lastly, the attachment filename was incorrectly
	  using the full path instead of just the basename, which was
	  causing problems with retrieval of the greeting. (closes issue
	  #14950) Reported by: noahisaac (closes issue #15729) Reported by:
	  lmadsen ........

2009-08-24 04:54 +0000 [r213791]  Moises Silva <moises.silva@gmail.com>

	* channels/chan_dahdi.c, /: Merged revisions 213790 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r213790 | moy | 2009-08-24 00:46:28 -0400 (Mon, 24 Aug 2009) | 1
	  line improve handling of openr2_chan_disconnect_call API failure,
	  unlikely, but happened on openr2 library bug ........

2009-08-21 22:54 +0000 [r213739]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 213738 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213738 |
	  tilghman | 2009-08-21 17:36:39 -0500 (Fri, 21 Aug 2009) | 2 lines
	  Clarifying comments in sip_register, and removing a dead section
	  ........

2009-08-21 22:23 +0000 [r213721]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 213716 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213716 |
	  dvossel | 2009-08-21 17:22:11 -0500 (Fri, 21 Aug 2009) | 10 lines
	  Register request line contains wrong address when user domain and
	  register host differ (closes issue #15539) Reported by:
	  Nick_Lewis Patches: chan_sip.c-registraraddr.patch uploaded by
	  Nick (license 657) register_domain_fix_1.6.2 uploaded by dvossel
	  (license 671) Tested by: Nick_Lewis, dvossel ........

2009-08-21 21:44 +0000 [r213698]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 213697 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r213697 | kpfleming | 2009-08-21 16:39:51 -0500 (Fri, 21 Aug
	  2009) | 12 lines Ensure that realtime mailboxes properly report
	  status on subscription. This patch modifies app_voicemail's
	  response to mailbox status subscriptions (via the internal event
	  system) to ensure that a subscription triggers an explicit poll
	  of the mailbox, so the subscriber can get an immediate cached
	  event with that status. Previously, the cache was only populated
	  with the status of non-realtime mailboxes. (closes issue #15717)
	  Reported by: natmlt ........

2009-08-21 21:12 +0000 [r213636]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 213635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213635 |
	  dvossel | 2009-08-21 16:02:50 -0500 (Fri, 21 Aug 2009) | 5 lines
	  fixes sip register parsing when user@domain is used (issue
	  #15008) (issue #15672) ........

2009-08-21 16:55 +0000 [r213563]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk.h, /: Merged revisions 213560 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r213560 | tilghman | 2009-08-21 11:53:52 -0500 (Fri, 21 Aug 2009)
	  | 14 lines Merged revisions 213559 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r213559 | tilghman | 2009-08-21 11:52:53 -0500 (Fri, 21 Aug 2009)
	  | 7 lines Permit DEBUG_FD_LEAKS to be used with C++ source files.
	  (closes issue #15698) Reported by: slavon Patches:
	  20090817__issue15698.diff.txt uploaded by tilghman (license 14)
	  Tested by: slavon, tilghman ........ ................

2009-08-21 16:06 +0000 [r213497]  Jason Parker <jparker@digium.com>

	* /, configs/queues.conf.sample: Merged revisions 213494 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r213494 | qwell | 2009-08-21 11:04:21 -0500
	  (Fri, 21 Aug 2009) | 12 lines Merged revisions 213493 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r213493 | qwell | 2009-08-21 11:03:21 -0500 (Fri, 21 Aug 2009) |
	  5 lines Clarify queues.conf comments to specify that variables
	  should be set in the dialplan. (closes issue #15755) Reported by:
	  trendboy ........ ................

2009-08-21 04:25 +0000 [r213475-213481]  Moises Silva <moises.silva@gmail.com>

	* channels/chan_dahdi.c, /: Merged revisions 213454 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r213454 | moy | 2009-08-21 00:09:26 -0400 (Fri, 21 Aug 2009) | 1
	  line increment the mfcr2 monitor count when clearing the call
	  request ........

	* channels/chan_dahdi.c, /: Merged revisions 213216 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r213216 | moy | 2009-08-19 23:26:59 -0400 (Wed, 19 Aug 2009) | 1
	  line fixed bug caused by calling ast_request without calling
	  ast_call on an R2 channel, ie, CHANISAVAIL ........

2009-08-21 03:53 +0000 [r213453]  Terry Wilson <twilson@digium.com>

	* main/loader.c, /: Merged revisions 213450 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213450 |
	  twilson | 2009-08-20 22:48:54 -0500 (Thu, 20 Aug 2009) | 2 lines
	  Make LOAD_ORDER actually work ........

2009-08-20 21:50 +0000 [r213413]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 213404 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r213404 | jpeeler | 2009-08-20 16:33:11 -0500 (Thu, 20 Aug 2009)
	  | 12 lines Fix greeting retrieval from IMAP Properly check for
	  the current voicemail state and if it doesn't exist, create it.
	  (closes issue #14597) Reported by: wtca Patches: 14597_v2.patch
	  uploaded by mmichelson (license 60) Tested by: jpeeler ........

2009-08-20 20:37 +0000 [r213350]  Matthew Nicholson <mnicholson@digium.com>

	* /, main/features.c: Merged revisions 213327 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213327 |
	  mnicholson | 2009-08-20 15:29:32 -0500 (Thu, 20 Aug 2009) | 7
	  lines Fix a crash by checking the proper pointer for validity
	  before deferencing it. (closes issue #15751) Reported by: atis
	  Patches: ast_bridge_call_peer_cdr.patch uploaded by atis (license
	  242) ........

2009-08-19 22:41 +0000 [r213182]  Jason Parker <jparker@digium.com>

	* main/alaw.c, main/ulaw.c, /: Merged revisions 213179 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r213179 | qwell | 2009-08-19 17:38:46 -0500 (Wed, 19 Aug 2009) |
	  5 lines Fix compile when certain G711 menuselect options are
	  enabled. (closes issue #15697) Reported by: slavon ........

2009-08-19 21:25 +0000 [r213128]  David Vossel <dvossel@digium.com>

	* apps/app_mixmonitor.c, /: Merged revisions 213113 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r213113 | dvossel | 2009-08-19 16:21:00 -0500
	  (Wed, 19 Aug 2009) | 14 lines Merged revisions 213103 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r213103 | dvossel | 2009-08-19 16:18:37 -0500 (Wed, 19 Aug 2009)
	  | 8 lines Fixes memory leak caused by incorrectly freeing
	  mixmonitor (closes issue #15699) Reported by: edantie Patches:
	  mixmonitor.patch uploaded by edantie (license 862) ........
	  ................

2009-08-19 21:22 +0000 [r213095-213117]  Tilghman Lesher <tlesher@digium.com>

	* configs/sip.conf.sample, /, channels/chan_sip.c: Merged revisions
	  213098 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213098 |
	  tilghman | 2009-08-19 16:05:17 -0500 (Wed, 19 Aug 2009) | 9 lines
	  Better parsing for the "register" line Allows characters that are
	  otherwise used as delimiters to be used within certain fields
	  (like the secret). (closes issue #15008, closes issue #15672)
	  Reported by: tilghman Patches: 20090818__issue15008.diff.txt
	  uploaded by tilghman (license 14) Tested by: lmadsen, tilghman
	  ........

	* /, channels/chan_sip.c: Merged revisions 213093 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213093 |
	  tilghman | 2009-08-19 15:29:41 -0500 (Wed, 19 Aug 2009) | 7 lines
	  If we have realtime caching enabled, 'sip reload' must purge
	  users/peers, even if the config files haven't changed. (closes
	  issue #12869) Reported by: bcnit Patches:
	  20090819__issue12869__2.diff.txt uploaded by tilghman (license
	  14) Tested by: lasko ........

2009-08-19 15:35 +0000 [r213047]  Russell Bryant <russell@digium.com>

	* /, main/features.c: Merged revisions 213046 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r213046 |
	  russell | 2009-08-19 10:32:18 -0500 (Wed, 19 Aug 2009) | 4 lines
	  Don't blow up on a NULL cdr. Reported in #asterisk-dev. ........

2009-08-18 20:34 +0000 [r212931-212944]  Kevin P. Fleming <kpfleming@digium.com>

	* /: Merged revisions 212939 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r212939 |
	  kpfleming | 2009-08-18 15:33:34 -0500 (Tue, 18 Aug 2009) | 1 line
	  Remove some accidentally-committed properties. ........

	* sounds/Makefile, doc/tex/asterisk.tex, CREDITS, /,
	  UPGRADE-1.4.txt, sounds/sounds.xml, build_tools/prep_tarball:
	  Merged revisions 212922 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r212922 |
	  kpfleming | 2009-08-18 15:29:37 -0500 (Tue, 18 Aug 2009) | 6
	  lines Convert this branch to Opsound music-on-hold. For more
	  details:
	  http://blogs.digium.com/2009/08/18/asterisk-music-on-hold-changes/
	  ........

2009-08-18 19:28 +0000 [r212866]  Tilghman Lesher <tlesher@digium.com>

	* /, configs/extconfig.conf.sample: Merged revisions 212857 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r212857 | tilghman | 2009-08-18 14:25:09 -0500 (Tue, 18
	  Aug 2009) | 4 lines Make the default extconfig.conf match entries
	  with the sample res_mysql.conf. This eliminates a future source
	  of possible confusion with the configuration of 1.6.1 and higher.
	  ........

2009-08-18 16:56 +0000 [r212769]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.c, /: Merged revisions 212758 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r212758 | rmudgett | 2009-08-18 11:29:47 -0500
	  (Tue, 18 Aug 2009) | 9 lines Merged revisions 212727 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r212727 | rmudgett | 2009-08-18 11:00:56 -0500 (Tue, 18
	  Aug 2009) | 1 line Removed some deadwood and added some doxygen
	  comments. ........ ................

2009-08-18 16:41 +0000 [r212767]  Sean Bright <sean@malleable.com>

	* main/manager.c, /: Merged revisions 212764 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r212764 | seanbright | 2009-08-18 12:38:36 -0400 (Tue, 18 Aug
	  2009) | 18 lines Merged revisions 212763 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r212763 | seanbright | 2009-08-18 12:36:00 -0400 (Tue, 18 Aug
	  2009) | 11 lines Delay the creation of temporary files until we
	  have a valid manager command to handle. Without this patch,
	  asterisk creates a temporary file before determining if the
	  specified command is valid. If invalid, we weren't properly
	  cleaning up the file. (closes issue #15730) Reported by: zmehmood
	  Patches: M15730.diff uploaded by junky (license 177) Tested by:
	  zmehmood ........ ................

2009-08-17 20:01 +0000 [r212631]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 212627 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r212627 | tilghman | 2009-08-17 14:57:42 -0500 (Mon, 17 Aug 2009)
	  | 4 lines Check the return value of opendir(3), or we may crash.
	  (closes issue #15720) Reported by: tobias_e ........

2009-08-17 18:56 +0000 [r212580-212584]  Sean Bright <sean@malleable.com>

	* /, channels/chan_agent.c: Merged revisions 212581 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r212581 | seanbright | 2009-08-17 14:50:24 -0400 (Mon, 17 Aug
	  2009) | 5 lines Correct spelling of AGENTACCEPTDTMF in
	  chan_agent. (closes issue #15668) Reported by: davidw ........

	* main/logger.c: Merged revisions 212574 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r212574 |
	  seanbright | 2009-08-17 14:18:16 -0400 (Mon, 17 Aug 2009) | 8
	  lines Correct the return value check for ast_safe_system. The
	  logic here was reversed as ast_safe_system returns -1 on error
	  and not on success. Fix suggested by reporter. (closes issue
	  #15667) Reported by: loic ........

2009-08-17 16:52 +0000 [r212509]  Jeff Peeler <jpeeler@digium.com>

	* channels/misdn_config.c, /: Merged revisions 212506 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r212506 | jpeeler | 2009-08-17 11:50:45 -0500
	  (Mon, 17 Aug 2009) | 19 lines Merged revisions 212498 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r212498 | jpeeler | 2009-08-17 11:34:56 -0500 (Mon, 17 Aug 2009)
	  | 12 lines Fix segfault when reloading chan_misdn. If more ports
	  were specified than configured in misdn.conf a reload would crash
	  asterisk. The problem was the unconfigured port was using data
	  from the previously configured port. When the data for an
	  unconfigured port was freed a crash would result from the double
	  free. (closes issue #12113) Reported by: agupta Patches:
	  bug12113.patch uploaded by jpeeler (license 325) ........
	  ................

2009-08-17 15:51 +0000 [r212434]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 212431 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r212431 | rmudgett | 2009-08-17 10:42:51 -0500
	  (Mon, 17 Aug 2009) | 16 lines Merged revisions 212430 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 Fix
	  uninitialized variable causing random MWI indications. (closes
	  issue #15727) Reported by: doda Patches: dahdi_changes.patch
	  uploaded by doda (license 853) ........ r212430 | rmudgett |
	  2009-08-17 10:36:28 -0500 (Mon, 17 Aug 2009) | 1 line Fix
	  uninitialized variable. ........ ................

2009-08-14 17:37 +0000 [r212250]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_curl.c, /: Merged revisions 212249 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r212249 |
	  tilghman | 2009-08-14 12:36:40 -0500 (Fri, 14 Aug 2009) | 2 lines
	  Add SSL_VERIFYPEER, as requested on the -users list ........

2009-08-13 15:47 +0000 [r212116]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c: Merged revisions 212113 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r212113 |
	  kpfleming | 2009-08-13 10:46:25 -0500 (Thu, 13 Aug 2009) | 3
	  lines Ensure that T38FaxVersion is put into outgoing SDP in the
	  proper case. ........

2009-08-13 13:56 +0000 [r212070]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 212067 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r212067 |
	  file | 2009-08-13 10:51:04 -0300 (Thu, 13 Aug 2009) | 2 lines
	  Check an actual populated variable when seeing if we need to do
	  video or not. ........

2009-08-13 11:47 +0000 [r212030]  Gavin Henry <ghenry@suretecsystems.com>

	* contrib/scripts/asterisk.ldap-schema,
	  contrib/scripts/asterisk.ldif, /: Merged revisions 212027 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r212027 | ghenry | 2009-08-13 12:37:12 +0100 (Thu, 13
	  Aug 2009) | 6 lines Fixed typo (closes issue #15710) Reported by:
	  suretec ........

2009-08-12 23:16 +0000 [r211951-211959]  Matthew Nicholson <mnicholson@digium.com>

	* apps/app_queue.c, /: Merged revisions 211957 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r211957 | mnicholson | 2009-08-12 18:14:36 -0500 (Wed, 12 Aug
	  2009) | 17 lines Merged revisions 211953 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r211953 | mnicholson | 2009-08-12 18:04:02 -0500 (Wed, 12 Aug
	  2009) | 10 lines This patch adds additional checking when
	  generating queue log TRANSFER events. The additional checks
	  prevent generation of false TRANSFER events in certain
	  situations. (closes issue #14536) Reported by: aragon Patches:
	  queue-log-xfer-fix1.diff uploaded by mnicholson (license 96)
	  Tested by: aragon, mnicholson ........ ................

	* /, channels/chan_sip.c: Merged revisions 211876 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r211876 |
	  mnicholson | 2009-08-12 14:53:14 -0500 (Wed, 12 Aug 2009) | 11
	  lines Make asterisk handle 423 Interval Too Short messages
	  better. This change uses separate values for the acceptable
	  minimum expiry provided by the 423 error and the expiry value
	  stored in the configuration file. Previously, the value pulled
	  from the configuration file would be overwritten. (closes issue
	  #14366) Reported by: Nick_Lewis Patches: sip-expiry-fix1.diff
	  uploaded by mnicholson (license 96) chan_sip.c-reqexpiry.patch
	  uploaded by Nick (license 657) Tested by: mnicholson ........

2009-08-12 16:21 +0000 [r211785]  Gavin Henry <ghenry@suretecsystems.com>

	* res/res_config_ldap.c, contrib/scripts/asterisk.ldap-schema,
	  contrib/scripts/asterisk.ldif, /: Merged revisions 211767 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r211767 | ghenry | 2009-08-12 17:00:46 +0100 (Wed, 12
	  Aug 2009) | 33 lines Added three new attributes and applied a
	  patch to res_config_ldap.c attributetype (
	  AstAccountSubscribeContext NAME 'AstAccountSubscribeContext' DESC
	  'Asterisk subscribe context' EQUALITY caseIgnoreMatch SUBSTR
	  caseIgnoreSubstringsMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.15)
	  attributetype ( AstAccountIpAddr NAME 'AstAccountIpAddr' DESC
	  'Asterisk aaccount IP address' EQUALITY caseIgnoreMatch SUBSTR
	  caseIgnoreSubstringsMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.15)
	  attributetype ( AstAccountUserAgent NAME 'AstAccountUserAgent'
	  DESC 'Asterisk account user context' EQUALITY caseIgnoreMatch
	  SUBSTR caseIgnoreSubstringsMatch SYNTAX
	  1.3.6.1.4.1.1466.115.121.1.15) and patch
	  fix_empty_attributes_1.6.1.4_v2.patch (closes issue #13725)
	  Reported by: macogeek Patches:
	  fix_empty_attributes_1.6.1.4_v2.patch uploaded by xvisor (license
	  863) Tested by: suretec ........

2009-08-10 19:51 +0000 [r211580-211585]  Tilghman Lesher <tlesher@digium.com>

	* doc/CODING-GUIDELINES, /: Merged revisions 211584 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r211584 | tilghman | 2009-08-10 14:49:41 -0500
	  (Mon, 10 Aug 2009) | 9 lines Merged revisions 211583 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r211583 | tilghman | 2009-08-10 14:48:48 -0500 (Mon, 10
	  Aug 2009) | 1 line Conversion specifiers, not format specifiers
	  ........ ................

	* apps/app_queue.c, apps/app_talkdetect.c, agi/eagi-sphinx-test.c,
	  res/res_config_curl.c, channels/chan_usbradio.c,
	  channels/chan_misdn.c, res/snmp/agent.c, apps/app_sms.c,
	  apps/app_verbose.c, apps/app_stack.c, apps/app_mixmonitor.c,
	  main/asterisk.c, main/dsp.c, main/timing.c,
	  doc/CODING-GUIDELINES, funcs/func_speex.c, main/frame.c,
	  utils/muted.c, apps/app_meetme.c, apps/app_alarmreceiver.c,
	  cdr/cdr_pgsql.c, res/res_musiconhold.c, channels/chan_iax2.c,
	  apps/app_followme.c, main/enum.c, main/indications.c,
	  res/res_config_sqlite.c, channels/misdn_config.c, utils/frame.c,
	  main/cli.c, pbx/pbx_loopback.c, channels/chan_phone.c,
	  funcs/func_enum.c, res/res_smdi.c, channels/chan_skinny.c,
	  funcs/func_odbc.c, apps/app_minivm.c, res/res_agi.c,
	  res/res_config_ldap.c, apps/app_adsiprog.c,
	  funcs/func_dialplan.c, main/pbx.c, main/dnsmgr.c,
	  funcs/func_sprintf.c, funcs/func_timeout.c, channels/chan_sip.c,
	  apps/app_privacy.c, res/res_limit.c, apps/app_waitforsilence.c,
	  codecs/codec_speex.c, agi/eagi-test.c, apps/app_morsecode.c,
	  funcs/func_cut.c, channels/chan_oss.c, main/netsock.c,
	  apps/app_waitforring.c, funcs/func_channel.c, apps/app_macro.c,
	  pbx/pbx_dundi.c, utils/extconf.c, pbx/pbx_config.c,
	  apps/app_chanspy.c, res/res_odbc.c, apps/app_voicemail.c,
	  apps/app_dahdibarge.c, funcs/func_rand.c, apps/app_readfile.c, /,
	  apps/app_record.c, main/utils.c, cdr/cdr_adaptive_odbc.c,
	  res/res_http_post.c, main/config.c, res/ael/pval.c, main/cdr.c,
	  main/channel.c, channels/chan_dahdi.c, pbx/pbx_spool.c,
	  main/manager.c, apps/app_setcallerid.c, apps/app_osplookup.c,
	  main/features.c, main/http.c, channels/xpmr/xpmr.c,
	  apps/app_rpt.c, channels/chan_mgcp.c, res/res_config_pgsql.c,
	  channels/chan_agent.c, funcs/func_math.c, apps/app_waituntil.c,
	  apps/app_disa.c, main/acl.c, apps/app_originate.c,
	  channels/iax2-provision.c: AST-2009-005

2009-08-10 14:15 +0000 [r211350]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 211347 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r211347 |
	  file | 2009-08-10 11:07:44 -0300 (Mon, 10 Aug 2009) | 5 lines Fix
	  retrieval of the port used for the video stream when adding SDP
	  to a SIP message. (closes issue #15121) Reported by: jsmith
	  ........

2009-08-09 15:43 +0000 [r211235-211278]  Tilghman Lesher <tlesher@digium.com>

	* /, main/astfd.c: Merged revisions 211275 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r211275 | tilghman | 2009-08-09 10:42:02 -0500 (Sun, 09 Aug 2009)
	  | 9 lines Merged revisions 211274 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r211274 | tilghman | 2009-08-09 10:41:01 -0500 (Sun, 09 Aug 2009)
	  | 2 lines Small oops. Clear the flags which have been checked.
	  ........ ................

	* apps/app_stack.c, /: Merged revisions 211232 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r211232 |
	  tilghman | 2009-08-09 02:11:22 -0500 (Sun, 09 Aug 2009) | 4 lines
	  Check for NULL frame, before dereferencing pointer. (closes issue
	  #15617) Reported by: rain ........

2009-08-07 20:18 +0000 [r211122]  Russell Bryant <russell@digium.com>

	* apps/app_chanspy.c, /: Merged revisions 211113 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r211113 | russell | 2009-08-07 15:12:21 -0500 (Fri, 07 Aug 2009)
	  | 11 lines Recorded merge of revisions 211112 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r211112 | russell | 2009-08-07 15:11:31 -0500 (Fri, 07 Aug 2009)
	  | 4 lines Resolve a deadlock involving app_chanspy and
	  masquerades. (ABE-1936) ........ ................

2009-08-07 18:20 +0000 [r211051]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_queue.c, /: Merged revisions 211040 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r211040 | tilghman | 2009-08-07 13:17:41 -0500 (Fri, 07 Aug 2009)
	  | 21 lines Merged revisions 211038 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r211038 | tilghman | 2009-08-07 13:16:28 -0500 (Fri, 07 Aug 2009)
	  | 14 lines QUEUE_MEMBER_LIST _really_ wants the interface name,
	  not the membername. This is a partial revert of revision 82590,
	  which was an attempted cleanup, but in reality, it broke
	  QUEUE_MEMBER_LIST, which has always been intended as a method by
	  which component interfaces could be queried from the queue.
	  Membername isn't useful here, because that field cannot be used
	  to obtain further information about the member. See the
	  documentation on QUEUE_MEMBER_LIST, RemoveQueueMember,
	  QUEUE_MEMBER_PENALTY, and the various AMI commands which take a
	  member argument for further justification. (closes issue #15664)
	  Reported by: rain Patches: app_queue-queue_member_list.diff
	  uploaded by rain (license 327) ........ ................

2009-08-07 13:10 +0000 [r210995]  Kevin P. Fleming <kpfleming@digium.com>

	* main/udptl.c, /: Merged revisions 210992 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r210992 |
	  kpfleming | 2009-08-07 08:08:00 -0500 (Fri, 07 Aug 2009) | 13
	  lines Workaround broken T.38 endpoints that offer tiny
	  MaxDatagram sizes. Some T.38 endpoints treat T38FaxMaxDatagram as
	  the maximum IFP size that should be sent to them, rather than the
	  maximum packet payload size. If such an endpoint also requests
	  UDPRedundancy as the error correction mode, we'll end up
	  calculating a tiny maximum IFP size, so small as to be unusable.
	  This patch sets a lower bound on what we'll consider the remote's
	  maximum IFP size to be, assuming that endpoints that do this
	  really can accept larger packets than they've offered to accept.
	  (closes issue #15649) Reported by: dazza76 ........

2009-08-06 21:47 +0000 [r210911-210917]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /: Merged revisions 210914 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r210914 | tilghman | 2009-08-06 16:46:01 -0500 (Thu, 06 Aug 2009)
	  | 14 lines Merged revisions 210913 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r210913 | tilghman | 2009-08-06 16:45:01 -0500 (Thu, 06 Aug 2009)
	  | 7 lines Because channel information can be accessed outside of
	  the channel thread, we must lock the channel prior to modifying
	  it. (closes issue #15397) Reported by: caspy Patches:
	  20090714__issue15397.diff.txt uploaded by tilghman (license 14)
	  Tested by: caspy ........ ................

	* apps/app_stack.c, include/asterisk/app.h, /, main/app.c: Merged
	  revisions 210908 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r210908 |
	  tilghman | 2009-08-06 16:29:26 -0500 (Thu, 06 Aug 2009) | 9 lines
	  Allow Gosub to recognize quote delimiters without consuming them.
	  (closes issue #15557) Reported by: rain Patches:
	  20090723__issue15557.diff.txt uploaded by tilghman (license 14)
	  Tested by: rain Review: https://reviewboard.asterisk.org/r/316/
	  ........

2009-08-06 17:49 +0000 [r210820]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 210817 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r210817 |
	  file | 2009-08-06 14:47:04 -0300 (Thu, 06 Aug 2009) | 11 lines
	  Accept additional T.38 reinvites after an initial one has been
	  handled. Discussion of this subject has yielded that it is not
	  actually acceptable to change T.38 parameters after the initial
	  reinvite but declining is harsh and can cause the fax to fail
	  when it may be possible to allow it to continue. This patch
	  changes things so that additional T.38 reinvites are accepted but
	  parameter changes ignored. This gives the fax a fighting chance.
	  (closes issue #15610) Reported by: huangtx2009 ........

2009-08-05 20:43 +0000 [r210686]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 210640 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r210640 | rmudgett | 2009-08-05 14:40:03 -0500
	  (Wed, 05 Aug 2009) | 21 lines Merged revisions 210575 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r210575 | rmudgett | 2009-08-05 14:18:56 -0500 (Wed, 05 Aug 2009)
	  | 14 lines Dialplan starts execution before the channel setup is
	  complete. * Issue 15655: For the case where dialing is complete
	  for an incoming call, dahdi_new() was asked to start the PBX and
	  then the code set more channel variables. If the dialplan hungup
	  before these channel variables got set, asterisk would likely
	  crash. * Fixed potential for overlap incoming call to erroneously
	  set channel variables as global dialplan variables if the
	  ast_channel structure failed to get allocated. * Added missing
	  set of CALLINGSUBADDR in the dialing is complete case. (closes
	  issue #15655) Reported by: alecdavis ........ ................

2009-08-05 18:56 +0000 [r210565-210566]  Leif Madsen <lmadsen@digium.com>

	* /: Merged revisions 210564 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r210564 | lmadsen | 2009-08-05 13:49:58 -0500 (Wed, 05 Aug 2009)
	  | 19 lines Merged revisions 210563 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r210563 | lmadsen | 2009-08-05 13:46:21 -0500 (Wed, 05 Aug 2009)
	  | 11 lines Update imapstorage.txt documentation. Updated the
	  imapstorage.txt documentation to reflect that issues with
	  c-client versions older than 2007 seem to cause crashing issues
	  that are not seen with more recent versions. Documentation has
	  been updated to reflect this. (closes issue #14496) Reported by:
	  vbcrlfuser Patches: __20090727-imap-documentation-patch.txt
	  uploaded by lmadsen (license 10) Tested by: lmadsen, mmichelson,
	  dbrooks ........ ................

	* doc/tex/imapstorage.tex: Merged revisions 210564 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r210564 | lmadsen | 2009-08-05 13:49:58 -0500
	  (Wed, 05 Aug 2009) | 19 lines Merged revisions 210563 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r210563 | lmadsen | 2009-08-05 13:46:21 -0500 (Wed, 05 Aug 2009)
	  | 11 lines Update imapstorage.txt documentation. Updated the
	  imapstorage.txt documentation to reflect that issues with
	  c-client versions older than 2007 seem to cause crashing issues
	  that are not seen with more recent versions. Documentation has
	  been updated to reflect this. (closes issue #14496) Reported by:
	  vbcrlfuser Patches: __20090727-imap-documentation-patch.txt
	  uploaded by lmadsen (license 10) Tested by: lmadsen, mmichelson,
	  dbrooks ........ ................

2009-08-04 14:55 +0000 [r210191-210241]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, /: Merged revisions 210238 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r210238 | kpfleming | 2009-08-04 09:53:00 -0500 (Tue, 04 Aug
	  2009) | 16 lines Merged revisions 210237 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r210237 | kpfleming | 2009-08-04 09:51:39 -0500 (Tue, 04 Aug
	  2009) | 10 lines Eliminate spurious compiler warnings from system
	  headers on *BSD platforms. Ensure that system headers located in
	  /usr/local/include are actually treated as system headers by the
	  compiler, and not as local headers which are subject to warnings
	  from the -Wundef compiler option and others. (closes issue
	  #15606) Reported by: mvanbaak ........ ................

	* configs/sip.conf.sample, configs/skinny.conf.sample, main/rtp.c,
	  channels/chan_mgcp.c, doc/chan_sip-perf-testing.txt,
	  contrib/scripts/realtime_pgsql.sql, /, channels/chan_sip.c,
	  channels/chan_skinny.c, configs/mgcp.conf.sample,
	  doc/res_config_sqlite.txt, doc/tex/phoneprov.tex, UPGRADE.txt,
	  configs/res_ldap.conf.sample: Merged revisions 210190 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r210190 | kpfleming | 2009-08-03 15:48:48 -0500 (Mon, 03
	  Aug 2009) | 11 lines Rename 'canreinvite' option to
	  'directmedia', with backwards compatibility. It is clear from
	  multiple mailing list, forum, wiki and other sorts of posts that
	  users don't really understand the effects that the 'canreinvite'
	  config option actually has, and that in some cases they think
	  that setting it to 'no' will actually cause various other
	  features (T.38, MOH, etc.) to not work properly, when in fact
	  this is not the case. This patch changes the proper name of the
	  option to what it should have been from the beginning
	  ('directmedia'), but preserves backwards compatibility for
	  existing configurations. ........

2009-08-01 11:33 +0000 [r209837-209906]  Russell Bryant <russell@digium.com>

	* main/db1-ast/mpool/mpool.c, /: Merged revisions 209887 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r209887 | russell | 2009-08-01 06:29:25 -0500
	  (Sat, 01 Aug 2009) | 12 lines Merged revisions 209879 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r209879 | russell | 2009-08-01 06:27:25 -0500 (Sat, 01 Aug 2009)
	  | 5 lines Resolve a valgrind warning about a read from
	  uninitialized memory. (issue #15396) Reported by: aragon ........
	  ................

	* apps/app_milliwatt.c, /: Merged revisions 209839 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r209839 | russell | 2009-08-01 06:02:07 -0500
	  (Sat, 01 Aug 2009) | 20 lines Merged revisions 209838 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r209838 | russell | 2009-08-01 05:59:05 -0500 (Sat, 01 Aug 2009)
	  | 13 lines Modify how Playtones() is used in Milliwatt() to
	  resolve gain issue. When Milliwatt() was changed internally to
	  use Playtones() so that the proper tone was used, it introduced a
	  drop in gain in the output signal. So, use the playtones API
	  directly and specify a volume argument such that the output
	  matches the gain of the original Milliwatt() code. (closes issue
	  #15386) Reported by: rue_mohr Patches: issue_15386.rev2.diff
	  uploaded by russell (license 2) Tested by: rue_mohr ........
	  ................

	* /, main/event.c: Merged revisions 209835 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209835 |
	  russell | 2009-08-01 05:43:40 -0500 (Sat, 01 Aug 2009) | 6 lines
	  Fix ast_event_queue_and_cache() to actually do the cache() part.
	  (closes issue #15624) Reported by: ffossard Tested by: russell
	  ........

2009-08-01 01:34 +0000 [r209816]  Kevin P. Fleming <kpfleming@digium.com>

	* pbx/pbx_config.c, channels/misdn/isdn_lib.c, utils/frame.c,
	  main/pbx.c, /, main/Makefile, channels/misdn/ie.c: Merged
	  revisions 209760-209761 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r209760 | kpfleming | 2009-07-31 20:03:07 -0500 (Fri, 31 Jul
	  2009) | 13 lines Merged revisions 209759 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r209759 | kpfleming | 2009-07-31 19:52:00 -0500 (Fri, 31 Jul
	  2009) | 7 lines Minor changes inspired by testing with latest
	  GCC. The latest GCC (what will become 4.5.x) has a few new
	  warnings, that in these cases found some either downright buggy
	  code, or at least seriously poorly designed code that could be
	  improved. ........ ................ r209761 | kpfleming |
	  2009-07-31 20:04:06 -0500 (Fri, 31 Jul 2009) | 1 line Revert
	  accidental Makefile change. ................

2009-07-31 22:01 +0000 [r209715]  Russell Bryant <russell@digium.com>

	* /, main/event.c: Merged revisions 209711 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209711 |
	  russell | 2009-07-31 16:53:31 -0500 (Fri, 31 Jul 2009) | 2 lines
	  Fix some places where ast_event_type was used instead of
	  ast_event_ie_type. ........

2009-07-30 18:51 +0000 [r209594]  David Brooks <dbrooks@digium.com>

	* channels/chan_console.c, include/asterisk/abstract_jb.h,
	  apps/app_forkcdr.c, channels/chan_dahdi.c,
	  contrib/init.d/rc.debian.asterisk, /, apps/app_sms.c,
	  codecs/lpc10/pitsyn.c: Merged revisions 209554 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209554 |
	  dbrooks | 2009-07-30 11:07:05 -0500 (Thu, 30 Jul 2009) | 6 lines
	  Fixes numerous spelling errors. Patch submitted by alecdavis.
	  (closes issue #15595) Reported by: alecdavis ........

2009-07-30 14:40 +0000 [r209518]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 209516 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209516 |
	  mmichelson | 2009-07-30 09:38:21 -0500 (Thu, 30 Jul 2009) | 8
	  lines Fix a crash that can result if text codecs are allowed but
	  textsupport is disabled. (closes issue #15596) Reported by:
	  fabled Patches: sip-red.patch uploaded by fabled (license 448)
	  ........

2009-07-28  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-beta4

2009-07-28 00:19 +0000 [r209328]  Tilghman Lesher <tlesher@digium.com>

	* /, sounds/sounds.xml: Merged revisions 209317 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r209317 | tilghman | 2009-07-27 19:14:12 -0500 (Mon, 27 Jul 2009)
	  | 9 lines Merged revisions 209315 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r209315 | tilghman | 2009-07-27 19:12:03 -0500 (Mon, 27 Jul 2009)
	  | 2 lines Publish French extra sounds ........ ................

2009-07-27 21:44 +0000 [r209265-209282]  Kevin P. Fleming <kpfleming@digium.com>

	* /, apps/app_fax.c: Merged revisions 209279 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209279 |
	  kpfleming | 2009-07-27 16:43:36 -0500 (Mon, 27 Jul 2009) | 7
	  lines Cleanup T.38 negotiation changes. Convert LOG_NOTICE
	  messages about T.38 negotiation in debug level 1 messages, clean
	  up some looping logic, and correct an improper use of ast_free()
	  for freeing an ast_frame. ........

	* /, apps/app_fax.c: Merged revisions 209256 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209256 |
	  kpfleming | 2009-07-27 16:21:43 -0500 (Mon, 27 Jul 2009) | 10
	  lines Make T.38 switchover in ReceiveFAX synchronous. In receive
	  mode, if the channel that ReceiveFAX is running on supports T.38,
	  we should *always* attempt to switch T.38, rather than listening
	  for an incoming CNG tone and only triggering on that. The channel
	  may be using a low-bitrate codec that distorts the CNG tone, the
	  sending FAX endpoint may not send CNG at all, or there could be a
	  variety of other reasons that we don't detect it, but in all
	  those cases if T.38 is available we certainly want to use it.
	  ........

2009-07-27 20:58 +0000 [r209238]  Mark Michelson <mmichelson@digium.com>

	* main/rtp.c, /: Merged revisions 209235 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209235 |
	  mmichelson | 2009-07-27 15:54:54 -0500 (Mon, 27 Jul 2009) | 5
	  lines Gracefully handle malformed RTP text packets. AST-2009-004
	  ........

2009-07-27 20:33 +0000 [r209234]  David Brooks <dbrooks@digium.com>

	* res/res_jabber.c, main/loader.c, channels/chan_dahdi.c,
	  channels/chan_vpb.cc, res/res_smdi.c, /,
	  include/asterisk/module.h, main/features.c, res/res_agi.c: Merged
	  revisions 209098 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209098 |
	  dbrooks | 2009-07-27 11:33:50 -0500 (Mon, 27 Jul 2009) | 6 lines
	  Fixing typos. Replaces "recieved" with "received" and "initilize"
	  with "initialize" (closes issue #15571) Reported by: alecdavis
	  ........

2009-07-27 20:23 +0000 [r209135-209222]  Mark Michelson <mmichelson@digium.com>

	* res/res_musiconhold.c, /: Merged revisions 209197 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r209197 | mmichelson | 2009-07-27 15:11:42 -0500 (Mon, 27 Jul
	  2009) | 9 lines Honor channel's music class when using realtime
	  music on hold. (closes issue #15051) Reported by: alexh Patches:
	  15051.patch uploaded by mmichelson (license 60) Tested by: alexh
	  ........

	* main/udptl.c, /, configs/udptl.conf.sample: Merged revisions
	  209132 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r209132 | mmichelson | 2009-07-27 12:50:04 -0500 (Mon, 27 Jul
	  2009) | 24 lines Merged revisions 209131 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r209131 | mmichelson | 2009-07-27 12:44:06 -0500 (Mon, 27 Jul
	  2009) | 18 lines Allow for UDPTL to use only even-numbered ports
	  if desired. There are some VoIP providers out there that will not
	  accept SDP offers with odd numbered UDPTL ports. While it is my
	  personal opinion that these VoIP providers are misinterpreting
	  RFC 2327, it really is not a big deal to play along with their
	  silly little games. Of course, since restricting UDPTL ports to
	  only even numbers reduces the range of available ports by half,
	  so the option to use only even port numbers is off by default. A
	  user can enable the behavior by setting use_even_ports=yes in
	  udptl.conf. (closes issue #15182) Reported by: CGMChris Patches:
	  15182.patch uploaded by mmichelson (license 60) Tested by:
	  CGMChris ........ ................

2009-07-27 16:07 +0000 [r209063]  David Brooks <dbrooks@digium.com>

	* apps/app_rpt.c, res/res_smdi.c, pbx/pbx_dundi.c: Just replacing
	  typos "recieved" with "received". From issue #15360, forgot to
	  apply to trunk and other branches.

2009-07-27 15:40 +0000 [r209059]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, /: Merged revisions 209056 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r209056 |
	  kpfleming | 2009-07-27 10:38:59 -0500 (Mon, 27 Jul 2009) | 10
	  lines Restore explicit export of ASTCFLAGS/ASTLDFLAGS and
	  underscore-variants to sub-makes. During the recent Makefile
	  improvements I made, it seemed the 'make' was automatically
	  carrying down the ASTCFLAGS/ASTLDFLAGS settings to sub-makes, so
	  I removed the explict export of them. However, there are some
	  circumstances where make does this, and some where it does not,
	  so I've brought them back to ensure they are always exported. I
	  also removed an extraneous double setting of _ASTLDFLAGS on *BSD
	  platforms. ........

2009-07-27 01:23 +0000 [r208927]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_iax2.c, /, main/translate.c: Merged revisions
	  208924 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r208924 | jpeeler | 2009-07-26 20:20:37 -0500 (Sun, 26 Jul 2009)
	  | 9 lines Merged revisions 208923 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208923 | jpeeler | 2009-07-26 20:18:31 -0500 (Sun, 26 Jul 2009)
	  | 2 lines Fix logic errors from 208746 ........ ................

2009-07-26 14:07 +0000 [r208889]  Michiel van Baak <michiel@vanbaak.info>

	* contrib/scripts/install_prereq, /: Merged revisions 208886 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r208886 | mvanbaak | 2009-07-26 16:00:52 +0200 (Sun, 26
	  Jul 2009) | 2 lines add OpenBSD to the install_prereq script
	  ........

2009-07-25 12:31 +0000 [r208816-208853]  Michiel van Baak <michiel@vanbaak.info>

	* contrib/scripts/install_prereq, /: Merged revisions 208848 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r208848 | mvanbaak | 2009-07-25 14:28:38 +0200 (Sat, 25
	  Jul 2009) | 2 lines libxml2-dev is needed as well by default.
	  ........

	* main/cli.c, /, configs/cli_aliases.conf.sample: Merged revisions
	  208813 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208813 |
	  mvanbaak | 2009-07-25 14:03:25 +0200 (Sat, 25 Jul 2009) | 10
	  lines add default alias reload to run module reload. Requiring
	  'module reload' to reload everything, including core etc makes
	  russell very unhappy. The default configuration already loads the
	  'friendly' aliases template. Added 'reload=module reload' to that
	  template. Also removed the comment in main/cli.c that reload
	  should come back. ........

2009-07-25 06:26 +0000 [r208755]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_iax2.c, /, channels/chan_skinny.c,
	  main/translate.c: Merged revisions 208749 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r208749 | jpeeler | 2009-07-25 01:23:18 -0500 (Sat, 25 Jul 2009)
	  | 13 lines Merged revisions 208746 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208746 | jpeeler | 2009-07-25 01:19:50 -0500 (Sat, 25 Jul 2009)
	  | 7 lines Fix compiling under dev-mode with gcc 4.4.0. Mostly
	  trivial changes, but I did not know of any other way to fix the
	  "dereferencing type-punned pointer will break strict-aliasing
	  rules" error without creating a tmp variable in chan_skinny.
	  ........ ................

2009-07-24 21:13 +0000 [r208695-208710]  Russell Bryant <russell@digium.com>

	* /, pbx/pbx_dundi.c: Merged revisions 208709 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208709 |
	  russell | 2009-07-24 16:12:43 -0500 (Fri, 24 Jul 2009) | 2 lines
	  Remove trailing whitespace. ........

	* main/cli.c, /: Merged revisions 208706 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208706 |
	  russell | 2009-07-24 15:54:37 -0500 (Fri, 24 Jul 2009) | 6 lines
	  Note that "reload" needs to be added back. I keep getting annoyed
	  at having to type "module reload" to reload everything, so I'm
	  adding a note that we need to add "reload" back. "module reload"
	  doesn't really make sense as the command to reload everything,
	  including the core. ........

	* main/cli.c, /: Merged revisions 208693 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208693 |
	  russell | 2009-07-24 15:25:23 -0500 (Fri, 24 Jul 2009) | 2 lines
	  Don't log a warning for something that does not affect operation.
	  ........

2009-07-24 19:42 +0000 [r208664]  Mark Michelson <mmichelson@digium.com>

	* /: Fixing trunk-blocked property.

2009-07-24 18:56 +0000 [r208596]  Russell Bryant <russell@digium.com>

	* apps/app_dial.c, /: Merged revisions 208593 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r208593 | russell | 2009-07-24 13:42:32 -0500 (Fri, 24 Jul 2009)
	  | 14 lines Merged revisions 208592 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208592 | russell | 2009-07-24 13:38:24 -0500 (Fri, 24 Jul 2009)
	  | 7 lines Do not log an ERROR if autoservice_stop() returns -1.
	  This does not indicate an error. A return of -1 just means that
	  the channel has been hung up. (reported in #asterisk-dev)
	  ........ ................

2009-07-24 18:32 +0000 [r208591]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 208588 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r208588 | mmichelson | 2009-07-24 13:31:04 -0500 (Fri, 24 Jul
	  2009) | 16 lines Merged revisions 208587 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208587 | mmichelson | 2009-07-24 13:26:50 -0500 (Fri, 24 Jul
	  2009) | 10 lines Only send a BYE when hanging up a channel that
	  is up. For cases where Asterisk sends an INVITE and receives a
	  non 2XX final response, Asterisk would follow the INVITE
	  transaction by immediately sending a BYE, which was unnecessary.
	  (closes issue #14575) Reported by: chris-mac ........
	  ................

2009-07-24 15:06 +0000 [r208551]  Kevin P. Fleming <kpfleming@digium.com>

	* main/udptl.c, /, channels/chan_sip.c, include/asterisk/udptl.h:
	  Merged revisions 208548 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208548 |
	  kpfleming | 2009-07-24 10:02:53 -0500 (Fri, 24 Jul 2009) | 8
	  lines Resolve a T.38 negotiation issue left over from the
	  udptl-updates merge. The udptl-updates branch that was merged
	  yesterday failed to properly send back T.38 SDP responses with
	  the correct error correction mode, if the incoming SDP from the
	  other end caused us to change error correction modes. This patch
	  corrects that situation. ........

2009-07-24 14:39 +0000 [r208545]  Michiel van Baak <michiel@vanbaak.info>

	* contrib/scripts/install_prereq, /: Merged revisions 208542 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r208542 | mvanbaak | 2009-07-24 16:35:49 +0200 (Fri, 24
	  Jul 2009) | 13 lines use aptitude for debian based systems The
	  function to check wether we need to install packages was using
	  dpkg-query which was gives wrong output on Debian 5 Also, the
	  apt-get has been replaced with aptitude because aptitude is now
	  the preferred way to handle packages on Debian (closes issue
	  #15570) Reported by: mvanbaak Patches:
	  2009072400_installprereq-aptitude.diff uploaded by mvanbaak
	  (license 7) ........

2009-07-23 22:31 +0000 [r208501]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/frame.h, main/rtp.c, main/channel.c,
	  main/udptl.c, main/frame.c, /, channels/chan_sip.c,
	  apps/app_fax.c, UPGRADE.txt, include/asterisk/udptl.h: Merged
	  revisions 208464 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208464 |
	  kpfleming | 2009-07-23 16:57:24 -0500 (Thu, 23 Jul 2009) | 46
	  lines Rework of T.38 negotiation and UDPTL API to address
	  interoperability problems Over the past couple of months, a
	  number of issues with Asterisk negotiating (and successfully
	  completing) T.38 sessions with various endpoints have been found.
	  This patch attempts to address many of them, primarily focused
	  around ensuring that the endpoints' MaxDatagram size is honored,
	  and in addition by ensuring that T.38 session parameter
	  negotiation is performed correctly according to the ITU T.38
	  Recommendation. The major changes here are: 1) T.38 applications
	  in Asterisk (app_fax) only generate/receive IFP packets, they do
	  not ever work with UDPTL packets. As a result of this, they
	  cannot be allowed to generate packets that would overflow the
	  other endpoints' MaxDatagram size after the UDPTL stack adds any
	  error correction information. With this patch, the application is
	  told the maximum *IFP* size it can generate, based on a
	  calculation using the far end MaxDatagram size and the active
	  error correction mode on the T.38 session. The same is true for
	  sending *our* MaxDatagram size to the remote endpoint; it is
	  computed from the value that the application says it can accept
	  (for a single IFP packet) combined with the active error
	  correction mode. 2) All treatment of T.38 session parameters as
	  'capabilities' in chan_sip has been removed; these parameters are
	  not at all like audio/video stream capabilities. There are strict
	  rules to follow for computing an answer to a T.38 offer, and
	  chan_sip now follows those rules, using the desired parameters
	  from the application (or channel) that wants to accept the T.38
	  negotiation. 3) chan_sip now stores and forwards
	  ast_control_t38_parameters structures for tracking 'our' and
	  'their' T.38 session parameters; this greatly simplifies
	  negotiation, especially for pass-through calls. 4) Since T.38
	  negotiation without specifying parameters or receiving the final
	  negotiated parameters is not very worthwhile, the AST_CONTROL_T38
	  control frame has been removed. A note has been added to
	  UPGRADE.txt about this removal, since any out-of-tree
	  applications that use it will no longer function properly until
	  they are upgraded to use AST_CONTROL_T38_PARAMETERS. Review:
	  https://reviewboard.asterisk.org/r/310/ ........

2009-07-23 19:36 +0000 [r208391]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 208388 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r208388 | mmichelson | 2009-07-23 14:34:49 -0500 (Thu, 23 Jul
	  2009) | 24 lines Merged revisions 208386 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208386 | mmichelson | 2009-07-23 14:24:21 -0500 (Thu, 23 Jul
	  2009) | 17 lines Fix a problem where a 491 response could be sent
	  out of dialog. This generalizes the fix for issue 13849. The
	  initial fix corrected the problem that Asterisk would reply with
	  a 491 if a reinvite were received from an endpoint and we had not
	  yet received an ACK from that endpoint for the initial INVITE it
	  had sent us. This expansion also allows Asterisk to appropriately
	  handle an INVITE with authorization credentials if Asterisk had
	  not received an ACK from the previous transaction in which
	  Asterisk had responded to an unauthorized INVITE with a 407.
	  (closes issue #14239) Reported by: klaus3000 Patches: 14239.patch
	  uploaded by mmichelson (license 60) Tested by: klaus3000 ........
	  ................

2009-07-23 19:25 +0000 [r208387]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 208383 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r208383 | jpeeler | 2009-07-23 14:21:50 -0500
	  (Thu, 23 Jul 2009) | 12 lines Merged revisions 208380 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208380 | jpeeler | 2009-07-23 14:19:53 -0500 (Thu, 23 Jul 2009)
	  | 6 lines Only set the priindication setting when not performing
	  a reload (closes issue #14696) Reported by: fdecher ........
	  ................

2009-07-23 16:30 +0000 [r208266-208320]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 208314 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r208314 | mmichelson | 2009-07-23 11:29:37 -0500 (Thu, 23 Jul
	  2009) | 9 lines Merged revisions 208312 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208312 | mmichelson | 2009-07-23 11:29:18 -0500 (Thu, 23 Jul
	  2009) | 3 lines Remove inaccurate XXX comment. ........
	  ................

	* /, channels/chan_sip.c: Merged revisions 208263 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r208263 | mmichelson | 2009-07-23 10:46:34 -0500 (Thu, 23 Jul
	  2009) | 15 lines Merged revisions 208262 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r208262 | mmichelson | 2009-07-23 10:43:07 -0500 (Thu, 23 Jul
	  2009) | 8 lines Properly handle 183 responses which do not
	  contain an SDP. (closes issue #15442) Reported by: ffloimair
	  Patches: 15442.patch uploaded by mmichelson (license 60) Tested
	  by: tkarl, ffloimair ........ ................

2009-07-22 21:46 +0000 [r208116]  Jason Parker <jparker@digium.com>

	* /, apps/app_festival.c: Merged revisions 208113 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208113 |
	  qwell | 2009-07-22 16:43:57 -0500 (Wed, 22 Jul 2009) | 9 lines
	  Restore an int declaration on PPC platforms. This x is one crafty
	  little bugger... It was used for 2 different things (one of which
	  was only done on PPC) in 1.4. One of the uses were removed in
	  trunk, and with it went the declaration. (closes issue #14038)
	  Reported by: ffloimair ........

2009-07-22 16:52 +0000 [r207949-208053]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_realtime.c: Merged revisions 208052 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r208052 |
	  tilghman | 2009-07-22 11:49:42 -0500 (Wed, 22 Jul 2009) | 7 lines
	  Clarify documentation on 'realtime update2' to show more than one
	  condition. (closes issue #15357) Reported by: snuffy Patches:
	  bug_fix_doc_update2.diff uploaded by snuffy (license 35)
	  (slightly modified by me) ........

	* /, funcs/func_strings.c: Merged revisions 207946 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r207946 | tilghman | 2009-07-21 17:45:32 -0500
	  (Tue, 21 Jul 2009) | 15 lines Merged revisions 207945 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r207945 | tilghman | 2009-07-21 17:38:54 -0500 (Tue, 21 Jul 2009)
	  | 8 lines Force an error if a blank is passed to QUOTE (because
	  the documentation states the argument is not optional). This
	  change makes URIENCODE and QUOTE behave similarly, since the
	  documentation states that the argument is not optional, for both.
	  (closes issue #15439) Reported by: pkempgen Patches:
	  20090706__issue15439.diff.txt uploaded by tilghman (license 14)
	  ........ ................

2009-07-21 22:23 +0000 [r207930]  Russell Bryant <russell@digium.com>

	* doc/CODING-GUIDELINES, /: Merged revisions 207925 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r207925 | russell | 2009-07-21 17:22:18 -0500 (Tue, 21 Jul 2009)
	  | 4 lines Note that we use tabs instead of spaces for
	  indentation. I'm surprised this was never actually in here...
	  ........

2009-07-21 20:30 +0000 [r207785-207862]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 207854 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r207854 | jpeeler | 2009-07-21 15:26:02 -0500
	  (Tue, 21 Jul 2009) | 16 lines Merged revisions 207827 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r207827 | jpeeler | 2009-07-21 15:16:55 -0500 (Tue, 21 Jul 2009)
	  | 9 lines Wait for wink before dialing when using E&M wink
	  signaling There was already code for other signaling types in
	  dahdi_handle_event to handle dialing if a dial operation dial
	  string was present. Simply add SIG_EMWINK to the list. (closes
	  issue #14434) Reported by: araasch ........ ................

	* channels/chan_dahdi.c: Revert r207638, this approach could
	  potentially block for an unacceptable amount of time.

2009-07-21 14:32 +0000 [r207727]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c, /: Merged revisions 207723 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r207723 | mmichelson | 2009-07-21 09:29:40 -0500 (Tue, 21 Jul
	  2009) | 11 lines Merged revisions 207714 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r207714 | mmichelson | 2009-07-21 09:26:00 -0500 (Tue, 21 Jul
	  2009) | 5 lines Document default timeout for AMI originations.
	  AST-224 ........ ................

2009-07-21 13:56 +0000 [r207685]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/Makefile, doc/video_console.txt, Makefile, agi/Makefile,
	  codecs/Makefile, utils/Makefile, funcs/Makefile,
	  codecs/lpc10/Makefile, main/db1-ast/Makefile, /, main/Makefile,
	  codecs/gsm/Makefile, Makefile.moddir_rules, Makefile.rules,
	  pbx/Makefile, res/Makefile: Merged revisions 207680 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r207680 | kpfleming | 2009-07-21 08:28:04 -0500
	  (Tue, 21 Jul 2009) | 18 lines Merged revisions 207647 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r207647 | kpfleming | 2009-07-21 08:04:44 -0500 (Tue, 21 Jul
	  2009) | 12 lines Ensure that user-provided CFLAGS and LDFLAGS are
	  honored. This commit changes the build system so that
	  user-provided flags (in ASTCFLAGS and ASTLDFLAGS) are supplied to
	  the compiler/linker *after* all flags provided by the build
	  system itself, so that the user can effectively override the
	  build system's flags if desired. In addition, ASTCFLAGS and
	  ASTLDFLAGS can now be provided *either* in the environment before
	  running 'make', or as variable assignments on the 'make' command
	  line. As a result, the use of COPTS and LDOPTS is no longer
	  necessary, so they are no longer documented, but are still
	  supported so as not to break existing build systems that supply
	  them when building Asterisk. ........ ................

2009-07-21 04:51 +0000 [r207638]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: Wait for wink before dialing when using
	  E&M wink signaling This patch adds a new dahdi_wait function to
	  specifically wait for the wink event. If the wink is not
	  eventually received the channel is hung up. (closes issue #14434)
	  Reported by: araasch Patches: emwinkmod uploaded by araasch
	  (license 693)

2009-07-20 22:14 +0000 [r207523]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 207424 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r207424 | mmichelson | 2009-07-20 14:48:12 -0500 (Mon, 20 Jul
	  2009) | 39 lines Merged revisions 207423 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r207423 | mmichelson | 2009-07-20 14:39:59 -0500 (Mon, 20 Jul
	  2009) | 33 lines Answer video SDP offers properly when
	  videosupport is not enabled. Copied from Review board: In issue
	  12434, the reporter describes a situation in which audio and
	  video is offered on the call, but because videosupport is
	  disabled in sip.conf, Asterisk gives no response at all to the
	  video offer. According to RFC 3264, all media offers should have
	  a corresponding answer. For offers we do not intend to actually
	  reply to with meaningful values, we should still reply with the
	  port for the media stream set to 0. In this patch, we take note
	  of what types of media have been offered and save the information
	  on the sip_pvt. The SDP in the response will take into account
	  whether media was offered. If we are not otherwise going to
	  answer a media offer, we will insert an appropriate m= line with
	  the port set to 0. It is important to note that this patch is
	  pretty much a bandage being applied to a broken bone. The patch
	  *only* helps for situations where video is offered but
	  videosupport is disabled and when udptl_pt is disabled but T.38
	  is offered. Asterisk is not guaranteed to respond to every media
	  offer. Notable cases are when multiple streams of the same type
	  are offered. The 2 media stream limit is still present with this
	  patch, too. In trunk and the 1.6.X branches, things will be a bit
	  different since Asterisk also supports text in SDPs as well.
	  (closes issue #12434) Reported by: mnnojd Review:
	  https://reviewboard.asterisk.org/r/311 Review:
	  https://reviewboard.asterisk.org/r/313 ........ ................

2009-07-20 16:41 +0000 [r207364]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 207361 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r207361 | russell | 2009-07-20 11:36:15 -0500 (Mon, 20 Jul 2009)
	  | 16 lines Merged revisions 207360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r207360 | russell | 2009-07-20 11:26:24 -0500 (Mon, 20 Jul 2009)
	  | 9 lines Only do the chan->fdno check in ast_read() in a
	  developer build. I changed this check to only happen in a
	  dev-mode build. I also added a comment explaining what is going
	  on. I also made it so that detection of this situation does not
	  affect ast_read() operation. (closes issue #14723) Reported by:
	  seadweller ........ ................

2009-07-18 04:19 +0000 [r207327]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 207317 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r207317 | tilghman | 2009-07-17 23:16:44 -0500 (Fri, 17 Jul 2009)
	  | 3 lines Flag field in wrong position. Reported by "Hoggins!" on
	  asterisk-dev list. ........

2009-07-18 03:50 +0000 [r207315]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c: Merged
	  revisions 145293,158010 from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 to make
	  merging easier. These changes are already on trunk.
	  ................ r145293 | rmudgett | 2008-09-30 18:55:24 -0500
	  (Tue, 30 Sep 2008) | 54 lines channels/chan_misdn.c
	  channels/misdn/isdn_lib.c * Miscellaneous other fixes from trunk
	  to make merging easier later. ........ r145200 | rmudgett |
	  2008-09-30 16:00:54 -0500 (Tue, 30 Sep 2008) | 7 lines *
	  Miscellaneous formatting changes to make v1.4 and trunk more
	  merge compatible in the mISDN area. channels/chan_misdn.c *
	  Eliminated redundant code in cb_events() EVENT_SETUP ........
	  r144257 | crichter | 2008-09-24 03:42:55 -0500 (Wed, 24 Sep 2008)
	  | 9 lines improved helptext of misdn_set_opt. ........ r142181 |
	  rmudgett | 2008-09-09 12:30:52 -0500 (Tue, 09 Sep 2008) | 1 line
	  Cleaned up comment ........ r138738 | rmudgett | 2008-08-18
	  16:07:28 -0500 (Mon, 18 Aug 2008) | 30 lines
	  channels/chan_misdn.c * Made bearer2str() use
	  allowed_bearers_array[] * Made use the causes.h defines instead
	  of hardcoded numbers. * Made use Asterisk presentation indicator
	  values if either of the mISDN presentation or screen options are
	  negative. * Updated the misdn_set_opt application option
	  descriptions. * Renamed the awkward Caller ID presentation
	  misdn_set_opt application option value not_screened to
	  restricted. Deprecated the not_screened option value.
	  channels/misdn/isdn_lib.c * Made use the causes.h defines instead
	  of hardcoded numbers. * Fixed some spelling errors and typos. *
	  Added all defined facility code strings to fac2str().
	  channels/misdn/isdn_lib.h * Added doxygen comments to struct
	  misdn_bchannel. channels/misdn/isdn_lib_intern.h * Added doxygen
	  comments to struct misdn_stack. channels/misdn_config.c
	  configs/misdn.conf.sample * Updated the mISDN presentation and
	  screen parameter descriptions. doc/misdn.txt (doc/tex/misdn.tex)
	  * Updated the misdn_set_opt application option descriptions. *
	  Fixed some spelling errors and typos. ................ r158010 |
	  rmudgett | 2008-11-19 19:46:09 -0600 (Wed, 19 Nov 2008) | 9 lines
	  Merged revision 157977 from
	  https://origsvn.digium.com/svn/asterisk/team/group/issue8824
	  ........ Fixes JIRA ABE-1726 The dial extension could be empty if
	  you are using MISDN_KEYPAD to control ISDN provider features.
	  ................

2009-07-17 22:31 +0000 [r207226-207257]  Tilghman Lesher <tlesher@digium.com>

	* /, doc/voicemail_odbc_postgresql.txt: Merged revisions 207255 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r207255 | tilghman | 2009-07-17 17:29:50 -0500 (Fri, 17
	  Jul 2009) | 2 lines Add flag here, too (as requested by jsmith)
	  ........

	* /, doc/tex/odbcstorage.tex, UPGRADE.txt: Merged revisions 207224
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r207224 | tilghman | 2009-07-17 17:04:43 -0500 (Fri, 17
	  Jul 2009) | 2 lines Document the "flag" field in the
	  voicemessages table. ........

2009-07-17 19:40 +0000 [r207104-207159]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 207156 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r207156 | jpeeler | 2009-07-17 14:37:38 -0500
	  (Fri, 17 Jul 2009) | 14 lines Merged revisions 207155 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r207155 | jpeeler | 2009-07-17 14:36:19 -0500 (Fri, 17 Jul 2009)
	  | 7 lines Fix format specifier to print out an unsigned long
	  long. Yep, it's even ifdefed out code. But it made it to the RR
	  list... (closes issue #14726) Reported by: lmadsen ........
	  ................

	* configs/chan_dahdi.conf.sample, /: Merged revisions 207095 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r207095 | jpeeler | 2009-07-17 14:16:35 -0500 (Fri, 17
	  Jul 2009) | 2 lines Update some missing allowed options for
	  overlapdial ........

2009-07-17 17:52 +0000 [r206869-207030]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 207029 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r207029 |
	  dvossel | 2009-07-17 12:51:44 -0500 (Fri, 17 Jul 2009) | 6 lines
	  sip option flags handled incorrectly (closes issue #15376)
	  Reported by: Takehiko Ooshima Tested by: dvossel,
	  Takehiko_Ooshima ........

	* /, channels/chan_sip.c: Merged revisions 206939 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r206939 | dvossel | 2009-07-17 11:13:22 -0500 (Fri, 17 Jul 2009)
	  | 20 lines Merged revisions 206938 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r206938 | dvossel | 2009-07-17 11:05:06 -0500 (Fri, 17 Jul 2009)
	  | 14 lines SIP incorrect From: header information when callpres
	  is prohib Some ITSP make use of the "Anonymous" display name to
	  detect a requirement to withhold caller id across the PSTN. This
	  does not work if the display name is "Unknown". (closes issue
	  #14465) Reported by: Nick_Lewis Patches:
	  chan_sip.c-callerpres.patch uploaded by Nick (license 657)
	  chan_sip.c-callerpres_trunk.patch uploaded by dvossel (license
	  671) Tested by: Nick_Lewis, dvossel ........ ................

	* /, funcs/func_timeout.c: Merged revisions 206877 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r206877 | dvossel | 2009-07-16 16:45:14 -0500 (Thu, 16 Jul 2009)
	  | 6 lines TIMEOUT(absolute) returned negative value. (closes
	  issue #15513) Reported by: ys ........

	* configs/iax.conf.sample, /: Merged revisions 206873 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r206873 | dvossel | 2009-07-16 16:33:51 -0500
	  (Thu, 16 Jul 2009) | 12 lines Merged revisions 206872 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r206872 | dvossel | 2009-07-16 16:33:19 -0500 (Thu, 16 Jul 2009)
	  | 6 lines error in iax.conf related IP-based access control
	  (closes issue #15518) Reported by: pkempgen ........
	  ................

	* /, main/callerid.c: Merged revisions 206868 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r206868 | dvossel | 2009-07-16 16:25:22 -0500 (Thu, 16 Jul 2009)
	  | 14 lines Merged revisions 206867 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r206867 | dvossel | 2009-07-16 16:24:16 -0500 (Thu, 16 Jul 2009)
	  | 8 lines avoid segfault caused by user error If the CALLERPRES()
	  dialplan function is set to nothing, a segfault occurs. This is
	  user error to begin with, but I'd rather see a cli warning
	  message than have Asterisk crash on me. ........ ................

2009-07-16 16:53 +0000 [r206811]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_realtime.c, /: Merged revisions 206808 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r206808 | tilghman | 2009-07-16 11:51:05 -0500
	  (Thu, 16 Jul 2009) | 13 lines Merged revisions 206807 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r206807 | tilghman | 2009-07-16 11:27:35 -0500 (Thu, 16 Jul 2009)
	  | 6 lines Fix a memory leak. (closes issue #15517) Reported by:
	  adomjan Patches: func_realtime.c-ast_variable_destroy.diff
	  uploaded by adomjan (license 487) ........ ................

2009-07-15 22:04 +0000 [r206770]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 206768 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r206768 |
	  dvossel | 2009-07-15 17:04:13 -0500 (Wed, 15 Jul 2009) | 8 lines
	  Session timer were not activated if Supported header field in
	  INVITE had both "timer" and other options. (closes issue #15403)
	  Reported by: makoto Patches: sip-session-timer.patch uploaded by
	  makoto (license ........

2009-07-15 21:50 +0000 [r206765]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib_intern.h, /:
	  Merged revisions 206707 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r206707 | rmudgett | 2009-07-15 16:14:41 -0500 (Wed, 15 Jul 2009)
	  | 33 lines Merged revisions 206706 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r206706 | rmudgett | 2009-07-15 15:44:55 -0500
	  (Wed, 15 Jul 2009) | 26 lines Merged revision 206700 from
	  https://origsvn.digium.com/svn/asterisk/be/branches/C.2-...
	  .......... Fixed chan_misdn crash because mISDNuser library is
	  not thread safe. With Asterisk the mISDNuser library is driven by
	  two threads concurrently: 1.
	  channels/misdn/isdn_lib.c::manager_event_handler() 2.
	  channels/misdn/isdn_lib.c::misdn_lib_isdn_event_catcher() Calls
	  into the library are done concurrently and recursively from
	  isdn_lib.c. Both threads can fiddle with the master/child
	  layer3_proc_t lists. One thread may traverse the list when the
	  other interrupts it and then removes the list element which the
	  first thread was currently handling. This is exactly what caused
	  the crash. About 60 calls were needed to a Gigaset CX475 before
	  it occurred once. This patch adds locking when calling into the
	  mISDNuser library. This also fixes some cb_log calls with wrong
	  port parameter. JIRA ABE-1913 Patches: misdn-locking.patch
	  (Modified with mostly cosmetic changes) ..........
	  ................ ................

2009-07-15 20:20 +0000 [r206703]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 206702 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r206702 |
	  dvossel | 2009-07-15 15:20:01 -0500 (Wed, 15 Jul 2009) | 10 lines
	  callerid(num) is wrong when username is missing A domain only sip
	  uri <sip:123.123.123.123> would return 123.123.123.123 as callid
	  num. Now, if the username is missing from a uri, the callerid num
	  field is left empty. (closes issue #15476) Reported by: viraptor
	  ........

2009-07-15 16:04 +0000 [r206639]  Sean Bright <sean@malleable.com>

	* codecs/codec_dahdi.c, /: Merged revisions 206636 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r206636 | seanbright | 2009-07-15 12:00:24 -0400
	  (Wed, 15 Jul 2009) | 9 lines Merged revisions 206635 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r206635 | seanbright | 2009-07-15 11:57:51 -0400 (Wed,
	  15 Jul 2009) | 1 line Only print debug info in codec_dahdi if we
	  are asking for it. ........ ................

2009-07-14 20:26 +0000 [r206598]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_meetme.c, contrib/scripts/meetme.sql: Merged
	  revisions 206567 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r206567 |
	  tilghman | 2009-07-14 15:14:45 -0500 (Tue, 14 Jul 2009) | 6 lines
	  Document all meetme realtime fields, and in the process, make
	  some field lengths more consistent. (closes issue #15493)
	  Reported by: lasko Patches: meetme.diff uploaded by lasko
	  (license 833) ........

2009-07-14 19:49 +0000 [r206565]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, /: Merged revisions 206489 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r206489 | rmudgett | 2009-07-14 12:01:48 -0500
	  (Tue, 14 Jul 2009) | 35 lines Merged revisions 206487 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r206487 | rmudgett | 2009-07-14 11:44:47 -0500 (Tue, 14 Jul 2009)
	  | 28 lines Fixes several call transfer issues with chan_misdn. *
	  issue #14355 - Crash if attempt to transfer a call to an
	  application. Masquerade the other pair of the four asterisk
	  channels involved in the two calls. The held call already must be
	  a bridged call (not an applicaton) or it would have been
	  rejected. * issue #14692 - Held calls are not automatically
	  cleared after transfer. Allow the core to initate disconnect of
	  held calls to the ISDN port. This also fixes a similar case where
	  the party on hold hangs up before being transferred or taken off
	  hold. * JIRA ABE-1903 - Orphaned held calls left in
	  music-on-hold. Do not simply block passing the hangup event on
	  held calls to asterisk core. * Fixed to allow held calls to be
	  transferred to ringing calls. Previously, held calls could only
	  be transferred to connected calls. * Eliminated unused call
	  states to simplify hangup code. * Eliminated most uses of
	  "holded" because it is not a word. (closes issue #14355) (closes
	  issue #14692) Reported by: sodom Patches:
	  misdn_xfer_v14_r205839.patch uploaded by rmudgett (license 664)
	  Tested by: rmudgett ........ ................

2009-07-14 14:59 +0000 [r206389]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 206386 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r206386 | russell | 2009-07-14 09:51:44 -0500
	  (Tue, 14 Jul 2009) | 20 lines Merged revisions 206385 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r206385 | russell | 2009-07-14 09:48:00 -0500
	  (Tue, 14 Jul 2009) | 13 lines Merged revisions 206384 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r206384 | russell | 2009-07-14 09:45:47 -0500 (Tue, 14 Jul 2009)
	  | 6 lines Ensure apathetic replies are sent out on the proper
	  socket. chan_iax2 supports multiple address bindings. The
	  send_apathetic_reply() function did not attempt to send its
	  response on the same socket that the incoming message came in on.
	  ........ ................ ................

2009-07-14 01:59 +0000 [r206373]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /: Merged
	  revisions 206341 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r206341 | rmudgett | 2009-07-13 19:48:59 -0500 (Mon, 13 Jul 2009)
	  | 11 lines Merged revisions 206284 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r206284 | rmudgett | 2009-07-13 19:17:28 -0500 (Mon, 13 Jul 2009)
	  | 4 lines Fix some memory leaks in chan_misdn. JIRA ABE-1911
	  ........ ................

2009-07-13 23:27 +0000 [r206281]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 206280 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r206280 |
	  dvossel | 2009-07-13 18:26:51 -0500 (Mon, 13 Jul 2009) | 9 lines
	  dns lookup of peername rather than peer's host in
	  transmit_register() (closes issue #15052) Reported by: fsantulli
	  Patches: chan_sip_bug_15052_[20090626204511].patch uploaded by
	  fsantulli (license 818) Tested by: fsantulli ........

2009-07-13 16:24 +0000 [r206187]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 206185 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r206185 | tilghman | 2009-07-13 11:23:07 -0500 (Mon, 13 Jul 2009)
	  | 2 lines Remove reference to non-existent help file ........

2009-07-10 21:46 +0000 [r205986]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 205985 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205985 |
	  dvossel | 2009-07-10 16:42:10 -0500 (Fri, 10 Jul 2009) | 16 lines
	  SIP register not using peer's outbound proxy If callbackextension
	  is defined for a peer it successfully causes a registration to
	  occur, but the registration ignores the outboundproxy settings
	  for the peer. This patch allows the peer to be passed to
	  obproxy_get() in transmit_register(). (closes issue #14344)
	  Reported by: Nick_Lewis Patches:
	  callbackextension_peer_trunk.diff uploaded by dvossel (license
	  671) Tested by: dvossel Review:
	  https://reviewboard.asterisk.org/r/294/ ........

2009-07-10 18:45 +0000 [r205942]  Kevin P. Fleming <kpfleming@digium.com>

	* main/udptl.c, /: Merged revisions 205939 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205939 |
	  kpfleming | 2009-07-10 13:44:09 -0500 (Fri, 10 Jul 2009) | 1 line
	  Update comments about the level of T.38 support in Asterisk.
	  ........

2009-07-10 17:54 +0000 [r205882]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 205878 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r205878 | mmichelson | 2009-07-10 12:39:57 -0500 (Fri, 10 Jul
	  2009) | 30 lines Merged revisions 205877 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r205877 | mmichelson | 2009-07-10 12:39:13 -0500
	  (Fri, 10 Jul 2009) | 23 lines Merged revisions 205776 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r205776 | mmichelson | 2009-07-10 10:56:45 -0500
	  (Fri, 10 Jul 2009) | 16 lines Merged revisions 205775 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205775 | mmichelson | 2009-07-10 10:51:36 -0500 (Fri, 10 Jul
	  2009) | 10 lines Ensure that outbound NOTIFY requests are
	  properly routed through stateful proxies. With this change, we
	  make note of Record-Route headers present in any SUBSCRIBE
	  request that we receive so that our outbound NOTIFY requests will
	  have the proper Route headers in them. (closes issue #14725)
	  Reported by: ibc ........ ................ ................
	  ................

2009-07-10 16:47 +0000 [r205841]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 205840 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r205840 | dvossel | 2009-07-10 11:42:04 -0500 (Fri, 10 Jul 2009)
	  | 37 lines Merged revisions 205804 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205804 | dvossel | 2009-07-10 11:23:59 -0500 (Fri, 10 Jul 2009)
	  | 31 lines SIP registration auth loop caused by stale nonce If an
	  endpoint sends two registration requests in a very short period
	  of time with the same nonce, both receive 401 responses from
	  Asterisk, each with a different nonce (the second 401 containing
	  the current nonce and the first one being stale). If the endpoint
	  responds to the first 401, it does not match the current nonce so
	  Asterisk sends a third 401 with a newly generated nonce (which
	  updates the current nonce)... Now if the endpoint responds to the
	  second 401, it does not match the current nonce either and
	  Asterisk sends a fourth 401 with a newly generated nonce... This
	  loop goes on and on. There appears to be a simple fix for this.
	  If the nonce from the request does not match our nonce, but is a
	  good response to a previous nonce, instead of sending a 401 with
	  a newly generated nonce, use the current one instead. This breaks
	  the loop as the nonce is not updated until a response is
	  received. Additional logic has been added to make sure no nonce
	  can be responded to twice though. (closes issue #15102) Reported
	  by: Jamuel Patches: patch-bug_0015102 uploaded by Jamuel (license
	  809) nonce_sip.diff uploaded by dvossel (license 671) Tested by:
	  Jamuel Review: https://reviewboard.asterisk.org/r/289/ ........
	  ................

2009-07-10 16:01 +0000 [r205781]  Kevin P. Fleming <kpfleming@digium.com>

	* /, apps/app_fax.c: Merged revisions 205780 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205780 |
	  kpfleming | 2009-07-10 11:00:44 -0500 (Fri, 10 Jul 2009) | 11
	  lines Eliminate extraneous LOG_DEBUG messages generated by
	  app_fax. The transmit_audio() and transmit_t38() functions in
	  app_fax have processing loops that are supposed to wait for
	  frames to arrive on the channel and then handle them, but they
	  also have short timeouts so that the loops can have watchdog
	  timers and do other required processing. This commit changes the
	  loops to not actually call ast_read() and attempt to process the
	  returned frame unless a frame actually arrived, eliminating
	  hundreds of LOG_DEBUG messages and slightly improving
	  performance. ........

2009-07-10 15:58 +0000 [r205779]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 205776 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r205776 | mmichelson | 2009-07-10 10:56:45 -0500 (Fri, 10 Jul
	  2009) | 16 lines Merged revisions 205775 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205775 | mmichelson | 2009-07-10 10:51:36 -0500 (Fri, 10 Jul
	  2009) | 10 lines Ensure that outbound NOTIFY requests are
	  properly routed through stateful proxies. With this change, we
	  make note of Record-Route headers present in any SUBSCRIBE
	  request that we receive so that our outbound NOTIFY requests will
	  have the proper Route headers in them. (closes issue #14725)
	  Reported by: ibc ........ ................

2009-07-10 15:36 +0000 [r205773]  Kevin P. Fleming <kpfleming@digium.com>

	* /, apps/app_fax.c: Merged revisions 205770 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205770 |
	  kpfleming | 2009-07-10 10:28:11 -0500 (Fri, 10 Jul 2009) | 12
	  lines Fix some remaining T.38 negotiation problems in app_fax.
	  Revision 205696 did not quite fix all the issues with the T.38
	  negotiation changes and app_fax; this patch corrects them, along
	  with a couple of other minor issues. (closes issue #15480)
	  Reported by: dimas Patches: test2-15480.patch uploaded by dimas
	  (license 88) ........

2009-07-09 23:56 +0000 [r205731]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c: Merged revisions 205728 via svn merge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205728 | rmudgett | 2009-07-09 18:37:53 -0500 (Thu, 09 Jul 2009)
	  | 21 lines No audio on calls from Asterisk to various ISDN
	  devices until DTMF sent by caller. Add missing clearing of the
	  dialing flag when the ISDN call is CONNECTED. (i.e. When libpri
	  generates the event PRI_EVENT_ANSWER.) (closes issue #15420)
	  Reported by: scottbmilne Patches: bug15420-1.4.25.1-diff2.txt
	  uploaded by alecdavis (license 585) Tested by: scottbmilne,
	  alecdavis (closes issue #15416) Reported by: avinoash (closes
	  issue #15389) Reported by: alecdavis This patch should also fix
	  the following issue: (issue #15205) Reported by: vinsik ........

2009-07-09 21:27 +0000 [r205699]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/frame.h, /, channels/chan_sip.c, apps/app_fax.c:
	  Merged revisions 205696 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205696 |
	  kpfleming | 2009-07-09 16:20:23 -0500 (Thu, 09 Jul 2009) | 16
	  lines Repair ability of SendFAX/ReceiveFAX to respond to T.38
	  switchover. Recent changes in T.38 negotiation in Asterisk caused
	  these applications to not respond when the other endpoint
	  initiated a switchover to T.38; this resulted in the T.38
	  switchover failing, and the FAX attempt to be made using an audio
	  connection, instead of T.38 (which would usually cause the FAX to
	  fail completely). This patch corrects this problem, and the
	  applications will now correctly respond to the T.38 switchover
	  request. In addition, the response will include the appopriate
	  T.38 session parameters based on what the other end offered and
	  what our end is capable of. (closes issue #14849) Reported by:
	  afosorio ........

2009-07-09 16:19 +0000 [r205595-205603]  David Vossel <dvossel@digium.com>

	* include/asterisk/time.h, /: Merged revisions 205600 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r205600 | dvossel | 2009-07-09 11:19:09 -0500
	  (Thu, 09 Jul 2009) | 9 lines Merged revisions 205599 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r205599 | dvossel | 2009-07-09 11:18:09 -0500 (Thu, 09
	  Jul 2009) | 2 lines Changing ast_samp2tv to not use floating
	  point. ........ ................

	* channels/chan_iax2.c, include/asterisk/frame.h, main/rtp.c, /:
	  Merged revisions 205479 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r205479 | dvossel | 2009-07-08 18:19:09 -0500 (Wed, 08 Jul 2009)
	  | 16 lines Merged revisions 205471 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205471 | dvossel | 2009-07-08 18:15:54 -0500 (Wed, 08 Jul 2009)
	  | 10 lines Fixes 8khz assumptions Many calculations assume 8khz
	  is the codec rate. This is not always the case. This patch only
	  addresses chan_iax.c and res_rtp_asterisk.c, but I am sure there
	  are other areas that make this assumption as well. Review:
	  https://reviewboard.asterisk.org/r/306/ ........ ................

2009-07-09 08:34 +0000 [r205535]  Michiel van Baak <michiel@vanbaak.info>

	* /, main/ssl.c: Merged revisions 205532 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205532 |
	  mvanbaak | 2009-07-09 10:31:24 +0200 (Thu, 09 Jul 2009) | 5 lines
	  pthread_self returns a pthread_t which is not an unsigned int on
	  all pthread implementations. Casting it to an unsigned int fixes
	  compiler warnings. Tested on OpenBSD and Linux both 32 and 64 bit
	  ........

2009-07-08 22:15 +0000 [r205411-205413]  David Vossel <dvossel@digium.com>

	* include/asterisk/pbx.h, include/asterisk/devicestate.h,
	  main/pbx.c, /, main/devicestate.c: Merged revisions 205412 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r205412 | dvossel | 2009-07-08 17:15:06 -0500
	  (Wed, 08 Jul 2009) | 12 lines Merged revisions 205409 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205409 | dvossel | 2009-07-08 16:35:12 -0500 (Wed, 08 Jul 2009)
	  | 6 lines moving ast_devstate_to_extenstate to pbx.c from
	  devicestate.c ast_devstate_to_extenstate belongs in pbx.c. This
	  change fixes a compile time error with chan_vpb as well. ........
	  ................

	* /, main/devicestate.c: Merged revisions 205410 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205410 |
	  dvossel | 2009-07-08 17:02:54 -0500 (Wed, 08 Jul 2009) | 3 lines
	  missing comma in devstatestring array ........

2009-07-08 19:28 +0000 [r205353]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 205350 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r205350 | mmichelson | 2009-07-08 14:26:55 -0500 (Wed, 08 Jul
	  2009) | 20 lines Merged revisions 205349 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205349 | mmichelson | 2009-07-08 14:26:13 -0500 (Wed, 08 Jul
	  2009) | 14 lines Prevent phantom calls to queue members. If a
	  caller were to hang up while a periodic announcement or position
	  were being said, the return value for those functions would
	  incorrectly indicate that the caller was still in the queue. With
	  these changes, the problem does not occur. (closes issue #14631)
	  Reported by: latinsud Patches: queue_announce_ghost_call2.diff
	  uploaded by latinsud (license 745) (with small modification from
	  me) ........ ................

2009-07-08 18:22 +0000 [r205302]  Jason Parker <jparker@digium.com>

	* config.guess, config.sub, /: Merged revisions 205291 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r205291 | qwell | 2009-07-08 13:19:46 -0500
	  (Wed, 08 Jul 2009) | 9 lines Merged revisions 205288 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r205288 | qwell | 2009-07-08 13:19:03 -0500 (Wed, 08 Jul
	  2009) | 1 line Update config.guess and config.sub from the
	  savannah.gnu.org git repo. ........ ................

2009-07-08 18:18 +0000 [r205287]  David Brooks <dbrooks@digium.com>

	* /, main/features.c: Merged revisions 205254 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205254 |
	  dbrooks | 2009-07-08 12:26:26 -0500 (Wed, 08 Jul 2009) | 8 lines
	  Fixes Park() argument handling Park() was not respecting the
	  arguments passed to it. Any extension/context/priority given to
	  it was being ignored. This patch remedies this. (closes issue
	  #15380) Reported by: DLNoah ........

2009-07-08 17:00 +0000 [r205223]  Tilghman Lesher <tlesher@digium.com>

	* main/say.c: oops, fixing build

2009-07-08 16:55 +0000 [r205217]  David Vossel <dvossel@digium.com>

	* include/asterisk/time.h, /: Merged revisions 205216 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r205216 | dvossel | 2009-07-08 11:54:24 -0500
	  (Wed, 08 Jul 2009) | 17 lines Merged revisions 205215 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205215 | dvossel | 2009-07-08 11:53:40 -0500 (Wed, 08 Jul 2009)
	  | 10 lines ast_samp2tv needs floating point for 16khz audio In
	  ast_samp2tv(), (1000000 / _rate) = 62.5 when _rate is 16000. The
	  .5 is currently stripped off because we don't calculate using
	  floating points. This causes madness with 16khz audio. (issue
	  ABE-1899) Review: https://reviewboard.asterisk.org/r/305/
	  ........ ................

2009-07-08 16:30 +0000 [r205207]  Tilghman Lesher <tlesher@digium.com>

	* /, main/say.c: Merged revisions 205196 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r205196 | tilghman | 2009-07-08 11:27:50 -0500 (Wed, 08 Jul 2009)
	  | 9 lines Merged revisions 205188 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r205188 | tilghman | 2009-07-08 11:26:15 -0500 (Wed, 08 Jul 2009)
	  | 2 lines Add redirection warnings for the invalid language codes
	  previously removed. ........ ................

2009-07-08 15:57 +0000 [r205148-205154]  Russell Bryant <russell@digium.com>

	* /, main/ssl.c: Merged revisions 205151 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205151 |
	  russell | 2009-07-08 10:56:28 -0500 (Wed, 08 Jul 2009) | 2 lines
	  Use tabs instead of spaces for indentation. ........

	* include/asterisk/_private.h, res/res_jabber.c, main/asterisk.c,
	  /, main/Makefile, res/res_crypto.c, main/ssl.c (added): Merged
	  revisions 205120 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r205120 |
	  russell | 2009-07-08 10:17:19 -0500 (Wed, 08 Jul 2009) | 16 lines
	  Move OpenSSL initialization to a single place, make library usage
	  thread-safe. While doing some reading about OpenSSL, I noticed a
	  couple of things that needed to be improved with our usage of
	  OpenSSL. 1) We had initialization of the library done in multiple
	  modules. This has now been moved to a core function that gets
	  executed during Asterisk startup. We already link OpenSSL into
	  the core for TCP/TLS functionality, so this was the most logical
	  place to do it. 2) OpenSSL is not thread-safe by default.
	  However, making it thread safe is very easy. We just have to
	  provide a couple of callbacks. One callback returns a thread ID.
	  The other handles locking. For more information, start with the
	  "Is OpenSSL thread-safe?" question on the FAQ page of
	  openssl.org. ........

2009-07-06 13:41 +0000 [r204951]  Kevin P. Fleming <kpfleming@digium.com>

	* main/channel.c, /: Merged revisions 204948 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r204948 |
	  kpfleming | 2009-07-06 08:38:29 -0500 (Mon, 06 Jul 2009) | 7
	  lines Improve handling of AST_CONTROL_T38 and
	  AST_CONTROL_T38_PARAMETERS for non-T.38-capable channels. This
	  change allows applications that request T.38 negotiation on a
	  channel that does not support it to get the proper indication
	  that it is not supported, rather than thinking that negotiation
	  was started when it was not. ........

2009-07-02 22:06 +0000 [r204838]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 204835 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r204835 | rmudgett | 2009-07-02 17:01:28 -0500
	  (Thu, 02 Jul 2009) | 17 lines Merged revisions 204834 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r204834 | rmudgett | 2009-07-02 16:59:43 -0500 (Thu, 02 Jul 2009)
	  | 10 lines Removed confusing warning message "Got Busy in
	  Connected State" If an incoming mISDN call is answered with the
	  Answer application and a subsequent Dial gets a busy endpoint
	  then it is valid for that already connected channel to get the
	  busy indication. Asterisk will play the busy tones until the
	  dialplan plays something else or hangs up the call. (closes issue
	  #11974) Reported by: fvdb ........ ................

2009-07-02 16:12 +0000 [r204711]  David Vossel <dvossel@digium.com>

	* include/asterisk/devicestate.h, main/pbx.c, /,
	  main/devicestate.c: Merged revisions 204710 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r204710 | dvossel | 2009-07-02 11:03:44 -0500 (Thu, 02 Jul 2009)
	  | 21 lines Merged revisions 204681 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r204681 | dvossel | 2009-07-02 10:05:57 -0500 (Thu, 02 Jul 2009)
	  | 14 lines Improved mapping of extension states from combined
	  device states. This fixes a few issues with incorrect extension
	  states and adds a cli command, core show device2extenstate, to
	  display all possible state mappings. (closes issue #15413)
	  Reported by: legart Patches: exten_helper.diff uploaded by
	  dvossel (license 671) Tested by: dvossel, legart, amilcar Review:
	  https://reviewboard.asterisk.org/r/301/ ........ ................

2009-06-30 21:30 +0000 [r204611]  Tilghman Lesher <tlesher@digium.com>

	* /, main/say.c, UPGRADE.txt: Merged revisions 204563 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r204563 | tilghman | 2009-06-30 15:41:04 -0500
	  (Tue, 30 Jun 2009) | 13 lines Merged revisions 204556 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r204556 | tilghman | 2009-06-30 15:23:51 -0500 (Tue, 30 Jun 2009)
	  | 6 lines More incorrect language codes, plus ensuring that
	  regionalizations use the specified language, and not English for
	  grammar. (closes issue #15022) Reported by: greenfieldtech
	  Patches: 20090519__issue15022.diff.txt uploaded by tilghman
	  (license 14) ........ ................

2009-06-30 18:55 +0000 [r204478]  Jason Parker <jparker@digium.com>

	* /, main/say.c: Merged revisions 204475 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r204475 | qwell | 2009-06-30 13:48:35 -0500 (Tue, 30 Jun 2009) |
	  9 lines Merged revisions 204474 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r204474 | qwell | 2009-06-30 13:47:06 -0500 (Tue, 30 Jun 2009) |
	  1 line Fix ast_say_counted_noun to correctly handle Polish. Fix a
	  comment typo in passing. ........ ................

2009-06-30 18:44 +0000 [r204473]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /, main/say.c, UPGRADE.txt: Recorded merge
	  of revisions 204470 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r204470 | tilghman | 2009-06-30 13:36:24 -0500 (Tue, 30 Jun 2009)
	  | 18 lines Recorded merge of revisions 204469 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r204469 | tilghman | 2009-06-30 13:23:35 -0500 (Tue, 30 Jun 2009)
	  | 11 lines "tw" is the language specification for Twi (from
	  Ghana) not Taiwanese. (closes issue #15346) Reported by: volivier
	  Patches: 20090617__issue15346__1.4.diff.txt uploaded by tilghman
	  (license 14) 20090617__issue15346__trunk.diff.txt uploaded by
	  tilghman (license 14) 20090617__issue15346__1.6.0.diff.txt
	  uploaded by tilghman (license 14)
	  20090617__issue15346__1.6.1.diff.txt uploaded by tilghman
	  (license 14) 20090617__issue15346__1.6.2.diff.txt uploaded by
	  tilghman (license 14) Tested by: volivier ........
	  ................

2009-06-30 17:22 +0000 [r204442]  Russell Bryant <russell@digium.com>

	* configs/res_config_sqlite.conf (removed),
	  configs/res_config_sqlite.conf.sample (added), /: Merged
	  revisions 204440 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r204440 |
	  russell | 2009-06-30 12:22:16 -0500 (Tue, 30 Jun 2009) | 2 lines
	  Rename res_config_sqlite.conf to res_config_sqlite.conf.sample
	  (missing .sample). ........

2009-06-29 22:53 +0000 [r204250-204304]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 204301 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r204301 | mmichelson | 2009-06-29 17:50:35 -0500 (Mon, 29 Jun
	  2009) | 15 lines Merged revisions 204300 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r204300 | mmichelson | 2009-06-29 17:45:34 -0500 (Mon, 29 Jun
	  2009) | 9 lines Add error message so that it is clear why a SIP
	  peer was not processed when a DNS lookup fails on a host or
	  outboundproxy. (closes issue #13432) Reported by: p_lindheimer
	  Patches: outboundproxy.patch uploaded by p (license 558) ........
	  ................

	* /, channels/chan_sip.c: Merged revisions 204247 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r204247 | mmichelson | 2009-06-29 16:48:54 -0500 (Mon, 29 Jun
	  2009) | 32 lines Merged revisions 204243,204246 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r204243 | mmichelson | 2009-06-29 16:23:43 -0500 (Mon, 29 Jun
	  2009) | 22 lines Fix a problem where chan_sip would ignore "old"
	  but valid responses. chan_sip has had a problem for quite a long
	  time that would manifest when Asterisk would send multiple SIP
	  responses on the same dialog before receiving a response. The
	  problem occurred because chan_sip only kept track of the highest
	  outgoing sequence number used on the dialog. If Asterisk sent two
	  requests out, and a response arrived for the first request sent,
	  then Asterisk would ignore the response. The result was that
	  Asterisk would continue retransmitting the requests and ignoring
	  the responses until the maximum number of retransmissions had
	  been reached. The fix here is to rearrange the code a bit so that
	  instead of simply comparing the sequence number of the response
	  to our latest outgoing sequence number, we walk our list of
	  outstanding packets and determine if there is a match. If there
	  is, we continue. If not, then we ignore the response. In doing
	  this, I found a few completely useless variables that I have now
	  removed. (closes issue #11231) Reported by: flefoll Review:
	  https://reviewboard.asterisk.org/r/298 ........ r204246 |
	  mmichelson | 2009-06-29 16:37:05 -0500 (Mon, 29 Jun 2009) | 3
	  lines Fix build oops. ........ ................

2009-06-27 09:55 +0000 [r203961]  Russell Bryant <russell@digium.com>

	* CHANGES, /: Merged revisions 203960 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r203960 |
	  russell | 2009-06-27 04:51:45 -0500 (Sat, 27 Jun 2009) | 2 lines
	  Minor tweaks and spelling fixes for CHANGES and UPGRADE.txt.
	  ........

2009-06-27 01:24 +0000 [r203941]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 203909 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r203909 | rmudgett | 2009-06-26 20:07:52 -0500
	  (Fri, 26 Jun 2009) | 23 lines Merged revisions 203908 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r203908 | rmudgett | 2009-06-26 19:55:12 -0500 (Fri, 26 Jun 2009)
	  | 16 lines The ISDN CPE side should not exclusively pick B
	  channels normally. Before this patch, Asterisk unconditionally
	  picked B channels exclusively on the CPE side and normally
	  allowed alternative B channels on the network side. Now Asterisk
	  does the opposite. Reasons for the CPE side to normally not pick
	  B channels exclusively: * For CPE point-to-multipoint mode (i.e.
	  phone side), the CPE side does not have enough information to
	  exclusively pick B channels. (There may be other devices on the
	  line.) * Q.931 gives preference to the network side picking B
	  channels. * Some telcos require the CPE side to not pick B
	  channels exclusively. (closes issue #14383) Reported by:
	  mbrancaleoni ........ ................

2009-06-26 22:14 +0000 [r203857]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 203853 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r203853 | jpeeler | 2009-06-26 17:11:31 -0500
	  (Fri, 26 Jun 2009) | 12 lines Merged revisions 203848 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r203848 | jpeeler | 2009-06-26 17:09:19 -0500 (Fri, 26 Jun 2009)
	  | 5 lines Make sure to recreate the dahdi pseudo channel after
	  dahdi restart (closes issue #14477) Reported by: timking ........
	  ................

2009-06-26 21:27 +0000 [r203782-203828]  Russell Bryant <russell@digium.com>

	* /, main/file.c: Merged revisions 203802 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r203802 | russell | 2009-06-26 16:21:48 -0500 (Fri, 26 Jun 2009)
	  | 22 lines Merged revisions 203785 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r203785 | russell | 2009-06-26 16:16:39 -0500 (Fri, 26 Jun 2009)
	  | 15 lines Don't fast forward past the end of a message. This is
	  nice change for users of the voicemail application. If someone
	  gets a little carried away with fast forwarding through a
	  message, they can easily get to the end and accidentally exit the
	  voicemail application by hitting the fast forward key during the
	  following prompt. This adds some safety by not allowing a fast
	  forward past the end of a message. (closes issue #14554) Reported
	  by: lacoursj Patches: 21761.patch uploaded by lacoursj (license
	  707) Tested by: lacoursj ........ ................

	* /, channels/chan_sip.c: Merged revisions 203779 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r203779 |
	  russell | 2009-06-26 15:45:00 -0500 (Fri, 26 Jun 2009) | 5 lines
	  Ensure the TCP read buffer is fully initialized before handling
	  each packet. (closes issue #14452) Reported by: umberto71
	  ........

2009-06-26 20:18 +0000 [r203731]  David Brooks <dbrooks@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 203721 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r203721 | dbrooks | 2009-06-26 15:13:51 -0500 (Fri, 26 Jun 2009)
	  | 16 lines Fixing voicemail's error in checking max silence vs
	  min message length Max silence was represented in milliseconds,
	  yet vmminsecs (minmessage) was represented as seconds. Also, the
	  inequality was reversed. The warning, if triggered, was "Max
	  silence should be less than minmessage or you may get empty
	  messages", which should have been logged if max silence was
	  greater than minmessage, but the check was for less than. Also,
	  conforming if statement to coding guidelines. closes issue
	  #15331) Reported by: markd Review:
	  https://reviewboard.asterisk.org/r/293/ ........

2009-06-26 19:49 +0000 [r203715]  Russell Bryant <russell@digium.com>

	* include/asterisk/devicestate.h, main/pbx.c, /,
	  main/devicestate.c: Merged revisions 203702 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r203702 |
	  russell | 2009-06-26 14:31:14 -0500 (Fri, 26 Jun 2009) | 5 lines
	  Make invalid hints report Unavailable instead of Idle. (closes
	  issue #14413) Reported by: pj ........

2009-06-26 19:48 +0000 [r203712]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 203710 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r203710 | dvossel | 2009-06-26 14:47:11 -0500 (Fri, 26 Jun 2009)
	  | 7 lines moving debug message from level 0 to 1. (closes issue
	  #15404) Reported by: leobrown Patches: iax_codec_debug.patch
	  uploaded by leobrown (license 541) ........

2009-06-26 19:42 +0000 [r203709]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 203672 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r203672 | jpeeler | 2009-06-26 14:03:25 -0500 (Fri, 26 Jun 2009)
	  | 16 lines Check if polarityonanswerdelay has elapsed before
	  setting a channel as answered after a polarity reversal.
	  Previously on a polarity switch event chan_dahdi would set the
	  channel immediately as answered. This would cause problems if a
	  polarity reversal occurred when the line was picked up as the
	  dial would not have yet occurred. Now if the polarity reversal
	  occurs before delay has elapsed after coming off hook or an
	  answer, it is ignored. Also, some refactoring was done in
	  _handle_event. (closes issue #13917) Reported by: alecdavis
	  Patches: chan_dahdi.bug13917.feb09.diff2.txt uploaded by
	  alecdavis (license 585) Tested by: alecdavis ........

2009-06-26 19:38 +0000 [r203705]  Joshua Colp <jcolp@digium.com>

	* configs/sip.conf.sample, include/asterisk/frame.h, main/rtp.c,
	  main/channel.c, main/frame.c, /, channels/chan_sip.c,
	  apps/app_fax.c: Merged revisions 203699 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r203699 |
	  file | 2009-06-26 16:27:24 -0300 (Fri, 26 Jun 2009) | 2 lines
	  Improve T.38 negotiation by exchanging session parameters between
	  application and channel. ........

2009-06-25 21:46 +0000 [r203445]  David Vossel <dvossel@digium.com>

	* main/ast_expr2.fl, main/ast_expr2.c, /: Merged revisions 203444
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r203444 | dvossel | 2009-06-25 16:45:32 -0500 (Thu, 25
	  Jun 2009) | 4 lines fixes a few redundant conditions (issue
	  #15269) ........

2009-06-25 21:21 +0000 [r203400]  Terry Wilson <twilson@digium.com>

	* main/cli.c, /: Merged revisions 203381 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r203381 | twilson | 2009-06-25 16:15:11 -0500 (Thu, 25 Jun 2009)
	  | 11 lines Merged revisions 203380 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r203380 | twilson | 2009-06-25 16:13:10 -0500 (Thu, 25 Jun 2009)
	  | 4 lines I didn't see that Mark already fixed the underlying
	  issue! Yay for removing useless code. ........ ................

2009-06-25 21:08 +0000 [r203379]  Russell Bryant <russell@digium.com>

	* /, main/features.c: Merged revisions 203376 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r203376 | russell | 2009-06-25 16:04:55 -0500 (Thu, 25 Jun 2009)
	  | 16 lines Merged revisions 203375 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r203375 | russell | 2009-06-25 16:02:18 -0500 (Thu, 25 Jun 2009)
	  | 9 lines Fix a case where CDR answer time could be before the
	  start time involving parking. (closes issue #13794) Reported by:
	  davidw Patches: 13794.patch uploaded by murf (license 17)
	  13794.patch.160 uploaded by murf (license 17) Tested by: murf,
	  dbrooks ........ ................

2009-06-25 19:27 +0000 [r203276]  Jason Parker <jparker@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 203258 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r203258 | qwell | 2009-06-25 14:22:46 -0500 (Thu, 25 Jun 2009) |
	  10 lines Unmute when we get a dtmfup (we muted on dtmfdown)
	  event. This would occasionally cause one-way audio when using
	  hardware DTMF detection. (closes issue #14761) Reported by:
	  tzafrir Patches: v1-14761.patch uploaded by dimas (license 88)
	  Tested by: tzafrir, dimas ........

2009-06-25 16:08 +0000 [r203119]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 203116 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r203116 | russell | 2009-06-25 11:04:10 -0500 (Thu, 25 Jun 2009)
	  | 18 lines Merged revisions 203115 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r203115 | russell | 2009-06-25 11:02:16 -0500 (Thu, 25 Jun 2009)
	  | 11 lines Resolve a crash related to a T.38 reinvite race
	  condition. This change resolves a crash observed locally during
	  some T.38 testing. A call was set up using a call file, and when
	  the T.38 reinvite came in, the channel state was still
	  AST_STATE_DOWN. The reason is explained by a comment in the code
	  that previously lived in the handling of AST_STATE_RINGING. This
	  change modifies the logic to handle the same race condition for
	  any channel state that is not UP. (closes ABE-1895) ........
	  ................

2009-06-24 21:27 +0000 [r203077]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 203037 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r203037 | rmudgett | 2009-06-24 16:08:55 -0500
	  (Wed, 24 Jun 2009) | 15 lines Merged revisions 203036 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r203036 | rmudgett | 2009-06-24 16:01:43 -0500 (Wed, 24 Jun 2009)
	  | 8 lines Improved chan_dahdi.conf pritimer error checking. Valid
	  format is: pritimer=timer_name,timer_value * Fixed segfault if
	  the ',' is missing. * Completely check the range returned by
	  pri_timer2idx() to prevent possible access outside array bounds.
	  ........ ................

2009-06-24 18:30 +0000 [r202970]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 202967 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r202967 | mmichelson | 2009-06-24 13:29:10 -0500 (Wed, 24 Jun
	  2009) | 9 lines Merged revisions 202966 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r202966 | mmichelson | 2009-06-24 13:28:47 -0500 (Wed, 24 Jun
	  2009) | 3 lines Use the handy UNLINK macro instead of hand-coding
	  the same thing in-line. ........ ................

2009-06-24 18:11 +0000 [r202928]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 202925 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r202925 |
	  file | 2009-06-24 15:08:17 -0300 (Wed, 24 Jun 2009) | 2 lines
	  Ensure the default settings are applied for T.38 when we set it
	  up for a peer. ........

2009-06-23 23:58 +0000 [r202842]  Sean Bright <sean@malleable.com>

	* doc/tex/cdrdriver.tex, /, doc/tex/billing.tex: Merged revisions
	  202840-202841 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r202840 |
	  seanbright | 2009-06-23 19:53:45 -0400 (Tue, 23 Jun 2009) | 1
	  line Remove some trailing whitespace before making content
	  changes. ........ r202841 | seanbright | 2009-06-23 19:57:07
	  -0400 (Tue, 23 Jun 2009) | 1 line Change some section names in
	  the CDR tex documentation. ........

2009-06-23 22:47 +0000 [r202805]  Russell Bryant <russell@digium.com>

	* doc/tex/cdrdriver.tex, /: Merged revisions 202804 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r202804 | russell | 2009-06-23 17:47:26 -0500 (Tue, 23 Jun 2009)
	  | 2 lines Clean up section hierarchy for the CDR chapter.
	  ........

2009-06-23 22:12 +0000 [r202765]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 202761 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r202761 | mattf | 2009-06-23 17:08:43 -0500 (Tue, 23 Jun 2009) |
	  1 line I could have sworn I committed this patch ages ago, but...
	  bug fix with setting NAI properly on linksets in certain
	  situations. ........

2009-06-23 16:33 +0000 [r202673]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 202672 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r202672 | dvossel | 2009-06-23 11:31:30 -0500 (Tue, 23 Jun 2009)
	  | 18 lines Merged revisions 202671 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r202671 | dvossel | 2009-06-23 11:28:46 -0500 (Tue, 23 Jun 2009)
	  | 12 lines MWI NOTIFY contains a wrong URI if Asterisk listens to
	  non-standard port and transport (closes issue #14659) Reported
	  by: klaus3000 Patches: patch_chan_sip_fixMWIuri_1.4.txt uploaded
	  by klaus3000 (license 65) mwi_port-transport_trunk.diff uploaded
	  by dvossel (license 671) Tested by: dvossel, klaus3000 Review:
	  https://reviewboard.asterisk.org/r/288/ ........ ................

2009-06-22 20:19 +0000 [r202495-202511]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 202497 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r202497 | russell | 2009-06-22 15:11:04 -0500 (Mon, 22 Jun 2009)
	  | 11 lines Merged revisions 202496 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r202496 | russell | 2009-06-22 15:08:53 -0500 (Mon, 22 Jun 2009)
	  | 4 lines Report CallerID change during a masquerade. Reported
	  by: markster ........ ................

	* /, channels/chan_sip.c: Merged revisions 202415 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r202415 | russell | 2009-06-22 11:05:08 -0500 (Mon, 22 Jun 2009)
	  | 9 lines Merged revisions 202414 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r202414 | russell | 2009-06-22 11:00:00 -0500 (Mon, 22 Jun 2009)
	  | 2 lines Make Polycom subscription type override check more
	  explicit. ........ ................

2009-06-22 16:31 +0000 [r202473]  Sean Bright <sean@malleable.com>

	* cdr/cdr_sqlite3_custom.c, /: Merged revisions 202417 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r202417 | seanbright | 2009-06-22 12:09:50 -0400 (Mon, 22 Jun
	  2009) | 4 lines Fix lock usage in cdr_sqlite3_custom to avoid
	  potential crashes during reload. Pointed out by Russell while
	  working on the CEL branch. ........

2009-06-22 15:37 +0000 [r202411]  David Vossel <dvossel@digium.com>

	* main/loader.c, /, include/asterisk/module.h: Merged revisions
	  202410 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r202410 |
	  dvossel | 2009-06-22 10:33:35 -0500 (Mon, 22 Jun 2009) | 5 lines
	  attempting to load running modules Modules placed in the priority
	  heap for loading were not properly removed from the linked list.
	  This resulted in some modules attempting to load twice. ........

2009-06-22 15:17 +0000 [r202340-202346]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 202343 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r202343 | mmichelson | 2009-06-22 09:58:24 -0500 (Mon, 22 Jun
	  2009) | 36 lines Merged revisions 202341-202342 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r202341 | mmichelson | 2009-06-22 09:42:55 -0500 (Mon, 22 Jun
	  2009) | 26 lines Fix a situation in which Asterisk would not stop
	  retransmitting 487s. If a CANCEL were received by Asterisk, we
	  would send a 487 in response to the original INVITE and a 200 OK
	  for the CANCEL. If there were a network hiccup which caused the
	  200 OK and the 487 to be lost, then the UA communicating with
	  Asterisk may try to retransmit its CANCEL. Asterisk's response to
	  this used to be to try sending another 487 to the canceled INVITE
	  and another 200 OK to the CANCEL. The problem here is that the
	  originally-sent 487 was sent "reliably" meaning that it will be
	  retransmitted until it is received properly. So when we receive
	  the second CANCEL it is likely that the first batch of 487s we
	  sent is still going strong and reaches the UA. The result was
	  that the second set of 487s would be retransmitted constantly
	  until the maximum number of retries had been reached. The fix for
	  this is that if we receive a second CANCEL for an INVITE, then we
	  cancel the retransmission of the first set of 487s and start a
	  second set. This causes the dialog to be terminated reasonably.
	  (closes issue #14584) Reported by: klaus3000 Patches:
	  14584_v2.patch uploaded by mmichelson (license 60) Tested by:
	  klaus3000 ........ r202342 | mmichelson | 2009-06-22 09:44:58
	  -0500 (Mon, 22 Jun 2009) | 3 lines Remove an extra debug line
	  left from previous commit. ........ ................

	* /, channels/chan_sip.c: Merged revisions 202337 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r202337 | mmichelson | 2009-06-22 09:35:09 -0500 (Mon, 22 Jun
	  2009) | 31 lines Merged revisions 202336 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r202336 | mmichelson | 2009-06-22 09:34:05 -0500 (Mon, 22 Jun
	  2009) | 25 lines Fix a possible infinite loop in SDP parsing
	  during glare situation. There was a while loop in
	  get_ip_and_port_from_sdp which was controlled by a call to
	  get_sdp_iterate. The loop would exit either if what we were
	  searching for was found or if the return was NULL. The problem is
	  that get_sdp_iterate never returns NULL. This means that if what
	  we were searching for was not present, the loop would run
	  infinitely. This modification of the loop fixes the problem.
	  (closes issue #15213) Reported by: schmidts (closes issue #15349)
	  Reported by: samy (closes issue #14464) Reported by: pj (closes
	  issue #15345) Reported by: aragon Patches: sip_inf_loop.patch
	  uploaded by mmichelson (license 60) Tested by: aragon ........
	  ................

2009-06-21 16:16 +0000 [r202261-202265]  Russell Bryant <russell@digium.com>

	* cdr/cdr_manager.c, /: Merged revisions 202262 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r202262 |
	  russell | 2009-06-21 11:11:48 -0500 (Sun, 21 Jun 2009) | 2 lines
	  Fix possibility of crashiness during reload in custom fields
	  handling. ........

	* cdr/cdr_manager.c, /: Merged revisions 202258 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r202258 |
	  russell | 2009-06-21 11:00:23 -0500 (Sun, 21 Jun 2009) | 2 lines
	  Standardize return values of load_config() so reload() doesn't
	  report an error on success. ........

2009-06-20 19:14 +0000 [r202186]  Sean Bright <sean@malleable.com>

	* /, apps/app_fax.c: Merged revisions 202183 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r202183 |
	  seanbright | 2009-06-20 15:09:47 -0400 (Sat, 20 Jun 2009) | 5
	  lines Fix version detection for API changes in spandsp. (closes
	  issue #15355) Reported by: deuffy ........

2009-06-19 21:08 +0000 [r202007]  Matthew Nicholson <mnicholson@digium.com>

	* channels/chan_sip.c: Added deadlock protection to
	  try_suggested_sip_codec in chan_sip.c. Review:
	  https://reviewboard.asterisk.org/r/287/

2009-06-19 20:26 +0000 [r201995]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 201994 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r201994 | dvossel | 2009-06-19 15:24:37 -0500
	  (Fri, 19 Jun 2009) | 14 lines Merged revisions 201993 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r201993 | dvossel | 2009-06-19 15:22:02 -0500 (Fri, 19 Jun 2009)
	  | 8 lines timestamp was being converted to host order as a short
	  rather than a long (closes issue #15361) Reported by: ffloimair
	  Patches: ts_issue.diff uploaded by dvossel (license 671) ........
	  ................

2009-06-19 15:49 +0000 [r201785-201906]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_odbc.c, /: Merged revisions 201904 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r201904 | tilghman | 2009-06-19 10:47:55 -0500 (Fri, 19 Jun 2009)
	  | 4 lines Fix 2 typos and add support for wide character types.
	  Reported by Benny Amorsen via the asterisk-users mailing list.
	  http://lists.digium.com/pipermail/asterisk-users/2009-June/233622.html
	  ........

	* /, main/features.c: Merged revisions 201829 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r201829 | tilghman | 2009-06-18 19:43:41 -0500 (Thu, 18 Jun 2009)
	  | 13 lines Merged revisions 201828 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r201828 | tilghman | 2009-06-18 19:40:41 -0500 (Thu, 18 Jun 2009)
	  | 6 lines If the "h" extension fails, give it another chance in
	  main/pbx.c. If the "h" extension fails, give it another chance in
	  main/pbx.c, when it returns from the bridge code. Fixes an issue
	  where the "h" extension may occasionally not fire, when a Dial is
	  executed from a Macro. Debugged in #asterisk with user tompaw.
	  ........ ................

	* /, apps/Makefile: Merged revisions 201783 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r201783 |
	  tilghman | 2009-06-18 15:52:36 -0500 (Thu, 18 Jun 2009) | 6 lines
	  One of the changes in 1.6.1 was to allow app_directory to use
	  functionality within app_voicemail for directory functions. It is
	  therefore no longer necessary for app_directory to be linked
	  against the ODBC libraries (and it never was necessary for
	  app_directory to be linked against IMAP, though it was). ........

2009-06-18 16:44 +0000 [r201679]  David Vossel <dvossel@digium.com>

	* channels/misdn/isdn_lib.c, utils/conf2ael.c, main/ast_expr2.c,
	  utils/stereorize.c, main/ast_expr2f.c, res/ael/ael_lex.c,
	  utils/ael_main.c, utils/extconf.c, channels/xpmr/xpmr.c,
	  pbx/pbx_config.c, res/res_config_ldap.c, apps/app_rpt.c,
	  main/asterisk.c, codecs/gsm/src/gsm_destroy.c, /,
	  channels/h323/ast_h323.cxx: Merged revisions 201678 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r201678 | dvossel | 2009-06-18 11:37:42 -0500 (Thu, 18 Jun 2009)
	  | 11 lines fixes some memory leaks and redundant conditions
	  (closes issue #15269) Reported by: contactmayankjain Patches:
	  patch.txt uploaded by contactmayankjain (license 740)
	  memory_leak_stuff.trunk.diff uploaded by dvossel (license 671)
	  Tested by: contactmayankjain, dvossel ........

2009-06-18 15:40 +0000 [r201614]  Russell Bryant <russell@digium.com>

	* res/res_musiconhold.c, /: Merged revisions 201610 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r201610 | russell | 2009-06-18 10:27:10 -0500
	  (Thu, 18 Jun 2009) | 36 lines Merged revisions 201600 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r201600 | russell | 2009-06-18 10:24:31 -0500 (Thu, 18 Jun 2009)
	  | 29 lines Fix memory corruption and leakage related reloads of
	  non files mode MoH classes. For Music on Hold classes that are
	  not files mode, meaning that we are executing an application that
	  will feed us audio data, we use a thread to monitor the external
	  application and read audio from it. This thread also makes use of
	  the MoH class object. In the MoH class destructor, we used
	  pthread_cancel() to ask the thread to exit. Unfortunately, the
	  code did not wait to ensure that the thread actually went away.
	  What needed to be done is a pthread_join() to ensure that the
	  thread fully cleans up before we proceed. By adding this one
	  line, we resolve two significant problems: 1) Since the thread
	  was never joined, it never fully goes away. So, on every reload
	  of non-files mode MoH, an unused thread was sticking around. 2)
	  There was a race condition here where the application monitoring
	  thread could still try to access the MoH class, even though the
	  thread executing the MoH reload has already destroyed it. (issue
	  #15109) Reported by: jvandal (issue #15123) Reported by:
	  axisinternet (issue #15195) Reported by: amorsen (issue AST-208)
	  ........ ................

2009-06-18 15:23 +0000 [r201595]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 201570 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r201570 |
	  dvossel | 2009-06-18 10:16:05 -0500 (Thu, 18 Jun 2009) | 11 lines
	  parsing extension correctly from sip register lines If a
	  transport type was specified, but no extension, parsing of the
	  extension would return whatever was after the transport rather
	  than defaulting to 's'. (closes issue #15111) Reported by: ffs
	  Patches: chan_sip.c_register-parser.patch uploaded by ffs
	  (license 730) Tested by: ffs, dvossel ........

2009-06-17 21:33 +0000 [r201533]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 201531 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r201531 | tilghman | 2009-06-17 16:31:39 -0500 (Wed, 17 Jun 2009)
	  | 7 lines Initialize additional variables, to prevent a possible
	  crash. (closes issue #15186) Reported by: ajohnson Patches:
	  20090528__issue15186.diff.txt uploaded by tilghman (license 14)
	  Tested by: ajohnson ........

2009-06-17 20:12 +0000 [r201461-201465]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 201462 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r201462 |
	  mmichelson | 2009-06-17 15:10:01 -0500 (Wed, 17 Jun 2009) | 12
	  lines Fix problem with no audio due to ignoring the SDP. A recent
	  change to our SDP version comparison made audio not function on
	  some calls. This was because of a test wherein we were trying to
	  see if an unsigned value was less than 0. This is a dumb
	  comparison and arguably the compiler should have warned about it.
	  Alas, though, it slipped past. Now it's fixed by changing the
	  variable to be a signed type. Found by several developers. Tested
	  by mnicholson and dbrooks. ........

	* main/channel.c, /: Merged revisions 201458 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r201458 | mmichelson | 2009-06-17 15:04:12 -0500 (Wed, 17 Jun
	  2009) | 15 lines Merged revisions 201450 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r201450 | mmichelson | 2009-06-17 14:59:31 -0500 (Wed, 17 Jun
	  2009) | 9 lines Change the datastore traversal in
	  ast_do_masquerade to use a safe list traversal. It is possible
	  for datastore fixup functions to remove the datastore from the
	  list and free it. In particular, the queue_transfer_fixup in
	  app_queue does this. While I don't yet know of this causing any
	  crashes, it certainly could. Found while discussing a separate
	  issue with Brian Degenhardt. ........ ................

2009-06-17 20:01 +0000 [r201447-201454]  David Vossel <dvossel@digium.com>

	* doc/datastores.txt, /: Merged revisions 201453 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r201453 |
	  dvossel | 2009-06-17 15:00:51 -0500 (Wed, 17 Jun 2009) | 3 lines
	  ast_channel_datastore_alloc is no longer used. updating
	  datastores.txt to reflect that. ........

	* apps/app_mixmonitor.c, /: Merged revisions 201445 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r201445 | dvossel | 2009-06-17 14:45:35 -0500
	  (Wed, 17 Jun 2009) | 25 lines Merged revisions 201423 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r201423 | dvossel | 2009-06-17 14:28:12 -0500 (Wed, 17 Jun 2009)
	  | 19 lines StopMixMonitor race condition (not giving up file
	  immediately) StopMixMonitor only indicates to the MixMonitor
	  thread to stop writing to the file. It does not guarantee that
	  the recording's file handle is available to the dialplan
	  immediately after execution. This results in a race condition. To
	  resolve this, the filestream pointer is placed in a datastore on
	  the channel. When StopMixMonitor is called, the datastore is
	  retrieved from the channel and the filestream is closed
	  immediately before returning to the dialplan. Documentation
	  indicating the use of StopMixMonitor to free files has been
	  updated as well. (closes issue #15259) Reported by: travisghansen
	  Tested by: dvossel Review:
	  https://reviewboard.asterisk.org/r/283/ ........ ................

2009-06-17 19:49 +0000 [r201446]  David Brooks <dbrooks@digium.com>

	* /, channels/chan_sip.c: Merged revisions 201381 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r201381 | dbrooks | 2009-06-17 14:15:07 -0500 (Wed, 17 Jun 2009)
	  | 16 lines Merged revisions 201380 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r201380 | dbrooks | 2009-06-17 13:45:50 -0500 (Wed, 17 Jun 2009)
	  | 9 lines Checks for NULL sip_pvt pointer in
	  chan_sip.c->acf_channel_read() Zombie channels could be passed,
	  and chan_sip.c wasn't checking for it. Could crash Asterisk. Now
	  checking for NULL pointer. (closes issue #15330) Reported by:
	  okrief Tested by: dbrooks ........ ................

2009-06-17 15:25 +0000 [r201360]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 201344 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r201344 |
	  dvossel | 2009-06-17 10:20:26 -0500 (Wed, 17 Jun 2009) | 16 lines
	  SIP registry ref count error During a sip reload, the list of
	  sip_registry objects are supposed to be traversed, unlinked, and
	  destroyed, but destruction never takes place due to a ref
	  counting error. This causes a memory leak when registry items are
	  removed from sip.conf and reloaded. While the registries are
	  removed from the global list, they are not removed from the
	  scheduler. Because of this, SIP register attempts continue to be
	  sent out for the item even though it may no longer be in the
	  .conf. (closes issue #15295) Reported by: amorsen Review:
	  https://reviewboard.asterisk.org/r/282/ ........

2009-06-17 12:06 +0000 [r201265]  Kevin P. Fleming <kpfleming@digium.com>

	* /, include/asterisk/linkedlists.h: Merged revisions 201262 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r201262 | kpfleming | 2009-06-17 07:04:17 -0500
	  (Wed, 17 Jun 2009) | 15 lines Merged revisions 201261 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r201261 | kpfleming | 2009-06-17 07:03:25 -0500 (Wed, 17 Jun
	  2009) | 9 lines Correct AST_LIST_APPEND_LIST behavior when list
	  to be appended is empty. When the list to be appended is empty,
	  and the list to be appended to is *not*, AST_LIST_APPEND_LIST
	  would actually cause the target list to become broken, and no
	  longer have a pointer to its last entry. This patch fixes the
	  problem. (reported by Stanislaw Pitucha on the asterisk-dev
	  mailing list) ........ ................

2009-06-16 22:30 +0000 [r201224]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 201223 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r201223 |
	  dvossel | 2009-06-16 17:29:30 -0500 (Tue, 16 Jun 2009) | 2 lines
	  fix issue with build_contact introduced by the "SIP trasnport
	  type issues" commit ........

2009-06-16 19:47 +0000 [r200990-201097]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/frame.h, apps/app_chanspy.c,
	  apps/app_mixmonitor.c, main/channel.c, main/autoservice.c,
	  main/frame.c, /, apps/app_meetme.c, main/slinfactory.c,
	  include/asterisk/linkedlists.h, main/file.c,
	  include/asterisk/channel.h: Merged revisions 201056 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r201056 | kpfleming | 2009-06-16 13:54:30 -0500
	  (Tue, 16 Jun 2009) | 18 lines Merged revisions 200991 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r200991 | kpfleming | 2009-06-16 12:05:38 -0500 (Tue, 16 Jun
	  2009) | 11 lines Improve support for media paths that can
	  generate multiple frames at once. There are various media paths
	  in Asterisk (codec translators and UDPTL, primarily) that can
	  generate more than one frame to be generated when the application
	  calling them expects only a single frame. This patch addresses a
	  number of those cases, at least the primary ones to solve the
	  known problems. In addition it removes the broken TRACE_FRAMES
	  support, fixes a number of bugs in various frame-related API
	  functions, and cleans up various code paths affected by these
	  changes. https://reviewboard.asterisk.org/r/175/ ........
	  ................

	* /, configure, autoconf/ast_gcc_attribute.m4, configure.ac: Merged
	  revisions 201090 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r201090 |
	  kpfleming | 2009-06-16 14:27:12 -0500 (Tue, 16 Jun 2009) | 5
	  lines Another minor fix to compiler attribute checking.
	  Defaulting to 'static' for the function scope was bad... so
	  remove it. ........

	* /, configure, autoconf/ast_gcc_attribute.m4, configure.ac: Merged
	  revisions 200985 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200985 |
	  kpfleming | 2009-06-16 11:32:36 -0500 (Tue, 16 Jun 2009) | 7
	  lines Fix problems with new compiler attribute checking in
	  configure script. The last changes to ast_gcc_attribute.m4 caused
	  some problems checking for various attributes, because the scope
	  of the symbol the attribute is applied to can be important; this
	  patch allows the scope to be specified for the check. ........

2009-06-16 16:28 +0000 [r200984]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 200946 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200946 |
	  dvossel | 2009-06-16 11:03:30 -0500 (Tue, 16 Jun 2009) | 32 lines
	  SIP transport type issues What this patch addresses: 1.
	  ast_sip_ouraddrfor() by default binds to the UDP address/port
	  reguardless if the sip->pvt is of type UDP or not. Now when no
	  remapping is required, ast_sip_ouraddrfor() checks the sip_pvt's
	  transport type, attempting to set the address and port to the
	  correct TCP/TLS bindings if necessary. 2. It is not necessary to
	  send the port number in the Contact header unless the port is
	  non-standard for the transport type. This patch fixes this and
	  removes the todo note. 3. In sip_alloc(), the default dialog
	  built always uses transport type UDP. Now sip_alloc() looks at
	  the sip_request (if present) and determines what transport type
	  to use by default. 4. When changing the transport type of a
	  sip_socket, the file descriptor must be set to -1 and in some
	  cases the tcptls_session's ref count must be decremented and set
	  to NULL. I've encountered several issues associated with this
	  process and have created a function, set_socket_transport(), to
	  handle the setting of the socket type. (closes issue #13865)
	  Reported by: st Patches: dont_add_port_if_tls.patch uploaded by
	  Kristijan (license 753) 13865.patch uploaded by mmichelson
	  (license 60) tls_port_v5.patch uploaded by vrban (license 756)
	  transport_issues.diff uploaded by dvossel (license 671) Tested
	  by: mmichelson, Kristijan, vrban, jmacz, dvossel Review:
	  https://reviewboard.asterisk.org/r/278/ ........

2009-06-16 16:05 +0000 [r200948]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_voicemail.c, /: Merged revisions 200943 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r200943 | mvanbaak | 2009-06-16 17:51:36 +0200 (Tue, 16 Jun 2009)
	  | 9 lines add FILE_STORAGE to Voicemail Build Options Voicemail
	  can only use one storage module at the moment. Because it's
	  unclear that selecting one of the storage modules in menuselect
	  will disable filesystem storage we now have a FILE_STORAGE option
	  that conflicts with the other modules. (closes issue #15333)
	  ........

2009-06-16 12:55 +0000 [r200842]  Eliel C. Sardanons <eliels@gmail.com>

	* res/res_smdi.c, /: Merged revisions 200841 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200841 |
	  eliel | 2009-06-16 08:32:00 -0400 (Tue, 16 Jun 2009) | 6 lines
	  Show the interface name on error, if it is not found. If the
	  smdiport specified is not found, show the interface name instead
	  of '(null)'. ........

2009-06-16 02:41 +0000 [r200807]  Moises Silva <moises.silva@gmail.com>

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample, /: Merged
	  revisions 200799 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200799 |
	  moy | 2009-06-15 21:24:30 -0500 (Mon, 15 Jun 2009) | 2 lines keep
	  backwards compatible chan_dahdi with older openr2 versions by not
	  using the new skip category feature unless supported ........

2009-06-16 01:30 +0000 [r200690-200765]  Kevin P. Fleming <kpfleming@digium.com>

	* /, configure, include/asterisk/autoconfig.h.in,
	  autoconf/ast_gcc_attribute.m4: Merged revisions 200764 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r200764 | kpfleming | 2009-06-15 20:28:08 -0500 (Mon, 15
	  Jun 2009) | 11 lines Ensure that configure-script testing for
	  compiler attributes actually works. The configure script tests
	  for compiler attributes didn't actually enable enough warnings or
	  provide a proper test harness to determine whether the compiler
	  supports the attribute in question or not; this caused gcc 4.1 to
	  report that it supports 'weakref', but it doesn't actually
	  support it in the way that is needed for our optional API
	  mechanism. The new configure script test will properly
	  distinguish between full support and partial support for this
	  attribute, among others. ........

	* CHANGES, /: Merged revisions 200726 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200726 |
	  kpfleming | 2009-06-15 20:03:22 -0500 (Mon, 15 Jun 2009) | 6
	  lines Document the new automatic 'ignoresdpversion' behavior.
	  Asterisk will now automatically ignore incorrect incoming SDP
	  version numbers when necessary to complete a T.38 re-INVITE
	  operation. ........

	* /, channels/chan_sip.c: Merged revisions 200689 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200689 |
	  kpfleming | 2009-06-15 15:42:38 -0500 (Mon, 15 Jun 2009) | 11
	  lines Accept T.38 re-INVITE responses with invalid SDP versions.
	  This commit changes the 'incoming SDP version' check logic a bit
	  more; when 'ignoresdpversion' is *not* set for a peer, if we
	  initiate a re-INVITE to switch to T.38, we'll always accept the
	  peer's SDP response, even if they don't properly increment the
	  SDP version number as they should. If this situation occurs, a
	  warning message will be generated suggesting that the peer's
	  configuration be changed to include the 'ignoresdpversion'
	  configuration option (although ideally they'd fix their SIP
	  implementation to be RFC compliant). AST-221 ........

2009-06-15 15:23 +0000 [r200517]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 200514 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r200514 | mmichelson | 2009-06-15 10:22:11 -0500 (Mon, 15 Jun
	  2009) | 11 lines Merged revisions 200513 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r200513 | mmichelson | 2009-06-15 10:21:46 -0500 (Mon, 15 Jun
	  2009) | 5 lines Add INFO to our allowed methods so that endpoints
	  know they may send it to us. AST-223 ........ ................

2009-06-14 06:33 +0000 [r200512]  Moises Silva <moises.silva@gmail.com>

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample, /,
	  build_tools/menuselect-deps.in: Merged revisions 200477 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r200477 | moy | 2009-06-14 01:13:48 -0500 (Sun, 14 Jun
	  2009) | 3 lines added openr2 to menuselect-deps.in, recent commit
	  in menuselect made me realize this was never done but was working
	  anyways also added support for skip category request feature of
	  openr2 and updated chan_dahdi.conf.sample ........

2009-06-12 19:08 +0000 [r200364]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /: Merged revisions 200361 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r200361 | mmichelson | 2009-06-12 14:07:51 -0500 (Fri, 12 Jun
	  2009) | 16 lines Merged revisions 200360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r200360 | mmichelson | 2009-06-12 14:06:41 -0500 (Fri, 12 Jun
	  2009) | 10 lines Suppress a warning message and give a better
	  return code when generating inband ringing after a call is
	  answered. (closes issue #15158) Reported by: madkins Patches:
	  15158.patch uploaded by mmichelson (license 60) Tested by:
	  madkins ........ ................

2009-06-12 02:20 +0000 [r200198-200255]  Sean Bright <sean@malleable.com>

	* contrib/init.d/rc.debian.asterisk, /: Merged revisions 200254 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r200254 | seanbright | 2009-06-11 22:20:19 -0400 (Thu,
	  11 Jun 2009) | 5 lines Call chgrp instead of chown when setting
	  run directory group ownership. (issue #13153) Reported by:
	  pabelanger ........

	* Makefile, /: Merged revisions 199781 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r199781 |
	  seanbright | 2009-06-09 14:08:53 -0400 (Tue, 09 Jun 2009) | 2
	  lines Fix all of the parallel build warnings issued when running
	  make -j#. ........

	* /: Undo block of revision 199782 (will be merging it momentarily)

2009-06-11 21:35 +0000 [r200172]  Terry Wilson <twilson@digium.com>

	* main/rtp.c: Don't access rtp->rtcp->* if rtp->rtcp is null

2009-06-11 21:18 +0000 [r200154]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 200146 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200146 |
	  mmichelson | 2009-06-11 16:17:14 -0500 (Thu, 11 Jun 2009) | 5
	  lines Fix a crash due to a potentially NULL p->options. Thanks to
	  mnicholson for pointing it out. ........

2009-06-11  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-beta3

2009-06-11 12:19 +0000 [r200051]  Leif Madsen <lmadsen@digium.com>

	* build_tools/make_version_h, /, build_tools/make_version_c: Merged
	  revisions 200039 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r200039 |
	  lmadsen | 2009-06-11 08:15:09 -0400 (Thu, 11 Jun 2009) | 8 lines
	  Fix path for .flavor and .version (issue #14737) Reported by:
	  davidw Patches: flavor.patch uploaded by davidw (license 780)
	  Tested by: davidw ........

2009-06-10 20:37 +0000 [r199998]  David Brooks <dbrooks@digium.com>

	* main/pbx.c, /: Fixes the argument order in definition of
	  new_find_extension(). In the definition of new_find_extension(),
	  the arguments 'callerid' and 'label' were swapped. The prototype
	  declaration and all calls to the function are ordered 'callerid'
	  then 'label', but the function itself was ordered 'label' then
	  'callerid'. (closes issue #15303) Reported by: JimDickenson

2009-06-10 20:18 +0000 [r199966]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 199958 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r199958 |
	  mmichelson | 2009-06-10 15:15:48 -0500 (Wed, 10 Jun 2009) | 6
	  lines Only try to use the invite_branch on outgoing INVITEs with
	  auth credentials. I have added a comment to the code to help ease
	  understanding of the logic here as well. ........

2009-06-10 16:13 +0000 [r199860]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk/utils.h, /: Merged revisions 199857 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r199857 | seanbright | 2009-06-10 12:10:23 -0400
	  (Wed, 10 Jun 2009) | 9 lines Merged revisions 199856 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r199856 | seanbright | 2009-06-10 12:08:35 -0400 (Wed,
	  10 Jun 2009) | 2 lines __WORDSIZE is not available on all
	  platforms, so use sizeof(void *) instead. ........
	  ................

2009-06-09 20:48 +0000 [r199744-199819]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 199818 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r199818 |
	  dvossel | 2009-06-09 15:47:57 -0500 (Tue, 09 Jun 2009) | 11 lines
	  CLI NOTIFY sending wrong transport type. SIP's cli NOTIFY command
	  only used UDP rather than copying the transport type from the
	  peer. (closes issue #15283) Reported by: jthurman Patches:
	  sip-notify-tcp-svn199728.patch uploaded by jthurman (license 614)
	  Tested by: jthurman, dvossel ........

	* main/loader.c, /, res/res_timing_pthread.c,
	  include/asterisk/module.h, res/res_timing_dahdi.c,
	  res/res_timing_timerfd.c: Merged revisions 199743 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r199743 | dvossel | 2009-06-09 11:22:04 -0500 (Tue, 09 Jun 2009)
	  | 11 lines module load priority This patch adds the option to
	  give a module a load priority. The value represents the order in
	  which a module's load() function is initialized. The lower the
	  value, the higher the priority. The value is only checked if the
	  AST_MODFLAG_LOAD_ORDER flag is set. If the AST_MODFLAG_LOAD_ORDER
	  flag is not set, the value will never be read and the module will
	  be given the lowest possible priority on load. Since some modules
	  are reliant on a timing interface, the timing modules have been
	  given a high load priorty. (closes issue #15191) Reported by:
	  alecdavis Tested by: dvossel Review:
	  https://reviewboard.asterisk.org/r/262/ ........

2009-06-08 19:39 +0000 [r199634]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk/utils.h, /: Merged revisions 199630 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r199630 | seanbright | 2009-06-08 15:33:09 -0400
	  (Mon, 08 Jun 2009) | 32 lines Merged revisions 199626,199628 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r199626 | seanbright | 2009-06-08 15:24:32 -0400 (Mon, 08 Jun
	  2009) | 21 lines Increase the size of our thread stack on 64 bit
	  processors. We were setting the stack size for each thread to
	  240KB regardless of architecture, which meant that in some
	  scenarios we actually had less available stack space on 64 bit
	  processors (pointers use 8 bytes instead of 4). So now we
	  calculate the stack size we reserve based on the platform's
	  __WORDSIZE, which gives us: 32 bit -> 240KB 64 bit -> 496KB 128
	  bit -> 1008KB (that's right, we're ready for 128 bit processors)
	  Patch typed by me but written by several members of
	  #asterisk-dev, including Kevin, Tilghman, and Qwell. (closes
	  issue #14932) Reported by: jpiszcz Patches:
	  06052009_issue14932.patch uploaded by seanbright (license 71)
	  Tested by: seanbright ........ r199628 | seanbright | 2009-06-08
	  15:28:33 -0400 (Mon, 08 Jun 2009) | 2 lines Fix a typo in the
	  stack size calculation just introduced. ........ ................

2009-06-08 17:42 +0000 [r199591]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Recorded merge of revisions 199588 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r199588 | mmichelson | 2009-06-08 12:32:04 -0500 (Mon,
	  08 Jun 2009) | 9 lines Fix a deadlock that could occur when
	  setting rtp stats on SIP calls. (closes issue #15143) Reported
	  by: cristiandimache Patches: 15143.patch uploaded by mmichelson
	  (license 60) Tested by: cristiandimache ........

2009-06-06 21:39 +0000 [r199369]  Russell Bryant <russell@digium.com>

	* Makefile, /: Merged revisions 199368 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r199368 |
	  russell | 2009-06-06 16:38:54 -0500 (Sat, 06 Jun 2009) | 2 lines
	  Switch from "echo -n" to printf. On my mac, the -n was just
	  getting printed out. ........

2009-06-05 21:25 +0000 [r199299]  David Vossel <dvossel@digium.com>

	* include/asterisk/devicestate.h, /, main/devicestate.c: Merged
	  revisions 199298 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r199298 | dvossel | 2009-06-05 16:21:22 -0500 (Fri, 05 Jun 2009)
	  | 21 lines Merged revisions 199297 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r199297 | dvossel | 2009-06-05 16:19:56 -0500 (Fri, 05 Jun 2009)
	  | 14 lines Fixes issue with hints giving unexpected results.
	  Hints with two or more devices that include ONHOLD gave
	  unexpected results. (closes issue #15057) Reported by:
	  p_lindheimer Patches: onhold_trunk.diff uploaded by dvossel
	  (license 671) pbx.c.1.4.patch uploaded by p (license 558)
	  devicestate.c.trunk.patch uploaded by p (license 671) Tested by:
	  p_lindheimer, dvossel Review:
	  https://reviewboard.asterisk.org/r/254/ ........ ................

2009-06-05 13:52 +0000 [r199230]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 199227 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r199227 | mmichelson | 2009-06-05 08:51:08 -0500 (Fri, 05 Jun
	  2009) | 14 lines Correct "dahdi show channels" output when
	  specifying a group. Since a DAHDI channel may belong to multiple
	  groups, we need to use a bitwise and instead of equivalence to
	  determine whether to display the channel information. (closes
	  issue #15248) Reported by: gentian Patches: 15248.patch uploaded
	  by mmichelson (license 60) Tested by: gentian ........

2009-06-04 19:15 +0000 [r199140]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 199139 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r199139 | dvossel | 2009-06-04 14:10:16 -0500
	  (Thu, 04 Jun 2009) | 9 lines Merged revisions 199138 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r199138 | dvossel | 2009-06-04 14:00:15 -0500 (Thu, 04
	  Jun 2009) | 3 lines Additional updates to AST-2009-001 ........
	  ................

2009-06-04 14:53 +0000 [r199054]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk/_private.h, main/asterisk.c, main/loader.c, /:
	  Merged revisions 199051 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r199051 | seanbright | 2009-06-04 10:31:24 -0400 (Thu, 04 Jun
	  2009) | 47 lines Merged revisions 199022 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r199022 | seanbright | 2009-06-04 10:14:57 -0400 (Thu, 04 Jun
	  2009) | 40 lines Safely handle AMI connections/reload requests
	  that occur during startup. During asterisk startup, a lock on the
	  list of modules is obtained by the primary thread while each
	  module is initialized. Issue 13778 pointed out a problem with
	  this approach, however. Because the AMI is loaded before other
	  modules, it is possible for a module reload to be issued by a
	  connected client (via Action: Command), causing a deadlock. The
	  resolution for 13778 was to move initialization of the manager to
	  happen after the other modules had already been lodaded. While
	  this fixed this particular issue, it caused a problem for users
	  (like FreePBX) who call AMI scripts via an #exec in a
	  configuration file (See issue 15189). The solution I have come up
	  with is to defer any reload requests that come in until after the
	  server is fully booted. When a call comes in to ast_module_reload
	  (from wherever) before we are fully booted, the request is added
	  to a queue of pending requests. Once we are done booting up, we
	  then execute these deferred requests in turn. Note that I have
	  tried to make this a bit more intelligent in that it will not
	  queue up more than 1 request for the same module to be reloaded,
	  and if a general reload request comes in ('module reload') the
	  queue is flushed and we only issue a single deferred reload for
	  the entire system. As for how this will impact existing
	  installations - Before 13778, a reload issued before module
	  initialization was completed would result in a deadlock. After
	  13778, you simply couldn't connect to the manager during startup
	  (which causes problems with #exec-that-calls-AMI configuration
	  files). I believe this is a good general purpose solution that
	  won't negatively impact existing installations. (closes issue
	  #15189) (closes issue #13778) Reported by: p_lindheimer Patches:
	  06032009_15189_deferred_reloads.diff uploaded by seanbright
	  (license 71) Tested by: p_lindheimer, seanbright Review:
	  https://reviewboard.asterisk.org/r/272/ ........ ................

2009-06-03 15:24 +0000 [r198827-198886]  David Vossel <dvossel@digium.com>

	* main/channel.c, /, main/features.c, include/asterisk/channel.h:
	  Merged revisions 198856 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r198856 |
	  dvossel | 2009-06-02 16:17:49 -0500 (Tue, 02 Jun 2009) | 10 lines
	  Generic call forward api, ast_call_forward() The function
	  ast_call_forward() forwards a call to an extension specified in
	  an ast_channel's call_forward string. After an ast_channel is
	  called, if the channel's call_forward string is set this function
	  can be used to forward the call to a new channel and terminate
	  the original one. I have included this api call in both
	  channel.c's ast_request_and_dial() and feature.c's
	  feature_request_and_dial(). App_dial and app_queue already
	  contain call forward logic specific for their application and
	  options. (closes issue #13630) Reported by: festr Review:
	  https://reviewboard.asterisk.org/r/271/ ........

	* channels/chan_iax2.c, /: Merged revisions 198824 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r198824 | dvossel | 2009-06-02 12:55:35 -0500 (Tue, 02 Jun 2009)
	  | 8 lines fixes issue with channels not going down after transfer
	  Iax2 currently does not support native bridging if the timeoutms
	  value is set. We check for that in iax2_bridge, but then set
	  timeoutms to 0 by default. If the timeoutms is not provided it is
	  set to -1. By setting timeoutms to 0 it is processed causing a
	  bridging retry loop. (closes issue #15216) Reported by: oxymoron
	  Tested by: dvossel ........

2009-06-02 13:51 +0000 [r198794]  Joshua Colp <jcolp@digium.com>

	* configs/sip.conf.sample, /, channels/chan_sip.c: Merged revisions
	  198791 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r198791 |
	  file | 2009-06-02 10:48:06 -0300 (Tue, 02 Jun 2009) | 5 lines
	  Correct documentation for the register line, specifically where
	  the domain should be specified. (closes issue #14367) Reported
	  by: Nick_Lewis ........

2009-06-01 21:04 +0000 [r198730]  Russell Bryant <russell@digium.com>

	* channels/iax2-parser.c, /: Merged revisions 198729 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r198729 | russell | 2009-06-01 16:03:18 -0500 (Mon, 01 Jun 2009)
	  | 2 lines Tell the IAX2 parser about more control frame types.
	  ........

2009-06-01 18:44 +0000 [r198629]  Tilghman Lesher <tlesher@digium.com>

	* /, contrib/scripts/meetme.sql: Merged revisions 198626 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r198626 | tilghman | 2009-06-01 13:40:35 -0500 (Mon, 01
	  Jun 2009) | 2 lines Add information for new meetme realtime
	  fields ........

2009-05-31 17:53 +0000 [r198471]  Tilghman Lesher <tlesher@digium.com>

	* /, funcs/func_strings.c: Merged revisions 198470 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r198470 | tilghman | 2009-05-31 12:52:28 -0500 (Sun, 31 May 2009)
	  | 2 lines Fix documentation for FIELDQTY. ........

2009-05-31 01:48 +0000 [r198440]  Eliel C. Sardanons <eliels@gmail.com>

	* /, res/res_timing_dahdi.c: Merged revisions 198437 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r198437 | eliel | 2009-05-30 21:22:15 -0400 (Sat, 30 May 2009) |
	  11 lines Avoid a crash when res_timing_dahdi is unloaded but
	  wasn't properly loaded. if dahdi_test_timer() fails,
	  timing_funcs_handle remains NULL causing a crash when calling
	  ast_unregister_timing_interface() with a NULL pointer. (closes
	  issue #15234) Reported by: eliel Patches: timing_dahdi1.diff
	  uploaded by eliel (license 64) ........

2009-05-31 01:21 +0000 [r198436]  Russell Bryant <russell@digium.com>

	* res/res_smdi.c, /: Merged revisions 198312 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r198312 | russell | 2009-05-29 22:43:23 -0500 (Fri, 29 May 2009)
	  | 12 lines Merged revisions 198311 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r198311 | russell | 2009-05-29 22:42:46 -0500 (Fri, 29 May 2009)
	  | 5 lines Fix a crash that occurred when MWI SMDI messages
	  expired. (closes issue #14561) Reported by: cmoss28 ........
	  ................

2009-05-30 20:22 +0000 [r198297-198397]  Sean Bright <sean.bright@gmail.com>

	* res/res_jabber.c, /: Merged revisions 198375 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r198375 |
	  seanbright | 2009-05-30 16:11:33 -0400 (Sat, 30 May 2009) | 13
	  lines Properly terminate the receive buffer before sending to
	  iksemel. aji_io_recv takes the maximum number of bytes to read
	  (instead of the total buffer size), so we have to subtract 1 from
	  our buffer size. Without this, when we receive packets that are
	  larger than our buffer, iksemel will choke and things get wonky.
	  (closes issue #15232) Reported by: lp0 Patches:
	  05302009_res_jabber.c.patch uploaded by seanbright (license 71)
	  Tested by: seanbright, lp0 ........

	* res/res_jabber.c, /: Merged revisions 198371 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r198371 | seanbright | 2009-05-30 15:38:58 -0400 (Sat, 30 May
	  2009) | 19 lines Merged revisions 198370 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r198370 | seanbright | 2009-05-30 15:36:20 -0400 (Sat, 30 May
	  2009) | 12 lines Properly terminate AMI JabberSend response
	  messages. The response message (either Error or Success) needs an
	  extra trailing \r\n after the fields to inform the client that
	  the message is complete. (closes issue #14876) Reported by: srt
	  Patches: 05302009_1.4_res_jabber.c.diff uploaded by seanbright
	  (license 71) asterisk_14876.patch uploaded by srt (license 378)
	  trunk-14876-2.diff uploaded by phsultan (license 73) ........
	  ................

	* apps/app_dial.c, /: Merged revisions 198285 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r198285 | seanbright | 2009-05-29 23:26:06 -0400 (Fri, 29 May
	  2009) | 15 lines Merged revisions 198251 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r198251 | seanbright | 2009-05-29 22:46:41 -0400 (Fri, 29 May
	  2009) | 8 lines Treat an empty FORWARD_CONTEXT the same way we
	  treat a missing one. (closes issue #15056) Reported by:
	  p_lindheimer Patches: 05292009_bug15056.diff uploaded by
	  seanbright (license 71) Tested by: p_lindheimer ........
	  ................

2009-05-30 02:35 +0000 [r198250]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 198248 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r198248 |
	  file | 2009-05-29 23:31:48 -0300 (Fri, 29 May 2009) | 2 lines
	  When removing all packets from a dialog we also need to free the
	  data if present. ........

2009-05-29 23:05 +0000 [r198148-198188]  Russell Bryant <russell@digium.com>

	* /, configs/modules.conf.sample: Merged revisions 198186 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r198186 | russell | 2009-05-29 18:04:31 -0500 (Fri, 29
	  May 2009) | 2 lines Suggesting that only a single timing module
	  be loaded is no longer necessary. ........

	* /, res/res_timing_pthread.c: Merged revisions 198183 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r198183 | russell | 2009-05-29 17:33:31 -0500 (Fri, 29 May 2009)
	  | 2 lines Improve handling of trying to ACK too many timer
	  expirations. ........

	* /, res/res_timing_pthread.c: Merged revisions 198146 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r198146 | russell | 2009-05-29 15:06:59 -0500 (Fri, 29 May 2009)
	  | 38 lines Resolve issues with choppy sound when using
	  res_timing_pthread. The situation that caused this problem was
	  when continuous mode was being turned on and off while a rate was
	  set for a timing interface. A very easy way to replicate this bug
	  was to do a Playback() from behind a Local channel. In this
	  scenario, a rate gets set on the channel for doing file playback.
	  At the same time, continuous mode gets turned on and off about
	  every 20 ms as frames get queued on to the PBX side channel from
	  the other side of the Local channel. Essentially, this module
	  treated continuous mode and a set rate as mutually exclusive
	  states for the timer to be in. When I dug deep enough, I observed
	  the following pattern: 1) Set timer to tick every 20 ms. 2) Wait
	  almost 20 ms ... 3) Continuous mode gets turned on for a queued
	  up frame 4) Continuous mode gets turned off 5) The timer goes
	  back to its tick per 20 ms. state but starts counting at 0 ms. 6)
	  Goto step 2. Sometimes, res_timing_pthread would make it 20 ms
	  and produce a timer tick, but not most of the time. This is what
	  produced the choppy sound (or sometimes no sound at all). Now,
	  the module treats continuous mode and a set rate as completely
	  independent timer modes. They can be enabled and disabled
	  independently of each other and things work as expected. (closes
	  issue #14412) Reported by: dome Patches: issue14412.diff.txt
	  uploaded by russell (license 2) issue14412-1.6.1.0.diff.txt
	  uploaded by russell (license 2) Tested by: DennisD, russell
	  ........

2009-05-29 19:26 +0000 [r198111]  Eliel C. Sardanons <eliels@gmail.com>

	* CREDITS, /: Merged revisions 198083 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r198083 |
	  eliel | 2009-05-29 15:18:35 -0400 (Fri, 29 May 2009) | 3 lines
	  Apply anti-spam obfuscation to an email address. ........

2009-05-29 19:14 +0000 [r198075]  Matthew Nicholson <mnicholson@digium.com>

	* main/cdr.c, main/channel.c, /, include/asterisk/cdr.h: Merged
	  revisions 198072 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r198072 | mnicholson | 2009-05-29 14:04:24 -0500 (Fri, 29 May
	  2009) | 21 lines Merged revisions 198068 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r198068 | mnicholson | 2009-05-29 13:53:01 -0500 (Fri, 29 May
	  2009) | 15 lines Use AST_CDR_NOANSWER instead of AST_CDR_NULL as
	  the default CDR disposition. This change also involves the
	  addition of an AST_CDR_FLAG_ORIGINATED flag that is used on
	  originated channels to distinguish: them from dialed channels.
	  (closes issue #12946) Reported by: meral Patches: null-cdr2.diff
	  uploaded by mnicholson (license 96) Tested by: mnicholson,
	  dbrooks (closes issue #15122) Reported by: sum Tested by: sum
	  ........ ................

2009-05-29 18:40 +0000 [r198066]  Joshua Colp <jcolp@digium.com>

	* /, main/file.c: Merged revisions 198064 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r198064 |
	  file | 2009-05-29 15:39:04 -0300 (Fri, 29 May 2009) | 2 lines Fix
	  a memory leak of the write buffer when writing a file. ........

2009-05-29 18:18 +0000 [r198008]  Sean Bright <sean.bright@gmail.com>

	* Makefile, /: Merged revisions 198000 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r198000 | seanbright | 2009-05-29 14:15:15 -0400 (Fri, 29 May
	  2009) | 15 lines Merged revisions 197998 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r197998 | seanbright | 2009-05-29 14:14:12 -0400 (Fri, 29 May
	  2009) | 8 lines Fix 'make config' target for Slackware. There was
	  a missing semi-colon after the echo statement in the Makefile
	  that was causing problems for some users. Fix suggested by
	  reporter. (closes issue #15225) Reported by: pdavis ........
	  ................

2009-05-29 16:29 +0000 [r197994]  Russell Bryant <russell@digium.com>

	* /, res/res_timing_pthread.c: Merged revisions 197960 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r197960 | russell | 2009-05-29 11:15:30 -0500 (Fri, 29 May 2009)
	  | 2 lines Trim trailing whitespace so that I can work on this bug
	  without it bothering me. :-) ........

2009-05-28 23:54 +0000 [r197894]  Leif Madsen <lmadsen@digium.com>

	* apps/app_mixmonitor.c, /: Merged revisions 197828 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r197828 | lmadsen | 2009-05-28 18:04:00 -0400 (Thu, 28 May 2009)
	  | 8 lines Update documentation in MixMonitor. Updated the
	  MixMonitor documentation for the 'b' option so that it is more
	  obvious that you must not optimize away the Local channel when
	  using this option. (closes issue #14829) Reported by: licedey
	  Tested by: mmichelson, licedey, lmadsen ........

2009-05-28 18:50 +0000 [r197703]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 197697 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r197697 | file | 2009-05-28 15:45:11 -0300 (Thu, 28 May 2009) | 2
	  lines Fix a bug where the trunkmtu setting was not set to the
	  default value of 1240 on load but was on reload. ........

2009-05-28 16:15 +0000 [r197625]  Eliel C. Sardanons <eliels@gmail.com>

	* /, channels/chan_sip.c: Merged revisions 197621 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r197621 | eliel | 2009-05-28 12:01:48 -0400 (Thu, 28 May 2009) |
	  19 lines Merged revisions 197562 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r197562 | eliel | 2009-05-28 11:21:32 -0400 (Thu, 28 May 2009) |
	  13 lines Use the address we already know when reloading a peer
	  with nat=yes. If we already have an address for a peer, and we
	  are reloading the sip configuration, try to use that address to
	  contact the peer, instead of getting it from the Contact. (closes
	  issue #15194) Reported by: ibc Patches: sip.patch uploaded by
	  eliel (license 64) Tested by: manwe ........ ................

2009-05-28 15:44 +0000 [r197548-197619]  Mark Michelson <mmichelson@digium.com>

	* main/rtp.c, /, channels/chan_sip.c, include/asterisk/rtp.h:
	  Merged revisions 197606 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r197606 | mmichelson | 2009-05-28 10:32:19 -0500 (Thu, 28 May
	  2009) | 22 lines Recorded merge of revisions 197588 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r197588 | mmichelson | 2009-05-28 10:27:49 -0500 (Thu,
	  28 May 2009) | 16 lines Allow for media to arrive from an
	  alternate source when responding to a reinvite with 491. When we
	  receive a SIP reinvite, it is possible that we may not be able to
	  process the reinvite immediately since we have also sent a
	  reinvite out ourselves. The problem is that whoever sent us the
	  reinvite may have also sent a reinvite out to another party, and
	  that reinvite may have succeeded. As a result, even though we are
	  not going to accept the reinvite we just received, it is
	  important for us to not have problems if we suddenly start
	  receiving RTP from a new source. The fix for this is to grab the
	  media source information from the SDP of the reinvite that we
	  receive. This information is passed to the RTP layer so that it
	  will know about the alternate source for media. Review:
	  https://reviewboard.asterisk.org/r/252 ........ ................

	* main/audiohook.c, apps/app_chanspy.c, /,
	  include/asterisk/audiohook.h: Merged revisions 197543 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r197543 | mmichelson | 2009-05-28 09:58:06 -0500
	  (Thu, 28 May 2009) | 27 lines Merged revisions 197537 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r197537 | mmichelson | 2009-05-28 09:49:13 -0500 (Thu, 28 May
	  2009) | 21 lines Add flags to chanspy audiohook so that audio
	  stays in sync. There are two flags being added to the chanspy
	  audiohook here. One is the pre-existing
	  AST_AUDIOHOOK_TRIGGER_SYNC flag. With this set, we ensure that
	  the read and write slinfactories on the audiohook do not skew
	  beyond a certain tolerance. In addition, there is a new audiohook
	  flag added here, AST_AUDIOHOOK_SMALL_QUEUE. With this flag set,
	  we do not allow for a slinfactory to build up a substantial
	  amount of audio before flushing it. For this particular issue,
	  this means that the person spying on the call will hear the
	  conversations in real time with very little delay in the audio.
	  (closes issue #13745) Reported by: geoffs Patches: 13745.patch
	  uploaded by mmichelson (license 60) Tested by: snblitz ........
	  ................

2009-05-28 14:56 +0000 [r197471-197542]  Joshua Colp <jcolp@digium.com>

	* /, main/utils.c: Merged revisions 197538 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r197538 |
	  file | 2009-05-28 11:51:43 -0300 (Thu, 28 May 2009) | 5 lines Fix
	  a bug in stringfields where it did not actually free the pools of
	  memory. (closes issue #15074) Reported by: pj ........

	* /, channels/chan_sip.c: Merged revisions 197467 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r197467 | file | 2009-05-28 10:47:45 -0300 (Thu, 28 May 2009) |
	  15 lines Merged revisions 197466 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r197466 | file | 2009-05-28 10:44:58 -0300 (Thu, 28 May 2009) | 8
	  lines Fix a bug where the flag indicating the presence of rport
	  would get overwritten by the nat setting. The presence of rport
	  is now stored as a separate flag. Once the dialog is setup and
	  authenticated (or it passes through unauthenticated) the proper
	  nat flag is set. (closes issue #13823) Reported by: dimas
	  ........ ................

2009-05-28 11:40 +0000 [r197441]  Gavin Henry <ghenry@suretecsystems.com>

	* contrib/scripts/asterisk.ldap-schema,
	  contrib/scripts/asterisk.ldif, doc/ldap.txt,
	  configs/res_ldap.conf.sample: issue #15155 and issue #15156 from
	  trunk

2009-05-27 23:49 +0000 [r197375]  Tilghman Lesher <tlesher@digium.com>

	* /, main/xml.c: Merged revisions 197374 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r197374 |
	  tilghman | 2009-05-27 18:48:15 -0500 (Wed, 27 May 2009) | 2 lines
	  Revert commit 192032. This define is needed on Mac OS X. ........

2009-05-27 22:23 +0000 [r197336]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/agi.h, /: Merged revisions 197335 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r197335 | kpfleming | 2009-05-27 17:21:53 -0500 (Wed, 27 May
	  2009) | 3 lines Ensure that this header includes xmldoc.h, since
	  it depends on it. ........

2009-05-27 20:11 +0000 [r197263]  Sean Bright <sean.bright@gmail.com>

	* Makefile, /: Merged revisions 197260 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r197260 |
	  seanbright | 2009-05-27 16:08:16 -0400 (Wed, 27 May 2009) | 6
	  lines Use bash explicitly when calling build_tools/mkpkgconfig
	  from the Makefile. Since we use bashisms in
	  build_tools/mkpkgconfig, we should call on bash explicitly when
	  running from the Makefile, otherwise we get errors during a 'make
	  install.' (closes issue #15209) Reported by: seandarcy ........

2009-05-27 19:30 +0000 [r197247]  Tilghman Lesher <tlesher@digium.com>

	* /, funcs/func_cut.c: Recorded merge of revisions 197209 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r197209 | tilghman | 2009-05-27 14:20:56 -0500
	  (Wed, 27 May 2009) | 12 lines Recorded merge of revisions 197194
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r197194 | tilghman | 2009-05-27 14:09:42 -0500 (Wed, 27 May 2009)
	  | 5 lines Use a different determinator on whether to print the
	  delimiter, since leading fields may be blank. (closes issue
	  #15208) Reported by: ramonpeek Patch by me, though inspired in
	  part by a patch from ramonpeek ........ ................

2009-05-27 17:28 +0000 [r197176]  Jeff Peeler <jpeeler@digium.com>

	* main/channel.c, include/asterisk/channel.h: Fix broken attended
	  transfers The bridge was terminating immediately after the
	  attended transfer was completed. The problem was because upon
	  reentering ast_channel_bridge nexteventts was checked to see if
	  it was set and if so could possibly return AST_BRIDGE_COMPLETE.
	  (closes issue #15183) Reported by: andrebarbosa Tested by:
	  andrebarbosa, tootai, loloski

2009-05-27 16:12 +0000 [r196950-197092]  Sean Bright <sean.bright@gmail.com>

	* configs/smdi.conf.sample, configs/extensions.conf.sample,
	  configs/sla.conf.sample, configs/chan_dahdi.conf.sample, /,
	  configs/vpb.conf.sample: Merged revisions 197089 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r197089 | seanbright | 2009-05-27 12:07:57 -0400 (Wed, 27 May
	  2009) | 6 lines Fix references to /etc/dahdi/system.conf and
	  /etc/asterisk/chan_dahdi.conf in the sample configuration files.
	  (closes issue #15207) Reported by: seandarcy ........

	* /, channels/chan_alsa.c: Merged revisions 196988 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r196988 | seanbright | 2009-05-27 09:02:54 -0400 (Wed, 27 May
	  2009) | 9 lines Display an error message when chan_alsa fails to
	  load due to a missing or inaccessible configuration file. Before
	  this change, when chan_alsa failed to load due to a missing or
	  inaccessible configuration file, no message would be displayed.
	  With this change, when chan_alsa fails to load due to a missing
	  or inaccessible configuration file, a message will be displayed.
	  (closes issue #14760) Reported by: Nick_Lewis Patches:
	  chan_alsa.c-confload.patch uploaded by Nick (license 657)
	  ........

	* main/xmldoc.c, /: Merged revisions 196948 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r196948 |
	  seanbright | 2009-05-26 18:43:21 -0400 (Tue, 26 May 2009) | 8
	  lines Reset the terminal to the correct fg/bg after XML
	  documenation is rendered. (closes issue #15200) Reported by:
	  ajohnson Patches: 05262009_xmldoc.patch uploaded by seanbright
	  (license 71) Tested by: ajohnson ........

	* main/manager.c, /: Merged revisions 196945 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r196945 |
	  seanbright | 2009-05-26 18:38:05 -0400 (Tue, 26 May 2009) | 13
	  lines Add ActionID to CoreShowChannel event. There is
	  inconsistency in how we handle manager responses that are lists
	  of items and, unfortunately, third parties have come to rely on
	  ActionID being on every event within those lists instead of just
	  keeping track of the ActionID for the current response. This
	  change makes CoreShowChannels include the ActionID with each
	  CoreShowChannel event generated as a result of it being called.
	  (closes issue #15001) Reported by: sum Patches:
	  patchactionid2.patch uploaded by sum (license 766) ........

2009-05-26 22:44 +0000 [r196870-196949]  Russell Bryant <russell@digium.com>

	* /, autoconf/ast_check_osptk.m4 (added), configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Merged revisions
	  196946 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r196946 |
	  russell | 2009-05-26 17:40:34 -0500 (Tue, 26 May 2009) | 8 lines
	  Update configure script to check for OSP toolkit 3.5.0. (closes
	  issue #14988) Reported by: tzafrir Patches: configure.ac.diff
	  uploaded by homesick (license 91) new_ast_check_osptk.m4 uploaded
	  by homesick (license 91) ........

	* /, res/res_convert.c: Merged revisions 196843 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r196843 | russell | 2009-05-26 13:20:57 -0500 (Tue, 26 May 2009)
	  | 16 lines Merged revisions 196826 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r196826 | russell | 2009-05-26 13:14:36 -0500 (Tue, 26 May 2009)
	  | 9 lines Resolve a file handle leak. The frames here should have
	  always been freed. However, out of luck, there was never any
	  memory leaked. However, after file streams became reference
	  counted, this code would leak the file stream for the file being
	  read. (closes issue #15181) Reported by: jkroon ........
	  ................

2009-05-26 16:39 +0000 [r196793]  Sean Bright <sean.bright@gmail.com>

	* apps/app_queue.c, /: Merged revisions 196792 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r196792 |
	  seanbright | 2009-05-26 12:38:54 -0400 (Tue, 26 May 2009) | 2
	  lines Add a missing unref for queues in handle_statechange.
	  ........

2009-05-26 13:47 +0000 [r196661-196724]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 196721 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r196721 |
	  file | 2009-05-26 10:43:13 -0300 (Tue, 26 May 2009) | 7 lines Fix
	  a bug where the sip unregister CLI command did not completely
	  unregister the peer. (closes issue #15118) Reported by: alecdavis
	  Patches: chan_sip_unregister.diff2.txt uploaded by alecdavis
	  (license 585) ........

	* contrib/scripts/safe_asterisk, /: Merged revisions 196658 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r196658 | file | 2009-05-26 10:06:50 -0300 (Tue,
	  26 May 2009) | 14 lines Merged revisions 196657 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r196657 | file | 2009-05-26 10:06:09 -0300 (Tue, 26 May 2009) | 7
	  lines Remove some bash specific stuff from safe_asterisk. (closes
	  issue #10812) Reported by: paravoid Patches:
	  safe_asterisk_bashism.diff uploaded by tzafrir (license 46)
	  ........ ................

2009-05-23 05:29 +0000 [r196487]  Moises Silva <moises.silva@gmail.com>

	* channels/chan_dahdi.c, /: Merged revisions 196456 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r196456 | moy | 2009-05-22 23:27:47 -0500 (Fri, 22 May 2009) | 1
	  line set MFCR2_CATEGORY just when starting the pbx ........

2009-05-22 21:59 +0000 [r196452]  David Vossel <dvossel@digium.com>

	* configs/sip.conf.sample, /, channels/chan_sip.c: Merged revisions
	  196416 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r196416 |
	  dvossel | 2009-05-22 16:09:45 -0500 (Fri, 22 May 2009) | 19 lines
	  SIP set outbound transport type from Registration In sip.conf the
	  transport option allows for the configuration of what transport
	  types (udp, tcp, and tls) a peer will accept, but only the first
	  type listed was used for outbound connections. This patch changes
	  this. Now the default transport type is only used until the peer
	  registers. When registration takes place the transport type is
	  parsed out of the Contact header. If the Contact header's
	  transport type is equal to one that the peer supports, the peer's
	  default transport type for outbound connections is set to match
	  the Contact header's type. If the Contact header's transport type
	  is not present, then the peer's default transport type is set to
	  match the one the peer registered with. When a peer unregisters
	  or the registration expires, the default transport type for that
	  peer is reset. (closes issue #12282) Reported by: rjain Patches:
	  reg_patch_1.diff uploaded by dvossel (license 671) Tested by:
	  dvossel (closes issue #14727) Reported by: pj Patches:
	  reg_patch_3.diff uploaded by dvossel (license 671) Tested by: pj,
	  dvossel Review: https://reviewboard.asterisk.org/r/249/ ........

2009-05-22 19:48 +0000 [r196378]  Eliel C. Sardanons <eliels@gmail.com>

	* /, apps/app_minivm.c: Merged revisions 196377 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r196377 |
	  eliel | 2009-05-22 15:38:33 -0400 (Fri, 22 May 2009) | 11 lines
	  Unregister every registered application by MiniVM. The MinivmMWI
	  application was not being unregistered on unload and we were not
	  able to load again the module or reload it. (closes issue #15174)
	  Reported by: junky Patches: unregister_minivm_mwi.diff uploaded
	  by junky (license 177) ........

2009-05-22 13:59 +0000 [r196120]  Joshua Colp <jcolp@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 196117 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r196117 | file | 2009-05-22 10:56:47 -0300 (Fri,
	  22 May 2009) | 12 lines Merged revisions 196116 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r196116 | file | 2009-05-22 10:54:17 -0300 (Fri, 22 May 2009) | 5
	  lines Fix a bug where using immediate with mISDN caused a cause
	  code of 16 to get sent back instead of 1 if the 's' extension did
	  not exist. (closes issue #12286) Reported by: lmamane ........
	  ................

2009-05-21 19:15 +0000 [r196000]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 195995 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r195995 | dvossel | 2009-05-21 14:11:49 -0500
	  (Thu, 21 May 2009) | 20 lines Merged revisions 195991 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195991 | dvossel | 2009-05-21 14:04:56 -0500 (Thu, 21 May 2009)
	  | 14 lines Sign problem calculating timestamp for iax frame leads
	  to no audio on the receiving peer. There are rare cases in which
	  a frame's delivery timestamp is slightly less than the iax2_pvt's
	  offset. This causes the pvt's timestamp to be a small negative
	  number, but since the timestamp value is unsigned it looks like a
	  huge positive number. This patch checks for this negative case
	  and sets the ms to zero. A similar check is already done right
	  below this one in the 'else' statement. (closes issue #15032)
	  Reported by: guillecabeza Patches: chan_iax2.c.patch_timestamp
	  uploaded by guillecabeza (license 380) Tested by: guillecabeza
	  (closes issue #14216) Reported by: Andrey Sofronov ........
	  ................

2009-05-21 15:57 +0000 [r195883]  Matthew Nicholson <mnicholson@digium.com>

	* main/cdr.c, /, include/asterisk/cdr.h: Merged revisions 195882
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r195882 | mnicholson | 2009-05-21 10:33:55 -0500
	  (Thu, 21 May 2009) | 20 lines Merged revisions 195881 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195881 | mnicholson | 2009-05-21 10:25:50 -0500 (Thu, 21 May
	  2009) | 13 lines This commit prevents cdr records with
	  AST_CDR_FLAG_ANSLOCKED and AST_CDR_FLAG_LOCKED from being updated
	  in certain cases. This is accomplished by adding two functions to
	  update the answer time and disposition of calls that checks for
	  the proper lock flags. These functions are used in the
	  ast_bridge_call() function so that ForkCDR(A) calls are
	  respected. This patch also modifies the way ast_bridge_call()
	  chooses the cdr record to base the bridged_cdr on. Previously the
	  first unlocked cdr record would be chosen, now instead the first
	  cdr record is chosen and forked cdr records are moved to the
	  bridge_cdr. This allows the original cdr record and any forked
	  cdr records to be properly updated with answer and end times.
	  (closes issue #13797) Reported by: sh0t Tested by: sh0t (closes
	  issue #14744) Reported by: deepesh ........ ................

2009-05-20 23:31 +0000 [r195842]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_stack.c, /: Merged revisions 195839 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r195839 |
	  tilghman | 2009-05-20 18:30:05 -0500 (Wed, 20 May 2009) | 3 lines
	  If a variable had a blank value upon the initial setting, then it
	  would do nothing. Identified by Dmitry Andrianov via private
	  email, fixed by me. ........

2009-05-20 17:35 +0000 [r195639-195707]  Joshua Colp <jcolp@digium.com>

	* /, main/features.c: Merged revisions 195698 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r195698 | file | 2009-05-20 14:33:02 -0300 (Wed, 20 May 2009) |
	  12 lines Merged revisions 195688 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195688 | file | 2009-05-20 14:30:25 -0300 (Wed, 20 May 2009) | 5
	  lines Fix some code that wrongly assumed a pointer would always
	  be non-NULL when dealing with CDRs after a bridge. (closes issue
	  #15079) Reported by: barryf ........ ................

	* /, apps/app_meetme.c: Merged revisions 195636 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r195636 | file | 2009-05-20 14:14:42 -0300 (Wed, 20 May 2009) |
	  12 lines Merged revisions 195635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195635 | file | 2009-05-20 14:14:00 -0300 (Wed, 20 May 2009) | 5
	  lines Fix a bug where the MeetMe option 'D' did not actually
	  prompt for the pin. (closes issue #15050) Reported by: pmhaddad
	  ........ ................

2009-05-19 20:19 +0000 [r195531]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 195521 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r195521 | tilghman | 2009-05-19 15:16:01 -0500
	  (Tue, 19 May 2009) | 14 lines Merged revisions 195520 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195520 | tilghman | 2009-05-19 15:12:20 -0500 (Tue, 19 May 2009)
	  | 7 lines Ensure thread keys are initialized before attempting to
	  access them. (closes issue #14889) Reported by: jaroth Patches:
	  app_voicemail.c.patch uploaded by msirota (license 758) Tested
	  by: msirota, BlargMaN ........ ................

2009-05-19 14:49 +0000 [r195452]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 195449 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r195449 | file | 2009-05-19 11:43:54 -0300 (Tue, 19 May 2009) |
	  14 lines Merged revisions 195448 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195448 | file | 2009-05-19 11:41:45 -0300 (Tue, 19 May 2009) | 7
	  lines Fix a bug where direct RTP setup would partially occur even
	  when disabled if the calling channel was answered. (issue #13545)
	  Reported by: davidw (issue #14244) Reported by: mbnwa ........
	  ................

2009-05-18 21:25 +0000 [r195405]  Eliel C. Sardanons <eliels@gmail.com>

	* main/manager.c, /: Merged revisions 195369 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r195369 |
	  eliel | 2009-05-18 16:49:20 -0400 (Mon, 18 May 2009) | 8 lines
	  Fix the CLI command 'manager show command' documentation and
	  functionality. The CLI command 'manager show command' supports
	  passing multiple action names in the same line, but it was not
	  allowing that because of a incorrect check in the argumentes
	  counter. Also the documentation was updated to show that this
	  usage of the command is possible. ........

2009-05-18 20:55 +0000 [r195359-195373]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_queue.c, include/asterisk/smdi.h, res/res_monitor.c,
	  apps/app_voicemail.c, res/res_smdi.c, /,
	  include/asterisk/monitor.h: Merged revisions 195370 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r195370 | tilghman | 2009-05-18 15:52:33 -0500
	  (Mon, 18 May 2009) | 15 lines Recorded merge of revisions 195366
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195366 | tilghman | 2009-05-18 15:24:13 -0500 (Mon, 18 May 2009)
	  | 8 lines Add a similar dependency on SMDI for voicemail as
	  already exists for ADSI. (closes issue #14846) Reported by: pj
	  Patches: 20090413__bug14846__1.4.diff.txt uploaded by tilghman
	  (license 14) 20090507__issue14846__1.6.0.diff.txt uploaded by
	  tilghman (license 14) 20090507__issue14846__1.6.1.diff.txt
	  uploaded by tilghman (license 14) ........ ................

	* main/asterisk.c, /: Merged revisions 195320 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r195320 |
	  tilghman | 2009-05-18 14:17:15 -0500 (Mon, 18 May 2009) | 9 lines
	  Move the spawn of astcanary down, until after the call to
	  daemon(3). This avoids possible conflicts with the internal
	  implementation of daemon(3). (closes issue #15093) Reported by:
	  tzafrir Patches: 20090513__issue15093__2.diff.txt uploaded by
	  tilghman (license 14) Tested by: tzafrir ........

2009-05-18 19:01 +0000 [r195319]  Mark Michelson <mmichelson@digium.com>

	* apps/app_externalivr.c, /: Merged revisions 195316 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r195316 | mmichelson | 2009-05-18 13:58:26 -0500 (Mon, 18 May
	  2009) | 18 lines Fix externalivr's setvariable command so that it
	  properly sets multiple variables. The command had a for loop that
	  was guaranteed to only execute once since the continuation
	  operation of the loop would set the input buffer NULL. I rewrote
	  the loop so that its operation was more obvious, and it would set
	  multiple variables correctly. I also reduced stack space required
	  for the function, constified the input string, and modified the
	  function so that it would not modify the input string while I was
	  at it. (closes issue #15114) Reported by: chris-mac Patches:
	  15114.patch uploaded by mmichelson (license 60) Tested by:
	  chris-mac ........

2009-05-18 15:57 +0000 [r195212]  Joshua Colp <jcolp@digium.com>

	* main/frame.c, /: Merged revisions 195207 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r195207 | file | 2009-05-18 12:53:26 -0300 (Mon, 18 May 2009) |
	  14 lines Merged revisions 195206 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195206 | file | 2009-05-18 12:51:22 -0300 (Mon, 18 May 2009) | 7
	  lines Fix a typo which caused loss of audio when using G729 in
	  some scenarios with a smoother present. (closes issue #15105)
	  Reported by: bamby Patches: process-vad-correctly.diff uploaded
	  by bamby (license 430) ........ ................

2009-05-18 14:54 +0000 [r195164]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_dial.c, main/pbx.c, /, apps/app_macro.c: Merged
	  revisions 195162 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r195162 |
	  eliel | 2009-05-18 10:45:23 -0400 (Mon, 18 May 2009) | 9 lines
	  Warn about the use of the application WaitExten() within a
	  Macro(). Update applications documentation to warn the user about
	  the use of the WaitExten() application within a Macro().
	  Recommend the use of Read() instead. (closes issue #14444)
	  Reported by: ewieling ........

2009-05-18 14:00 +0000 [r195099]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 195096 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r195096 | file | 2009-05-18 10:56:16 -0300 (Mon, 18 May 2009) |
	  12 lines Merged revisions 195095 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195095 | file | 2009-05-18 10:53:39 -0300 (Mon, 18 May 2009) | 5
	  lines Fix a bug where the codecs of the called party leg were not
	  properly sent back to the caller call leg when reinvited. (closes
	  issue #13569) Reported by: bkw918 ........ ................

2009-05-18 13:50 +0000 [r195093-195094]  Eliel C. Sardanons <eliels@gmail.com>

	* /, main/xml.c: Merged revisions 195075 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r195075 |
	  eliel | 2009-05-18 09:30:34 -0400 (Mon, 18 May 2009) | 3 lines Do
	  not avoid loading the XML documentation if not XInclude
	  substitution is done. ........

	* doc/appdocsxml.dtd, Makefile, /, main/xml.c: Merged revisions
	  194982 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194982 |
	  eliel | 2009-05-16 16:01:22 -0400 (Sat, 16 May 2009) | 20 lines
	  Allow to include sections of other parts of the xml
	  documentation. Avoid duplicating xml documentation by allowing to
	  include other parts of the xml documentation using XInclude.
	  Example: <xi:include
	  xpointer="xpointer(/docs/function[@name='CHANNEL']/synopsis)" />
	  (Insert this line to include the synopsis of the CHANNEL function
	  xml documentation). It is also possible to include documentation
	  from other files in the 'documentation/' directory using the
	  href="" attribute inside a xinclude element. (closes issue
	  #15107) Reported by: lmadsen (issue #14444) Reported by: ewieling
	  ........

2009-05-18 13:39 +0000 [r195092]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 195089 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r195089 |
	  file | 2009-05-18 10:36:17 -0300 (Mon, 18 May 2009) | 5 lines Fix
	  a bug where specifying an empty outboundproxy would cause packets
	  to get sent to ourself. (closes issue #15106) Reported by:
	  timeshell ........

2009-05-18 13:14 +0000 [r195024]  Russell Bryant <russell@digium.com>

	* main/manager.c, /: Merged revisions 195021 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r195021 | russell | 2009-05-18 07:59:11 -0500 (Mon, 18 May 2009)
	  | 12 lines Recorded merge of revisions 195020 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r195020 | russell | 2009-05-18 07:57:46 -0500 (Mon, 18 May 2009)
	  | 5 lines Don't try to unlock a bogus channel. (closes issue
	  #15144) Reported by: cristiandimache ........ ................

2009-05-16 18:43 +0000 [r194946]  Eliel C. Sardanons <eliels@gmail.com>

	* main/pbx.c, /: Merged revisions 194945 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194945 |
	  eliel | 2009-05-16 14:32:11 -0400 (Sat, 16 May 2009) | 8 lines
	  Fix a missing unlock in case of error, and a missing free().
	  Always free the allocated memory for a string field, because we
	  are always using it (not only when xmldocs are enabled). Also if
	  there is an error allocating memory for the string field remember
	  to unlock the list of registered applications, before returning.
	  ........

2009-05-15 22:48 +0000 [r194836-194877]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 194874 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r194874 | dvossel | 2009-05-15 17:44:44 -0500
	  (Fri, 15 May 2009) | 23 lines Merged revisions 194873 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194873 | dvossel | 2009-05-15 17:43:13 -0500 (Fri, 15 May 2009)
	  | 17 lines IAX2 REGAUTH loop IAX was not sending REGREJ to
	  terminate invalid registrations. Instead it sent another REGAUTH
	  if the authentication challenge failed. This caused a loop of
	  REGREQ and REGAUTH frames. (Related to Security fix AST-2009-001)
	  (closes issue #14867) Reported by: aragon Tested by: dvossel
	  (closes issue #14717) Reported by: mobeck Patches:
	  regauth_loop_update_patch.diff uploaded by dvossel (license 671)
	  Tested by: dvossel ........ ................

	* channels/chan_iax2.c, channels/iax2-parser.c,
	  channels/iax2-parser.h, /, channels/iax2.h: Merged revisions
	  194833 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r194833 | dvossel | 2009-05-15 15:52:12 -0500 (Fri, 15 May 2009)
	  | 24 lines Merged revisions 194557,194685 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194557 | dvossel | 2009-05-14 17:59:43 -0500 (Thu, 14 May 2009)
	  | 10 lines IAX2 "Ghost" Channels There is a bug tracker issue
	  where people are reporting "Ghost" channels in their 'iax2 show
	  channels' output. The confusion is caused by channels being
	  listed as "(NONE)" with format "unknown". These are not channels
	  of coarse. They are usually just pending registration or poke
	  requests, but it is confusing output. To help make sense of this
	  I have added two columns to 'iax2 show channels'. One shows the
	  first message which started the transaction, and the second shows
	  the last message sent by either side of the call. This helps
	  diagnose why the entry exists and why it may not go away. (closes
	  issue #14207) Reported by: clive18 Review:
	  https://reviewboard.asterisk.org/r/246/ ........ r194685 |
	  dvossel | 2009-05-15 10:40:37 -0500 (Fri, 15 May 2009) | 6 lines
	  Update to previous IAX2 "Ghost" Channels patch. Fixed some
	  comments made on reviewboard for the previous patch. (issue
	  #14207) ........ ................

2009-05-15 18:44 +0000 [r194717-194768]  Russell Bryant <russell@digium.com>

	* configs/logger.conf.sample, /: Merged revisions 194765 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r194765 | russell | 2009-05-15 13:43:42 -0500
	  (Fri, 15 May 2009) | 10 lines Merged revisions 194764 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194764 | russell | 2009-05-15 13:43:18 -0500 (Fri, 15 May 2009)
	  | 2 lines Fix some spelling fail. ........ ................

	* /, codecs/g722/g722_encode.c, codecs/g722/g722_decode.c: Merged
	  revisions 194722 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194722 |
	  russell | 2009-05-15 12:59:08 -0500 (Fri, 15 May 2009) | 4 lines
	  Shuttle some bits around to address some gain issues with G.722.
	  (closes AST-209) ........

	* codecs/Makefile, codecs/g722/Makefile (removed), /: Merged
	  revisions 194718 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194718 |
	  russell | 2009-05-15 12:37:12 -0500 (Fri, 15 May 2009) | 2 lines
	  Further simplify codec_g722 build. ........

	* codecs/Makefile, /: Merged revisions 194714 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194714 |
	  russell | 2009-05-15 12:24:39 -0500 (Fri, 15 May 2009) | 2 lines
	  Actually force running make for g722. ........

2009-05-15 13:47 +0000 [r194650]  Michiel van Baak <michiel@vanbaak.info>

	* CREDITS, /: Merged revisions 194649 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194649 |
	  mvanbaak | 2009-05-15 15:43:24 +0200 (Fri, 15 May 2009) | 2 lines
	  add eliel ........

2009-05-15 13:42 +0000 [r194648]  Eliel C. Sardanons <eliels@gmail.com>

	* doc/appdocsxml.dtd, main/xmldoc.c, /: Merged revisions 194635 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r194635 | eliel | 2009-05-15 09:23:37 -0400 (Fri, 15 May
	  2009) | 16 lines Allow to specify an enumlist inside an enum. It
	  was not possible to use an enumlist inside an enum: <enumlist>
	  <enum name="aa"> <enumlist> ... </enumlist> </enum> </enumlist>
	  Now we will be able to insert as many levels as we want. (closes
	  issue #15112) Reported by: lmadsen ........

2009-05-14 22:31 +0000 [r194545]  Kevin P. Fleming <kpfleming@digium.com>

	* /: Merged revisions 194520 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r194520 | kpfleming | 2009-05-14 17:26:02 -0500 (Thu, 14 May
	  2009) | 9 lines Merged revisions 194509 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194509 | kpfleming | 2009-05-14 17:23:49 -0500 (Thu, 14 May
	  2009) | 1 line Update URL to Reviewboard ........
	  ................

2009-05-14 22:23 +0000 [r194510]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 194496 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r194496 | mmichelson | 2009-05-14 17:20:51 -0500 (Thu, 14 May
	  2009) | 30 lines Merged revisions 194484 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194484 | mmichelson | 2009-05-14 17:17:55 -0500 (Thu, 14 May
	  2009) | 24 lines Fix a race condition where a reinvite could
	  trigger a 482 response. The loop detection/spiral detection code
	  in chan_sip used the owner channel's state as a criterion for
	  determining if the incoming INVITE is a looped request. The
	  problem with this is that the INVITE-handling code happens in a
	  different thread than the thread that marks the owner channel as
	  being up. As a result, if a reinvite were to come in very
	  quickly, say from another Asterisk on the same LAN, it was
	  possible for the reinvite to arrive before the owner channel had
	  been set to the up state. This patch corrects the problem by
	  using the invitestate of the sip_pvt instead, since that can be
	  guaranteed to be set correctly by the time the reinvite arrives.
	  Since there is a switch statement further in the INVITE-handling
	  code, the AST_STATE_RINGING state also checks the invitestate of
	  the sip_pvt in case we should actually be treating the channel as
	  if it were up already. (closes issue #12215) Reported by: jpyle
	  Patches: 12215_confirmed.patch uploaded by mmichelson (license
	  60) Tested by: lmadsen ........ ................

2009-05-14 17:07 +0000 [r194437]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_meetme.c: Merged revisions 194434 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194434 |
	  file | 2009-05-14 14:05:33 -0300 (Thu, 14 May 2009) | 7 lines Fix
	  a bug where the 'T' option to Meetme did not work. (closes issue
	  #15031) Reported by: Stochastic (closes issue #13801) Reported
	  by: justdave ........

2009-05-14 16:23 +0000 [r194431]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 194430 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r194430 |
	  tilghman | 2009-05-14 11:22:14 -0500 (Thu, 14 May 2009) | 7 lines
	  If the timing ended on a zero, then we would loop forever.
	  (closes issue #14983) Reported by: teox Patches:
	  20090513__issue14983.diff.txt uploaded by tilghman (license 14)
	  Tested by: teox ........

2009-05-13 13:42 +0000 [r194213]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 194209 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r194209 | file | 2009-05-13 10:39:10 -0300 (Wed, 13 May 2009) |
	  18 lines Merged revisions 194208 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194208 | file | 2009-05-13 10:38:01 -0300 (Wed, 13 May 2009) |
	  11 lines Fix RFC2833 issues with DTMF getting duplicated and with
	  duration wrapping over. (closes issue #14815) Reported by:
	  geoff2010 Patches: v1-14815.patch uploaded by dimas (license 88)
	  Tested by: geoff2010, file, dimas, ZX81, moliveras (closes issue
	  #14460) Reported by: moliveras Tested by: moliveras ........
	  ................

2009-05-13 00:54 +0000 [r194141]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 194138 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r194138 | tilghman | 2009-05-12 19:52:49 -0500 (Tue, 12 May 2009)
	  | 14 lines Merged revisions 194137 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194137 | tilghman | 2009-05-12 19:52:03 -0500 (Tue, 12 May 2009)
	  | 7 lines Fix logic for how to proceed with a single digit
	  extension. (closes issue #15091) Reported by: andrew Patches:
	  20090512__issue15091.diff.txt uploaded by tilghman (license 14)
	  Tested by: andrew ........ ................

2009-05-12 22:48 +0000 [r194059]  Matthew Nicholson <mnicholson@digium.com>

	* apps/app_queue.c, /: Merged revisions 194057 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r194057 | mnicholson | 2009-05-12 17:32:13 -0500 (Tue, 12 May
	  2009) | 22 lines Merged revisions 194028 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r194028 | mnicholson | 2009-05-12 17:15:45 -0500 (Tue, 12 May
	  2009) | 16 lines This change modifies app_queue to properly
	  generate CDR records in failure situations. This involves setting
	  a proper cdr disposition coresponding to the given failure
	  condition and ensuring the proper information is stored in the
	  cdr record. (closes issue #13691) Reported by: dferrer Tested by:
	  mnicholson (closes issue #13637) Reported by: atis Tested by:
	  atis ........ ................

2009-05-12 20:51 +0000 [r193962]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 193954 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r193954 |
	  mmichelson | 2009-05-12 15:28:13 -0500 (Tue, 12 May 2009) | 18
	  lines Update spiral support in trunk and 1.6.X to match what is
	  in 1.4. In 1.4, a SIP spiral is treated the same way as a call
	  forward. This works much better than what is currently in trunk
	  and 1.6.X. The code in trunk and 1.6.X did not create a new call
	  to the recipient of the spiral, instead trying to continue the
	  same call. In addition to just being plain wrong, this also had
	  the side effect of only being able to spiral calls to other SIP
	  channels. With this in place, as long as call forwards are
	  honored, SIP spirals will work properly. This means that it will
	  work for outbound calls made by the Queue, Dial, and Page
	  applications. For originated calls and spool calls, however, the
	  spiral will not work properly until a generic call forward
	  mechanism is introduced into Asterisk. (relates to issue #13630)
	  ........

2009-05-12 20:42 +0000 [r193823-193959]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 193956 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r193956 | tilghman | 2009-05-12 15:40:22 -0500
	  (Tue, 12 May 2009) | 13 lines Merged revisions 193955 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r193955 | tilghman | 2009-05-12 15:39:21 -0500 (Tue, 12 May 2009)
	  | 6 lines Avoid initializing routines if the authentication
	  fails. Fixes a crash (RR) issue. (closes issue #14508) Reported
	  by: tiziano Patches: 20090221_2_wrongmailbox.diff.txt uploaded by
	  tiziano (license 377) ........ ................

	* apps/app_voicemail.c, /: Merged revisions 193870 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r193870 | tilghman | 2009-05-12 12:29:33 -0500 (Tue, 12 May 2009)
	  | 2 lines Convert a THREADSTORAGE object into a simple malloc'd
	  object (as suggested by Russell on -dev) ........

	* apps/app_voicemail.c, /: Recorded merge of revisions 193756 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r193756 | tilghman | 2009-05-11 17:50:47 -0500
	  (Mon, 11 May 2009) | 25 lines Recorded merge of revisions 193755
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r193755 | tilghman | 2009-05-11 17:48:20 -0500 (Mon, 11 May 2009)
	  | 18 lines Move 300 bytes around on the stack, to make more room
	  for an extension buffer. This allows more concurrent extensions
	  to be copied for a single voicemail, without creating a
	  possibility of upsetting existing users, where a dialplan could
	  run out of stack space where it had run fine before.
	  Alternatively, we could have allocated off the heap, but that is
	  a larger change and would have increased the chance for
	  instability introduced by this change. This is really solved
	  starting in 1.6.0.11, as the use of an ast_str buffer allows an
	  unlimited number of extensions (up to available memory). We
	  additionally create a new warning message when the buffer length
	  is exceeded, permitting administrators to see an issue after the
	  fact, whereas previously the list was silently truncated. (closes
	  issue #14739) Reported by: p_lindheimer Patches:
	  20090417__bug14739.diff.txt uploaded by tilghman (license 14)
	  Tested by: p_lindheimer ........ ................

2009-05-11 22:12 +0000 [r193719]  Russell Bryant <russell@digium.com>

	* /, res/res_timing_timerfd.c: Merged revisions 193718 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r193718 | russell | 2009-05-11 17:04:40 -0500 (Mon, 11 May 2009)
	  | 12 lines Fix some timer state corruption. In res_timer_timerfd,
	  handle the case that set_rate gets called while a timer is still
	  in continuous mode. In this case, we want to remember the
	  configured rate, but not actually set it until continuous mode
	  has been disabled. Thanks to dvossel for finding and helping to
	  debug the problem. (closes issue #15080) Reported by: dvossel
	  Tested by: dvossel ........

2009-05-11 19:17 +0000 [r193617]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 193614 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r193614 | rmudgett | 2009-05-11 14:11:29 -0500
	  (Mon, 11 May 2009) | 19 lines Merged revisions 193613 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r193613 | rmudgett | 2009-05-11 14:09:00 -0500 (Mon, 11 May 2009)
	  | 12 lines Sent wrong message to clear a call we started if the
	  other end has not responed yet. In the state MISDN_CALLING (i.e.
	  SETUP was sent but no answer has arrived yet), it is not allowed
	  to clear the call with RELEASE_COMPLETE. It must be cleared with
	  DISCONNECT. A RELEASE_COMPLETE is only allowed as an answer to a
	  SETUP. (See Q.931 ch. 5.3.2, 5.3.2.a, 5.3.2.b) Patches:
	  chan-misdn-ccstate7.patch uploaded by customer. JIRA ABE-1862
	  ........ ................

2009-05-11 18:59 +0000 [r193612]  Leif Madsen <lmadsen@digium.com>

	* /, funcs/func_channel.c: Update CHANNEL(transfercapabilities)
	  documentation. (closes issue #15073) Reported by: pkempgen
	  Patches: 20090511__issue15073__trunk.diff.txt uploaded by
	  tilghman (license 14)

2009-05-10 17:08 +0000 [r193503]  Joshua Colp <jcolp@digium.com>

	* main/bridging.c, /: Merged revisions 193502 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r193502 |
	  file | 2009-05-10 14:07:46 -0300 (Sun, 10 May 2009) | 2 lines Fix
	  a bug where receiving a control frame of subclass -1 would cause
	  certain channels to get hung up. ........

2009-05-09 11:33 +0000 [r193462]  Russell Bryant <russell@digium.com>

	* include/asterisk/event.h, /: Merged revisions 193461 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r193461 | russell | 2009-05-09 06:33:09 -0500 (Sat, 09 May 2009)
	  | 2 lines Minor documentation update for ast_event_queue().
	  ........

2009-05-08 20:52 +0000 [r193390]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 193387 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r193387 |
	  dvossel | 2009-05-08 15:32:51 -0500 (Fri, 08 May 2009) | 7 lines
	  TCP not matching valid peer. find_peer() does not find a valid
	  peer when using pvt->recv as the sockaddr_in argument. Because of
	  the way TCP works, the port number in pvt->recv is not what we're
	  looking for at all. There is currently only one place that
	  find_peer searches for a peer using the sockaddr_in argument. If
	  the peer is not found after using pvt->recv (works for UDP since
	  the port number will be correct), a temp sockaddr_in struct is
	  made using the Contact header in the sip_request. This has the
	  correct port number in it. Review:
	  http://reviewboard.digium.com/r/236/ ........

2009-05-08 19:51 +0000 [r193350]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 193349 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r193349 |
	  mmichelson | 2009-05-08 14:50:44 -0500 (Fri, 08 May 2009) | 12
	  lines Reset the members' call counts when resetting queue
	  statistics. This helps to prevent odd scenarios where a queue
	  will claim to have taken 0 calls, but the members appear to have
	  taken a non-zero amount. (closes issue #15068) Reported by: sum
	  Patches: patchreset.patch uploaded by sum (license 766) Tested
	  by: sum ........

2009-05-08 15:36 +0000 [r193336]  Sean Bright <sean.bright@gmail.com>

	* funcs/func_devstate.c, /: Merged revisions 193274 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r193274 | seanbright | 2009-05-08 11:18:40 -0400 (Fri, 08 May
	  2009) | 2 lines Fix the spelling of UNAVAILABLE in func_devstate
	  CLI completion. ........

2009-05-08 14:55 +0000 [r193266]  David Vossel <dvossel@digium.com>

	* channels/misdn_config.c, /: Merged revisions 193263 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r193263 | dvossel | 2009-05-08 09:52:19 -0500
	  (Fri, 08 May 2009) | 15 lines Merged revisions 193262 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r193262 | dvossel | 2009-05-08 09:51:09 -0500 (Fri, 08 May 2009)
	  | 9 lines "misdn show config" segfaults asterisk, if no MSN lists
	  (closes issue #14976) Reported by: alecdavis Patches:
	  misdn_config.diff.txt uploaded by alecdavis (license 585) Tested
	  by: alecdavis, FabienToune ........ ................

2009-05-08 14:12 +0000 [r193197]  Kevin P. Fleming <kpfleming@digium.com>

	* configs/logger.conf.sample, /, main/logger.c: Merged revisions
	  193194 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r193194 | kpfleming | 2009-05-08 09:06:15 -0500 (Fri, 08 May
	  2009) | 13 lines Merged revisions 193193 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r193193 | kpfleming | 2009-05-08 09:03:28 -0500 (Fri, 08 May
	  2009) | 7 lines Make absolute paths for logger channels work
	  properly (Note: This is not a new feature, it was previously
	  undocumented and broken.) The Asterisk logger has a feature to
	  support absolute pathnames for logger channels, but the code
	  implementing the feature was broken. This has been fixed, and the
	  absolute path feature is now documented in the sample
	  logger.conf. ........ ................

2009-05-07 23:44 +0000 [r193123]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 193120 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r193120 | tilghman | 2009-05-07 18:42:28 -0500 (Thu, 07 May 2009)
	  | 26 lines Merged revisions 193119 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r193119 | tilghman | 2009-05-07 18:41:11 -0500 (Thu, 07 May 2009)
	  | 19 lines Fix Background within a Macro for FreePBX. If the
	  single digit DTMF is an extension in the specified context, then
	  go there and signal no DTMF. Otherwise, we should exit with that
	  DTMF. If we're in Macro, we'll exit and seek that DTMF as the
	  beginning of an extension in the Macro's calling context. If
	  we're not in Macro, then we'll simply seek that extension in the
	  calling context. Previously, someone complained about the
	  behavior as it related to the interior of a Gosub routine, and
	  the fix (#14011) inadvertently broke FreePBX (#14940). This
	  change should fix both of these situations, but with the possible
	  incompatibility that if a single digit extension does not exist
	  (but a longer extension COULD have matched), it would have
	  previously gone immediately to the "i" extension, but will now
	  need to wait for a timeout. (closes issue #14940) Reported by:
	  p_lindheimer Patches: 20090420__bug14940.diff.txt uploaded by
	  tilghman (license 14) Tested by: p_lindheimer ........
	  ................

2009-05-07 22:51 +0000 [r193080]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 193077 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r193077 | rmudgett | 2009-05-07 17:24:04 -0500
	  (Thu, 07 May 2009) | 12 lines Merged revisions 193050 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r193050 | rmudgett | 2009-05-07 17:17:06 -0500 (Thu, 07 May 2009)
	  | 5 lines Give a more helpful message when an incoming call's
	  dialed extension does not match. Added the dialed extension and
	  context to the chan_misdn messages warning that the dialed number
	  cannot be matched in the dialplan. ........ ................

2009-05-07 17:53 +0000 [r192936-193008]  Tilghman Lesher <tlesher@digium.com>

	* /, funcs/func_odbc.c: Merged revisions 193006 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r193006 |
	  tilghman | 2009-05-07 12:51:13 -0500 (Thu, 07 May 2009) | 7 lines
	  Second result should not contain data from the first result.
	  (closes issue #15039) Reported by: jims Patches:
	  20090506__issue15039.diff.txt uploaded by tilghman (license 14)
	  Tested by: jims ........

	* channels/chan_unistim.c, /: Merged revisions 192938 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r192938 | tilghman | 2009-05-07 12:13:36 -0500 (Thu, 07 May 2009)
	  | 6 lines Send DTMF frame before playing back audio. (closes
	  issue #14858) Reported by: barryf Patches:
	  20090507__bug14858.diff.txt uploaded by tilghman (license 14)
	  ........

	* /, channels/chan_sip.c: Merged revisions 192933 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r192933 | tilghman | 2009-05-07 11:43:56 -0500 (Thu, 07 May 2009)
	  | 17 lines Merged revisions 192932 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r192932 | tilghman | 2009-05-07 11:29:08 -0500 (Thu, 07 May 2009)
	  | 10 lines Eliminate repetition of fullcontact during
	  reconstruction. If the fullcontact field appears in both the
	  sippeers and the sipregs table, then during reconstruction of the
	  field, it will otherwise be doubled. (closes issue #14754)
	  Reported by: Alexei Gradinari Patches:
	  20090506__bug14754.diff.txt uploaded by tilghman (license 14)
	  Tested by: lmadsen ........ ................

2009-05-07  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-beta2

2009-05-06 22:20 +0000 [r192874]  Jeff Peeler <jpeeler@digium.com>

	* /, main/features.c: Merged revisions 192861 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r192861 | jpeeler | 2009-05-06 17:17:27 -0500 (Wed, 06 May 2009)
	  | 17 lines Merged revisions 192858 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r192858 | jpeeler | 2009-05-06 17:15:19 -0500 (Wed, 06 May 2009)
	  | 10 lines Make ParkedCall application stop execution of the
	  dialplan after hang up Just changed park_exec to always return
	  non-zero. I really wasn't entirely sure at first if this was a
	  bug. Decided it was since it would be surprising when not using
	  ParkedCall in the dialplan to hang up and have dialplan execution
	  continue. (closes issue #14555) Reported by: francesco_r ........
	  ................

2009-05-06 17:57 +0000 [r192813]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 190946 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r190946 | mattf | 2009-04-28 17:05:05 -0500 (Tue, 28 Apr 2009) |
	  1 line Make sure that we do not clear the down flag on the BRI
	  during PTMP link transients. Also refix SS7 audio that the early
	  media patch broke. ........

2009-05-06 17:41 +0000 [r192637-192810]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 192808 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r192808 | file | 2009-05-06 14:38:51 -0300 (Wed, 06 May 2009) |
	  10 lines Fix a bug where a timer would be created but not
	  acknowledged. This scenario crept up if chan_iax2 was loaded with
	  no configuration file present. It would create a timer and tell
	  it to go at an interval but the thread that normally acknowledges
	  it would not be created because no configuration file was
	  present. The timer will now be closed if no configuration file is
	  present. (closes issue #15014) Reported by: madkins ........

	* res/res_clialiases.c, /: Merged revisions 192736 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r192736 | file | 2009-05-06 13:09:27 -0300 (Wed, 06 May 2009) | 4
	  lines Make the code that prevents an infinite loop from happening
	  into a case insensitive check. (thanks eliel) ........

	* res/res_clialiases.c, /: Merged revisions 192700 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r192700 | file | 2009-05-06 11:35:47 -0300 (Wed, 06 May 2009) | 5
	  lines Fix an infinite loop with tab completion of CLI aliases
	  that reference themselves. (closes issue #15020) Reported by:
	  junky ........

	* /, channels/chan_sip.c: Merged revisions 192634 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r192634 | file | 2009-05-06 10:34:35 -0300 (Wed, 06 May 2009) |
	  14 lines Merged revisions 192633 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r192633 | file | 2009-05-06 10:30:51 -0300 (Wed, 06 May 2009) | 7
	  lines Update some old logic to stop both begin and end DTMF
	  frames from reaching the core if rfc2833 is not enabled. (closes
	  issue #15036) Reported by: dimas Patches: v1-15036.patch uploaded
	  by dimas (license 88) ........ ................

2009-05-05 20:02 +0000 [r192528]  Sean Bright <sean.bright@gmail.com>

	* /, static-http/astman.js: Merged revisions 192525 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r192525 | seanbright | 2009-05-05 15:57:49 -0400
	  (Tue, 05 May 2009) | 18 lines Merged revisions 192524 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r192524 | seanbright | 2009-05-05 15:56:11 -0400 (Tue, 05 May
	  2009) | 11 lines Fix Javascript error when using astman.js in
	  Internet Explorer. Internet Explorer (tested with 7.0) does not
	  like trailing commas on constructs like object initializers, so
	  get rid of them to avoid some errors. (closes issue #15026)
	  Reported by: rajnishgiri Patches: bug15026.patch uploaded by
	  seanbright (license 71) Tested by: seanbright ........
	  ................

2009-05-05 18:27 +0000 [r192402-192480]  Joshua Colp <jcolp@digium.com>

	* /, main/features.c: Merged revisions 192462 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r192462 | file | 2009-05-05 15:23:58 -0300 (Tue, 05 May 2009) |
	  15 lines Merged revisions 192454 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r192454 | file | 2009-05-05 15:22:27 -0300 (Tue, 05 May 2009) | 8
	  lines Fix an incorrect assumption that certain values on the
	  channel will always exist when they may not. The CDR code
	  involved with bridges wrongly assumed that the currently
	  executing application and data values will always exist. It is
	  possible for this to be false when call forwarding is involved.
	  (closes issue #14984) Reported by: gincantalupo ........
	  ................

	* apps/app_followme.c, /: Merged revisions 192430 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r192430 | file | 2009-05-05 14:46:51 -0300 (Tue, 05 May 2009) |
	  12 lines Merged revisions 192429 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r192429 | file | 2009-05-05 14:43:30 -0300 (Tue, 05 May 2009) | 5
	  lines Fix a bug where the followme application would continue
	  trying numbers after the caller hung up. (closes issue #13624)
	  Reported by: sgenyuk ........ ................

	* /, channels/chan_sip.c: Merged revisions 192387 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r192387 |
	  file | 2009-05-05 11:22:47 -0300 (Tue, 05 May 2009) | 10 lines
	  Fix a bug with setting t38pt_udptl at the user or peer level. If
	  an incoming call authenticated as a user or peer and t38pt_udptl
	  was not set to yes in general then no UDPTL session would be
	  present and any T38 related things would fail. This commit
	  changes it so that if after authenticating T38 is enabled but no
	  UDPTL session is present one will be created. (issue AST-215)
	  ........

2009-05-05 13:43 +0000 [r192298-192360]  Kevin P. Fleming <kpfleming@digium.com>

	* main/astobj2.c, include/asterisk/stringfields.h, /, main/utils.c:
	  Merged revisions 192357 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r192357 |
	  kpfleming | 2009-05-05 15:18:21 +0200 (Tue, 05 May 2009) | 5
	  lines Correct some flaws in the memory accounting code for
	  stringfields and ao2 objects Under some conditions, the memory
	  allocation for stringfields and ao2 objects would not have
	  supplied valid file/function names for MALLOC_DEBUG tracking, so
	  this commit corrects that. ........

	* main/astobj2.c, main/datastore.c, main/channel.c, /,
	  include/asterisk/astobj2.h, include/asterisk/datastore.h,
	  include/asterisk/channel.h: Merged revisions 192318 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r192318 | kpfleming | 2009-05-05 12:34:19 +0200 (Tue, 05 May
	  2009) | 5 lines Properly account for memory allocated for
	  channels and datastores As in previous commits, when channels are
	  allocated (with ast_channel_alloc) or datastores are allocated
	  (with ast_datastore_alloc) properly account for the memory being
	  owned by the caller, instead of the allocator function itself.
	  ........

	* include/asterisk/stringfields.h, /, main/utils.c: Merged
	  revisions 192279 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r192279 |
	  kpfleming | 2009-05-05 10:51:06 +0200 (Tue, 05 May 2009) | 5
	  lines Ensure that string pools allocated to hold stringfields are
	  properly accounted in MALLOC_DEBUG mode This commit modifies the
	  stringfield pool allocator to remember the 'owner' of the
	  stringfield manager the pool is being allocated for, and ensures
	  that pools allocated in the future when fields are populated are
	  owned by that file/function. ........

2009-05-04 22:48 +0000 [r192217]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 192214 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r192214 | dvossel | 2009-05-04 17:44:51 -0500
	  (Mon, 04 May 2009) | 17 lines Merged revisions 192213 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r192213 | dvossel | 2009-05-04 17:37:31 -0500 (Mon, 04 May 2009)
	  | 11 lines global mohinterpret setting is ignored mohinterpret
	  and mohsuggest global variables were not copied over during
	  build_users and build_peers. (closes issue #14728) Reported by:
	  dimas Patches: v1-14728.patch uploaded by dimas (license 88)
	  Tested by: dimas, dvossel ........ ................

2009-05-04 19:34 +0000 [r192175]  Kevin P. Fleming <kpfleming@digium.com>

	* main/astobj2.c, /, include/asterisk/astobj2.h: Merged revisions
	  192059 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r192059 |
	  kpfleming | 2009-05-04 18:24:16 +0200 (Mon, 04 May 2009) | 5
	  lines Ensure that astobj2 memory allocations are properly
	  accounted for when MALLOC_DEBUG is used This commit ensures that
	  all astobj2 allocated objects are properly accounted for in
	  MALLOC_DEBUG mode by passing down the file/function/line
	  information from the module/function that actually called the
	  astobj2 allocation function. ........

2009-05-04 19:31 +0000 [r192135-192173]  Tilghman Lesher <tlesher@digium.com>

	* /, configure, res/res_agi.c: Merged revisions 192171 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r192171 | tilghman | 2009-05-04 14:29:13 -0500 (Mon, 04 May 2009)
	  | 8 lines Restore 'asyncagi break' command to 1.6.1 and higher.
	  (closes issue #14985) Reported by: nikkk Patches:
	  20090428__bug14985.diff.txt uploaded by tilghman (license 14)
	  20090429__bug14985__1.6.1.diff.txt uploaded by tilghman (license
	  14) Tested by: nikkk ........

	* autoconf/ast_ext_tool_check.m4, /: Merged revisions 192132 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r192132 | tilghman | 2009-05-04 13:42:56 -0500 (Mon, 04
	  May 2009) | 6 lines Pass libraries in LIBS, not LDFLAGS. (closes
	  issue #14671) Reported by: Chainsaw Patches:
	  asterisk-1.6.0.6-toolcheck-libs-not-ldflags.patch uploaded by
	  Chainsaw (license 723) ........

2009-05-04 17:45 +0000 [r192097]  Leif Madsen <lmadsen@digium.com>

	* apps/app_forkcdr.c, /: Merged revisions 192096 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r192096 |
	  lmadsen | 2009-05-04 13:42:56 -0400 (Mon, 04 May 2009) | 4 lines
	  Commit documentation changes related to issue #14801. (issue
	  #14801) ........

2009-05-04 15:54 +0000 [r192033]  Eliel C. Sardanons <eliels@gmail.com>

	* /, main/xml.c: Merged revisions 192032 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r192032 |
	  eliel | 2009-05-04 11:35:35 -0400 (Mon, 04 May 2009) | 3 lines Do
	  not re-define _POSIX_C_SOURCE if it was already defined. ........

2009-05-04 10:01 +0000 [r191958]  Kevin P. Fleming <kpfleming@digium.com>

	* /, configs/modules.conf.sample: Merged revisions 191955 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r191955 | kpfleming | 2009-05-04 11:57:36 +0200 (Mon, 04
	  May 2009) | 8 lines Ensure that by default only one console
	  channel driver is loaded This configuration file was changed to
	  ensure that only one console channel driver (chan_oss) is loaded
	  by default, but the change would only work if chan_console was
	  not built. Now it will work as expected; if chan_alsa or
	  chan_console are built and installed, they will not be loaded
	  unless explicity requested. ........

2009-05-03 14:06 +0000 [r191885]  Russell Bryant <russell@digium.com>

	* Makefile, /: Merged revisions 191884 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r191884 |
	  russell | 2009-05-03 09:05:10 -0500 (Sun, 03 May 2009) | 2 lines
	  Remove unnecessary compiler flag ........

2009-05-02 18:48 +0000 [r191779]  Kevin P. Fleming <kpfleming@digium.com>

	* /, main/logger.c: Merged revisions 191775 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r191775 |
	  kpfleming | 2009-05-02 20:39:48 +0200 (Sat, 02 May 2009) | 5
	  lines Fix an error in queue_log file rotation optimization code
	  This code was copy-and-pasted without properly changing
	  references to event_rotate into queue_rotate, so under some
	  conditions the log rotation would rotate queue_log even though it
	  was not necessary. ........

2009-05-02 15:52 +0000 [r191703]  Sean Bright <sean.bright@gmail.com>

	* main/asterisk.c, /: Merged revisions 191700 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r191700 |
	  seanbright | 2009-05-02 11:45:07 -0400 (Sat, 02 May 2009) | 1
	  line Update copyright year to 2009 ........

2009-05-01 20:02 +0000 [r191554-191563]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 191560 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r191560 | tilghman | 2009-05-01 15:01:21 -0500 (Fri, 01 May 2009)
	  | 13 lines Merged revisions 191559 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r191559 | tilghman | 2009-05-01 15:00:23 -0500 (Fri, 01 May 2009)
	  | 6 lines SIP Response 410 maps to cause code 22 (or 23), not 1.
	  (closes issue #14993) Reported by: BigJimmy Patches: causepatch
	  uploaded by BigJimmy (license 371) ........ ................

	* channels/chan_iax2.c, /: Merged revisions 191494 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r191494 | tilghman | 2009-05-01 13:18:00 -0500 (Fri, 01 May 2009)
	  | 4 lines Set debug message back to DEBUG level. (closes issue
	  #15007) Reported by: hulber ........

2009-05-01 18:20 +0000 [r191508]  Jeff Peeler <jpeeler@digium.com>

	* main/channel.c, /: Merged revisions 191489 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r191489 | jpeeler | 2009-05-01 13:09:23 -0500 (Fri, 01 May 2009)
	  | 15 lines Merged revisions 191488 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r191488 | jpeeler | 2009-05-01 12:40:46 -0500 (Fri, 01 May 2009)
	  | 9 lines Fix DTMF not being sent to other side after a partial
	  feature match This fixes a regression from commit 176701. The
	  issue was that ast_generic_bridge never exited after the feature
	  digit timeout had elapsed, which prevented the queued DTMF from
	  being sent to the other side. This issue was reported to me
	  directly. ........ ................

2009-04-30 17:46 +0000 [r191224-191370]  Tilghman Lesher <tlesher@digium.com>

	* main/asterisk.c, /, configure, include/asterisk/autoconfig.h.in,
	  configure.ac: Merged revisions 191367 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r191367 |
	  tilghman | 2009-04-30 12:40:58 -0500 (Thu, 30 Apr 2009) | 3 lines
	  Detect eaccess (or euidaccess) before using it. Reported by
	  Andrew Lindh via the -dev list. ........

	* main/asterisk.c, /: Merged revisions 191283 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r191283 |
	  tilghman | 2009-04-30 01:47:13 -0500 (Thu, 30 Apr 2009) | 11
	  lines Change working directory to / under certain conditions. If
	  backgrounding and no core will be produced, then changing the
	  directory won't break anything; likewise, if the CWD isn't
	  accessible by the current user, then a core wasn't possible
	  anyway. (closes issue #14831) Reported by: chris-mac Patches:
	  20090428__bug14831.diff.txt uploaded by tilghman (license 14)
	  20090430__bug14831.diff.txt uploaded by tilghman (license 14)
	  Tested by: chris-mac ........

	* /, channels/h323/ast_h323.cxx, channels/chan_h323.c: Merged
	  revisions 191219 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r191219 |
	  tilghman | 2009-04-29 18:06:56 -0500 (Wed, 29 Apr 2009) | 2 lines
	  Make H.323 compile with FDLEAK detection code enabled ........

2009-04-29 18:40 +0000 [r191139]  David Brooks <dbrooks@digium.com>

	* pbx/pbx_config.c, /: Merged revisions 191136 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r191136 |
	  dbrooks | 2009-04-29 13:32:58 -0500 (Wed, 29 Apr 2009) | 3 lines
	  Removing crufty code that is no longer necessary. Code cleanup.
	  ........

2009-04-29 08:59 +0000 [r190994]  Russell Bryant <russell@digium.com>

	* main/indications.c, /: Merged revisions 190993 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r190993 |
	  russell | 2009-04-29 03:58:39 -0500 (Wed, 29 Apr 2009) | 7 lines
	  Log an error message if indications.conf is not found. (closes
	  issue #14990) Reported by: tzafrir Patches: indications_err.diff
	  uploaded by tzafrir (license 46) ........

2009-04-29 06:38 +0000 [r190985]  TransNexus OSP Development <support@transnexus.com>

	* apps/app_osplookup.c, /: Merged revisions 190830 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r190830 | transnexus | 2009-04-28 17:10:42 +0800 (Tue, 28 Apr
	  2009) | 2 lines Updated for OSP Toolkit 3.5. ........

2009-04-28 17:33 +0000 [r190907]  Tilghman Lesher <tlesher@digium.com>

	* doc/tex/cdrdriver.tex, /: Merged revisions 190904 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r190904 | tilghman | 2009-04-28 12:31:43 -0500 (Tue, 28 Apr 2009)
	  | 2 lines UniqueID column has a maximum size of 150 ........

2009-04-28 14:17 +0000 [r190732-190869]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, /: Merged revisions 190865 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r190865 |
	  kpfleming | 2009-04-28 09:15:47 -0500 (Tue, 28 Apr 2009) | 5
	  lines Build XML documention from *only* the source files that
	  have docs in them Change the build process so that
	  doc/core-en_US.xml is dependent solely on the source files that
	  have documentation in them, not on all source files. ........

	* /, Makefile.rules: Merged revisions 190861 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r190861 |
	  kpfleming | 2009-04-28 09:12:09 -0500 (Tue, 28 Apr 2009) | 5
	  lines Remove Makefile rules for bison and flex sources We never,
	  ever want these files to processed automatically, because we
	  store the output files in Subversion and users should never need
	  to rebuild them. ........

	* /, configure, include/asterisk/autoconfig.h.in: Merged revisions
	  190725 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r190725 | kpfleming | 2009-04-27 14:30:54 -0500 (Mon, 27 Apr
	  2009) | 13 lines Merged revisions 190721 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r190721 | kpfleming | 2009-04-27 14:29:46 -0500 (Mon, 27 Apr
	  2009) | 7 lines Fix 'inconsistent line endings' when autoconf
	  2.63 is used Attempt to make configure script regeneration 'safe'
	  using autoconf 2.63, which embeds a bare CR into the script, thus
	  making Subversion complain about inconsistent line endings This
	  commit changes the MIME type of the configure script to be
	  'binary' thus making Subversion no longer inspect line endings,
	  and as a bonus 'svn diff' will no longer try to generate diff
	  output for it, which is not generally useful anyway. ........
	  ................

2009-04-27 19:36 +0000 [r190729]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 190726 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r190726 |
	  tilghman | 2009-04-27 14:34:48 -0500 (Mon, 27 Apr 2009) | 4 lines
	  Don't warn on pipe in the System call. (closes issue #14979)
	  Reported by: pj ........

2009-04-27 19:15 +0000 [r190666]  Russell Bryant <russell@digium.com>

	* res/res_smdi.c, /: Merged revisions 190663 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r190663 | russell | 2009-04-27 14:08:12 -0500 (Mon, 27 Apr 2009)
	  | 22 lines Merged revisions 190661-190662 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r190661 | russell | 2009-04-27 14:00:54 -0500 (Mon, 27 Apr 2009)
	  | 9 lines Resolve a crash in res_smdi when used with chan_dahdi.
	  When chan_dahdi goes to get an SMDI message, it provides no
	  search criteria. It just grabs the next message that arrives.
	  This code was written with the SMDI dialplan functions in mind,
	  since that is now the preferred method of using SMDI. However,
	  this broke support of it being used from chan_dahdi. (closes
	  AST-212) ........ r190662 | russell | 2009-04-27 14:03:59 -0500
	  (Mon, 27 Apr 2009) | 2 lines Fix a typo from 190661. ........
	  ................

2009-04-27 16:28 +0000 [r190625]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 190622 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r190622 |
	  mmichelson | 2009-04-27 11:26:14 -0500 (Mon, 27 Apr 2009) | 3
	  lines Update warning message to not have pipes and contain all
	  options. ........

2009-04-23 21:23 +0000 [r190383]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 190371 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ ........

2009-04-23 20:44 +0000 [r190355]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 190352 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r190352 |
	  tilghman | 2009-04-23 15:42:11 -0500 (Thu, 23 Apr 2009) | 7 lines
	  Labels are sometimes (most of the time?) NULL for extensions.
	  (closes issue #14895) Reported by: chris-mac Patches:
	  20090423__bug14895__2.diff.txt uploaded by tilghman (license 14)
	  Tested by: lmadsen ........

2009-04-23 19:18 +0000 [r190297]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, /: Merged revisions 190287 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r190287 | file | 2009-04-23 16:15:30 -0300 (Thu,
	  23 Apr 2009) | 13 lines Merged revisions 190286 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r190286 | file | 2009-04-23 16:13:18 -0300 (Thu, 23 Apr 2009) | 6
	  lines Fix a bug in chan_local glare hangup detection. If both
	  sides of a Local channel were hung up at around the same time it
	  was possible for one thread to destroy the local private
	  structure and have the other thread immediately try to remove the
	  already freed structure from the local channel list. ........
	  ................

2009-04-23 17:47 +0000 [r190253]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 190250 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r190250 |
	  mmichelson | 2009-04-23 12:45:35 -0500 (Thu, 23 Apr 2009) | 9
	  lines Fix reversed behavior of leavewhenempty option in
	  queues.conf. (closes issue #14650) Reported by: alecdavis
	  Patches: 14650.patch uploaded by mmichelson (license 60) Tested
	  by: mmichelson, lmadsen ........

2009-04-22 21:43 +0000 [r190096]  Tilghman Lesher <tlesher@digium.com>

	* /, configure, include/asterisk/autoconfig.h.in, configure.ac,
	  include/asterisk/lock.h: Merged revisions 190093 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r190093 | tilghman | 2009-04-22 16:38:15 -0500
	  (Wed, 22 Apr 2009) | 14 lines Merged revisions 190092 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r190092 | tilghman | 2009-04-22 16:35:03 -0500 (Wed, 22 Apr 2009)
	  | 7 lines Detect availability of pthread_rwlock_timedwrlock()
	  before using it. (closes issue #14930) Reported by: tilghman
	  Patches: 20090420__bug14930.diff.txt uploaded by tilghman
	  (license 14) Tested by: mvanbaak, tilghman ........
	  ................

2009-04-22 21:18 +0000 [r189997-190066]  Jeff Peeler <jpeeler@digium.com>

	* main/cli.c, funcs/func_groupcount.c, /, main/app.c,
	  include/asterisk/channel.h: Merged revisions 190057 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r190057 | jpeeler | 2009-04-22 16:15:55 -0500 (Wed, 22 Apr 2009)
	  | 9 lines Fix building of chan_h323 with gcc-3.3 There seems to
	  be a bug with old versions of g++ that doesn't allow a structure
	  member to use the name list. Rename list member to group_list in
	  ast_group_info and change the few places it is used. (closes
	  issue #14790) Reported by: stuarth ........

	* channels/h323/chan_h323.h, /, channels/h323/ast_h323.cxx,
	  channels/chan_h323.c: Merged revisions 189993 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r189993 |
	  jpeeler | 2009-04-22 14:23:49 -0500 (Wed, 22 Apr 2009) | 18 lines
	  Make chan_h323 respect packetization settings and fix small
	  reload issue. Previously, packetization settings were ignored and
	  now they are not. A new config option 'autoframing' has been
	  added to mirror the way chan_sip handles it. Turning on the
	  autoframing option (available both as a global option or per
	  peer) overrides the local settings with the remote packetization
	  settings. Testing was performed with varying packetization levels
	  with the following codecs: ulaw, alaw, gsm, and g729. Also, an
	  unrelated config reload issue has been fixed in the case of the
	  config file not changing. (closes issue #12415) Reported by: pj
	  Patches: 2009012200_h323packetization.diff.txt uploaded by
	  mvanbaak (license 7), modified by me ........

2009-04-22 18:01 +0000 [r189986]  Russell Bryant <russell@digium.com>

	* /, main/features.c: Merged revisions 189951 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r189951 |
	  russell | 2009-04-22 11:56:43 -0500 (Wed, 22 Apr 2009) | 2 lines
	  Fix call parking callback. Pipes -> Commas. ........

2009-04-22 16:04 +0000 [r189816-189914]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_unistim.c, /: Merged revisions 189911 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r189911 | tilghman | 2009-04-22 11:01:30 -0500 (Wed, 22 Apr 2009)
	  | 7 lines Do not continue to receive DTMF, when the channel is
	  hungup and about to be destroyed. (closes issue #14858) Reported
	  by: barryf Patches: 20090421__bug14858.diff.txt uploaded by
	  tilghman (license 14) Tested by: barryf ........

	* /, configure, configure.ac: Merged revisions 189813 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r189813 | tilghman | 2009-04-22 01:33:08 -0500 (Wed, 22 Apr 2009)
	  | 3 lines Detect liblua on SuSE, and add libm for linking for
	  Fedora. (Reported via the -dev list, Subject: Compiling Asterisk
	  with LUA) ........

2009-04-21 20:45 +0000 [r189775]  David Vossel <dvossel@digium.com>

	* /, channels/chan_sip.c: Merged revisions 189771 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r189771 |
	  dvossel | 2009-04-21 15:28:37 -0500 (Tue, 21 Apr 2009) | 11 lines
	  Fixes segfault when switching UDP to TCP in sip.conf after
	  reload. If transport in sip.conf is switched from UDP to TCP,
	  Asterisk segfaults right after issuing a sip reload. The problem
	  is the socket type is changed to TCP but the fd may still be
	  present for UDP. Later, when the TCP session should be created or
	  set using an existing one, it isn't because the old file
	  descriptor is still present. Now every time transport is changed
	  during a sip.conf reload, the file descriptor is set to -1,
	  signifying it must be created or found. (closes issue #14727)
	  Reported by: pj Tested by: dvossel Review:
	  http://reviewboard.digium.com/r/229/ ........

2009-04-20 22:11 +0000 [r189540]  Tilghman Lesher <tlesher@digium.com>

	* main/stdtime/localtime.c, /: Merged revisions 189539 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r189539 | tilghman | 2009-04-20 17:10:25 -0500 (Mon, 20 Apr 2009)
	  | 3 lines Use nanosleep instead of poll. This is not just because
	  mmichelson suggested it, but also because Mac OS X puked on my
	  poll(). ........

2009-04-20 21:41 +0000 [r189536]  Terry Wilson <twilson@digium.com>

	* apps/app_dial.c, /: Merged revisions 189495,189516 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r189495 | twilson | 2009-04-20 16:24:34 -0500
	  (Mon, 20 Apr 2009) | 9 lines Merged revisions 189463 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r189463 | twilson | 2009-04-20 16:00:52 -0500 (Mon, 20
	  Apr 2009) | 2 lines Don't treat a NOANSWER like a CHANUNAVAIL
	  ........ ................ r189516 | twilson | 2009-04-20 16:29:29
	  -0500 (Mon, 20 Apr 2009) | 9 lines Merged revisions 189465 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r189465 | twilson | 2009-04-20 16:10:27 -0500 (Mon, 20 Apr 2009)
	  | 2 lines Update CDR appropriately when AST_CAUSE_NO_ANSWER is
	  set ........ ................

2009-04-20 21:36 +0000 [r189533]  Sean Bright <sean.bright@gmail.com>

	* /, res/ael/ael.tab.c, res/ael/ael.y: Merged revisions 189464 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r189464 | seanbright | 2009-04-20 17:09:59 -0400
	  (Mon, 20 Apr 2009) | 20 lines Merged revisions 189462 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r189462 | seanbright | 2009-04-20 16:58:39 -0400 (Mon, 20 Apr
	  2009) | 13 lines Properly handle @s within hints in AEL. AEL was
	  not handling the case of a device hint containing an @ symbol,
	  which caused parking hints (e.g. hint(park:exten@context)) to
	  error out the parser. This patch makes AEL treat the @ the same
	  way it treats colon and ampersand now, meaning the characters are
	  included in verbatim. (closes issue #14941) Reported by: bpgoldsb
	  Patches: bug14941.patch uploaded by seanbright (license 71)
	  Tested by: bpgoldsb ........ ................

2009-04-20 17:11 +0000 [r189353]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 189350 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r189350 |
	  file | 2009-04-20 14:05:15 -0300 (Mon, 20 Apr 2009) | 10 lines
	  Fix a bug with non-UDP connections that caused dialogs to not get
	  freed. This issue crept up because of a reference count issue on
	  non-UDP based dialogs. The dialog reference count was increased
	  when transmitting a packet reliably but never decreased. This
	  caused the dialog structure to hang around despite being unlinked
	  from the dialogs container. (closes issue #14919) Reported by:
	  vrban ........

2009-04-20 14:07 +0000 [r189281]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /: Merged revisions 189278 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r189278 | mmichelson | 2009-04-20 09:05:27 -0500 (Mon, 20 Apr
	  2009) | 18 lines Merged revisions 189277 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r189277 | mmichelson | 2009-04-20 09:04:41 -0500 (Mon, 20 Apr
	  2009) | 12 lines Move the check for chan->fdno == -1 to after the
	  zombie/hangup check. Many users were finding that their hung up
	  channels were staying up and causing 100% CPU usage. (issue
	  #14723) Reported by: seadweller Patches: 14723_1-4-tip.patch
	  uploaded by mmichelson (license 60) Tested by: falves11, bamby
	  ........ ................

2009-04-18 01:42 +0000 [r189207-189208]  David Vossel <dvossel@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 188647 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r188647 | dvossel | 2009-04-15 17:10:04 -0500
	  (Wed, 15 Apr 2009) | 18 lines Merged revisions 188646 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r188646 | dvossel | 2009-04-15 17:08:40 -0500 (Wed, 15 Apr 2009)
	  | 12 lines National prefix inserted even when caller ID not
	  available When the caller ID is restricted, the expected behavior
	  is for the caller id to be blank. In chan_dahdi, the national
	  prefix is placed onto the callers number even if its restricted
	  (empty) causing the caller id to be the national prefix rather
	  than blank. (closes issue #13207) Reported by: shawkris Patches:
	  national_prefix.diff uploaded by dvossel (license 671) Review:
	  http://reviewboard.digium.com/r/220/ ........ ................

	* /, channels/chan_agent.c: Merged revisions 189204 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r189204 | dvossel | 2009-04-17 20:28:45 -0500
	  (Fri, 17 Apr 2009) | 18 lines Merged revisions 189203 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r189203 | dvossel | 2009-04-17 20:27:19 -0500 (Fri, 17 Apr 2009)
	  | 12 lines Fixed autologoff in agents.conf not working when agent
	  logs in via AgentLogin app An agent logs in by calling an
	  extension that calls the AgentLogin app. In agents.conf
	  ackcall=always is set, so when they get a call they have the
	  choice to either acknowledge it or ignore it. autologoff=10 is
	  set as well, so if the agent ignores the call over 10sec one may
	  assume that the agent should be logged out (and in this case
	  hungup on as well), but this was not happening. (closes issue
	  #14091) Reported by: evandro Patches: autologoff.diff uploaded by
	  dvossel (license 671) Review:
	  http://reviewboard.digium.com/r/225/ ........ ................

2009-04-17 21:56 +0000 [r189140]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /: Merged
	  revisions 189137 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r189137 | rmudgett | 2009-04-17 16:48:10 -0500 (Fri, 17 Apr 2009)
	  | 17 lines Merged revisions 188833,189134 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r188833 | rmudgett | 2009-04-16 16:37:58 -0500 (Thu, 16 Apr 2009)
	  | 4 lines Only disable mISDN DSP if Asterisk DSP is enabled.
	  Leave jitter setting alone. JIRA ABE-1835 ........ r189134 |
	  rmudgett | 2009-04-17 16:27:55 -0500 (Fri, 17 Apr 2009) | 4 lines
	  Modifed/added some debug messages. JIRA ABE-1835 ........
	  ................

2009-04-17 20:21 +0000 [r189105]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 189097 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r189097 |
	  mmichelson | 2009-04-17 15:20:23 -0500 (Fri, 17 Apr 2009) | 13
	  lines Prevent a crash when SIP blonde transferring an unbridged
	  call. If one attempts to use the attended transfer button on a
	  SIP phone to transfer an unbridged call (such as a call to an
	  IVR) but hangs up while the target of the transfer is still
	  ringing, we need to not crash. The problem was that ast_hangup
	  was called from outside the channel thread. AST-211 ........

2009-04-17 19:47 +0000 [r189081]  Sean Bright <sean.bright@gmail.com>

	* main/asterisk.c, /: Merged revisions 189077 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r189077 |
	  seanbright | 2009-04-17 15:36:38 -0400 (Fri, 17 Apr 2009) | 1
	  line Fix copy/paste error with 'transmit silence' flag. ........

2009-04-17 17:31 +0000 [r189068]  Matthew Nicholson <mnicholson@digium.com>

	* main/pbx.c, /: Merged revisions 189010 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r189010 | mnicholson | 2009-04-17 10:44:18 -0500 (Fri, 17 Apr
	  2009) | 12 lines Merged revisions 189009 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r189009 | mnicholson | 2009-04-17 10:43:09 -0500 (Fri, 17 Apr
	  2009) | 5 lines Make Busy() application set the CDR disposition
	  to BUSY. (closes issue #14306) Reported by: cristiandimache
	  ........ ................

2009-04-17 14:50 +0000 [r188941-188950]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 188947 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r188947 | file | 2009-04-17 11:44:56 -0300 (Fri, 17 Apr 2009) |
	  22 lines Merged revisions 188946 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r188946 | file | 2009-04-17 11:41:25 -0300 (Fri, 17 Apr 2009) |
	  15 lines Fix a bug where a value used to create the channel name
	  was bogus. This commit fixes the scenario where an incoming call
	  is authenticated using a peer entry. Previously the channel name
	  was created using either the username setting from the sip.conf
	  entry or the IP address that the call came from. Now the channel
	  name will be created using the peer name itself. This commit will
	  not change the way the channel name is generated for users or
	  friends. (closes issue #14256) Reported by: Nick_Lewis Patches:
	  chan_sip.c-chname.patch uploaded by Nick (license 657) Tested by:
	  Nick_Lewis, file ........ ................

	* channels/chan_dahdi.c, /: Merged revisions 188938 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r188938 | file | 2009-04-17 11:26:53 -0300 (Fri,
	  17 Apr 2009) | 11 lines Merged revisions 188937 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r188937 | file | 2009-04-17 11:25:57 -0300 (Fri, 17 Apr 2009) | 4
	  lines Fix a situation where the DAHDI channel private structure
	  lock was not unlocked when it should have been. (issue AST-210)
	  ........ ................

2009-04-16 22:05 +0000 [r188777-188839]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 188836 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r188836 | tilghman | 2009-04-16 16:57:37 -0500 (Thu, 16 Apr 2009)
	  | 14 lines Merged revisions 188835 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r188835 | tilghman | 2009-04-16 16:41:13 -0500 (Thu, 16 Apr 2009)
	  | 7 lines Only update realtime, if global option rtupdate !=
	  false (closes issue #14885) Reported by: deepesh Patches:
	  20090413__bug14885.diff.txt uploaded by tilghman (license 14)
	  Tested by: deepesh ........ ................

	* apps/app_voicemail.c, /: Merged revisions 188774 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r188774 | tilghman | 2009-04-16 16:03:31 -0500
	  (Thu, 16 Apr 2009) | 11 lines Merged revisions 188773 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r188773 | tilghman | 2009-04-16 16:02:29 -0500 (Thu, 16 Apr 2009)
	  | 4 lines Umask should not be exported into global namespace.
	  (closes issue #14912) Reported by: jcapp ........
	  ................

2009-04-15 20:20 +0000 [r188474-188598]  Mark Michelson <mmichelson@digium.com>

	* /, main/file.c: Merged revisions 188585 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r188585 | mmichelson | 2009-04-15 15:17:33 -0500 (Wed, 15 Apr
	  2009) | 13 lines Merged revisions 188582 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r188582 | mmichelson | 2009-04-15 15:04:20 -0500 (Wed, 15 Apr
	  2009) | 7 lines Update ast_readvideo_callback to match
	  ast_readaudio_callback. This fixes potential refcount errors that
	  may occur on ast_filestreams. AST-208 ........ ................

	* apps/app_queue.c, /: Merged revisions 188470 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r188470 |
	  mmichelson | 2009-04-14 18:28:13 -0500 (Tue, 14 Apr 2009) | 3
	  lines Fix a couple of queue member reference leaks. ........

2009-04-14 17:46 +0000 [r188259-188416]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 188413 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r188413 |
	  file | 2009-04-14 14:40:50 -0300 (Tue, 14 Apr 2009) | 5 lines Fix
	  an incorrect clock rate when sending T140 text. (closes issue
	  #14029) Reported by: epicac ........

	* /, channels/chan_sip.c: Merged revisions 188247 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r188247 |
	  file | 2009-04-14 10:14:21 -0300 (Tue, 14 Apr 2009) | 7 lines Fix
	  a bug with the change I made yesterday to outbound proxy support.
	  Per discussion with oej on IRC we need the actual IP address, not
	  the outbound proxy IP address, in the sa field. Upon further
	  inspection this should make the behaviour of all other uses of
	  the outbound proxy in the code. ........

2009-04-14 05:47 +0000 [r188209-188213]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 188210 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r188210 |
	  tilghman | 2009-04-14 00:45:13 -0500 (Tue, 14 Apr 2009) | 2 lines
	  As suggested by Russell, warn users when their dialplan arguments
	  contain pipes, but not commas. ........

	* /, utils/smsq.c: Merged revisions 188206 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r188206 |
	  tilghman | 2009-04-14 00:27:53 -0500 (Tue, 14 Apr 2009) | 6 lines
	  Application delimiter is ',', not '|'. (closes issue #14881)
	  Reported by: stegro Patches: smsq.patch uploaded by stegro
	  (license 752) ........

2009-04-13 19:33 +0000 [r188105]  Mark Michelson <mmichelson@digium.com>

	* res/res_musiconhold.c, /: Merged revisions 188102 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r188102 | mmichelson | 2009-04-13 14:31:48 -0500 (Mon, 13 Apr
	  2009) | 5 lines Fix another crash related to cached realtime
	  music on hold. This was another off-by-one problem caused by
	  moh_register. ........

2009-04-13 16:34 +0000 [r188070]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 188067 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r188067 |
	  file | 2009-04-13 13:28:06 -0300 (Mon, 13 Apr 2009) | 10 lines
	  Fix a bug where using an outbound proxy would cause the local
	  address to be 127.0.0.1. Copy the outbound proxy IP address into
	  the SIP dialog structure as the IP address we will be sending to.
	  This has to be done because the logic that determines what local
	  IP address to use in the SIP messages is not aware of an outbound
	  proxy being in place. It only knows what IP address we are
	  sending to. (closes issue #12006) Reported by: mnicholson
	  ........

2009-04-13 14:20 +0000 [r188039]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 188032 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r188032 |
	  mmichelson | 2009-04-13 09:17:56 -0500 (Mon, 13 Apr 2009) | 6
	  lines Set all queue variables on both the caller and member
	  channels. This allows for the variables to be accessed if a
	  member macro is run. Thanks to Grigoriy Puzankin for bringing
	  this up on the -dev list. ........

2009-04-10 20:28 +0000 [r187916]  Jeff Peeler <jpeeler@digium.com>

	* channels/Makefile, /: Merged revisions 187906 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r187906 |
	  jpeeler | 2009-04-10 15:26:46 -0500 (Fri, 10 Apr 2009) | 12 lines
	  Fix module embedding for chan_h323. Include libchanh323.a in the
	  modules.link file so that all the symbols can be resolved at link
	  time. (closes issue #11966) Reported by: dome Patches:
	  issue_11966.patch uploaded by kpfleming (license 421) Tested by:
	  jpeeler ........

2009-04-10 17:31 +0000 [r187769]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/sip-friends.sql,
	  contrib/scripts/realtime_pgsql.sql, /: Merged revisions 187764
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r187764 | tilghman | 2009-04-10 12:29:34 -0500
	  (Fri, 10 Apr 2009) | 9 lines Merged revisions 187763 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r187763 | tilghman | 2009-04-10 12:28:46 -0500 (Fri, 10
	  Apr 2009) | 2 lines Add lastms column to the contributed table
	  designs ........ ................

2009-04-10 16:54 +0000 [r187724]  Kevin P. Fleming <kpfleming@digium.com>

	* /, build_tools/embed_modules.xml: Merged revisions 187721 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r187721 | kpfleming | 2009-04-10 11:51:44 -0500 (Fri, 10
	  Apr 2009) | 5 lines clean up some patterns for files to remove
	  add embedding support for bridge and test modules ........

2009-04-10 16:05 +0000 [r187679]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 187674 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r187674 |
	  tilghman | 2009-04-10 10:59:40 -0500 (Fri, 10 Apr 2009) | 4 lines
	  Ensure pvt is not NULL before dereferencing it. (closes issue
	  #14784) Reported by: pj ........

2009-04-10 16:01 +0000 [r187677]  Russell Bryant <russell@digium.com>

	* tests/test_sched.c, tests/test_heap.c, /: Merged revisions 187675
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r187675 | russell | 2009-04-10 11:00:29 -0500 (Fri, 10
	  Apr 2009) | 2 lines Disable test modules by default. ........

2009-04-10 03:57 +0000 [r187601]  Tilghman Lesher <tlesher@digium.com>

	* main/audiohook.c, main/bridging.c, main/channel.c, main/pbx.c,
	  main/manager.c, /, include/asterisk/linkedlists.h,
	  main/features.c, main/http.c, main/app.c,
	  include/asterisk/lock.h: Merged revisions 187599 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r187599 | tilghman | 2009-04-09 22:55:27 -0500 (Thu, 09 Apr 2009)
	  | 2 lines Modify headers and macros, according to Russell's
	  suggestions on the -dev list ........

2009-04-09 21:09 +0000 [r187564]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merge revision 187488 from trunk.

2009-04-09 19:29 +0000 [r187531-187546]  David Vossel <dvossel@digium.com>

	* main/audiohook.c, /: Merged revisions 186379 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r186379 |
	  dvossel | 2009-04-03 11:29:47 -0500 (Fri, 03 Apr 2009) | 6 lines
	  audio_audiohook_write_list() did not correctly update sample size
	  after ast_translate. audio_audiohook_write_list() did not take
	  into account that the sample size may change after translation
	  depending on if the original frame is is 8khz or 16khz. the
	  sample size is now updated after translating to reflect this
	  possibility. This caused the audio on the receiving end to sound
	  terrible. Thanks to jcolp and mmichelson for helping me work this
	  out. (issue AST-197) ........

	* /, channels/chan_sip.c: Merged revisions 185846 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r185846 | dvossel | 2009-04-01 14:03:32 -0500 (Wed, 01 Apr 2009)
	  | 16 lines Merged revisions 185845 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185845 | dvossel | 2009-04-01 14:02:00 -0500 (Wed, 01 Apr 2009)
	  | 10 lines Fixes issue with dropped calles due to re-Invite glare
	  and re-Invites never executing after a 491 Acknowledgement for
	  491 responses were never being processed because it didn't match
	  our pending invite's seqno. Since the ACK was never processed,
	  the 491 frame would continue to be retransmitted until eventually
	  the call was dropped due to max retries. Now during a pending
	  invite, if we receive another invite, we send an 491 and hold on
	  to that glare invite's seqno in the "glareinvite" variable for
	  that sip_pvt struct. When ACK's are received, we first check to
	  see if it is in response to our pending invite, if not we check
	  to see if it is in response to a glare invite. In this case, it
	  is in response to the glare invite and must be dealt with or the
	  call is dropped. I've changed the wait time for resending the
	  re-Invite after receving a 491 response to comply with RFC 3261.
	  Before this patch the scheduled re-Invite would only change a
	  flag indicating that the re-Invite should be sent out, now it
	  actually sends it out as well. (closes issue #12013) Reported by:
	  alx Review: http://reviewboard.digium.com/r/213/ ........
	  ................

2009-04-09 19:15 +0000 [r187496]  Mark Michelson <mmichelson@digium.com>

	* res/res_musiconhold.c, /: Merged revisions 187421,187424 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r187421 | mmichelson | 2009-04-09 12:30:39 -0500 (Thu,
	  09 Apr 2009) | 21 lines Fix a crash in res_musiconhold when using
	  cached realtime moh. The moh_register function links an mohclass
	  and then immediately unrefs the class since the container now has
	  a reference. The problem with using realtime music on hold is
	  that the class is allocated, registered, and started in one fell
	  swoop. The refcounting logic resulted in the count being off by
	  one. The same problem did not happen when using a static config
	  because the allocation and registration of an mohclass is a
	  separate operation from starting moh. This also did not affect
	  non-cached realtime moh because the classes are not registered at
	  all. I also have modified res_musiconhold to use the _t_ variants
	  of the ao2_ functions so that more info can be gleaned when
	  attempting to trace the refcounts. I found this to be incredibly
	  helpful for debugging this issue and there's no good reason to
	  remove it. (closes issue #14661) Reported by: sum ........
	  r187424 | mmichelson | 2009-04-09 12:34:39 -0500 (Thu, 09 Apr
	  2009) | 3 lines Use safe macro practices even though they really
	  aren't necessary. ........

2009-04-09 18:55 +0000 [r187051-187487]  Tilghman Lesher <tlesher@digium.com>

	* main/manager.c, /, include/asterisk/linkedlists.h,
	  include/asterisk/lock.h: Merged revisions 187483 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r187483 | tilghman | 2009-04-09 13:40:01 -0500
	  (Thu, 09 Apr 2009) | 15 lines Merged revisions 187428 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r187428 | tilghman | 2009-04-09 13:08:20 -0500 (Thu, 09 Apr 2009)
	  | 8 lines Race condition between ast_cli_command() and 'module
	  unload' could cause a deadlock. Add lock timeouts to avoid this
	  potential deadlock. (closes issue #14705) Reported by: jamessan
	  Patches: 20090320__bug14705.diff.txt uploaded by tilghman
	  (license 14) Tested by: jamessan ........ ................

	* /, channels/chan_sip.c: Merged revisions 187381 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r187381 |
	  tilghman | 2009-04-09 12:20:49 -0500 (Thu, 09 Apr 2009) | 4 lines
	  Allow '/' in username portion of register; this is a regression.
	  (closes issue #14668) Reported by: Netview ........

	* /, channels/chan_sip.c, apps/app_sendtext.c: Merged revisions
	  187363 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r187363 | tilghman | 2009-04-09 11:39:43 -0500 (Thu, 09 Apr 2009)
	  | 10 lines Merged revisions 187362 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r187362 | tilghman | 2009-04-09 11:38:37 -0500 (Thu, 09 Apr 2009)
	  | 3 lines Permit zero-length text messages in SIP. (Related to an
	  issue posted to the -users list, subject "AEL2, BASE64_DECODE and
	  hexadecimal") ........ ................

	* main/asterisk.c, agi/Makefile, build_tools/cflags.xml,
	  utils/Makefile, include/asterisk.h, /, main/Makefile,
	  main/file.c, main/astfd.c (added): Merged revisions 187302 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r187302 | tilghman | 2009-04-08 23:59:05 -0500
	  (Wed, 08 Apr 2009) | 14 lines Merged revisions 187300-187301 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r187300 | tilghman | 2009-04-08 23:31:38 -0500 (Wed, 08 Apr 2009)
	  | 3 lines Add debugging mode for diagnosing file descriptor
	  leaks. (Related to issue #14625) ........ r187301 | tilghman |
	  2009-04-08 23:32:40 -0500 (Wed, 08 Apr 2009) | 2 lines Oops,
	  missed this file in the last commit. ........ ................

	* /, funcs/func_odbc.c: Merged revisions 187050 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r187050 |
	  tilghman | 2009-04-08 12:08:43 -0500 (Wed, 08 Apr 2009) | 7 lines
	  If the first column is empty, output a delimiter anyway. (closes
	  issue #14848) Reported by: john8675309 Patches:
	  20090408__bug14848.diff.txt uploaded by tilghman (license 14)
	  Tested by: john8675309 ........

2009-04-08 16:54 +0000 [r186988-187049]  Mark Michelson <mmichelson@digium.com>

	* res/res_musiconhold.c, /: Merged revisions 187046 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r187046 | mmichelson | 2009-04-08 11:52:20 -0500
	  (Wed, 08 Apr 2009) | 16 lines Merged revisions 187045 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r187045 | mmichelson | 2009-04-08 11:52:03 -0500 (Wed, 08 Apr
	  2009) | 10 lines Fix a small logical error when loading moh
	  classes. We were unconditionally incrementing the number of
	  mohclasses registered. However, we should actually only increment
	  if the call to moh_register was successful. While this probably
	  has never caused problems, I noticed it and decided to fix it
	  anyway. ........ ................

	* main/channel.c, /: Merged revisions 186985 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186985 | mmichelson | 2009-04-08 10:27:41 -0500 (Wed, 08 Apr
	  2009) | 30 lines Merged revisions 186984 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186984 | mmichelson | 2009-04-08 10:26:46 -0500 (Wed, 08 Apr
	  2009) | 24 lines Make a couple of changes with regards to a new
	  message printed in ast_read(). "ast_read() called with no
	  recorded file descriptor" is a new message added after a bug was
	  discovered. Unfortunately, it seems there are a bunch of places
	  that potentially make such calls to ast_read() and trigger this
	  error message to be displayed. This commit does two things to
	  help to make this message appear less. First, the message has
	  been downgraded to a debug level message if dev mode is not
	  enabled. The message means a lot more to developers than it does
	  to end users, and so developers should take an effort to be sure
	  to call ast_read only when a channel is ready to be read from.
	  However, since this doesn't actually cause an error in operation
	  and is not something a user can easily fix, we should not spam
	  their console with these messages. Second, the message has been
	  moved to after the check for any pending masquerades. ast_read()
	  being called with no recorded file descriptor should not
	  interfere with a masquerade taking place. This could be seen as a
	  simple way of resolving issue #14723. However, I still want to
	  try to clear out the existing ways of triggering this message,
	  since I feel that would be a better resolution for the issue.
	  ........ ................

2009-04-08 12:39 +0000 [r186929]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 186928 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r186928 |
	  russell | 2009-04-08 07:35:57 -0500 (Wed, 08 Apr 2009) | 13 lines
	  Update some comments and resolve potential memory corruption in
	  chan_sip. While browsing chan_sip the other day, I noticed this
	  dangerous code in dialog_needdestroy(). This function is an
	  ao2_callback. It is absolutely _not_ okay to unlock the container
	  from within this function. It's also not clear why it was useful.
	  Given that it could cause memory corruption, I have removed it.
	  There was also a TODO comment left describing a potential
	  implementation of an improvement to the needdestroy handling. I'm
	  not convinced that what was described is the best choice here, so
	  I have briefly described the way that this function is used today
	  that could be improved. ........

2009-04-08 05:08 +0000 [r186901]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 186899 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r186899 |
	  tilghman | 2009-04-08 00:06:22 -0500 (Wed, 08 Apr 2009) | 2 lines
	  Add lastms to the require API call. ........

2009-04-08 00:10 +0000 [r186836-186845]  Mark Michelson <mmichelson@digium.com>

	* formats/format_wav_gsm.c, /, formats/format_wav.c: Merged
	  revisions 186842 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186842 | mmichelson | 2009-04-07 19:09:28 -0500 (Tue, 07 Apr
	  2009) | 14 lines Merged revisions 186841 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186841 | mmichelson | 2009-04-07 19:09:04 -0500 (Tue, 07 Apr
	  2009) | 8 lines Fix a few typos of the word "frequency." (closes
	  issue #14842) Reported by: jvandal Patches: frequency-typo.diff
	  uploaded by jvandal (license 413) ........ ................

	* /, channels/chan_sip.c: Merged revisions 186837 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r186837 |
	  mmichelson | 2009-04-07 19:01:49 -0500 (Tue, 07 Apr 2009) | 7
	  lines Fix bad merge from fix for issue 13867. (closes issue
	  #14686) Reported by: davidw ........

	* main/channel.c, /: Merged revisions 186833 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186833 | mmichelson | 2009-04-07 18:50:56 -0500 (Tue, 07 Apr
	  2009) | 15 lines Merged revisions 186832 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186832 | mmichelson | 2009-04-07 18:49:49 -0500 (Tue, 07 Apr
	  2009) | 8 lines Set the AST_FEATURE_WARNING_ACTIVE flag when a
	  p2p bridge returns AST_BRIDGE_RETRY. Without this flag set,
	  warning sounds will not be properly played to either party of the
	  bridge. (closes issue #14845) Reported by: adomjan ........
	  ................

2009-04-07 22:33 +0000 [r186807]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_macro.c: Merged revisions 186799 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186799 | tilghman | 2009-04-07 17:23:46 -0500 (Tue, 07 Apr 2009)
	  | 10 lines Merged revisions 186775 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186775 | tilghman | 2009-04-07 17:16:50 -0500 (Tue, 07 Apr 2009)
	  | 3 lines Fix Macro documentation to match current (and intended)
	  behavior. (See -dev mailing list) ........ ................

2009-04-07 20:59 +0000 [r186723]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c, /: Merged revisions 186720 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186720 | mmichelson | 2009-04-07 15:46:18 -0500 (Tue, 07 Apr
	  2009) | 12 lines Merged revisions 186719 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186719 | mmichelson | 2009-04-07 15:43:49 -0500 (Tue, 07 Apr
	  2009) | 6 lines Ensure that \r\n is printed after the ActionID in
	  an OriginateResponse. (closes issue #14847) Reported by: kobaz
	  ........ ................

2009-04-03 20:21 +0000 [r186469]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 186461 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r186461 | kpfleming | 2009-04-03 15:20:01 -0500
	  (Fri, 03 Apr 2009) | 11 lines Merged revisions 186458 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186458 | kpfleming | 2009-04-03 15:19:20 -0500 (Fri, 03 Apr
	  2009) | 5 lines Fix a bug where DAHDI/Zaptel channels would not
	  properly switch formats when requested Don't offer
	  AST_FORMAT_SLINEAR on DAHDI/Zaptel channels... while it could
	  provide a slight performance benefit, the translation core in
	  Asterisk has some flaws when a channel driver offers multiple raw
	  formats. this fix is much simpler than fixing the translation
	  core to solve that issue (although that will be done later).
	  ........ ................

2009-04-03 20:05 +0000 [r186449]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c, /, configs/voicemail.conf.sample: Merged
	  revisions 186444,186447 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186444 | tilghman | 2009-04-03 14:30:34 -0500 (Fri, 03 Apr 2009)
	  | 14 lines Merged revisions 186415 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186415 | tilghman | 2009-04-03 14:06:58 -0500 (Fri, 03 Apr 2009)
	  | 7 lines Distinguish in a sent email between simple sends and
	  forwards. (closes issue #11678) Reported by: jamessan Patches:
	  20090330__bug11678.diff.txt uploaded by tilghman (license 14)
	  Tested by: tilghman, lmadsen ........ ................ r186447 |
	  tilghman | 2009-04-03 14:59:55 -0500 (Fri, 03 Apr 2009) | 9 lines
	  Merged revisions 186445 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186445 | tilghman | 2009-04-03 14:56:48 -0500 (Fri, 03 Apr 2009)
	  | 2 lines Found a conflict in the last commit, due to multiple
	  targets ........ ................

2009-04-03 15:56 +0000 [r186324]  Joshua Colp <jcolp@digium.com>

	* include/asterisk/crypto.h, /: Merged revisions 186321 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r186321 | file | 2009-04-03 12:52:50 -0300 (Fri,
	  03 Apr 2009) | 12 lines Merged revisions 186320 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186320 | file | 2009-04-03 12:48:56 -0300 (Fri, 03 Apr 2009) | 5
	  lines Fix a problem with the crypto variable definitions not
	  actually being defined properly. (closes issue #14804) Reported
	  by: jvandal ........ ................

2009-04-03 15:19 +0000 [r186302]  Tilghman Lesher <tlesher@digium.com>

	* main/stdtime/localtime.c, /: Merged revisions 186297 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r186297 | tilghman | 2009-04-03 10:18:28 -0500 (Fri, 03 Apr 2009)
	  | 4 lines Compatibility fix for glibc 2.4 (Closes issue #14820)
	  Reported by: phsultan ........

2009-04-03 14:34 +0000 [r186289]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 186286 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r186286 | mmichelson | 2009-04-03 09:32:05 -0500 (Fri, 03 Apr
	  2009) | 20 lines Fix the ability to retrieve voicemail messages
	  from IMAP. A recent change made interactive vm_states no longer
	  get added to the list of vm_states and instead get stored in
	  thread-local storage. In trunk and all the 1.6.X branches, the
	  problem is that when we search for messages in a voicemail box,
	  we would attempt to update the appropriate vm_state struct by
	  directly searching in the list of vm_states instead of using the
	  get_vm_state_by_imap_user function. This meant we could not find
	  the interactive vm_state that we wanted. (closes issue #14685)
	  Reported by: BlargMaN Patches: 14685.patch uploaded by mmichelson
	  (license 60) Tested by: BlargMaN, qualleyiv, mmichelson ........

2009-04-03 02:11 +0000 [r186233]  Russell Bryant <russell@digium.com>

	* cdr/cdr_radius.c, /: Merged revisions 186230 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186230 | russell | 2009-04-02 21:03:48 -0500 (Thu, 02 Apr 2009)
	  | 29 lines Merged revisions 186229 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186229 | russell | 2009-04-02 20:57:44 -0500 (Thu, 02 Apr 2009)
	  | 21 lines Fix a memory leak in cdr_radius. I came across this
	  while doing some testing of my ast_channel_ao2 branch. After
	  running a test overnight that generated over 5 million calls,
	  Asterisk had taken up about 1 GB of my system memory. So, I
	  re-ran the test with MALLOC_DEBUG turned on. However, it showed
	  no leaks in Asterisk during the test, even though Asterisk was
	  still consuming it somehow. Instead, I turned to valgrind, which
	  when run with --leak-check=full, told me exactly where the leak
	  came from, which was from allocations inside the radiusclient-ng
	  library. This explains why MALLOC_DEBUG did not report it. After
	  a bit of analysis, I found that we were leaking a little bit of
	  memory every time a CDR record was passed to cdr_radius. I don't
	  actually have a radius server set up to receive CDR records.
	  However, I always have my development systems compile and install
	  all modules. In addition to making sure there are not build
	  errors across modules, always loading modules helps find bugs
	  like this, too, so it is strongly recommend for all developers.
	  ........ ................

2009-04-02 22:00 +0000 [r186178]  Mark Michelson <mmichelson@digium.com>

	* configs/features.conf.sample, /: Merged revisions 186175 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r186175 | mmichelson | 2009-04-02 16:56:21 -0500
	  (Thu, 02 Apr 2009) | 11 lines Merged revisions 186174 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r186174 | mmichelson | 2009-04-02 16:55:34 -0500 (Thu, 02 Apr
	  2009) | 5 lines Fix instructions in one-step parking comment to
	  make more sense. Changed a capital K to a lowercase k. ........
	  ................

2009-04-02 17:28 +0000 [r186111]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 186101 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r186101 | kpfleming | 2009-04-02 12:26:07 -0500
	  (Thu, 02 Apr 2009) | 9 lines Merged revisions 186081 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r186081 | kpfleming | 2009-04-02 12:21:29 -0500 (Thu, 02
	  Apr 2009) | 3 lines ensure that the buffer passed to
	  DAHDI_SET_BUFINFO is fully initialized ........ ................

2009-04-02 17:14 +0000 [r186022-186063]  Tilghman Lesher <tlesher@digium.com>

	* configs/sip.conf.sample, /, channels/chan_sip.c: Merged revisions
	  186060 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r186060 | tilghman | 2009-04-02 12:10:28 -0500 (Thu, 02 Apr 2009)
	  | 16 lines Merged revisions 186059 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r186059 | tilghman | 2009-04-02 12:09:13 -0500
	  (Thu, 02 Apr 2009) | 9 lines Merged revisions 186056 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r186056 | tilghman | 2009-04-02 12:02:18 -0500 (Thu, 02
	  Apr 2009) | 2 lines Fix for AST-2009-003 ........
	  ................ ................

	* main/strings.c, /: Merged revisions 186021 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r186021 |
	  tilghman | 2009-04-02 10:14:22 -0500 (Thu, 02 Apr 2009) | 7 lines
	  Missed a common case for needing to extend the buffer. (closes
	  issue #14716) Reported by: sum Patches:
	  20090402__bug14716.diff.txt uploaded by tilghman (license 14)
	  Tested by: sum ........

2009-04-02 13:54 +0000 [r185957]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 185953 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r185953 | kpfleming | 2009-04-02 08:51:44 -0500
	  (Thu, 02 Apr 2009) | 11 lines Merged revisions 185952 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185952 | kpfleming | 2009-04-02 08:43:43 -0500 (Thu, 02 Apr
	  2009) | 5 lines the DAHDI_GETCONF, DAHDI_SETCONF and
	  DAHDI_GET_PARAMS ioctls were recently corrected to show that they
	  do, in fact, read data from userspace as part of their work. due
	  to this fix, valgrind now reports a number of cases where
	  chan_dahdi passed an uninitialized (or partially) buffer to these
	  ioctls, which could lead to unexpected behavior. this patch
	  corrects chan_dahdi to ensure that buffers passed to these ioctls
	  are always fully initialized. ........ ................

2009-04-01 22:44 +0000 [r185947]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/pbx.h, include/asterisk/strings.h,
	  main/taskprocessor.c, res/res_odbc.c,
	  include/asterisk/res_odbc.h, include/asterisk.h, main/strings.c,
	  main/manager.c, /, main/tdd.c, include/asterisk/astobj2.h,
	  main/ast_expr2f.c: Merged revisions 185912 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r185912 |
	  tilghman | 2009-04-01 15:13:28 -0500 (Wed, 01 Apr 2009) | 4 lines
	  Merge changes from str_substitution that are unrelated to that
	  branch. Included is a small bugfix to an ast_str helper, but most
	  of these changes are simply doxygen fixes. ........

2009-04-01 13:51 +0000 [r185775]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 185772 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r185772 | russell | 2009-04-01 08:48:26 -0500 (Wed, 01 Apr 2009)
	  | 14 lines Merged revisions 185771 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185771 | russell | 2009-04-01 08:47:30 -0500 (Wed, 01 Apr 2009)
	  | 6 lines Fix a case where DTMF could bypass audiohooks. This
	  change fixes a situation where an audiohook that wants DTMF would
	  not actually get it. This is in the code path where we end DTMF
	  digit length emulation while handling a NULL frame. ........
	  ................

2009-03-31 22:38 +0000 [r185667]  Kevin P. Fleming <kpfleming@digium.com>

	* utils, /: Merged revisions 185664 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r185664 |
	  kpfleming | 2009-03-31 17:35:07 -0500 (Tue, 31 Mar 2009) | 1 line
	  ignore copied (generated) file ........

2009-03-31 22:13 +0000 [r185472-185605]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 185604 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r185604 |
	  mmichelson | 2009-03-31 17:12:52 -0500 (Tue, 31 Mar 2009) | 3
	  lines Fix trunk's compilation. ........

	* apps/app_queue.c, /: Merged revisions 185600 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r185600 | mmichelson | 2009-03-31 17:02:48 -0500 (Tue, 31 Mar
	  2009) | 12 lines Merged revisions 185599 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185599 | mmichelson | 2009-03-31 17:00:01 -0500 (Tue, 31 Mar
	  2009) | 6 lines Fix crash that would occur if an empty member was
	  specified in queues.conf. (closes issue #14796) Reported by: pida
	  ........ ................

	* apps/app_voicemail.c, /: Merged revisions 185469 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r185469 | mmichelson | 2009-03-31 14:46:18 -0500
	  (Tue, 31 Mar 2009) | 14 lines Merged revisions 185468 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185468 | mmichelson | 2009-03-31 14:45:30 -0500 (Tue, 31 Mar
	  2009) | 8 lines Fix Russian voicemail intro to say the word
	  "messages" properly. (closes issue #14736) Reported by: chappell
	  Patches: voicemail_no_messages.diff uploaded by chappell (license
	  8) ........ ................

2009-03-31 17:51 +0000 [r185428]  David Brooks <dbrooks@digium.com>

	* channels/chan_gtalk.c, /: Merged revisions 185363 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r185363 | dbrooks | 2009-03-31 11:46:57 -0500
	  (Tue, 31 Mar 2009) | 44 lines Merged revisions 185362 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185362 | dbrooks | 2009-03-31 11:37:12 -0500 (Tue, 31 Mar 2009)
	  | 35 lines Fix incorrect parsing in chan_gtalk when xmpp contains
	  extra whitespaces To drill into the xmpp to find the capabilities
	  between channels, chan_gtalk calls iks_child() and iks_next().
	  iks_child() and iks_next() are functions in the iksemel xml
	  parsing library that traverse xml nodes. The bug here is that
	  both iks_child() and iks_next() will return the next iks_struct
	  node *regardless* of type. chan_gtalk expects the next node to be
	  of type IKS_TAG, which in most cases, it is, but in this case (a
	  call being made from the Empathy IM client), there exists
	  iks_struct nodes which are not IKS_TAG data (they are extraneous
	  whitespaces), and chan_gtalk doesn't handle that case, so
	  capabilities don't match, and a call cannot be made.
	  iks_first_tag() and iks_next_tag(), on the other hand, will not
	  return the very next iks_struct, but will check to see if the
	  next iks_struct is of type IKS_TAG. If it isn't, it will be
	  skipped, and the next struct of type IKS_TAG it finds will be
	  returned. This assures that chan_gtalk will find the iks_struct
	  it is looking for. This fix simply changes all calls to
	  iks_child() and iks_next() to become calls to iks_first_tag() and
	  iks_next_tag(), which resolves the capability matching. The
	  following is a payload listing from Empathy, which, due to the
	  extraneous whitespace, will not be parsed correctly by iksemel:
	  <iq from='dbrooksjab@235-22-24-10/Telepathy'
	  to='astjab@235-22-24-10/asterisk' type='set' id='542757715704'>
	  <session xmlns='http://www.google.com/session'
	  initiator='dbrooksjab@235-22-24-10/Telepathy' type='initiate'
	  id='1837267342'> <description
	  xmlns='http://www.google.com/session/phone'> <payload-type
	  clockrate='16000' name='speex' id='96'/> <payload-type
	  clockrate='8000' name='PCMA' id='8'/> <payload-type
	  clockrate='8000' name='PCMU' id='0'/> <payload-type
	  clockrate='90000' name='MPA' id='97'/> <payload-type
	  clockrate='16000' name='SIREN' id='98'/> <payload-type
	  clockrate='8000' name='telephone-event' id='99'/> </description>
	  </session> </iq> Review: http://reviewboard.digium.com/r/181/
	  ........ ................

2009-03-31 14:59 +0000 [r185264]  Russell Bryant <russell@digium.com>

	* apps/app_queue.c, /: Merged revisions 185261 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r185261 |
	  russell | 2009-03-31 09:53:45 -0500 (Tue, 31 Mar 2009) | 5 lines
	  Don't free() an astobj2 object. (closes issue #14672) Reported
	  by: makoto ........

2009-03-31 14:11 +0000 [r185200]  Joshua Colp <jcolp@digium.com>

	* main/audiohook.c, /: Merged revisions 185197 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r185197 | file | 2009-03-31 11:07:36 -0300 (Tue, 31 Mar 2009) |
	  15 lines Merged revisions 185196 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185196 | file | 2009-03-31 11:06:39 -0300 (Tue, 31 Mar 2009) | 8
	  lines Fix crash when moving audiohooks between channels. Handle
	  the scenario where we are called to move audiohooks between
	  channels and the source channel does not actually have any on it.
	  (closes issue #14734) Reported by: corruptor ........
	  ................

2009-03-30 20:52 +0000 [r185128-185129]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn_config.c, /, configs/misdn.conf.sample: Merged
	  revisions 185123 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r185123 | rmudgett | 2009-03-30 15:42:14 -0500 (Mon, 30 Mar 2009)
	  | 9 lines Merged revisions 185121 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185121 | rmudgett | 2009-03-30 15:40:11 -0500 (Mon, 30 Mar 2009)
	  | 1 line Update the channel allocation method documentation.
	  ........ ................

	* channels/misdn/isdn_lib.c, /: Merged revisions 185122 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r185122 | rmudgett | 2009-03-30 15:41:24 -0500
	  (Mon, 30 Mar 2009) | 26 lines Merged revisions 185120 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185120 | rmudgett | 2009-03-30 15:38:11 -0500 (Mon, 30 Mar 2009)
	  | 19 lines Make chan_misdn BRI TE side normally defer channel
	  selection to the NT side. Channel allocation collisions are not
	  handled by chan_misdn very well. This patch simply avoids the
	  problem for BRI only. For PRI, allocation collisions are still
	  possible but less likely since there are simply more channels
	  available and each end could use a different allocation strategy.
	  misdn.conf options available: te_choose_channel - Use to force
	  the TE side to allocate channels. method - Specify the channel
	  allocation strategy. (closes issue #13488) Reported by:
	  Christian_Pinedo Patches: isdn_lib.patch.txt uploaded by crich
	  Tested by: crich, siepkes, festr ........ ................

2009-03-30 16:52 +0000 [r185089]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 185072 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r185072 | mmichelson | 2009-03-30 11:26:48 -0500 (Mon, 30 Mar
	  2009) | 45 lines Merged revisions 185031 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r185031 | mmichelson | 2009-03-30 11:17:35 -0500 (Mon, 30 Mar
	  2009) | 39 lines Fix queue weight behavior so that calls in
	  low-weight queues are not inappropriately blocked. (This is
	  copied and pasted from the review request I made for this patch)
	  Asterisk has some odd behavior when queue weights are used. The
	  current logic used when potentially calling a queue member is: If
	  the member we are going to call is part of another queue and
	  _that other queue has any callers in it_ and has a higher weight
	  than the queue we are calling from, then don't try to contact
	  that member. The issue here is what I have marked with
	  underscores. If the higher-weighted queue has any callers in it
	  at all, then the queue member will be unreachable from the
	  lower-weighted queue. This has the potential to be really really
	  bad if using a queue strategy, such as leastrecent or
	  fewestcalls, with the potential to call the same member
	  repeatedly. The fix proposed by garychen on issue 13220 is very
	  simple and, as far as I can see, works well for this situation.
	  With this set of changes, the logic used becomes: If the member
	  we are going to call is part of another queue, the other queue
	  has a higher weight than the queue we are calling from, and the
	  higher weight queue has at least as many callers as available
	  members, then do not try to contact the queue member. If the
	  higher weighted queue has fewer callers than available members,
	  then there is no reason to deny the call to this member since the
	  other queue can afford to spare a member. Since the fix involved
	  writing a generic function for determining the number of
	  available members in the queue, I also modified the is_our_turn
	  function to make use of the new num_available_members function to
	  determine if it is our turn to try calling a member. There is one
	  small behavior change. Before writing this patch, if you had
	  autofill disabled, then if you were the head caller in a queue,
	  you would automatically be told that it was your turn to try
	  calling a member. This did not take into account whether there
	  were actually any queue members available to take the call. Now
	  we actually make sure there is at least one member available to
	  take the call if autofill is disabled. (closes issue #13220)
	  Reported by: garychen Review:
	  http://reviewboard.digium.com/r/202/ ........ ................

2009-03-30 14:43 +0000 [r184951]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 184948 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r184948 | file | 2009-03-30 11:37:47 -0300 (Mon, 30 Mar 2009) |
	  21 lines Merged revisions 184947 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r184947 | file | 2009-03-30 11:35:47 -0300 (Mon, 30 Mar 2009) |
	  14 lines Improve our handling of T38 in the initial INVITE from a
	  device. We now answer with matching media streams to what is
	  requested. If an INVITE is received with both a T38 and RTP media
	  stream this means we answer with both. For any outgoing calls
	  created as a result of this inbound one no T38 is requested in
	  the initial INVITE. Instead if we start receiving udptl packets
	  we trigger a reinvite on the outbound side. (closes issue #12437)
	  Reported by: marsosa Tested by: pinga-fogo, okrief, file, afu
	  Review: http://reviewboard.digium.com/r/208/ ........
	  ................

2009-03-30 13:57 +0000 [r184913]  Russell Bryant <russell@digium.com>

	* channels/h323/Makefile.in, /: Merged revisions 184910 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r184910 | russell | 2009-03-30 08:55:44 -0500 (Mon, 30
	  Mar 2009) | 4 lines Fix build error when chan_h323 is not being
	  built. (reported by cai1982 in #asterisk-dev) ........

2009-03-29 05:56 +0000 [r184839-184846]  Russell Bryant <russell@digium.com>

	* apps/app_followme.c, /: Merged revisions 184843 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r184843 | russell | 2009-03-29 00:52:20 -0500 (Sun, 29 Mar 2009)
	  | 13 lines Merged revisions 184842 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r184842 | russell | 2009-03-29 00:51:55 -0500 (Sun, 29 Mar 2009)
	  | 5 lines Ensure targs variable is fully initialized. (closes
	  issue #14758) Reported by: tim_ringenbach ........
	  ................

	* channels/Makefile, /: Merged revisions 184838 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184838 |
	  russell | 2009-03-29 00:32:04 -0500 (Sun, 29 Mar 2009) | 8 lines
	  Simplify chan_h323 build to not require a second run of "make".
	  (closes issue #14715) Reported by: jthurman Patches:
	  h323-makefile-1.6.2.0-beta1.patch uploaded by jthurman (license
	  614) Tested by: tzafrir, russell ........

2009-03-27 19:21 +0000 [r184779]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c, main/timing.c, main/channel.c, /,
	  bridges/bridge_softmix.c, include/asterisk/timing.h,
	  include/asterisk/channel.h: Merged revisions 184762 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r184762 | kpfleming | 2009-03-27 14:10:32 -0500 (Fri, 27 Mar
	  2009) | 12 lines Improve timing interface to remember which
	  provider provided a timer The ability to load/unload timing
	  interfaces is nice, but it means that when a timer is allocated,
	  it may come from provider A, but later provider B becomes the
	  'preferred' provider. If this happens, all timer API calls on the
	  timer that was provided by provider A will actually be handed to
	  provider B, which will say WTF and return an error. This patch
	  changes the timer API to include a pointer to the provider of the
	  timer handle so that future operations on the timer will be
	  forwarded to the proper provider. (closes issue #14697) Reported
	  by: moy Review: http://reviewboard.digium.com/r/211/ ........

2009-03-27 18:12 +0000 [r184707-184729]  Russell Bryant <russell@digium.com>

	* main/manager.c, /, apps/app_minivm.c: Merged revisions 184726 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r184726 | russell | 2009-03-27 13:04:43 -0500 (Fri, 27
	  Mar 2009) | 2 lines Use ast_random() instead of rand() to ensure
	  we use the best RNG available. ........

	* apps/app_queue.c, apps/app_voicemail.c, main/cli.c,
	  include/asterisk/app.h, /, apps/app_dumpchan.c, main/app.c:
	  Merged revisions 184693 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184693 |
	  russell | 2009-03-27 11:21:10 -0500 (Fri, 27 Mar 2009) | 2 lines
	  Change global_app_buf to ast_str_thread_global_buf. ........

2009-03-27 15:58 +0000 [r184650-184678]  Joshua Colp <jcolp@digium.com>

	* /, bridges/bridge_softmix.c: Merged revisions 184677 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r184677 | file | 2009-03-27 12:57:28 -0300 (Fri, 27 Mar 2009) | 7
	  lines Fix a potential timer leak in bridge_softmix. It is
	  possible for a bridge to be created without actually being used.
	  In that scenario a timing file descriptor would be opened and not
	  closed. To fix this the timing file descriptor is now closed in
	  the destroy callback, not the thread function. ........

	* /, res/res_agi.c: Merged revisions 184673 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184673 |
	  file | 2009-03-27 12:46:46 -0300 (Fri, 27 Mar 2009) | 7 lines Fix
	  speech structure leak in the AGI speech recognition integration.
	  The AGI dialplan applications did not destroy the speech
	  structure automatically if it was not destroyed by the running
	  AGI script. They will now do this. (issue LUMENVOX-15) ........

	* /, bridges/bridge_softmix.c: Merged revisions 184639 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r184639 | file | 2009-03-27 11:18:40 -0300 (Fri, 27 Mar 2009) | 2
	  lines Remove a cast that is not needed. ........

2009-03-27 14:09 +0000 [r184632]  Russell Bryant <russell@digium.com>

	* main/asterisk.c, include/asterisk/utils.h, main/pbx.c, /,
	  res/ais/evt.c, main/event.c, pbx/pbx_dundi.c: Merged revisions
	  184630 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184630 |
	  russell | 2009-03-27 09:00:18 -0500 (Fri, 27 Mar 2009) | 2 lines
	  Change g_eid to ast_eid_default. ........

2009-03-27 13:59 +0000 [r184612-184629]  Joshua Colp <jcolp@digium.com>

	* /, bridges/bridge_softmix.c: Merged revisions 184628 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r184628 | file | 2009-03-27 10:57:29 -0300 (Fri, 27 Mar 2009) | 6
	  lines Fix a potential race condition when creating a software
	  based mixing bridge. It was possible for no timer to become
	  available between creating the bridge and starting it. We now
	  open a timer when creating it and keep it open until the bridge
	  is destroyed. ........

	* /, channels/chan_sip.c: Merged revisions 184566 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r184566 | file | 2009-03-27 10:15:26 -0300 (Fri, 27 Mar 2009) |
	  16 lines Merged revisions 184565 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r184565 | file | 2009-03-27 10:06:45 -0300 (Fri, 27 Mar 2009) | 9
	  lines Fix an issue where nat=yes would not always take effect for
	  the RTP session on outgoing calls. If calls were placed using an
	  IP address or hostname the global nat setting was copied over but
	  was not set on the RTP session itself. This caused the RTP stack
	  to not perform symmetric RTP actions. (closes issue #14546)
	  Reported by: acunningham ........ ................

2009-03-27 02:35 +0000 [r184514-184552]  Russell Bryant <russell@digium.com>

	* /, include/asterisk/lock.h: Merged revisions 184531 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r184531 | russell | 2009-03-26 21:20:23 -0500 (Thu, 26 Mar 2009)
	  | 20 lines Fix some issues with rwlock corruption that caused
	  deadlock like symptoms. When dvossel and I were doing some load
	  testing last week, we noticed that we could make Asterisk trunk
	  lock up instantly when we started generating a bunch of calls.
	  The backtraces of locked threads were bizarre, and many were
	  stuck on an _unlock_ of an rwlock. The changes are: 1) Fix a
	  number of places where a backtrace would be loaded into an
	  invalid index of the backtrace array. It's an off by one error,
	  which ends up writing over the rwlock itself. 2) Ensure that in
	  the array of held locks, we NULL out an index once it is not
	  being used so that it's not confusing when analyzing its
	  contents. 3) Remove a bunch of logging referring to an rwlock
	  operating being done with "deep reentrancy". It is normal for
	  _many_ threads to hold a read lock on an rwlock. ........

	* /, main/file.c: Merged revisions 184515 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184515 |
	  russell | 2009-03-26 20:40:28 -0500 (Thu, 26 Mar 2009) | 2 lines
	  Don't act surprised if we get a -1 indication. ........

	* include/asterisk/heap.h, /, main/heap.c: Merged revisions 184512
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r184512 | russell | 2009-03-26 20:35:56 -0500 (Thu, 26
	  Mar 2009) | 2 lines Pass more useful information through to lock
	  tracking when DEBUG_THREADS is on. ........

2009-03-26 22:19 +0000 [r184454]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile, /: Merged revisions 184448 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r184448 | kpfleming | 2009-03-26 17:18:14 -0500 (Thu, 26 Mar
	  2009) | 9 lines Merged revisions 184447 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r184447 | kpfleming | 2009-03-26 17:17:32 -0500 (Thu, 26 Mar
	  2009) | 3 lines use new, improved 8kHz prompts ........
	  ................

2009-03-25 22:15 +0000 [r184343-184346]  Russell Bryant <russell@digium.com>

	* /, main/event.c: Merged revisions 184344 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184344 |
	  russell | 2009-03-25 17:11:35 -0500 (Wed, 25 Mar 2009) | 2 lines
	  Remove unneeded AST_LIST_ENTRY() and comment on the purpose of
	  ast_event_ref. ........

	* include/asterisk/_private.h, channels/chan_iax2.c,
	  channels/chan_dahdi.c, include/asterisk/event.h,
	  apps/app_minivm.c, res/ais/evt.c, main/event.c,
	  include/asterisk/strings.h, main/asterisk.c,
	  channels/chan_mgcp.c, apps/app_voicemail.c,
	  channels/chan_unistim.c, include/asterisk/devicestate.h, /,
	  channels/chan_sip.c, main/devicestate.c: Merged revisions 184339
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r184339 | russell | 2009-03-25 16:57:19 -0500 (Wed, 25
	  Mar 2009) | 35 lines Improve performance of the ast_event cache
	  functionality. This code comes from
	  svn/asterisk/team/russell/event_performance/. Here is a summary
	  of the changes that have been made, in order of both invasiveness
	  and performance impact, from smallest to largest. 1) Asterisk
	  1.6.1 introduces some additional logic to be able to handle
	  distributed device state. This functionality comes at a cost. One
	  relatively minor change in this patch is that the extra
	  processing required for distributed device state is now
	  completely bypassed if it's not needed. 2) One of the things that
	  I noticed when profiling this code was that a _lot_ of time was
	  spent doing string comparisons. I changed the way strings are
	  represented in an event to include a hash value at the front. So,
	  before doing a string comparison, we do an integer comparison on
	  the hash. 3) Finally, the code that handles the event cache has
	  been re-written. I tried to do this in a such a way that it had
	  minimal impact on the API. I did have to change one API call,
	  though - ast_event_queue_and_cache(). However, the way it works
	  now is nicer, IMO. Each type of event that can be cached (MWI,
	  device state) has its own hash table and rules for hashing and
	  comparing objects. This by far made the biggest impact on
	  performance. For additional details regarding this code and how
	  it was tested, please see the review request. (closes issue
	  #14738) Reported by: russell Review:
	  http://reviewboard.digium.com/r/205/ ........

2009-03-25 19:27 +0000 [r184266-184283]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 184280 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184280 |
	  file | 2009-03-25 16:22:06 -0300 (Wed, 25 Mar 2009) | 5 lines Fix
	  issue with a T38 reinvite being sent even if not configured to do
	  so. If we receive a T38 request negotiate control frame we should
	  only attempt to do so if the option is enabled on the dialog.
	  ........

	* main/bridging.c, /: Merged revisions 183652 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r183652 |
	  file | 2009-03-22 18:00:28 -0300 (Sun, 22 Mar 2009) | 4 lines Fix
	  a minor logic flaw with the bridge generic thread. We only want
	  to move the channel pointers that are actually present. ........

2009-03-25 15:33 +0000 [r184256]  Eliel C. Sardanons <eliels@gmail.com>

	* main/asterisk.c, /: Merged revisions 184220 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r184220 | eliel | 2009-03-25 10:38:19 -0400 (Wed, 25 Mar 2009) |
	  19 lines Merged revisions 184188 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r184188 | eliel | 2009-03-25 10:12:54 -0400 (Wed, 25 Mar 2009) |
	  13 lines Avoid destroying the CLI line when moving the cursor
	  backward and trying to autocomplete. When moving the cursor
	  backward and pressing TAB to autocomplete, a NULL is put in the
	  line and we are loosing what we have already wrote after the
	  actual cursor position. (closes issue #14373) Reported by: eliel
	  Patches: asterisk.c.patch uploaded by eliel (license 64) Tested
	  by: lmadsen ........ ................

2009-03-25 14:40 +0000 [r184150-184221]  Russell Bryant <russell@digium.com>

	* main/timing.c, /: Merged revisions 184219 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184219 |
	  russell | 2009-03-25 09:33:32 -0500 (Wed, 25 Mar 2009) | 2 lines
	  Include poll-compat.h ........

	* main/timing.c, /: Merged revisions 184151 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184151 |
	  russell | 2009-03-24 21:03:13 -0500 (Tue, 24 Mar 2009) | 2 lines
	  Change poll() to ast_poll(). ........

	* utils/Makefile, /, include/asterisk/compat.h: Merged revisions
	  184147 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184147 |
	  russell | 2009-03-24 20:42:10 -0500 (Tue, 24 Mar 2009) | 5 lines
	  Fix build issues on Mac OSX. (closes issue #14714) Reported by:
	  ygor ........

2009-03-24 22:42 +0000 [r184082]  Mark Michelson <mmichelson@digium.com>

	* apps/app_senddtmf.c, /: Merged revisions 184079 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r184079 | mmichelson | 2009-03-24 17:40:39 -0500 (Tue, 24 Mar
	  2009) | 15 lines Merged revisions 184078 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r184078 | mmichelson | 2009-03-24 17:34:45 -0500 (Tue, 24 Mar
	  2009) | 9 lines Change NULL pointer check to be ast_strlen_zero.
	  The 'digit' variable is guaranteed to be non-NULL, so the if
	  statement could never evaluate true. Changing to ast_strlen_zero
	  makes the logic correct. This was found while reviewing
	  ast_channel_ao2 code review. ........ ................

2009-03-24 22:02 +0000 [r184041-184044]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 184043 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r184043 |
	  russell | 2009-03-24 17:00:58 -0500 (Tue, 24 Mar 2009) | 2 lines
	  Put siren7 and siren14 in ast_best_codec() just so they're in
	  there somewhere. ........

	* channels/chan_iax2.c, /: Merged revisions 184037 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r184037 | russell | 2009-03-24 16:40:44 -0500 (Tue, 24 Mar 2009)
	  | 6 lines Exclude slin16, siren7, and siren14 from bandwidth=low
	  and =medium The default codec configuration for chan_iax2 is
	  bandwidth=low. I noticed slin16 being negotiated as the codec in
	  some test calls, but that no longer happens after this change.
	  ........

2009-03-24 15:29 +0000 [r183868-183917]  Tilghman Lesher <tlesher@digium.com>

	* /, configs/voicemail.conf.sample: Merged revisions 183914 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r183914 | tilghman | 2009-03-24 10:26:42 -0500
	  (Tue, 24 Mar 2009) | 10 lines Merged revisions 183913 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r183913 | tilghman | 2009-03-24 10:25:42 -0500 (Tue, 24 Mar 2009)
	  | 3 lines Additionally note that the operator option needs an 'o'
	  extension. (Related to issue #14731) ........ ................

	* /, main/http.c: Merged revisions 183865 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r183865 |
	  tilghman | 2009-03-23 18:28:20 -0500 (Mon, 23 Mar 2009) | 2 lines
	  Allow browsers to cache images and other static content. (This is
	  a regression over 1.4) ........

2009-03-23 19:00 +0000 [r183769]  Mark Michelson <mmichelson@digium.com>

	* res/res_monitor.c, /: Merged revisions 183766 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r183766 | mmichelson | 2009-03-23 13:58:03 -0500 (Mon, 23 Mar
	  2009) | 13 lines Merged revisions 183700 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r183700 | mmichelson | 2009-03-23 12:59:28 -0500 (Mon, 23 Mar
	  2009) | 7 lines Fix a memory leak in res_monitor.c The only way
	  that this leak would occur is if Monitor were started using the
	  Manager interface and no File: header were given. Discovered
	  while reviewing the ast_channel_ao2 review request. ........
	  ................

2009-03-23 18:12 +0000 [r183704]  Leif Madsen <lmadsen@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 183701 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r183701 | lmadsen | 2009-03-23 14:06:40 -0400 (Mon, 23 Mar 2009)
	  | 7 lines Fixes a documentation error introduced during the CLI
	  cleanup at AstriDevCon 2008. (closes issue #14655) Reported by:
	  ulogic Patches: chan_dahdi.patch uploaded by ulogic (license 728)
	  Tested by: lmadsen ........

2009-03-20 17:09 +0000 [r183564]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c, /: Merged revisions 183560 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r183560 | russell | 2009-03-20 12:00:58 -0500
	  (Fri, 20 Mar 2009) | 10 lines Merged revisions 183559 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r183559 | russell | 2009-03-20 11:53:25 -0500 (Fri, 20 Mar 2009)
	  | 2 lines Fix a crash in IAX2 registration handling found during
	  load testing with dvossel. ........ ................

2009-03-20 12:19 +0000 [r183519]  Eliel C. Sardanons <eliels@gmail.com>

	* channels/chan_dahdi.c, /: Merged revisions 183511 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r183511 | eliel | 2009-03-20 08:12:49 -0400 (Fri, 20 Mar 2009) |
	  2 lines Remove duplicate <description> inside the xml
	  documentation. ........

2009-03-19 19:20 +0000 [r183337]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 183321 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk
	  ................ r183321 | tilghman | 2009-03-19 14:17:31 -0500
	  (Thu, 19 Mar 2009) | 15 lines Merged revisions 183319 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r183319 | tilghman | 2009-03-19 14:15:33 -0500 (Thu, 19 Mar 2009)
	  | 8 lines Delay signalling progress until a PRI channel really
	  signals progress. (closes issue #13034) Reported by: klaus3000
	  Patches: 20090316__bug13034.diff.txt uploaded by tilghman
	  (license 14) patch_trunk_183progress_klaus3000.txt uploaded by
	  klaus3000 (license 65) Tested by: klaus3000 ........
	  ................

2009-03-19 18:20 +0000 [r183263]  Russell Bryant <russell@digium.com>

	* main/loader.c, /, configure, include/asterisk/autoconfig.h.in,
	  configure.ac: Merged revisions 183242 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r183242 | russell | 2009-03-19 13:00:15 -0500 (Thu, 19 Mar 2009)
	  | 10 lines Merged revisions 183241 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r183241 | russell | 2009-03-19 12:52:52 -0500 (Thu, 19 Mar 2009)
	  | 2 lines Remove the use of RTLD_NOLOAD, as it is not behaving
	  like expected. ........ ................

2009-03-19 18:12 +0000 [r183247]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c, /: Merged revisions 183244 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r183244 |
	  mmichelson | 2009-03-19 13:10:34 -0500 (Thu, 19 Mar 2009) | 16
	  lines Fix a memory leak associated with queues. For every attempt
	  that app_queue made to place an outbound call to a queue member,
	  we would allocate a queue_end_bridge structure. When the bridge
	  for the call had completed, we would free the structure.
	  Unfortunately not all call attempts actually end up bridged to a
	  member, so we need to be more selective of when to allocate the
	  structure. With this change, the allocation occurs in an area
	  where we can guarantee that the call will be bridged. (closes
	  issue #14680) Reported by: caspy Patches: 14680.patch uploaded by
	  mmichelson (license 60) Tested by: caspy ........

2009-03-19  Leif Madsen <lmadsen@digium.com>

	* Release Asterisk 1.6.2.0-beta1

2009-03-19 16:11 +0000 [r183122]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 183117 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r183117 | mmichelson | 2009-03-19 11:07:54 -0500 (Thu, 19 Mar
	  2009) | 20 lines Merged revisions 183115 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r183115 | mmichelson | 2009-03-19 11:04:02 -0500 (Thu, 19 Mar
	  2009) | 14 lines Fix an issue where cancelled outgoing SIP calls
	  would erroneously report the device as "in use." A user was
	  having an issue where if an outgoing SIP call was canceled, the
	  SIP device would remain in use if we had not received any
	  response to the initial INVITE we sent out. The SIP device would
	  remain in use until the autocongestion timer was exhausted. I
	  tracked down the cause of this to be the section of code I am
	  removing here. I asked several people what the purpose of this
	  code was meant to be, but no one could give me any sort of answer
	  as to why this was here. The person who was having this issue has
	  been using this patch for several months and it has stopped the
	  problems they have had. AST-196 ........ ................

2009-03-19 15:45 +0000 [r183068-183111]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 183108 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r183108 |
	  file | 2009-03-19 12:37:23 -0300 (Thu, 19 Mar 2009) | 11 lines
	  Improve our triggering of a T38 switchover internally when
	  triggered by a received reinvite. Previously we reached across
	  the channel bridge to get the other party's SIP dialog structure
	  in order to trigger an outgoing reinvite. This is extremely
	  dangerous to do and only works if bridged to another SIP channel.
	  This patch changes this to use the T38 control frame method of
	  requesting a switchover. This change also causes the SIP channel
	  driver to propogate back whether the switchover worked or not
	  instead of blindly accepting the incoming T38 reinvite. Review:
	  http://reviewboard.digium.com/r/200/ ........

	* main/channel.c, /: Merged revisions 183057 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r183057 |
	  file | 2009-03-18 19:22:56 -0300 (Wed, 18 Mar 2009) | 6 lines Fix
	  an issue where a T38 control frame would get dropped. If two
	  channels were bridged together using a generic bridge the T38
	  control frame would get passed up instead of being indicated on
	  the other channel. ........

2009-03-18 21:19 +0000 [r183031]  Jeff Peeler <jpeeler@digium.com>

	* /, channels/h323/ast_h323.cxx: Merged revisions 183028 via
	  svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r183028 | jpeeler | 2009-03-18 16:18:27 -0500 (Wed, 18
	  Mar 2009) | 4 lines Add some code removed by mistake from commit
	  182722 that works around a file descriptor leak in versions of
	  PWLib prior to 1.12.0. ........

2009-03-18 14:39 +0000 [r182947]  Russell Bryant <russell@digium.com>

	* main/poll.c, main/io.c, main/channel.c, channels/chan_skinny.c,
	  configure, apps/app_mp3.c, res/res_agi.c,
	  include/asterisk/poll-compat.h, channels/chan_alsa.c,
	  main/asterisk.c, apps/app_nbscat.c, /, main/Makefile,
	  include/asterisk/autoconfig.h.in, configure.ac,
	  include/asterisk/io.h, main/utils.c, include/asterisk/channel.h:
	  Merged revisions 182847 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r182847 | russell | 2009-03-17 21:28:55 -0500 (Tue, 17 Mar 2009)
	  | 52 lines Merged revisions 182810 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r182810 | russell | 2009-03-17 21:09:13 -0500 (Tue, 17 Mar 2009)
	  | 44 lines Fix cases where the internal poll() was not being used
	  when it needed to be. We have seen a number of problems caused by
	  poll() not working properly on Mac OSX. If you search around,
	  you'll find a number of references to using select() instead of
	  poll() to work around these issues. In Asterisk, we've had poll.c
	  which implements poll() using select() internally. However, we
	  were still getting reports of problems. vadim investigated a bit
	  and realized that at least on his system, even though we were
	  compiling in poll.o, the system poll() was still being used. So,
	  the primary purpose of this patch is to ensure that we're using
	  the internal poll() when we want it to be used. The changes are:
	  1) Remove logic for when internal poll should be used from the
	  Makefile. Instead, put it in the configure script. The logic in
	  the configure script is the same as it was in the Makefile.
	  Ideally, we would have a functionality test for the problem, but
	  that's not actually possible, since we would have to be able to
	  run an application on the _target_ system to test poll()
	  behavior. 2) Always include poll.o in the build, but it will be
	  empty if AST_POLL_COMPAT is not defined. 3) Change uses of poll()
	  throughout the source tree to ast_poll(). I feel that it is good
	  practice to give the API call a new name when we are changing its
	  behavior and not using the system version directly in all cases.
	  So, normally, ast_poll() is just redefined to poll(). On systems
	  where AST_POLL_COMPAT is defined, ast_poll() is redefined to
	  ast_internal_poll(). 4) Change poll() in main/poll.c to be
	  ast_internal_poll(). It's worth noting that any code that still
	  uses poll() directly will work fine (if they worked fine before).
	  So, for example, out of tree modules that are using poll() will
	  not stop working or anything. However, for modules to work
	  properly on Mac OSX, ast_poll() needs to be used. (closes issue
	  #13404) Reported by: agalbraith Tested by: russell, vadim
	  http://reviewboard.digium.com/r/198/ ........ ................

2009-03-17 20:53 +0000 [r182725]  Jeff Peeler <jpeeler@digium.com>

	* channels/h323/chan_h323.h, channels/h323/compat_h323.cxx, /,
	  channels/h323/ast_h323.cxx, configure,
	  autoconf/ast_check_openh323.m4, channels/h323/compat_h323.h,
	  channels/chan_h323.c, channels/h323/ast_h323.h: Merged revisions
	  182722 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r182722 |
	  jpeeler | 2009-03-17 15:47:31 -0500 (Tue, 17 Mar 2009) | 15 lines
	  Allow H.323 Plus library to be used in addition to the OpenH323
	  library Chan_h323 can now be compiled against both the previously
	  supported versions of OpenH323 as well as the current H.323 Plus
	  (version 1.20.2). The configure script has been modified to look
	  in the default install location of h323 to hopefully help avoid
	  using the environment variables OPENH323DIR and PWLIBDIR. Also,
	  the CLI command "h323 show version" has been added which
	  indicates which version of h323 is in use. (closes issue #11261)
	  Reported by: vhatz Patches: asterisk-1.6.0.6-h323plus.patch
	  uploaded by jthurman (license 614) ........

2009-03-17 16:46 +0000 [r182592]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 182553 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r182553 |
	  russell | 2009-03-17 10:22:12 -0500 (Tue, 17 Mar 2009) | 5 lines
	  Tweak the handling of the frame list inside of ast_answer(). This
	  does not change any behavior, but moves the frames from the local
	  frame list back to the channel read queue using an O(n) algorithm
	  instead of O(n^2). ........

2009-03-17 15:01 +0000 [r182528-182534]  Kevin P. Fleming <kpfleming@digium.com>

	* main/channel.c, /: Merged revisions 182530 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r182530 |
	  kpfleming | 2009-03-17 09:59:33 -0500 (Tue, 17 Mar 2009) | 2
	  lines correct logic flaw in ast_answer() changes in r182525
	  ........

	* main/channel.c, /, main/features.c, include/asterisk/channel.h:
	  Merged revisions 182525 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r182525 |
	  kpfleming | 2009-03-17 09:38:11 -0500 (Tue, 17 Mar 2009) | 11
	  lines Improve behavior of ast_answer() to not lose incoming
	  frames ast_answer(), when supplied a delay before returning to
	  the caller, use ast_safe_sleep() to implement the delay.
	  Unfortunately during this time any incoming frames are discarded,
	  which is problematic for T.38 re-INVITES and other sorts of
	  channel operations. When a delay is not passed to ast_answer(),
	  it still delays for up to 500 milliseconds, waiting for media to
	  arrive. Again, though, it discards any control frames, or
	  non-voice media frames. This patch rectifies this situation, by
	  storing all incoming frames during the delay period on a list,
	  and then requeuing them onto the channel before returning to the
	  caller. http://reviewboard.digium.com/r/196/ ........

2009-03-17 05:54 +0000 [r182453]  Tilghman Lesher <tlesher@digium.com>

	* main/db.c, /: Merged revisions 182450 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ................
	  r182450 | tilghman | 2009-03-17 00:51:54 -0500 (Tue, 17 Mar 2009)
	  | 14 lines Merged revisions 182449 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r182449 | tilghman | 2009-03-17 00:50:52 -0500 (Tue, 17 Mar 2009)
	  | 7 lines Fix race in astdb The underlying db1 implementation
	  does not fully isolate the pages retrieved from astdb, so the
	  lock protecting accesses needs to be extended until the copy from
	  the shared memory structure is done. (closes issue #14682)
	  Reported by: makoto ........ ................

2009-03-17 02:02 +0000 [r182409]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 182408 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/trunk ........
	  r182408 | rmudgett | 2009-03-16 20:54:53 -0500 (Mon, 16 Mar 2009)
	  | 8 lines OPENR2 uses an incorrect string value if the extension
	  delimiter is not present. * Fixed OPENR2 using an incorrect
	  string value if the extension delimiter is not present in the
	  Dial() function. This was fixed for SS7 and PRI in trunk
	  -r172400. * Made OPENR2 stripmsd behavior the same as the SS7,
	  PRI, and others. * Removed trailing whitespace that appeared with
	  OPENR2. ........

2009-03-16 20:51 +0000 [r182360-182361]  Russell Bryant <russell@digium.com>

	* /: svnmerge init

	* / (added): Create a branch for 1.6.2

2009-03-16 20:35 +0000 [r182355]  Russell Bryant <russell@digium.com>

	* CREDITS, channels/chan_dahdi.c, configs/chan_dahdi.conf.sample,
	  configure, include/asterisk/autoconfig.h.in, configure.ac,
	  CHANGES, makeopts.in: Add MFC/R2 support for chan_dahdi. This
	  commit introduces official support for R2 signaling in
	  chan_dahdi. The modifications to chan_dahdi, and the supporting
	  library, LibOpenR2, were both written by Moises Silva. Many users
	  are using this code, or a variant of it, in Asterisk 1.2, 1.4 and
	  1.6 in Brazil, México and Argentina. An unknown number of users
	  (but at least 1) are using it in each of the following countries:
	  Colombia, Nepal, Thailand, Venezuela, Perú, and probably others.
	  To use this code, LibOpenR2 must be installed from
	  http://www.libopenr2.org/. Information about configuration can be
	  found in configs/chan_dahdi.conf.sample. The code committed is
	  the most up to date version, which was being maintained in
	  svn/asterisk/team/moy/mfcr2/. I would also like to include a
	  Thank You to the many others that tested this code beyond those
	  listed in this commit message. These are the names that I could
	  find in the mantis issue. (closes issue #12509) Reported by: moy
	  Patches: chan_zap-mfr2.patch uploaded by moy (license 222) Tested
	  by: moy, korihor, viniciusfontes, Skarmeth, loloski,
	  asbestoshead, titogarrido, heliocoelhojr, konsultex, ncorrare,
	  ecarruda, rtorresduque, PTorres, ychen Review:
	  http://reviewboard.digium.com/r/40/

2009-03-16 17:49 +0000 [r182282]  David Vossel <dvossel@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 182281 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r182281 | dvossel | 2009-03-16 12:47:42 -0500 (Mon, 16
	  Mar 2009) | 7 lines Randomize IAX2 encryption padding The 16-32
	  byte random padding at the beginning of an encrypted IAX2 frame
	  turns out to not be all that random at all. This patch calls
	  ast_random to fill the padding buffer with random data. The
	  padding is randomized at the beginning of every encrypted call
	  and for every encrypted retransmit frame. Review:
	  http://reviewboard.digium.com/r/193/ ........

2009-03-16 17:33 +0000 [r182211-182278]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_env.c: Fix an off-by-one error in the FILE() function,
	  and extend FILE()'s length parameter to work like variable
	  substitution. Previously, FILE() returned one less character than
	  specified, due to the terminating NULL. Both the offset and
	  length parameters now behave identically to the way variable
	  substitution offsets and lengths also work. (closes issue #14670)
	  Reported by: BMC

	* channels/chan_local.c, /: Merged revisions 182208 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r182208 | tilghman | 2009-03-16 10:39:15 -0500 (Mon, 16
	  Mar 2009) | 7 lines Fixup glare detection, to fix a memory leak
	  of a local pvt structure. (closes issue #14656) Reported by:
	  caspy Patches: 20090313__bug14656__2.diff.txt uploaded by
	  tilghman (license 14) Tested by: caspy ........

2009-03-16 13:58 +0000 [r182171]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Fix a memory leak in the ast_answer /
	  __ast_answer API call. For a channel that is not yet answered
	  this API call will wait until a voice frame is received on the
	  channel before returning. It does this by waiting for frames on
	  the channel and reading them in. The frames read in were not
	  freed when they should have been.

2009-03-13 21:26 +0000 [r182029-182121]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Change faulty comparison used when announcing
	  average hold minutes and seconds (closes issue #14227) Reported
	  by: caspy

	* main/features.c: Remove ast_ prefix from functions which are not
	  public.

	* /, main/features.c: Merged revisions 181990 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181990 | mmichelson | 2009-03-13 12:12:32 -0500 (Fri, 13 Mar
	  2009) | 35 lines Check the DYNAMIC_FEATURES of both the chan and
	  peer when interpreting DTMF. Dynamic features defined in the
	  applicationmap section of features.conf allow one to specify
	  whether the caller, callee, or both have the ability to use the
	  feature. The documentation in the features.conf.sample file could
	  be interpreted to mean that one only needs to set the
	  DYNAMIC_FEATURES channel variable on the calling channel in order
	  to allow for the callee to be able to use the features which he
	  should have permission to use. However, the DYNAMIC_FEATURES
	  variable would only be read from the channel of the participant
	  that pressed the DTMF sequence to activate the feature. The
	  result of this was that the callee was unable to use dynamic
	  features unless the dialplan writer had taken measures to be sure
	  that the DYNAMIC_FEATURES variable was set on the callee's
	  channel. This commit changes the behavior of
	  ast_feature_interpret to concatenate the values of
	  DYNAMIC_FEATURES from both parties involved in the bridge. The
	  features themselves determine who has permission to use them, so
	  there is no reason to believe that one side of the bridge could
	  gain the ability to perform an action that they should not have
	  the ability to perform. Kevin Fleming pointed out on the
	  asterisk-users list that the typical way that this was worked
	  around in the past was by setting _DYNAMIC_FEATURES on the
	  calling channel so that the value would be inherited by the
	  called channel. While this works, the documentation alone is not
	  enough to figure out why this is necessary for the callee to be
	  able to use dynamic features. In this particular case, changing
	  the code to match the documentation is safe, easy, and will
	  generally make things easier for people for future installations.
	  This bug was originally reported on the asterisk-users list by
	  David Ruggles. (closes issue #14657) Reported by: mmichelson
	  Patches: 14657.patch uploaded by mmichelson (license 60) ........

2009-03-13 17:25 +0000 [r182022]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix an issue with requesting a T38 reinvite
	  before the call is answered. The code responsible for sending the
	  T38 reinvite did not check if an INVITE was already being
	  handled. This caused things to get confused and the call to fail.
	  The code now defers sending the T38 reinvite until the current
	  INVITE is done being handled. (issue AST-191)

2009-03-13 16:55 +0000 [r181985]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: improve a bit of suboptimal code

2009-03-13 01:26 +0000 [r181899]  Richard Mudgett <rmudgett@digium.com>

	* /: Merged revisions 181898 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 Just
	  recording the v1.4 change in trunk since it originally came from
	  here. ........ r181898 | rmudgett | 2009-03-12 20:19:29 -0500
	  (Thu, 12 Mar 2009) | 4 lines Use the correct branch integrated
	  property when generating the version string. Copied the
	  make_version file from Asterisk trunk. ........

2009-03-12 21:43 +0000 [r181769-181846]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Run the macro on the queue member's channel
	  when he answers, not the caller's channel.

	* /, channels/chan_sip.c: Merged revisions 181768 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181768 | mmichelson | 2009-03-12 13:29:48 -0500 (Thu, 12 Mar
	  2009) | 22 lines Properly send a 487 on an INVITE we have not
	  responded to if we receive a BYE. If we receive an INVITE from an
	  endpoint and then later receive a BYE from that same endpoint
	  before we have sent a final response for the INVITE, then we need
	  to respond to the INVITE with a 487. There was logic in the code
	  prior to this commit which seemed to exist solely to handle this
	  situation, but there was one condition in an if statement which
	  was incorrect. The only way we would send a 487 was if the
	  sip_pvt had no owner channel. This made no sense since we created
	  the owner channel when we received the INVITE, meaning that the
	  majority of the time we would never send the 487. The 487 being
	  sent should not rely on whether we have created a channel. Its
	  delivery should be dependent on the current state of the initial
	  INVITE transaction. With this commit, that logic is now correctly
	  in place. (closes issue #14149) Reported by: legranjl Patches:
	  14149.patch uploaded by mmichelson (license 60) Tested by:
	  legranjl ........

2009-03-12 17:32 +0000 [r181731]  Tilghman Lesher <tlesher@digium.com>

	* main/translate.c: Adjust translation table column widths based
	  upon the translation times. Previously, only 5 columns were
	  displayed, and if a translation time exceeded 99,999 useconds, it
	  would be displayed as 0, instead of its actual time. (closes
	  issue #14532) Reported by: pj Patches:
	  20090311__bug14532.diff.txt uploaded by tilghman (license 14)
	  Tested by: pj

2009-03-12 16:56 +0000 [r181612-181665]  Joshua Colp <jcolp@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 181664 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r181664 | file | 2009-03-12 13:56:20 -0300 (Thu, 12 Mar
	  2009) | 2 lines Fix incorrect usage of strncasecmp... I really
	  meant to use strcasecmp. ........

	* /, res/res_musiconhold.c: Merged revisions 181659-181660 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181659 | file | 2009-03-12 13:50:37 -0300 (Thu, 12 Mar 2009) | 8
	  lines Fix another scenario where depending on configuration the
	  stream would not get read. For custom commands we don't know
	  whether the audio is coming from a stream or not so we are going
	  to have to read the data despite no channels. (closes issue
	  #14416) Reported by: caspy ........ r181660 | file | 2009-03-12
	  13:52:45 -0300 (Thu, 12 Mar 2009) | 2 lines Fix logic flaw in
	  previous commit. ........

	* /, res/res_musiconhold.c: Merged revisions 181655 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r181655 | file | 2009-03-12 13:29:19 -0300 (Thu, 12 Mar
	  2009) | 10 lines Fix issue with streaming MOH failing if nobody
	  is listening. When a music class is setup to actually provide
	  music on hold from a stream we need to constantly read audio from
	  it since it will constantly be providing audio. This is now done
	  despite there being no channels listening to it. (closes issue
	  #14416) Reported by: caspy ........

	* apps/app_dial.c: Fix crash when sleep and retries argument was
	  not given to RetryDial application. (closes issue #14647)
	  Reported by: sherpya

2009-03-12 01:33 +0000 [r181542-181577]  Richard Mudgett <rmudgett@digium.com>

	* build_tools/make_version: Whitespace chages.

	* build_tools/make_version: Use the correct branch integrated
	  property when generating the version string

2009-03-11 23:14 +0000 [r181499]  Michiel van Baak <michiel@vanbaak.info>

	* configs/sip.conf.sample: Provide correct hint to debug SIP
	  trouble in the default config (closes issue #14646) Reported by:
	  strk

2009-03-11 22:25 +0000 [r181465]  Russell Bryant <russell@digium.com>

	* main/channel.c: Make handling of the BRIDGE_PLAY_SOUND variable
	  thread-safe.

2009-03-11 22:20 +0000 [r181444]  Jason Parker <jparker@digium.com>

	* /, configure, configure.ac: Merged revisions 181436 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r181436 | qwell | 2009-03-11 17:18:42 -0500 (Wed, 11 Mar
	  2009) | 4 lines Allow prefix to set localstatedir (when used and
	  different from the default). This is similar to the /etc change
	  that was made for the non-FreeBSD case. ........

2009-03-11 22:14 +0000 [r181424-181428]  Russell Bryant <russell@digium.com>

	* main/channel.c: Make handling of the BRIDGEPVTCALLID variable
	  thread-safe.

	* main/channel.c, /: Merged revisions 181423 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181423 | russell | 2009-03-11 16:42:58 -0500 (Wed, 11 Mar 2009)
	  | 9 lines Make code that updates BRIDGEPEER variable thread-safe.
	  It is not safe to read the name field of an ast_channel without
	  the channel locked. This patch fixes some places in channel.c
	  where this was being done, and lead to crashes related to
	  masquerades. (closes issue #14623) Reported by: guillecabeza
	  ........

2009-03-11 17:34 +0000 [r181371]  David Vossel <dvossel@digium.com>

	* channels/iax2-parser.h, /, channels/chan_iax2.c: Merged revisions
	  181340 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181340 | dvossel | 2009-03-11 12:25:31 -0500 (Wed, 11 Mar 2009)
	  | 11 lines encrypted IAX2 during packet loss causes decryption to
	  fail on retransmitted frames If an iax channel is encrypted, and
	  a retransmit frame is sent, that packet's iseqno is updated while
	  it is encrypted. This causes the entire frame to be corrupted.
	  When the corrupted frame is sent, the other side decrypts it and
	  sends a VNAK back because the decrypted frame doesn't make any
	  sense. When we get the VNAK, we look through the sent queue and
	  send the same corrupted frame causing a loop. To fix this,
	  encrypted frames requiring retransmission are decrypted, updated,
	  then re-encrypted. Since key-rotation may change the key held by
	  the pvt struct, the keys used for encryption/decryption are held
	  within the iax_frame to guarantee they remain correct. (closes
	  issue #14607) Reported by: stevenla Tested by: dvossel Review:
	  http://reviewboard.digium.com/r/192/ ........

2009-03-11 17:26 +0000 [r181345]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 181328 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181328 | file | 2009-03-11 14:22:52 -0300 (Wed, 11 Mar 2009) |
	  14 lines Fix issue where an attended transfer could not be
	  completed under a rare scenario. When completing an attended
	  transfer chan_sip does a check to make sure the extension in the
	  URI portion of the Refer-To header is a local valid extension. We
	  don't actually need to check this since we know for sure the
	  other channel is already up and talking to the extension. Some
	  devices do not put the extension in the Refer-To header either,
	  which can cause the extension check to fail. We now no longer do
	  this check if it is an attended transfer. (closes issue #14628)
	  Reported by: sverre Patches: 14628.diff uploaded by file (license
	  11) ........

2009-03-11 17:04 +0000 [r181301]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/astobj2.h: Turn off malloc debugging of astobj2,
	  since it apparently doesn't work too well during startup.

2009-03-11 16:40 +0000 [r181296]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 181295 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181295 | file | 2009-03-11 13:36:50 -0300 (Wed, 11 Mar 2009) | 9
	  lines Fix a problem with inband DTMF detection on outgoing SIP
	  calls when dtmfmode=auto. When dtmfmode was set to auto the
	  inband DTMF detector was not setup on outgoing SIP calls. This
	  caused inband DTMF detection to fail. The inband DTMF detector is
	  now setup for both dtmfmode inband and auto. (closes issue
	  #13713) Reported by: makoto ........

2009-03-11 16:19 +0000 [r181292]  Russell Bryant <russell@digium.com>

	* doc/google-soc2009-ideas.txt: Replace contents of this doc with a
	  pointer to its new home

2009-03-11 14:28 +0000 [r181244]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix segfault when dialing a typo'd queue If
	  trying to dial a non-existent queue, there would be a segfault
	  when attempting to access q->weight, even though q was NULL. This
	  problem was introduced during the queue-reset merge and thus only
	  affects trunk. (closes issue #14643) Reported by: alecdavis

2009-03-11 13:44 +0000 [r181210]  Joshua Colp <jcolp@digium.com>

	* apps/app_confbridge.c: Don't play the "you are about to be placed
	  into the conference" and "the leader has left the conference"
	  sounds if the quiet option is enabled. (reported by Vadim Lebedev
	  on the asterisk-dev list)

2009-03-11 04:06 +0000 [r181135]  Jeff Peeler <jpeeler@digium.com>

	* utils/Makefile, include/asterisk/utils.h,
	  include/asterisk/astmm.h, channels/chan_sip.c,
	  channels/h323/ast_h323.cxx, main/features.c, utils/extconf.c,
	  pbx/pbx_config.c: Fix malloc debug macros to work properly with
	  h323. The main problem here was that cstdlib was undefining free
	  thereby causing the proper debug macros to not be used.
	  ast_h323.cxx has been changed to call ast_free instead to avoid
	  the issue. A few other issues were addressed: - There were a few
	  instances of functions improperly passing ast_free instead of
	  ast_free_ptr. - Some clean up was done to avoid the debug macros
	  intentionally being redefined. (copied below from Kevin's commit,
	  appreciate the help) - disable astmm.h from doing anything when
	  STANDALONE is defined, which is used by the tools in the utils/
	  directory that use parts of Asterisk header files in hackish
	  ways; also ensure that utils/extconf.c and utils/conf2ael.c are
	  compiled with STANDALONE defined. (closes issue #13593) Reported
	  by: pj

2009-03-11 02:25 +0000 [r181099]  Russell Bryant <russell@digium.com>

	* doc/google-soc2009-ideas.txt: tabs to spaces

2009-03-11 00:49 +0000 [r181032-181033]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Add missing comment that quotes RFC 3891

	* /, channels/chan_sip.c: Merged revisions 181029,181031 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r181029 | mmichelson | 2009-03-10 19:30:26 -0500 (Tue, 10 Mar
	  2009) | 9 lines Fix incorrect tag checking on transfers when
	  pedantic=yes is enabled. (closes issue #14611) Reported by:
	  klaus3000 Patches: patch_chan_sip_attended_transfer_1.4.23.txt
	  uploaded by klaus3000 (license 65) Tested by: klaus3000 ........
	  r181031 | mmichelson | 2009-03-10 19:32:40 -0500 (Tue, 10 Mar
	  2009) | 3 lines Remove unused variables. ........

2009-03-11 00:29 +0000 [r181027-181028]  Tilghman Lesher <tlesher@digium.com>

	* main/strings.c, main/hashtab.c, include/asterisk/astobj2.h,
	  main/heap.c, include/asterisk/strings.h,
	  include/asterisk/hashtab.h, main/astobj2.c,
	  include/asterisk/heap.h: Add MALLOC_DEBUG to various utility
	  APIs, so that memory leaks can be tracked back to their source.
	  (related to issue #14636)

	* main/pbx.c: Spacing changes only

2009-03-10 22:03 +0000 [r180944]  Jason Parker <jparker@digium.com>

	* /, configure, configure.ac, autoconf/ast_prog_sed.m4,
	  autoconf/ast_check_gnu_make.m4: Merged revisions 180941 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r180941 | qwell | 2009-03-10 17:02:18 -0500 (Tue, 10 Mar 2009) |
	  1 line Make things happier when using autoconf 2.62+ ........

2009-03-10 22:03 +0000 [r180935-180942]  Russell Bryant <russell@digium.com>

	* doc/google-soc2009-ideas.txt: Add some notes on getting in
	  contact with the dev community

	* doc/google-soc2009-ideas.txt: Remove difficulty and language
	  specifiers

	* doc/google-soc2009-ideas.txt: Expand upon documentation of
	  manager event project

2009-03-10 21:15 +0000 [r180898]  Michiel van Baak <michiel@vanbaak.info>

	* CHANGES: list the move of the astvarrundir from /var/run to
	  /var/run/asterisk (actually its $(localstatedir)/run/asterisk
	  Makes setups with asterisk as non-root easier to manage because
	  you can setup permissions on this dir instead of touching a file
	  and setting permissions on that. Files that come to mind are
	  asterisk.pid and asterisk.ctl socket. Prodded by and ok @russell

2009-03-10 19:36 +0000 [r180859-180862]  Russell Bryant <russell@digium.com>

	* doc/google-soc2009-ideas.txt: add more projects

	* doc/google-soc2009-ideas.txt: add more project ideas

2009-03-10 14:40 +0000 [r180800]  Joshua Colp <jcolp@digium.com>

	* main/manager.c: Reset the thread local string buffer when
	  handling the UserEvent action. (closes issue #14593) Reported by:
	  JimDickenson

2009-03-09 22:00 +0000 [r180750]  Russell Bryant <russell@digium.com>

	* doc/google-soc2009-ideas.txt: Add current mentors list, and first
	  pass on a project list broken out of "PineMango" I will work on
	  adding projects that have been sent to be via email tomorrow.

2009-03-09 20:58 +0000 [r180719]  Jeff Peeler <jpeeler@digium.com>

	* include/asterisk/rtp.h, include/asterisk/extconf.h,
	  main/devicestate.c, include/asterisk/tcptls.h, main/enum.c,
	  include/asterisk/callerid.h, include/asterisk/doxyref.h,
	  include/asterisk/event.h, include/asterisk/audiohook.h,
	  include/asterisk/dsp.h, include/asterisk/timing.h,
	  include/asterisk/udptl.h, include/asterisk/dlinkedlists.h,
	  include/asterisk/utils.h, include/asterisk/devicestate.h,
	  include/asterisk/taskprocessor.h, include/asterisk/enum.h,
	  include/asterisk/astobj2.h, include/asterisk/config.h,
	  include/asterisk/channel.h, include/asterisk/manager.h,
	  include/asterisk/heap.h, include/asterisk/logger.h,
	  include/asterisk/http.h, include/asterisk/res_odbc.h,
	  include/asterisk/app.h, main/tcptls.c,
	  include/asterisk/linkedlists.h, include/asterisk/sched.h,
	  include/asterisk/datastore.h, include/asterisk/lock.h,
	  include/asterisk/pbx.h, include/asterisk/dnsmgr.h: Add Doxygen
	  documentation for API changes from 1.6.0 to 1.6.1 Copied from my
	  review board description: This is a continuation of the API
	  changes documentation started for describing changes between
	  releases. Most of the API changes were pretty simple needing only
	  to be brought to attention via the new "Asterisk API Changes"
	  list. However, if you see anything that needs further explanation
	  feel free to supplement what is there. The current method of
	  documenting is to add (in the header file): \version <ver number>
	  <description of changes> and then to add the function to the
	  change list in doxyref.h on the AstAPIChanges page. I also made
	  sure all the functions that were newly added were tagged with
	  \since 1.6.1. I think this is a good habit to start both for the
	  historical aspect as well as for the future ability to easily add
	  a "New Asterisk API" page. Review:
	  http://reviewboard.digium.com/r/190/

2009-03-09 14:14 +0000 [r180684]  Russell Bryant <russell@digium.com>

	* doc/google-soc2009-ideas.txt (added): Add skeleton for GSoC ideas
	  list

2009-03-07 15:36 +0000 [r180641]  Russell Bryant <russell@digium.com>

	* contrib/asterisk-ng-doxygen: Make some minor updates to the
	  doxygen configuration - add bridges directory to be processed -
	  add some res/ subdirs - alphabetize subdirs - use consistent
	  indentation

2009-03-06 18:25 +0000 [r180579]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 180567 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r180567 | mmichelson | 2009-03-06 12:23:09 -0600 (Fri,
	  06 Mar 2009) | 2 lines Make compilation succeed in dev-mode when
	  IMAP storage is enabled. ........

2009-03-06 17:26 +0000 [r180534]  David Vossel <dvossel@digium.com>

	* /, main/enum.c: Merged revisions 180532 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r180532 | dvossel | 2009-03-06 11:19:55 -0600 (Fri, 06 Mar 2009)
	  | 9 lines Fix handling of backreferences for ENUM lookups enum.c
	  did not handle regex backtraces correctly. The '\1' in the regex
	  is a backreference that requires a pattern match to be inserted.
	  The way the code used to work is that it would find the
	  backreference and insert the entire input string minus the '+'.
	  This is incorrect. The regexec() function takes in a variable
	  called pmatch which is an array of structs containing the start
	  and end indexes for each backreference substring. The original
	  code actually passed the pmatch array pointer into regexec but
	  never did anything with it. Now when a backtrace is found, the
	  backtrace number is looked up in the pmatch array and the correct
	  substring is inserted. (closes issue #14576) Reported by:
	  chris-mac Review: http://reviewboard.digium.com/r/187/ ........

2009-03-05 23:26 +0000 [r180383-180465]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 180464 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r180464 | mmichelson | 2009-03-05 17:26:11 -0600 (Thu,
	  05 Mar 2009) | 16 lines [IMAP] Fix message retrieval issues when
	  identical mailbox names were defined in separate contexts. There
	  was a fix put in a while back so that an X-Asterisk-VM-Context
	  message header was added to stored IMAP voicemails. This would
	  allow for us to differentiate if the same mailbox name was used
	  in multiple contexts. The problem still left was that not all
	  places where messages were retrieved actually attempted to use
	  this header for information when retrieving messages. This commit
	  fixes that so that MWI and message retrieval from VoiceMailMain
	  work as expected. (closes issue #13853) Reported by: vicks1
	  Patches: 13853_v2.patch uploaded by mmichelson (license 60)
	  Tested by: lmadsen ........

	* /, configs/voicemail.conf.sample, apps/app_voicemail.c: Merged
	  revisions 180380 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r180380 | mmichelson | 2009-03-05 12:58:48 -0600 (Thu, 05 Mar
	  2009) | 25 lines Fix broken mailbox parsing when searchcontexts
	  option is enabled. When using the searchcontexts option in
	  voicemail.conf, the code made the assumption that all mailbox
	  names defined were unique across all contexts. However, the code
	  did nothing to actually enforce this assumption, nor did it do
	  anything to alert a user that he may have created an ambiguity in
	  his voicemail.conf file by defining the same mailbox name in
	  multiple contexts. With this change, we now will issue a nice
	  long warning if searchcontexts is on and we encounter the same
	  mailbox name in multiple contexts and ignore any duplicates after
	  the first box. Whether searchcontexts is enabled or not, if we
	  come across a duplicate mailbox in the same context, then we will
	  issue a warning and ignore the duplicated mailbox. I have also
	  added a small note to voicemail.conf.sample in the explanation
	  for searchcontexts explaining that you cannot define the same
	  mailbox in multiple contexts if you have enabled the option.
	  (closes issue #14599) Reported by: lmadsen Patches: 14599.patch
	  uploaded by mmichelson (license 60) (with slight modification)
	  Tested by: lmadsen ........

2009-03-05 19:05 +0000 [r180382]  Michiel van Baak <michiel@vanbaak.info>

	* Makefile: Make sure we terminate the first s| command so we can
	  actually produce correct files.

2009-03-05 18:29 +0000 [r180373]  Kevin P. Fleming <kpfleming@digium.com>

	* main/frame.c, /, include/asterisk/frame.h, main/rtp.c: Merged
	  revisions 180372 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r180372 | kpfleming | 2009-03-05 12:22:16 -0600 (Thu, 05 Mar
	  2009) | 9 lines Fix problems when RTP packet frame size is
	  changed During some code analysis, I found that calling
	  ast_rtp_codec_setpref() on an ast_rtp session does not work as
	  expected; it does not adjust the smoother that may on the RTP
	  session, in fact it summarily drops it, even if it has data in
	  it, even if the current format's framing size has not changed.
	  This is not good. This patch changes this behavior, so that if
	  the packetization size for the current format changes, any
	  existing smoother is safely updated to use the new size, and if
	  no smoother was present, one is created. A new API call for
	  smoothers, ast_smoother_reconfigure(), was required to implement
	  these changes. Review: http://reviewboard.digium.com/r/184/
	  ........

2009-03-05 18:18 +0000 [r180369]  Joshua Colp <jcolp@digium.com>

	* channels/chan_bridge.c (added), main/Makefile,
	  bridges/bridge_simple.c, bridges/bridge_softmix.c,
	  include/asterisk/channel.h, bridges/bridge_multiplexed.c,
	  CHANGES, Makefile, include/asterisk/bridging_technology.h
	  (added), bridges (added), bridges/bridge_builtin_features.c,
	  include/asterisk/bridging_features.h (added),
	  include/asterisk/bridging.h (added), apps/app_confbridge.c
	  (added), main/bridging.c (added), bridges/Makefile: Merge phase 1
	  support for the new bridging architecture. This commit brings in
	  the bridging core, bridging technologies, and the ConfBridge
	  application. For usage information on the ConfBridge application
	  please see the output of "core show application ConfBridge" from
	  the CLI. For API documentation please see the doxygen page
	  describing the architecture and the documentation for each API
	  call. Review: http://reviewboard.digium.com/r/93/

2009-03-05 06:21 +0000 [r180304-180334]  Tilghman Lesher <tlesher@digium.com>

	* contrib/editors/asterisk.vim: Also highlight the preamble and
	  postamble

	* contrib/editors/ael.vim (added), contrib/editors/asterisk.vim
	  (added), contrib/editors (added), contrib/editors/asteriskvm.vim
	  (added): Add syntax coloring files for Vim, including a new one
	  for AEL

2009-03-04 21:01 +0000 [r180261]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Resolve object matching issues related to
	  the removal of the sip_user object. Previously, chan_sip had both
	  sip_peer and sip_user objects in memory. A patch went in to
	  remove sip_user to simplify the code, since everything could be
	  done with just sip_peer. This patch resolves some regressions
	  found that were introduced by those changes. This code comes from
	  svn/asterisk/team/group/sip-object-matching/. Here is a list of
	  the changes that have been made: 1) When doing a match by name
	  with the find_peer() function, make it much easier to specify
	  which objects should be matched by having a parameter that
	  specifies exactly which object types should be considered. Also,
	  update find_by_name() to handle this parameter. Finally, update
	  all code to use the new option values. 2) When looking up an
	  object for an outbound request by name, consider peers only.
	  (create_addr()) 3) Only match peers on an incoming registration
	  request. 4) When doing authentication (except for SUBSCRIBE),
	  look up users by name, instead of all objects by name. 5) When
	  doing authentication (except for SUBSCRIBE), after looking for a
	  user by name, look for a peer by IP address, instead of all
	  objects by IP address. 6) When handling the SIP qualify CLI
	  command or manager action, look for a peer by name, instead of
	  any object by name. 7) When handling the SIP unregister CLI
	  command, look for a peer by name, instead of any object by name.
	  9) In sip_do_debug_peer(), search for a peer by name, instead of
	  any object by name. 9) When handling the SIPPEER() dialplan
	  function, search for a peer by name, instead of any object by
	  name. 10) In the following session timer related functions,
	  st_get_se(), st_get_refresher(), and st_get_mode(), when looking
	  for an object for a given sip_pvt using pvt->peername, look for a
	  peer by name, instead of any object by name. 11) Fix build_peer()
	  to properly handle the case where separate type=peer and
	  type=user entries were specified in sip.conf. (closes issue
	  #14505) Reported by: lmadsen Review:
	  http://reviewboard.digium.com/r/172/

2009-03-04 20:48 +0000 [r180259]  Tilghman Lesher <tlesher@digium.com>

	* main/aescrypt.c, main/abstract_jb.c, main/acl.c, main/app.c,
	  main/alaw.c: Spacing changes only

2009-03-04 19:24 +0000 [r180195]  Joshua Colp <jcolp@digium.com>

	* /, main/callerid.c: Merged revisions 180194 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r180194 | file | 2009-03-04 15:22:50 -0400 (Wed, 04 Mar 2009) | 4
	  lines Look for the number in a callerid string starting from the
	  end. This way a value using <> can exist in the name portion.
	  (issue #AST-194) ........

2009-03-04 17:03 +0000 [r180155]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample: Allow for "magic"
	  pickups to work when we wish to ignore the context When the
	  subscription context for a call pickup subscription differs from
	  the context of the call pickup target, there's not an easy way to
	  divine what context should be used for the pickup. The way to
	  work around this is to use PICKUPMARK as the context for the
	  pickup. This has been documented in the sip.conf.sample file
	  (ABE-1708) closes issue #14567 submitted by: alecdavis

2009-03-04 14:39 +0000 [r180120]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c: Remove duplicate 'k' and 'K' Dial options.
	  (closes issue #14601) Reported by: alecdavis Patches:
	  app_dial.optionk.diff.txt uploaded by alecdavis (license 585)

2009-03-03 23:35 +0000 [r180079]  Steve Murphy <murf@digium.com>

	* utils/Makefile: My bad! left check_expr2 in the ALL_UTILS list by
	  mistake. Already done to 1.6.x

2009-03-03 23:21 +0000 [r180032]  David Vossel <dvossel@digium.com>

	* main/channel.c, include/asterisk/app.h, apps/app_read.c,
	  main/app.c: app_read does not break from prompt loop with user
	  terminated empty string In app.c, ast_app_getdata is called to
	  stream the prompts and receive DTMF input. If ast_app_getdata()
	  receives an empty string caused by the user inputing the end of
	  string character, in this case '#', it should break from the
	  prompt loop and return to app_read, but instead it cycles through
	  all the prompts. I've added a return value for this special case
	  in ast_readstring() which uses an enum I've delcared in apps.h.
	  This enum is now used as a return value for ast_app_getdata().
	  (closes issue #14279) Reported by: Marquis Patches:
	  fix_app_read.patch uploaded by Marquis (license 32)
	  read-ampersanmd.patch2 uploaded by dvossel (license 671) Tested
	  by: Marquis, dvossel Review: http://reviewboard.digium.com/r/177/

2009-03-03 22:49 +0000 [r180007]  Mark Michelson <mmichelson@digium.com>

	* /, configs/queues.conf.sample, apps/app_queue.c: Merged revisions
	  180006 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r180006 | mmichelson | 2009-03-03 16:48:18 -0600 (Tue, 03 Mar
	  2009) | 17 lines Clarify some documentation of queues.conf.sample
	  It had always been possible to explicitly specify a "blank" value
	  for a sound file in queues.conf and have no sound played back.
	  The problem with this is that it would result in some ugly CLI
	  warnings from file.c. This commit introduces a check when playing
	  a file in app_queue to see if the name of the file is zero-length
	  and return early if that is the case. Also, the ability to
	  specify the blank sound files in queues.conf is now mentioned
	  more clearly in queues.conf.sample (closes issue #14227) Reported
	  by: caspy ........

2009-03-03 22:12 +0000 [r179973]  Steve Murphy <murf@digium.com>

	* utils/Makefile, utils/expr2.testinput, /, main/ast_expr2.h,
	  main/ast_expr2.y, main/ast_expr2f.c, main/ast_expr2.fl,
	  main/ast_expr2.c: Merged revisions 179807 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 I had some
	  work to do to port these changes to trunk; the check_expr stuff
	  hasn't been updated here for quite some time, it appears. I added
	  some more tests to the check_expr2 suite. I had to play around
	  with the makefile a bit, etc. I added STANDALONE2 #ifdefs to
	  ast_expr2.y so as not to conflict structure with aelparse.
	  ........ r179807 | murf | 2009-03-03 11:11:34 -0700 (Tue, 03 Mar
	  2009) | 19 lines These changes allow AEL to better check ${}
	  constructs within $[...], that are concatenated with text. I
	  modified and added rules in ast_expr2.fl to better handle the
	  concatenations. I added some default routines to ast_expr2.y so
	  the standalone would compile. It also looks like I haven't run
	  this thru bison since 2.1, so it's good to get this updated. The
	  Makefile has comments added now for check_expr2 and check_expr to
	  explain what they are for, and how to run them. The testexpr2s
	  stuff has been removed, in favor of check_expr2. expr2.testinput
	  has been updated to include the two expressions that inspired
	  these changes (from mcnobody on #asterisk this morning) The
	  regression has been run and all looks well. ........

2009-03-03 22:01 +0000 [r179972]  David Vossel <dvossel@digium.com>

	* apps/app_meetme.c: app_meetme not setting filename and fileformat
	  correctly for realtime When app_meetme finds a realtime
	  conference, it doesn't get the filename and fileformat correctly
	  when 'r' is set. Now app_meetme first checks to see if fileformat
	  and filename are declared in the db, if they're not it checks the
	  .conf file, if its not declared there either it then uses
	  defaults. (closes issue #14545) Reported by: dalbaech Patches:
	  app_meetme-realtime5.patch uploaded by dvossel (license 671)
	  Realtime_Conference_Record_workaround.txt uploaded by dalbaech
	  (license 705) Tested by: dvossel, dalbaech Review:
	  http://reviewboard.digium.com/r/180/

2009-03-03 20:59 +0000 [r179937]  Mark Michelson <mmichelson@digium.com>

	* res/res_timing_dahdi.c, doc/timing.txt (added): Add documentation
	  for timing modules used in Asterisk This document specifies the
	  timing modules available in Asterisk beginning with Asterisk
	  1.6.1. The document goes into detail about the differences
	  between each and gives a general overview of what timing is used
	  for in Asterisk. There is also a section which can be used to
	  help customize your setup or to troubleshoot timing issues you
	  may have. I also added messages to the DAHDI timing test used in
	  res_timing_dahdi.c that points to this new documentation if
	  people experience problems. Big thanks to all who contributed
	  comments on this. (closes issue #14490) Reported by: mmichelson
	  Patches: timing.txt uploaded by mmichelson (license 60) Review:
	  http://reviewboard.digium.com/r/164/

2009-03-03 20:02 +0000 [r179903]  Brian Degenhardt <bmd@digium.com>

	* apps/app_directed_pickup.c: fix a leaked channel lock (and future
	  deadlock) when we try to pick up our own channel

2009-03-03 18:28 +0000 [r179841]  Joshua Colp <jcolp@digium.com>

	* /, main/features.c: Merged revisions 179840 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179840 | file | 2009-03-03 14:27:09 -0400 (Tue, 03 Mar 2009) | 9
	  lines Do not assume that the bridge_cdr is still attached to the
	  channel when the 'h' exten is finished executing. It is possible
	  for a masquerade operation to occur when the 'h' exten is
	  operating. This operation moves the CDR records around causing
	  the bridge_cdr to no longer exist on the channel where it is
	  expected to. We can not safely modify it afterwards because of
	  this, so don't even try. (closes issue #14564) Reported by: meric
	  ........

2009-03-03 17:03 +0000 [r179745]  Mark Michelson <mmichelson@digium.com>

	* pbx/pbx_spool.c: Convert pbx_spool to use string fields instead
	  of statically-sized buffers. In tests run after making this
	  conversion, I noticed an approximate 85% reduction in memory
	  usage for call file processing. Review:
	  http://reviewboard.digium.com/r/168/

2009-03-03 16:47 +0000 [r179742]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 179741 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179741 | russell | 2009-03-03 10:45:46 -0600 (Tue, 03 Mar 2009)
	  | 6 lines Ensure chan->fdno always gets reset to -1 after
	  handling a channel fd event. Since setting fdno to -1 had to be
	  moved, a couple of other code paths that do process an fd event
	  return early and do not pass through the code path where it was
	  moved to. So, set it to -1 in a few other places, too. ........

2009-03-03 15:13 +0000 [r179675]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Please prefix default values with DEFAULT

2009-03-03 14:40 +0000 [r179672]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /: Merged revisions 179671 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179671 | file | 2009-03-03 10:38:09 -0400 (Tue, 03 Mar 2009) | 3
	  lines Move where fdno is set to the default value to *after* the
	  read callback of the channel driver is called. We have to do this
	  as the underlying channel driver may need the fdno value to
	  determine what to read. ........

2009-03-03 13:54 +0000 [r179609]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 179608 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179608 | russell | 2009-03-03 07:53:52 -0600 (Tue, 03 Mar 2009)
	  | 9 lines Make it easier to detect an improper call to
	  ast_read(). When you call ast_waitfor() on a channel, the index
	  into the channel fds array that holds the file descriptor that
	  poll() determines has input available is stored in fdno. This
	  patch clears out this value after a call to ast_read() and also
	  reports errors if ast_read() is called without an fdno set. From
	  a discussion on the asterisk-dev list. ........

2009-03-03 00:01 +0000 [r179537]  Jeff Peeler <jpeeler@digium.com>

	* main/channel.c, /: Merged revisions 179536 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179536 | jpeeler | 2009-03-02 17:54:39 -0600 (Mon, 02 Mar 2009)
	  | 15 lines Fix bridging regression from commit 176701 This fixes
	  a bad regression where the bridge would exit after an attended
	  transfer was made. The problem was due to nexteventts getting set
	  after the masquerade which caused the bridge to return
	  AST_BRIDGE_COMPLETE. (closes issue #14315) Reported by:
	  tim_ringenbach ........

2009-03-02 23:36 +0000 [r179533]  Russell Bryant <russell@digium.com>

	* /, apps/app_meetme.c: Merged revisions 179532 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179532 | russell | 2009-03-02 17:34:13 -0600 (Mon, 02 Mar 2009)
	  | 40 lines Move ast_waitfor() down to avoid the results of the
	  API call becoming stale. This call to ast_waitfor() was being
	  done way too soon in this section of code. Specifically, there
	  was code in between the call to waitfor and the code that uses
	  the result that puts the channel in autoservice. By putting the
	  channel in autoservice, the previous results of ast_waitfor()
	  become meaningless, as the autoservice thread will do it's own
	  ast_waitfor() and ast_read() on the channel. So, when we came
	  back out of autoservice and eventually hit the block of code that
	  calls ast_read() on the channel, there may not actually be any
	  input on the channel available. Even though the previous call to
	  ast_waitfor() in app_meetme said there was input, the autoservice
	  thread has since serviced the channel for some period of time.
	  This bug manifested itself while dvossel was doing some testing
	  of MeetMe in Asterisk trunk. He was using the timerfd timing
	  module. When the code hit ast_read() erroneously, it determined
	  that it must have been called because of input on the timer fd,
	  as chan->fdno was set to AST_TIMING_FD, since that was the cause
	  of the last legitimate call to ast_read() done by autoservice. In
	  this test, an IAX2 channel was calling into the MeetMe
	  conference. It was _much_ more likely to be seen with an IAX2
	  channel because of the way audio is handled. Every audio frame
	  that comes in results in a call to ast_queue_frame(), which then
	  uses ast_timer_enable_continuous() to notify the channel thread
	  that a frame is waiting to be handled. So, the chances of
	  ast_waitfor() indicating that a channel needs servicing due to a
	  timer event on an IAX2 event is very high. Finally, it is
	  interesting to note that if a different timing interface was
	  being used, this bug would probably not be noticed. When
	  ast_read() is called and erroneously thinks that there is a timer
	  event to handle, it calls the ast_timer_ack() function. The
	  pthread and dahdi timing modules handle the ack() function being
	  called when there is no event by simply ignoring it. In the case
	  of the timerfd module, it results in a read() on the timer fd
	  that will block forever, as there is no data to read. This caused
	  Asterisk to lock up very quickly. Thanks to dvossel and
	  mmichelson for the fun debugging session. :-) ........

2009-03-02 23:10 +0000 [r179469]  Tilghman Lesher <tlesher@digium.com>

	* /, main/app.c: Merged revisions 179468 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179468 | tilghman | 2009-03-02 17:09:01 -0600 (Mon, 02 Mar 2009)
	  | 10 lines When ending a recording with silence detection,
	  remember to reduce the duration. The end of the recording is
	  correspondingly trimmed, but the duration was not trimmed by the
	  number of seconds trimmed, so the saved duration was necessarily
	  longer than the actual soundfile duration. (closes issue #14406)
	  Reported by: sasargen Patches: 20090226__bug14406.diff.txt
	  uploaded by tilghman (license 14) Tested by: sasargen ........

2009-03-02 23:06 +0000 [r179462-179465]  Russell Bryant <russell@digium.com>

	* res/res_timing_timerfd.c: Fix a reference leak in
	  timerfd_set_rate(). (found during a debugging session with
	  dvossel and mmichelson.)

	* main/channel.c, /: Merged revisions 179461 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179461 | russell | 2009-03-02 16:58:18 -0600 (Mon, 02 Mar 2009)
	  | 8 lines Ensure that only one thread is calling ast_settimeout()
	  on a channel at a time. For example, with an IAX2 channel, you
	  can have both the channel thread and the chan_iax2 processing
	  threads calling this function, and doing so twice at the same
	  time is a bad thing. (Found in a debugging session with dvossel
	  and mmichelson) ........

2009-03-02 20:16 +0000 [r179396]  Jason Parker <jparker@digium.com>

	* /, main/editline/configure, main/editline/np/unvis.c,
	  main/editline/sys.h, main/editline/configure.in: Merged revisions
	  179395 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r179395 | qwell | 2009-03-02 14:14:57 -0600 (Mon, 02 Mar 2009) |
	  1 line Remove several silly warnings in editline. One about a
	  broken preprocessor directive, and another about strlcpy/strlcat.
	  (closes issue #14264) Reported by: dimas ........

2009-03-02 17:18 +0000 [r179361]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_sqlite3_custom.c: Backport 1.6.0 fix to trunk (failsafe
	  if db is not loaded)

2009-03-02 14:28 +0000 [r179291-179323]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Do not try to remove a registration
	  scheduled item if the scheduler context has already been
	  destroyed. (closes issue #14580) Reported by: alecdavis

	* main/audiohook.c: Fix issue where changing the volume of both
	  directions of audio did not work. (closes issue #14574) Reported
	  by: KNK Patches: audiohook_volume_fix.diff uploaded by KNK
	  (license 545)

2009-03-01 23:25 +0000 [r179219-179254]  Mark Michelson <mmichelson@digium.com>

	* apps/app_speech_utils.c: Swap reversed timevals. This was pointed
	  out by ScribbleJ in #asterisk-dev. Thanks very much, ScribbleJ!

	* channels/chan_sip.c: Properly free memory and remove scheduler
	  entries when a transmission failure occurs. Previously, only the
	  "data" field of the sip_pkt created during __sip_reliable_xmit
	  was freed when XMIT_ERROR was returned by __sip_xmit. When
	  retrans_pkt was called, this inevitably resulted in the reading
	  and writing of freed memory. XMIT_ERROR is a condition meaning
	  that we don't want to attempt resending the packet at all. The
	  proper action to take is to remove the scheduler entry we just
	  created, free the packet's data as well as the packet itself, and
	  unlink it from the list of packets on the sip_pvt structure.
	  (closes issue #14455) Reported by: Nick_Lewis Patches:
	  14455.patch uploaded by mmichelson (license 60) Tested by:
	  Nick_Lewis

2009-02-27 21:47 +0000 [r179164]  Russell Bryant <russell@digium.com>

	* res/res_ais.c, doc/distributed_devstate.txt,
	  configs/ais.conf.sample: Mark res_ais as experimental, as the
	  binary event format is subject to change.

2009-02-27 21:32 +0000 [r179161]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_sqlite3_custom.c: If config file is blank, don't load
	  module. (Closes issue #14563)

2009-02-27 21:23 +0000 [r179154]  Russell Bryant <russell@digium.com>

	* UPGRADE.txt: Add a note about the ordering of entries in sip.conf
	  in 1.6.1.

2009-02-27 20:34 +0000 [r179122]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: Add reload support to chan_skinny.
	  Special thanks goes to DEA who had to redo this patch twice
	  because we first put unload/load support in and later redid the
	  way we configure devices and lines. (closes issue #10297)
	  Reported by: DEA Patches: skinny-reload-trunkv2.diff uploaded by
	  wedhorn (license 30) skinny-reload-trunk-v4.txt uploaded by DEA
	  (license 3) With mods by me based on feedback from wedhorn and
	  Russell and seanbright Tested by: DEA, mvanbaak, pj Review:
	  http://reviewboard.digium.com/r/130/

2009-02-27 19:04 +0000 [r179057]  Jason Parker <jparker@digium.com>

	* doc/tex/channelvariables.tex: Update documentation for DIALEDTIME
	  and ANSWEREDTIME variables. (closes issue #14566) Reported by:
	  klaus3000 Patches: ANSWEREDTIME-1.4-patch.txt uploaded by
	  klaus3000 (license 65) ANSWEREDTIME-trunk-patch.txt uploaded by
	  klaus3000 (license 65)

2009-02-27 15:51 +0000 [r179021]  Russell Bryant <russell@digium.com>

	* sounds/Makefile: Fix downloading SIREN7 and SIREN14 sound
	  packages. In passing, also fix downloading SLIN16 extra sound
	  packages. (closes issue #14565) Reported by: jtodd

2009-02-27 03:45 +0000 [r178986]  Steve Murphy <murf@digium.com>

	* /, main/features.c, configs/features.conf.sample: Merged
	  revisions 178956 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 In this
	  case, it's just a matter of reducing the default timeouts from
	  2000 to 1000 msec, as the max def feature digit timeout is no
	  longer halved. ........ r178956 | murf | 2009-02-26 14:27:32
	  -0700 (Thu, 26 Feb 2009) | 18 lines This change moves the default
	  feature digit timeout to 1000 ms from the previous default of
	  500. As per bug 14515, a dev discussion arrived at a "mediated
	  concensus" of a default feature digit timeout of 1.0 sec. Some
	  voted for 1300; ctooley thought 1500 for distracted phone users
	  in phone booths; kpfleming put his foot down at 1.0 sec. Users
	  who found the previous default max delay of 250 msec perfect, are
	  welcome to override the new default. Notice that I said that 250
	  msec was the default; wait a minute, you might say, the config
	  file said it was 500 msec!; well, because of the bug fix for
	  14515, we found that 500 msec was actually enforcing a max of
	  250. The bug fix would restore 500 msec, but we felt even that
	  was a bit tight for most users... 2000 msec was pushed earlier by
	  mmichelson, so that reduces to 1000 msec after the bug fix.
	  Enjoy! ........

2009-02-26 18:41 +0000 [r178919]  Tilghman Lesher <tlesher@digium.com>

	* main/features.c, CHANGES, configs/features.conf.sample: Sound
	  confirmation of call pickup success. (closes issue #13826)
	  Reported by: azielke Patches: pickupsound2-trunk.patch uploaded
	  by azielke (license 548) __20081124_bug_13826_updated.patch
	  uploaded by lmadsen (license 10) Tested by: lmadsen

2009-02-26 17:46 +0000 [r178871]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c: IAX2 prune realtime, minor tweak to last
	  fix A return statement was missing which caused unexpected cli
	  output. issue #14479

2009-02-26 17:45 +0000 [r178828-178870]  Steve Murphy <murf@digium.com>

	* apps/app_osplookup.c, apps/app_rpt.c: These small fixes prevent
	  compiler warnings with ubuntu 8.10's gcc-4.3.2, which tend to
	  break my dev-mode build. Not a problem in 1.6.x.

	* /, main/features.c: Merged revisions 178804 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r178804 | murf | 2009-02-26 10:09:03 -0700 (Thu, 26 Feb 2009) |
	  28 lines This patch prevents the feature detection timeout from
	  being cut in half. Because the ast_channel_bridge() call will
	  return 0 and pass a frame pointer for both DTMF_BEGIN and
	  DTMF_END, the feature_timer field in hte config struct is getting
	  decremented twice, which effectively cuts the digittimeout in
	  half. I added conditions to the if statement to only let DTMF_END
	  frames to flow thru, which solved the problem. Also, when the
	  frame pointer is null, let control flow thru-- this usually
	  happens on timeouts. I added a comment to the code to explain
	  what's going on and why. Many thanks to sodom for reporting this
	  problem. Personnally, it always seemed like something was wrong
	  with the featuredigittimeout, but I never could quite decide
	  what... and was too busy to investigate. This bug forced the
	  issue, and now we know. Sodom had other issues in 14515, but I
	  couldn't reproduce them. If he still has problems, and wants to
	  get them solved, he is welcome to reopen 14515. (closes issue
	  #14515) Reported by: sodom Patches: 14515.patch uploaded by murf
	  (license 17) Tested by: murf, sodom ........

2009-02-26 16:42 +0000 [r178801]  Joshua Colp <jcolp@digium.com>

	* main/file.c: Fix an issue where the timer for file playback would
	  not be stopped if DAHDI was not installed. (closes issue #14541)
	  Reported by: grant

2009-02-26 15:50 +0000 [r178767]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c: IAX2 prune realtime fix Iax2 prune realtime
	  had issues. If "iax2 prune realtime all" was called, it would
	  appear like the command was successful, but in reality nothing
	  happened. This is because the reload that was supposed to take
	  place checks the config files, sees no changes, and does nothing.
	  If there had been a change in the the config file, the realtime
	  users would have been marked for deletion and everything would
	  have been fine. Now prune_users() and prune_peers() are called
	  instead of reload_config() to prune all users/peers that are
	  realtime. These functions remove all users/peers with the
	  rtfriend and delme flags set. iax2_prune_realtime() also lacked
	  the code to properly delete a single friend. For example. if iax2
	  prune realtime <friend> was called, only the peer instance would
	  be removed. The user would still remain. (closes issue #14479)
	  Reported by: mousepad99 Review:
	  http://reviewboard.digium.com/r/176/

2009-02-26 15:40 +0000 [r178764]  Joshua Colp <jcolp@digium.com>

	* main/indications.c: Ensure there is a valid tone part before
	  trying to play tones. (closes issue #14558) Reported by:
	  alecdavis

2009-02-26 15:02 +0000 [r178733]  Olle Johansson <oej@edvina.net>

	* configs/res_snmp.conf.sample: Clarifications on the different
	  models and reference to further docs.

2009-02-26 13:39 +0000 [r178703-178704]  Kevin P. Fleming <kpfleming@digium.com>

	* README: another minor commit to test post-commit script changes
	  (now testing post-revprop-change as well, third try)

	* README: minor commit to test post-commit script changes

2009-02-25 19:49 +0000 [r178573-178607]  Tilghman Lesher <tlesher@digium.com>

	* main/stdtime/localtime.c: Picky, picky buildbots

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  main/stdtime/localtime.c: Use notification when timezone files
	  change and re-scan then. (closes issue #14300) Reported by:
	  jamessan Patches: 20090127__bug14300.diff.txt uploaded by
	  tilghman (license 14) 20090224__bug14300.diff uploaded by
	  jamessan (license 246) Tested by: jamessan Review:
	  http://reviewboard.digium.com/r/136/

	* res/res_odbc.c: Oops, wrong direction of command

2009-02-25 12:45 +0000 [r178509]  Russell Bryant <russell@digium.com>

	* /, main/asterisk.c: Merged revisions 178508 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r178508 | russell | 2009-02-25 06:43:36 -0600 (Wed, 25 Feb 2009)
	  | 2 lines Update the copyright year for the main page of the
	  doxygen documentation. ........

2009-02-24 23:27 +0000 [r178375-178446]  Tilghman Lesher <tlesher@digium.com>

	* /, configs/extensions.conf.sample: Merged revisions 178445 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r178445 | tilghman | 2009-02-24 17:25:24 -0600 (Tue, 24 Feb 2009)
	  | 5 lines Add section about the #exec command in configuration
	  files. (closes issue #14540) Reported by: jtodd Patch by: jtodd,
	  with additional notes by tilghman (license 14) ........

	* main/asterisk.c: Apparently, a void cast doesn't override
	  warn_unused_result.

	* main/asterisk.c: The 3 possible errors with pipe(2) are all
	  impossible in this situation.

2009-02-24 20:39 +0000 [r178374]  Russell Bryant <russell@digium.com>

	* /, main/rtp.c: Merged revisions 178373 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r178373 | russell | 2009-02-24 14:36:19 -0600 (Tue, 24 Feb 2009)
	  | 6 lines Only set dtmfcount on BEGIN, and ensure it gets reset
	  to 0 properly. (issue #14460) Reported by: moliveras Tested by:
	  russell ........

2009-02-24 20:06 +0000 [r178303-178342]  Tilghman Lesher <tlesher@digium.com>

	* utils/astcanary.c, main/asterisk.c: Use a SIGPIPE to kill the
	  process, instead of depending upon the astcanary process being
	  inherited by init.

	* utils/astcanary.c: Cause astcanary to exit if Asterisk exits
	  abnormally and doesn't kill astcanary. Also, add some
	  documentation supporting the use of astcanary. (closes issue
	  #14538) Reported by: KNK Patches: asterisk-1.6.x-astcanary.diff
	  uploaded by KNK (license 545)

2009-02-24 17:42 +0000 [r178300]  David Vossel <dvossel@digium.com>

	* doc/manager_1_1.txt, CHANGES, channels/chan_iax2.c: Allows
	  manager command to see if IAX link is trunked and encrypted.
	  Displays what kind of encryption is enabled as well. Manager
	  command "iaxpeers" now shows if a link is trunked and encrypted.
	  Instead of encryption saying simply "yes" or "no", it now
	  displays what type of encryption is enabled and if keyrotation is
	  on or not. (closes issue #14427) Reported by: snuffy Patches:
	  iax_show_trunks.diff uploaded by snuffy (license 35)
	  2009022200_iax2_show_trunkencryption.diff.txt uploaded by
	  mvanbaak (license 7) Tested by: mvanbaak, dvossel, snuffy Review:
	  http://reviewboard.digium.com/r/173/

2009-02-24 15:18 +0000 [r178213]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 178205 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r178205 | file | 2009-02-24 11:16:07 -0400 (Tue, 24 Feb 2009) | 9
	  lines Skip check for extension when subscribing for MWI. Since
	  the remote side is not actually subscribing to a specific
	  extension when subscribing for MWI just skip the check to see if
	  the extension exists. They can't use it to specify the mailbox
	  either since we require configuration of that in sip.conf (closes
	  issue #14531) Reported by: festr ........

2009-02-23 23:11 +0000 [r178142]  Russell Bryant <russell@digium.com>

	* /, main/rtp.c: Merged revisions 178141 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r178141 | russell | 2009-02-23 17:09:01 -0600 (Mon, 23 Feb 2009)
	  | 14 lines Fix infinite DTMF when a BEGIN is received without an
	  END. This commit is related to rev 175124 of 1.4 where a previous
	  attempt was made to fix this problem. The problem with the
	  previous patch was that the inserted code needed to go _before_
	  setting the lastrxts to the current timestamp. Because those were
	  the same, the dtmfcount variable was never decremented, and so
	  the END was never sent. In passing, I removed the dtmfsamples
	  variable which was completed unused. I also removed a redundant
	  setting of the lastrxts variable. (closes issue #14460) Reported
	  by: moliveras ........

2009-02-23 21:02 +0000 [r178107]  Tilghman Lesher <tlesher@digium.com>

	* configs/voicemail.conf.sample, CHANGES, apps/app_voicemail.c:
	  Permit emailsubject and emailbody to be set per mailbox. (closes
	  issue #14372) Reported by: fhackenberger Patches:
	  voicemail_individual_subject_and_body_1.6.1 uploaded by
	  fhackenberger (license 592) with additional fixes by Corydon76
	  (license 14)

2009-02-23 18:23 +0000 [r178061]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: update the new manager commands in
	  chan_skinny to match chan_sip's headers. requested by oej.

2009-02-23 17:59 +0000 [r178030]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c: Changes the way keyrotation is enabled by
	  default Key rotation was enabled by default by setting the global
	  encryption method to IAX_ENCRYPT_KEYROTATE. the problem with this
	  is that if encryption is not enabled, and the encryption method
	  is set to anything except 0, the peer appears to have encryption
	  enabled when issuing a "iax2 show peers". Rather than have the
	  key rotation bit always set by default, it is now only set when
	  an encryption method is enabled. (closes issue #14523) Reported
	  by: mvanbaak

2009-02-23 17:48 +0000 [r178027]  Michiel van Baak <michiel@vanbaak.info>

	* CHANGES: list the addition of the SKINNY manager actions in the
	  CHANGES file.

2009-02-23 17:29 +0000 [r178022]  Russell Bryant <russell@digium.com>

	* tests/test_sched.c, main/sched.c: Fix a regression in scheduler
	  entry ordering, and add a regression test for it. (closes issue
	  #14522) Reported by: pj Tested by: russell

2009-02-22 23:04 +0000 [r177988]  Michiel van Baak <michiel@vanbaak.info>

	* doc/manager_1_1.txt, channels/chan_skinny.c: Add a couple of
	  manager commands to chan_skinny Added: SKINNYdevices
	  SKINNYshowdevice SKINNYlines SKINNYshowline (closes issue #14521)
	  Reported by: mvanbaak Review:
	  http://reviewboard.digium.com/r/170/

2009-02-21 15:59 +0000 [r177944]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: On update, test against the existence of
	  sipregs.

2009-02-21 14:37 +0000 [r177913]  Michiel van Baak <michiel@vanbaak.info>

	* main/asterisk.c: add extra check for sysinfo/sysctl (closes issue
	  #14513) Reported by: snuffy Patches: bug14513_fixsysinfo.diff
	  uploaded by snuffy (license 35)

2009-02-21 14:16 +0000 [r177884]  Sean Bright <sean.bright@gmail.com>

	* main/hashtab.c, include/asterisk/hashtab.h: Trailing whitespace,
	  minor coding guideline fixes, and start beefing up the hashtab
	  documentation a bit.

2009-02-21 13:17 +0000 [r177855]  Russell Bryant <russell@digium.com>

	* include/asterisk/indications.h: Fix build issues on Solaris and
	  OpenBSD. (closes issue #14512) Reported by: snuffy

2009-02-21 13:13 +0000 [r177849-177852]  Michiel van Baak <michiel@vanbaak.info>

	* Makefile, contrib/init.d/rc.debian.asterisk,
	  contrib/init.d/rc.archlinux.asterisk,
	  contrib/scripts/safe_asterisk: set
	  ASTVARRUNDIR=$(localstatedir)/run/asterisk as default path When
	  running asterisk as non-root and without this patch the pidfile
	  wants to go into /var/run/asterisk.pid. This directory is not
	  writable for the non-root user and changing permissions is not an
	  option. Putting it in /var/run/asterisk/asterisk.pid makes it
	  possible to set permissions on the /var/run/asterisk dir so
	  everything works as it should be. Patched committed is based on
	  pabelanger's patch. (closes issue #13153) Reported by: pabelanger
	  Patches: 2009012900_bug13153-nonrootscripts.diff.txt uploaded by
	  mvanbaak (license 7) Review: http://reviewboard.digium.com/r/139/

	* channels/chan_sip.c: make chan_sip.c compile on OpenBSD again.

2009-02-20 23:02 +0000 [r177732-177787]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, /: Merged revisions 177786 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r177786 | tilghman | 2009-02-20 16:59:52 -0600 (Fri, 20 Feb 2009)
	  | 9 lines Don't print the CR-NL combination when we aren't
	  outputting to the manager. An embedded CR-NL in a CLI command
	  screws up several AMI parsers that don't expect to see that
	  combination in the middle of output. (Closes issue #14305)
	  Reported by: martins Patch by: tilghman ........

	* /, include/asterisk/threadstorage.h: Merged revisions 177701 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r177701 | tilghman | 2009-02-20 15:15:01 -0600 (Fri, 20 Feb 2009)
	  | 3 lines This exception does not appear to still be true for
	  Solaris 10, and OpenSolaris definitely needs it to be removed.
	  Fixed for snuff-home on -dev channel. ........

2009-02-20 20:29 +0000 [r177699]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* apps/app_fax.c: Make app_fax compatible with spandsp-0.0.6pre4
	  Prior to spandsp-0.0.6pre4 the t30_stats_t structure used a
	  pages_transferred integer to indicate the number of pages
	  transferred (so far) during the fax session. The
	  spandsp-0.0.6pre4 release removed the pages_transferred integer
	  and replaced it with two different integers - pages_tx and
	  pages_rx. This revision uses the new integers for
	  spandsp-0.0.6pre4 while maintaining backwards compatibility for
	  previous spandsp releases.

2009-02-20 17:29 +0000 [r177661-177664]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/app.h, main/app.c, apps/app_system.c: Allow
	  semicolons to be escaped, when passing arguments to the System
	  command. (closes issue #14231) Reported by: jcovert Patches:
	  20090113__bug14231__2.diff.txt uploaded by Corydon76 (license 14)
	  corrected_20090113__bug14231__2.diff.txt uploaded by jcovert
	  (license 551) Tested by: jcovert

	* apps/app_voicemail.c: Oops, merge broke trunk

2009-02-20 00:35 +0000 [r177624]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_sip.c: Set sip_request ast_str data to NULL so
	  ast_str_copy allocates space properly in copy_request (issue
	  #14478) Reported by: erik_dedecker

2009-02-19 23:56 +0000 [r177595]  Steve Murphy <murf@digium.com>

	* /, main/Makefile, main/ast_expr2f.c: Merged revisions 177540 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 Trunk was
	  already pretty 8-bit clean; but I'm still removing the --full
	  from the flex command so everything is uniform. ........ r177540
	  | murf | 2009-02-19 15:51:37 -0700 (Thu, 19 Feb 2009) | 21 lines
	  This patch fixes a problem with 8-bit input to the ast_expr2
	  scanner. The real culprit was the --full argument to flex in the
	  Makefile! This causes a 7-bit scanner to be generated. I reviewed
	  the rules and found one rule where I needed to specifically
	  include 8-bit chars for a token. I tested against the text
	  supplied by ibercom, and all looks very well. This has been there
	  a surprisingly long time! (closes issue #14498) Reported by:
	  ibercom Patches: 14498.patch uploaded by murf (license 17) Tested
	  by: murf ........

2009-02-19 22:33 +0000 [r177506-177537]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 177536 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r177536 | tilghman | 2009-02-19 16:26:01 -0600 (Thu, 19
	  Feb 2009) | 7 lines Fix up potential crashes, by reducing the
	  sharing between interactive and non-interactive threads. (closes
	  issue #14253) Reported by: Skavin Patches:
	  20090219__bug14253.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: Skavin ........

	* doc/database_transactions.txt (added): Document how to use
	  database transactions

2009-02-19 16:45 +0000 [r177387]  Jeff Peeler <jpeeler@digium.com>

	* include/asterisk/channel.h: Fix another merge error from 176708

2009-02-19 16:38 +0000 [r177384]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_speech_utils.c: Merged revisions 177383 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r177383 | file | 2009-02-19 12:37:25 -0400 (Thu, 19 Feb
	  2009) | 3 lines If we are able to create a speech structure unset
	  the ERROR variable in case it was previously set. (issue
	  #LUMENVOX-13) ........

2009-02-19 15:56 +0000 [r177356]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c: Fix mismerge from revision 176708 pointed out by
	  Kaloyan Kovachev on the asterisk-dev mailing list. Thanks!

2009-02-19 00:26 +0000 [r177320]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/res_odbc.h, funcs/func_odbc.c, CHANGES,
	  res/res_odbc.c, configs/res_odbc.conf.sample: ODBC transaction
	  support

2009-02-19 00:08 +0000 [r177291]  Joshua Colp <jcolp@digium.com>

	* CHANGES: Update CHANGES file to include MWI subscription support
	  that was added some time ago.

2009-02-18 23:51 +0000 [r177287]  Tilghman Lesher <tlesher@digium.com>

	* main/strings.c: Handle negative length and eliminate a condition
	  that is always true.

2009-02-18 23:50 +0000 [r177286]  Steve Murphy <murf@digium.com>

	* /, res/ael/ael.tab.c, res/ael/ael.y: Merged revisions 177225 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r177225 | murf | 2009-02-18 15:43:14 -0700 (Wed, 18 Feb 2009) |
	  34 lines This patch fixes a regression of sorts that was
	  introduced in rev 24425. It basically fixes AST-190/ABE-1782.
	  What was wrong: the user has 6000 extensions in one context; and
	  then 6000 contexts, one per extension. The parser could only
	  handle about 4893 of the 6000 extens in the single context. This
	  was due to the regression I mentioned. To get rid of shift/reduce
	  conflicts, Luigi set up right-recursive lists for globals,
	  context elements, switch lists, and statements. Right recursive
	  lists got rid of the warnings, but instead, they use up a
	  tremendous amount of stack space when the lists are long. I saw
	  this a few years back, and resolved not to fix it until someone
	  complained. That day has arrived! After the changes were made, I
	  ran the regression test suite, and there were no problems. I took
	  the test case the user provided, and added 100,000 extensions to
	  the single context, that already had 6,000 extens in it. (I'll
	  see your 6, and raise you 100!) It takes a few minutes to read it
	  all in, check it and generate code for it, but no problems. So, I
	  think I can say that fundamentally, there are no longer any
	  limits on the number of items you can place in contexts,
	  statement blocks, switches, or globals, beyond your virt mem
	  constraints. ........

2009-02-18 23:09 +0000 [r177229]  Kevin P. Fleming <kpfleming@digium.com>

	* main/frame.c: fix two very minor bugs: if anyone ever uses
	  SLINEAR16 as a format in RTP, ensure that the samples are
	  byte-swapped to network order if needed. also, when a smoother is
	  operating on a format that has a sample rate other than 8000
	  samples per second, use the proper sample rate for computing
	  delivery timestamps.

2009-02-18 22:51 +0000 [r177226]  David Vossel <dvossel@digium.com>

	* main/features.c: Locking issue in action_bridge and bridge_exec
	  action_bridge() and bridge_exec() both search for the channels to
	  bridge to, and then immediately drop the lock. Instead, they
	  should hold the lock until the masquerade is complete. This will
	  guarantee the channel remains and prevent any other weirdness
	  from occurring. In action_bridge() some more weirdness comes into
	  play. Both channels are needlessly locked at the same time and
	  perform the exact same logic. It makes sense from a coding
	  organizational standpoint, but could cause a theoretical deadlock
	  so I split the code up. There is an issue associated with this,
	  but since its a rather complicated thing to reproduce I'm not
	  certain this alone will close it. issue# 14296 Review:
	  http://reviewboard.digium.com/r/167/

2009-02-18 20:11 +0000 [r177162]  Jeff Peeler <jpeeler@digium.com>

	* channels/h323/compat_h323.cxx, autoconf/ast_check_pwlib.m4,
	  channels/h323/cisco-h225.h, channels/h323/caps_h323.cxx,
	  channels/h323/ast_h323.cxx, channels/h323/ast_ptlib.h (added),
	  configure, channels/h323/compat_h323.h, configure.ac,
	  channels/h323/caps_h323.h, autoconf/ast_prog_sed.m4,
	  channels/h323/ast_h323.h, channels/h323/chan_h323.h,
	  channels/h323/cisco-h225.cxx: Modify h323 to build against PTLib
	  as well as the older PWLib Several changes in PTLib have occurred
	  requiring build time detection. Changes accounted for include the
	  library name change, config option change, install location
	  change, and a boolean type change which is handled by
	  ast_ptlib.h. Also, the sed check has been modified to properly
	  work with autoconf >= 2.62. (closes issue #14224) Reported by:
	  bergolth Patches: asterisk-autoconf-sed.patch uploaded by
	  bergolth (license 661) asterisk-pwlib-v3.patch uploaded by
	  bergolth (license 661) Tested by: jpeeler

2009-02-18 19:12 +0000 [r177101]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Re-add 'o' option to MeetMe, reverting rev
	  62297. Enabling this option by default proved to be a bad idea,
	  as the talker detection is not very reliable. So, make it
	  optional again, and off by default. (issue #13801) Reported by:
	  justdave

2009-02-18 19:05 +0000 [r177098]  Tilghman Lesher <tlesher@digium.com>

	* /, include/asterisk/config.h: Merged revisions 177096 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r177096 | tilghman | 2009-02-18 12:30:38 -0600 (Wed, 18 Feb 2009)
	  | 2 lines Document the return value of the update method (as
	  requested on -dev list) ........

2009-02-18 17:24 +0000 [r177035]  Doug Bailey <dbailey@digium.com>

	* main/utils.c: Fixed error where a check for an zero length,
	  terminated string was needed.

2009-02-18 17:11 +0000 [r177005]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix ordering of output for a ChannelUpdate
	  manager event. (closes issue #14497) Reported by: vinsik Patches:
	  chan_update_fix-chan_sip.c.diff uploaded by vinsik (license 623)

2009-02-18 16:09 +0000 [r176948]  Doug Bailey <dbailey@digium.com>

	* main/utils.c: Need to take into account the \0 terminator of the
	  old string to determine the amount available.

2009-02-18 15:35 +0000 [r176943]  Steve Murphy <murf@digium.com>

	* main/pbx.c: This patch fixes merge_contexts_and_delete so it does
	  not deadlock when hints are present. Reason: when I re-engineered
	  the merge_and_delete func to reduce its lock time, I failed to
	  notice that the functions it calls still also do locking as
	  before. This leads to deadlocks on dialplan reloads, when there
	  are actually living, subscribed hints registered in the system.
	  While the reporter come across this problem while using AEL, I
	  might note that these deadlocks should also happen if
	  extensions.conf were used. Here I added these routines to pbx.c:
	  ast_add_extension_nolock add_pri_lockopt
	  ast_add_extension2_lockopt find_context add_hint_nolock All of
	  the above routines are static and restricted to be used only
	  within pbx.c, and more specifically within the
	  merge_contexts_and_delete routine. They are pretty much the same
	  as their counterparts except they don't lock contexts or hints.
	  Most of them now do the real work of their name-alike, with
	  optional locking via extra arguments, and are called by their
	  name-alike. The goal was to have the original functions so they
	  would behave exactly as before. Both PJ and I tested these fixes,
	  and the deadlocking problem is no longer encountered. (closes
	  issue #14357) Reported by: pj Patches: 14357.diff uploaded by
	  murf (license 17) Tested by: pj, murf

2009-02-18 06:14 +0000 [r176901-176904]  Russell Bryant <russell@digium.com>

	* include/asterisk/heap.h: Add example code for a heap traversal.

	* main/pbx.c: Fix a number of incorrect uses of strncpy(). The big
	  problem here is that the 3rd argument provided in these uses of
	  strncpy() did not reserve a byte for the null terminator, leaving
	  the potential for writing one byte past the end of the buffer.
	  Aside from this, there were coding guidelines violations with
	  regards to spacing, as well as hard coded lengths being used
	  instead of sizeof().

2009-02-18 02:55 +0000 [r176869]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* channels/chan_sip.c: T38 faxdetect should jump to the 'fax'
	  extension for incoming calls only The previous implementation of
	  T38 faxdetect resulted in both sides of the call jumping to a fax
	  extension when both sides had 't38pt_udptl=yes' and
	  'faxdetect=yes' in sip.conf and a 'fax' extension in the current
	  context. This revision will jump to a 'fax' extension on incoming
	  calls only.

2009-02-18 02:02 +0000 [r176841]  Kevin P. Fleming <kpfleming@digium.com>

	* main/rtp.c: suppress smoothers for Siren codecs as well as Speex
	  and G.723.1

2009-02-17 22:52 +0000 [r176771]  Russell Bryant <russell@digium.com>

	* apps/app_milliwatt.c: Remove a dependency that no longer exists.

2009-02-17 22:28 +0000 [r176760]  Shaun Ruffell <sruffell@digium.com>

	* codecs/codec_dahdi.c: Several changes to codec_dahdi to play nice
	  with G723. This commit brings in the changes that were living out
	  on the svn/asterisk/team/sruffell/asterisk-trunk-transcoder
	  branch. codec_dahdi.c now always uses signed linear as the simple
	  codec so that a soft g729 codec will not end up being preferred
	  to the hardware codec. There are also changes to allow
	  codec_dahdi.c to feed packets to the hardware in the native
	  sample size of the codec. This solves problems with choppy audio
	  when using G723.

2009-02-17 22:08 +0000 [r176708]  Jeff Peeler <jpeeler@digium.com>

	* main/channel.c, /, main/features.c, include/asterisk/channel.h:
	  Merged revisions 176701 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r176701 | jpeeler | 2009-02-17 15:54:34 -0600 (Tue, 17 Feb 2009)
	  | 17 lines Modify bridging to properly evaluate DTMF after first
	  warning is played The main problem is currently if the Dial flag
	  L is used with a warning sound, DTMF is not evaluated after the
	  first warning sound. To fix this, a flag has been added in
	  ast_generic_bridge for playing the warning which ensures that if
	  a scheduled warning is missed, multiple warrnings are not played
	  back (due to a feature evaluation or waiting for digits).
	  ast_channel_bridge was modified to store the nexteventts in the
	  ast_bridge_config structure as that information was lost every
	  time ast_channel_bridge was reentered, causing a hangup due to
	  incorrect time calculations. (closes issue #14315) Reported by:
	  tim_ringenbach Reviewed on reviewboard:
	  http://reviewboard.digium.com/r/163/ ........

2009-02-17 22:02 +0000 [r176706]  Mark Michelson <mmichelson@digium.com>

	* tests/test_sched.c: Use constants from inttypes.h to clear up
	  32-bit compilation errors

2009-02-17 21:59 +0000 [r176705]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* channels/chan_sip.c: create a UDPTL structure in
	  create_addr_from_peer() if it does not already exist for T38 This
	  is required to create a UDPTL structure in
	  create_addr_from_peer() to handle the scenario where
	  't38pt_udptl=yes' is not defined in the [general] section of
	  sip.conf but is defined the peer's context. I tested this patch
	  by enabling t38pt_udptl in the [general] section on one system
	  and only enabling t38pt_udptl in a peer's context on the system
	  sending a fax. Without the patch, the sending system will fail to
	  initiate T38 negotiation with the warning message, "No way to add
	  SDP without an UDPTL structure". When this patch is applied the
	  sending side will successfully initiate T38 negotiation.

2009-02-17 21:40 +0000 [r176697]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/frame.h: Clear up documentation of
	  AST_FRIENDLY_OFFSET in frame.h

2009-02-17 21:23 +0000 [r176669]  Tilghman Lesher <tlesher@digium.com>

	* /: Recorded merge of revisions 176661 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r176661 | tilghman | 2009-02-17 15:21:41 -0600 (Tue, 17 Feb 2009)
	  | 9 lines Backport change to 1.4: Prior to masquerade, move the
	  group definitions to the channel performing the masq, so that the
	  group count lingers past the bridge. (closes issue #14275)
	  Reported by: kowalma Patches: 20090216__bug14275.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: kowalma ........

2009-02-17 21:22 +0000 [r176666]  Russell Bryant <russell@digium.com>

	* main/channel.c, res/res_timing_pthread.c, res/res_timing_dahdi.c,
	  res/res_timing_timerfd.c, include/asterisk/timing.h,
	  main/timing.c: Update the timing API to have better support for
	  multiple timing interfaces. 1) Add module use count handling so
	  that timing modules can be unloaded. 2) Implement unload_module()
	  functions for the timing interface modules. 3) Allow multiple
	  timing modules to be loaded, and use the one with the highest
	  priority value. 4) Report which timing module is being use in the
	  "timing test" CLI command. (closes issue #14489) Reported by:
	  russell Review: http://reviewboard.digium.com/r/162/

2009-02-17 21:14 +0000 [r176642]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_local.c: Prior to masquerade, move the group
	  definitions to the channel performing the masq, so that the group
	  count lingers past the bridge. (closes issue #14275) Reported by:
	  kowalma Patches: 20090216__bug14275.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: kowalma

2009-02-17 21:04 +0000 [r176632-176639]  Russell Bryant <russell@digium.com>

	* tests/test_sched.c (added), main/sched.c: Significantly improve
	  scheduler performance under high load. This patch changes the
	  scheduler to use a max-heap to store pending scheduler entries
	  instead of a fully sorted doubly linked list. When the number of
	  entries in the scheduler gets large, this will perform much
	  better. For much more detailed information on this change, see
	  the review request. Review: http://reviewboard.digium.com/r/160/

	* tests/test_heap.c (added): Add a test module for the heap
	  implementation. Review: http://reviewboard.digium.com/r/160/

	* main/Makefile, main/heap.c (added), include/asterisk/heap.h
	  (added): Add an implementation of the heap data structure. A heap
	  is a convenient data structure for implementing a priority queue.
	  Code from svn/asterisk/team/russell/heap/. Review:
	  http://reviewboard.digium.com/r/160/

2009-02-17 20:50 +0000 [r176631]  Olle Johansson <oej@edvina.net>

	* include/asterisk/config.h: Typo

2009-02-17 20:41 +0000 [r176627]  Russell Bryant <russell@digium.com>

	* channels/chan_unistim.c, main/pbx.c, apps/app_read.c,
	  configs/indications.conf.sample, apps/app_playtones.c (added),
	  include/asterisk/indications.h, apps/app_readexten.c,
	  apps/app_disa.c, UPGRADE.txt, include/asterisk/channel.h,
	  include/asterisk/_private.h, main/indications.c, main/loader.c,
	  main/channel.c, channels/chan_misdn.c, channels/chan_skinny.c,
	  funcs/func_channel.c, res/snmp/agent.c, main/app.c,
	  res/res_indications.c (removed), main/asterisk.c: Merge a large
	  set of updates to the Asterisk indications API. This patch
	  includes a number of changes to the indications API. The primary
	  motivation for this work was to improve stability. The object
	  management in this API was significantly flawed, and a number of
	  trivial situations could cause crashes. The changes included are:
	  1) Remove the module res_indications. This included the critical
	  functionality that actually loaded the indications configuration.
	  I have seen many people have Asterisk problems because they
	  accidentally did not have an indications.conf present and loaded.
	  Now, this code is in the core, and Asterisk will fail to start
	  without indications configuration. There was one part of
	  res_indications, the dialplan applications, which did belong in a
	  module, and have been moved to a new module, app_playtones. 2)
	  Object management has been significantly changed. Tone zones are
	  now managed using astobj2, and it is no longer possible to crash
	  Asterisk by issuing a reload that destroys tone zones while they
	  are in use. 3) The API documentation has been filled out. 4) The
	  API has been updated to follow our naming conventions. 5) Various
	  bits of code throughout the tree have been updated to account for
	  the API update. 6) Configuration parsing has been mostly
	  re-written. 7) "Code cleanup" The code is from
	  svn/asterisk/team/russell/indications/. Review:
	  http://reviewboard.digium.com/r/149/

2009-02-17 18:49 +0000 [r176592]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_odbc.c, res/res_odbc.c: Add assertions in the quest to
	  track down a refcount leak. (closes issue #14485) Reported by:
	  davevg

2009-02-17 17:33 +0000 [r176557]  Russell Bryant <russell@digium.com>

	* main/pbx.c, apps/app_queue.c: Fix a race condition that caused
	  device states to become incorrect for hints. The problem here is
	  that the hint processing code was subscribed to the wrong event
	  type. So, it started processing state for a hint too soon, before
	  the device state cache had been updated. Also, fix a similar bug
	  in app_queue, as it was also subscribed to the wrong event type.
	  (closes issue #14461) Reported by: alecdavis

2009-02-17 17:28 +0000 [r176513-176556]  Olle Johansson <oej@edvina.net>

	* configs/extconfig.conf.sample: Typo

	* main/config.c: If there are no realtime engines, there's no
	  reason to check for realtime families

2009-02-17 14:39 +0000 [r176360-176501]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: In this version, we can combine the queries,
	  because we support dropping nonexistent columns.

	* /, channels/chan_sip.c: Merged revisions 176426 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r176426 | tilghman | 2009-02-16 18:49:22 -0600 (Mon, 16 Feb 2009)
	  | 10 lines After a 'sip reload', qualifies for realtime peers
	  weren't immediately restarted, instead waiting until the next
	  registration. We're now caching the qualify across a
	  reload/restart and starting the qualify immediately upon loading
	  the peer. (closes issue #14196) Reported by: pdf Patches:
	  20090120__bug14196_1.4.diff.txt uploaded by pdf (license 663)
	  Tested by: pdf ........

	* main/strings.c: Might want to update the buffer pointer after a
	  realloc (or we crash) (closes issue #14485) Reported by: davevg

2009-02-16 23:37 +0000 [r176356]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/sounds.xml: add support for Siren7 and Siren14 flavors of
	  prompts and music on hold

2009-02-16 23:33 +0000 [r176355]  David Vossel <dvossel@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 176354 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r176354 | dvossel | 2009-02-16 17:30:52 -0600 (Mon, 16
	  Feb 2009) | 8 lines Fixes issue with AST_CONTROL_SRCUPDATE not
	  being relayed correctly during bridging This should have been
	  committed with rev176247, but I missed it. srcupdate frames no
	  longer break out of the native bridge, but are not being sent to
	  the other call leg either. This fixs that. issue #13749 ........

2009-02-16 23:14 +0000 [r176320]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_skinny.c: Use the correct list macros for deleting
	  an item from the middle of a list. (issue #13777) Reported by: pj
	  Patches: 20090203__bug13777.diff.txt uploaded by Corydon76
	  (license 14) Tested by: pj

2009-02-16 21:45 +0000 [r176255]  Kevin P. Fleming <kpfleming@digium.com>

	* /, main/utils.c, include/asterisk/stringfields.h: Merged
	  revisions 176216 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r176216 | kpfleming | 2009-02-16 15:10:38 -0600 (Mon, 16 Feb
	  2009) | 3 lines fix a flaw in the ast_string_field_build() family
	  of API calls; these functions made no attempt to reuse the space
	  already allocated to a field, so every time the field was written
	  it would allocate new space, leading to what appeared to be a
	  memory leak. ........ r176254 | kpfleming | 2009-02-16 15:41:46
	  -0600 (Mon, 16 Feb 2009) | 3 lines correct a logic error in the
	  last stringfields commit... don't mark additional space as
	  allocated if the string was built using already-allocated space
	  ........

2009-02-16 21:40 +0000 [r176253]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_meetme.c: Merged revisions 176249,176252 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r176249 | mmichelson | 2009-02-16 15:34:27 -0600 (Mon,
	  16 Feb 2009) | 14 lines Open the DAHDI pseudo device and set it
	  to be nonblocking atomically Apparently on FreeBSD, attempting to
	  set the O_NONBLOCKING flag separately from opening the file was
	  causing an "inappropriate ioctl for device" error. While I cannot
	  fathom why this would be happening, I certainly am not opposed to
	  making the code a bit more compact/efficient if it also fixes a
	  bug. (closes issue #14482) Reported by: ys Patches: meetme.patch
	  uploaded by ys (license 281) Tested by: ys ........ r176252 |
	  mmichelson | 2009-02-16 15:39:21 -0600 (Mon, 16 Feb 2009) | 3
	  lines Remove unused variable and make dev-mode compilation happy
	  ........

2009-02-16 21:30 +0000 [r176248]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c: Merged revisions 175597 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/trunk ........ r175597 |
	  dvossel | 2009-02-13 14:11:55 -0600 (Fri, 13 Feb 2009) | 4 lines
	  Fixed iax2 key rotation backwards compatibility Turns key
	  rotation back on by default. Added bit into encryption IE to
	  indicate whether or not key rotation is supported or not. If it
	  is not supported then it is not enabled, which insures backwards
	  compatibility. This eliminates the need for the keyrotate option
	  in iax.conf, so it has been removed. ........

2009-02-16 18:25 +0000 [r176174]  Mark Michelson <mmichelson@digium.com>

	* main/logger.c: Assist proper thread synchronization when stopping
	  the logger thread. I was finding that on my dev box, occasionally
	  attempting to "stop now" in trunk would cause Asterisk to hang. I
	  traced this to the fact that the logger thread was waiting on a
	  condition which had already been signalled. The logger thread
	  also need to be sure to check the value of the
	  close_logger_thread variable. The close_logger_thread variable is
	  only checked when the list of logmessages is empty. This allows
	  for the logger thread to print and free any pending messages
	  before exiting.

2009-02-16 17:44 +0000 [r176138]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c: Can't set debug level 2 (intense
	  debugging) unless the syntax matches

2009-02-16 17:09 +0000 [r176100]  Russell Bryant <russell@digium.com>

	* channels/chan_features.c (removed): Remove chan_features. Review:
	  http://reviewboard.digium.com/r/161/

2009-02-16 15:36 +0000 [r176030]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 176029 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r176029 | file | 2009-02-16 11:33:53 -0400 (Mon, 16 Feb 2009) | 9
	  lines Don't have the Via header stored as a stringfield as it can
	  change often during the lifetime of a dialog. This issue crept up
	  with subscriptions on the AA50. When an outgoing NOTIFY is sent a
	  new branch value is created and the Via header is changed to
	  reflect it. Since this was a stringfield a new spot in the pool
	  was used for the value while the old was left untouched/unused.
	  If the current pool was full a new pool was created. This would
	  cause memory usage to increase steadily. (issue #AA50-2332)
	  ........

2009-02-16 02:54 +0000 [r175983]  Russell Bryant <russell@digium.com>

	* main/channel.c: Make the causes array static, and remove the type
	  name as it is not needed.

2009-02-16 00:26 +0000 [r175952]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_unistim.c, /, channels/chan_sip.c,
	  include/asterisk/manager.h, doc/unistim.txt: Merged revisions
	  175921 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r175921 | mvanbaak | 2009-02-16 00:37:03 +0100 (Mon, 16 Feb 2009)
	  | 3 lines fix mis-spelling of the word registered. Reported by
	  De_Mon on #asterisk-dev. ........

2009-02-15 21:27 +0000 [r175829-175882]  Russell Bryant <russell@digium.com>

	* include/asterisk/sched.h, main/sched.c: Make ast_sched_report()
	  and ast_sched_dump() thread safe.

	* channels/chan_sip.c, include/asterisk/sched.h, main/sched.c: Fix
	  a number of problems with ast_sched_report(). 1) It had numerous
	  coding guidelines violations with regards to formatting. 2) It
	  allocated memory using ast_calloc() that was never freed. 3) It
	  didn't check for failure from the allocation. 4) It used
	  sprintf() and strcat() to build the result, doing zero checking
	  to prevent writing past the end of the provided buffer. The
	  function also lacks API documentation, but that has not been
	  addressed in this commit.

2009-02-15 20:39 +0000 [r175783-175827]  Olle Johansson <oej@edvina.net>

	* formats/format_ilbc.c, /: Merged revisions 175825 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r175825 | oej | 2009-02-15 21:33:17 +0100 (SÃ¶n, 15 Feb
	  2009) | 2 lines format_ilbc does not depend on codec libraries
	  and can therefore always be made. My mistake. Ursäkta! ........

	* formats/format_ilbc.c, /: Merged revisions 175792 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r175792 | oej | 2009-02-15 21:20:21 +0100 (SÃ¶n, 15 Feb
	  2009) | 2 lines Disable format_ilbc.so by default, like
	  codec_ilbc.so ........

	* /, channels/chan_sip.c: Merged revisions 175777 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r175777 | oej | 2009-02-15 20:48:38 +0100 (SÃ¶n, 15 Feb 2009) | 2
	  lines Make sure that the debug line is not printed on debug level
	  0 ........

2009-02-13 20:57 +0000 [r175655-175663]  Mark Michelson <mmichelson@digium.com>

	* doc/manager_1_1.txt, CHANGES, apps/app_queue.c: Merge queue-reset
	  branch to Asterisk From a user point-of-view, this adds new CLI
	  commands and Manager Actions to better facilitate the reloading
	  of queues and the resetting of their statistics. The new CLI
	  commands are the "queue reload" and "queue reset stats" commands.
	  The new manager actions are the QueueReload and QueueReset
	  commands. Review: http://reviewboard.digium.com/r/115

	* doc/manager_1_1.txt, apps/app_chanspy.c: Add manager events for
	  chanspy starting or stopping (closes issue #14469) Reported by:
	  caio1982 Patches: chanspy_events2.diff uploaded by caio1982
	  (license 22)

2009-02-13 20:26 +0000 [r175623-175636]  Russell Bryant <russell@digium.com>

	* res/res_jabber.c: fix a few more XML documentation problems

	* main/pbx.c: add missing </para>

2009-02-13 20:11 +0000 [r175597]  David Vossel <dvossel@digium.com>

	* configs/iax.conf.sample, channels/iax2.h, channels/chan_iax2.c:
	  Fixed iax2 key rotation backwards compatibility Turns key
	  rotation back on by default. Added bit into encryption IE to
	  indicate whether or not key rotation is supported or not. If it
	  is not supported then it is not enabled, which insures backwards
	  compatibility. This eliminates the need for the keyrotate option
	  in iax.conf, so it has been removed. Review:
	  http://reviewboard.digium.com/r/159/

2009-02-13 19:49 +0000 [r175591]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 175590 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r175590 | mmichelson | 2009-02-13 13:47:48 -0600 (Fri,
	  13 Feb 2009) | 16 lines Fix a potential crash situation when
	  using IMAP voicemail If calling into VoiceMailMain when using
	  IMAP storage, it was possible to crash Asterisk by hanging up the
	  phone when prompted for a voicemail mailbox. This patch fixes the
	  issue. While it may appear that this patch is superficial, it
	  allows code execution to continue to the failure case just below
	  the IMAP_STORAGE code block where this patch has been applied
	  (closes issue #14473) Reported by: dwpaul Patches:
	  voicemail_imap_crash_no_mailbox.patch uploaded by dwpaul (license
	  689) ........

2009-02-13 16:41 +0000 [r175549]  Joshua Colp <jcolp@digium.com>

	* apps/app_record.c: Add an option to keep the recorded file upon
	  hangup. (closes issue #14341) Reported by: fnordian

2009-02-13 13:41 +0000 [r175508-175512]  Kevin P. Fleming <kpfleming@digium.com>

	* CHANGES: document G.722.1/.1C support

	* main/frame.c, channels/chan_sip.c, include/asterisk/rtp.h,
	  channels/chan_h323.c, include/asterisk/frame.h,
	  formats/format_siren14.c (added), main/rtp.c,
	  formats/format_siren7.c (added): Add basic (passthrough,
	  playback, record) support for ITU G.722.1 and G.722.1C (also
	  known as Siren7 and Siren14) This patch adds passthrough, file
	  recording and file playback support for the codecs listed above,
	  with negotiation over SIP/SDP supported. Due to Asterisk's
	  current limitation of treating a codec/bitrate combination as a
	  unique codec, only G.722.1 at 32 kbps and G.722.1C at 48 kbps are
	  supported. Along the way, some related work was done: 1) The
	  rtpPayloadType structure definition, used as a return result for
	  an API call in rtp.h, was moved from rtp.c to rtp.h so that the
	  API call was actually usable. The only previous used of the API
	  all was chan_h323.c, which had a duplicate of the structure
	  definition instead of doing it the right way. 2) The hardcoded
	  SDP sample rates for various codecs in chan_sip.c were removed,
	  in favor of storing these sample rates in rtp.c along with the
	  codec definitions there. A new API call was added to allow
	  retrieval of the sample rate for a given codec. 3) Some basic
	  'a=fmtp' parsing for SDP was added to chan_sip, because chan_sip
	  *must* decline any media streams offered for these codecs that
	  are not at the bitrates that we support (otherwise Bad Things
	  (TM) would result). Review: http://reviewboard.digium.com/r/158/

2009-02-13 04:22 +0000 [r175411-175475]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* CHANGES: add 'faxbuffers' configuration option information to
	  CHANGES

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample: Add
	  dynamic fax buffer configuration option to chan_dahdi.conf When
	  the 'faxdetect' configuration option is used, one may also want
	  to use the 'faxbuffers' configuration option in chan_dahdi.conf.
	  This option will dynamically use the configured 'faxbuffers'
	  buffer policy on a channel for the life of the call following the
	  detection of fax tones. The faxbuffers buffer policy will be
	  reverted during call teardown. An example use of 'faxbuffers' is
	  below. This example would switch to using 6 buffers with a full
	  buffer policy. faxbuffers=>6,full

2009-02-12 21:41 +0000 [r175368]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Remove useless string copy, and make sscanf
	  safe again

2009-02-12 21:27 +0000 [r175344]  David Vossel <dvossel@digium.com>

	* configs/iax.conf.sample, CHANGES, channels/chan_iax2.c: Adds
	  force encryption option to iax.conf This patch adds
	  forceencryption=yes as an iax.conf option. When force encryption
	  is enabled, no unencrypted connections are allowed. This insures
	  all connections are encrypted. This is a new feature, so CHANGES
	  and iax.conf.sample are updated as well. (closes issue #13285)
	  Reported by: sgofferj Tested by: russell Review:
	  http://reviewboard.digium.com/r/150/

2009-02-12 21:25 +0000 [r175334]  Tilghman Lesher <tlesher@digium.com>

	* main/udptl.c, /: Merged revisions 175311 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r175311 | tilghman | 2009-02-12 15:19:40 -0600 (Thu, 12 Feb 2009)
	  | 9 lines Fix crashes when receiving certain T.38 packets. Also,
	  increase the maximum size of T.38 packets and warn users when
	  they try to set the limits above those maximums. (closes issue
	  #13050) Reported by: schern Patches: 20090212__bug13050.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: schern ........

2009-02-12 20:48 +0000 [r175298]  Jeff Peeler <jpeeler@digium.com>

	* /, main/features.c: Merged revisions 175294 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r175294 | jpeeler | 2009-02-12 14:34:36 -0600 (Thu, 12 Feb 2009)
	  | 9 lines Fix ParkedCall event information for From field in the
	  case of a blind transfer If the parker information can not be
	  obtained from the peer, try and see if the BLINDTRANSFER channel
	  variable has been set. Previously, a blind transfer to the
	  ParkAndAnnounce app would return nothing for the From. Closes
	  AST-189 ........

2009-02-12 20:45 +0000 [r175255-175295]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Avoid using ast_strdupa() in a loop.

	* build_tools/cflags.xml: Don't enable something by default that
	  has a dependency on something _not_ enabled by default.
	  menuselect was not happy with this.

2009-02-12 18:48 +0000 [r175250]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c: correct warning message to not refer
	  specifically to DAHDI

2009-02-12 18:00 +0000 [r175188]  Jeff Peeler <jpeeler@digium.com>

	* /, main/features.c: Merged revisions 175187 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r175187 | jpeeler | 2009-02-12 11:57:10 -0600 (Thu, 12 Feb 2009)
	  | 6 lines Fix crash in event of failed attempt to transfer to
	  parking The peer may not necessarily exist, such as in the case
	  of a transfer to ParkAndAnnounce. In this case don't try to play
	  a sound to it. ........

2009-02-12 17:07 +0000 [r175127]  David Vossel <dvossel@digium.com>

	* channels/chan_iax2.c: Setting key rotation to be off by default
	  Key rotation breaks compatibility between (trunk/1.6.1) and
	  (1.2/1.4/1.6.0). As a follow up to this, I am investigating
	  possible ways to allow key rotation to be on by default and not
	  affect the other branches, but for now it must be turned off.

2009-02-12 16:57 +0000 [r175125]  Russell Bryant <russell@digium.com>

	* /, main/rtp.c: Merged revisions 175124 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r175124 | russell | 2009-02-12 10:51:13 -0600 (Thu, 12 Feb 2009)
	  | 27 lines Don't send DTMF for infinite time if we do not receive
	  an END event. I thought that this was going to end up being a
	  pretty gnarly fix, but it turns out that there was actually
	  already a configuration option in rtp.conf, dtmftimeout, that was
	  intended to handle this situation. However, in between Asterisk
	  1.2 and Asterisk 1.4, the code that processed the option got
	  lost. So, this commit brings it back to life. The default timeout
	  is 3 seconds. However, it is worth noting that having this be
	  configurable at all is not really the recommended behavior in RFC
	  2833. From Section 3.5 of RFC 2833: Limiting the time period of
	  extending the tone is necessary to avoid that a tone "gets
	  stuck". Regardless of the algorithm used, the tone SHOULD NOT be
	  extended by more than three packet interarrival times. A slight
	  extension of tone durations and shortening of pauses is generally
	  harmless. Three seconds will pretty much _always_ be far more
	  than three packet interarrival times. However, that behavior is
	  not required, so I'm going to leave it with our legacy behavior
	  for now. Code from svn/asterisk/team/russell/issue_14460 (closes
	  issue #14460) Reported by: moliveras ........

2009-02-12 16:28 +0000 [r175121]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/astobj2.h, main/astobj2.c: Make lock information
	  for ao2_trylock be more useful and gnarly Core show locks
	  information involving an ao2_trylock did not show the function
	  that called ao2_trylock, but would instead show ao2_trylock as
	  the source of the lock. This is not useful when trying to debug
	  locking issues. One bizarre note is that this logic is already in
	  1.4 but somehow did not get merged to trunk or the 1.6.X
	  branches.

2009-02-12 14:25 +0000 [r175058-175089]  Philippe Sultan <philippe.sultan@gmail.com>

	* channels/chan_gtalk.c: Issue a warning message if our candidate's
	  IP is the loopback address. (closes issue #13985) Reported by:
	  jcovert Tested by: phsultan

	* /, channels/chan_gtalk.c: Merged revisions 175029 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r175029 | phsultan | 2009-02-12 11:16:21 +0100 (Thu, 12
	  Feb 2009) | 12 lines Set the initiator attribute to lowercase in
	  our replies when receiving calls. This attribute contains a JID
	  that identifies the initiator of the GoogleTalk voice session.
	  The GoogleTalk client discards Asterisk's replies if the
	  initiator attribute contains uppercase characters. (closes issue
	  #13984) Reported by: jcovert Patches: chan_gtalk.2.patch uploaded
	  by jcovert (license 551) Tested by: jcovert ........

2009-02-11 23:12 +0000 [r174945-174951]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix a bit of odd logic for announcing position.
	  Sync with 1.6.0's logic

	* apps/app_queue.c: Fix odd "thank you" sound playing behavior in
	  app_queue.c If someone has configured the queue to play an
	  position or holdtime announcement, then it is odd and potentially
	  unexpected to hear a "Thank you for your patience" sound when no
	  position or holdtime was actually announced. This fixes the
	  announcement so that the "thanks" sound is only played in the
	  case that a position or holdtime was actually announced. There is
	  a way that the "thank you" sound can be played without a position
	  or holdtime, and that is to set announce-frequency to a value but
	  keep announce-position and announce-holdtime both turned off.
	  (closes issue #14227) Reported by: caspy Patches: 14227_v3.patch
	  uploaded by putnopvut (license 60) Tested by: caspy

	* apps/app_dial.c, main/channel.c, main/pbx.c, apps/app_dictate.c,
	  apps/app_waitforsilence.c, include/asterisk/channel.h: Fix 'd'
	  option for app_dial and add new option to Answer application The
	  'd' option would not work for channel types which use RTP to
	  transport DTMF digits. The only way to allow for this to work was
	  to answer the channel if we saw that this option was enabled. I
	  realized that this may cause issues with CDRs, specifically with
	  giving false dispositions and answer times. I therefore modified
	  ast_answer to take another parameter which would tell if the CDR
	  should be marked answered. I also extended this to the Answer
	  application so that the channel may be answered but not CDRified
	  if desired. I also modified app_dictate and app_waitforsilence to
	  only answer the channel if it is not already up, to help not
	  allow for faulty CDR answer times. All of these changes are going
	  into Asterisk trunk. For 1.6.0 and 1.6.1, however, all the
	  changes except for the change to the Answer application will go
	  in since we do not introduce new features into stable branches
	  (closes issue #14164) Reported by: DennisD Patches: 14164.patch
	  uploaded by putnopvut (license 60) Tested by: putnopvut Review:
	  http://reviewboard.digium.com/r/145

2009-02-11 14:44 +0000 [r174844]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Tell the device state core a change happened when
	  a channel is freed but not a specific state. We need to do this
	  because while we know that the freeing of the channel may cause
	  something to become not in use we do not know this for sure.
	  There may be another channel that is still up which would cause
	  it to be in use. (closes issue #13238) Reported by: kowalma
	  Patches: 20090121__bug13238.diff.txt uploaded by Corydon76
	  (license 14) Tested by: alecdavis

2009-02-10 23:17 +0000 [r174764-174805]  Mark Michelson <mmichelson@digium.com>

	* apps/app_chanspy.c: Fix potential for stack overflows in
	  app_chanspy.c When using the 'g' or 'e' options, the stack
	  allocations that were used could cause a stack overflow if a
	  spyer stayed on the line long enough without actually
	  successfully spying on anyone. The problem has been corrected by
	  using static buffers and copying the contents of the appropriate
	  strings into them instead of using functions like alloca or
	  ast_strdupa

	* main/manager.c: Fix an fd leak that would occur in HTTP AMI
	  sessions The explanation behind this fix is a bit complicated,
	  and I've already typed it up in the code as a huge comment inside
	  of manager.c, so I'll give the abridged version here. We needed a
	  way to separate action-specific data from session-specific data.
	  Unfortunately, the only way to maintain API compatibility and to
	  not have to change every single manager action was to rename the
	  current mansession structure and wrap it inside a new mansession
	  structure which actually contains action- specific data. (closes
	  issue #14364) Reported by: awk Patches: 14364_better.patch
	  uploaded by putnopvut (license 60) Tested by: putnopvut Review:
	  http://reviewboard.digium.com/r/148/

2009-02-10 20:15 +0000 [r174710]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Only decrease inringing count if above zero.
	  (issue #13238) Reported by: kowalma

2009-02-10 19:38 +0000 [r174705]  Kevin P. Fleming <kpfleming@digium.com>

	* main/slinfactory.c, include/asterisk/slinfactory.h: improve
	  slinfactory API to remove implicit sample rate and require
	  explicit sample rate selection by creator of the slinfactory

2009-02-10 18:16 +0000 [r174584]  Matthew Nicholson <mnicholson@digium.com>

	* /, main/jitterbuf.c: Merged revisions 174583 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r174583 | mnicholson | 2009-02-10 11:52:42 -0600 (Tue, 10 Feb
	  2009) | 18 lines Improve behavior of jitterbuffer when
	  maxjitterbuffer is set. This change improves the way the
	  jitterbuffer handles maxjitterbuffer and dramatically reduces the
	  number of frames dropped when maxjitterbuffer is exceeded. In the
	  previous jitterbuffer, when maxjitterbuffer was exceeded, all new
	  frames were dropped until the jitterbuffer is empty. This change
	  modifies the code to only drop frames until maxjitterbuffer is no
	  longer exceeded. Also, previously when maxjitterbuffer was
	  exceeded, dropped frames were not tracked causing stats for
	  dropped frames to be incorrect, this change also addresses that
	  problem. (closes issue #14044) Patches: bug14044-1.diff uploaded
	  by mnicholson (license 96) Tested by: mnicholson Review:
	  http://reviewboard.digium.com/r/144/ ........

2009-02-10 17:48 +0000 [r174543-174580]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Set the type for the peer structure to be a
	  peer as the default. (closes issue #14447) Reported by: triccyx

	* channels/chan_sip.c: Make the logic for inuse and inringing
	  manipluation match that of 1.4. The old broken logic would reset
	  the values back to 0 during certain scenarios causing the wrong
	  state to be reported. (closes issue #14399) Reported by: caspy
	  (issue #13238) Reported by: kowalma

2009-02-10 07:06 +0000 [r174470-174503]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_stack.c, apps/app_voicemail.c: Fix0ring build

	* apps/app_stack.c: Remove the usage of the KeepAlive app, as it no
	  longer exists.

2009-02-10 04:49 +0000 [r174370-174435]  Steve Murphy <murf@digium.com>

	* apps/app_rpt.c: This patch removes the use of AST_PBX_KEEPALIVE
	  from app_rpt.c. (closes issue #14435) Reported by: D_McNaul

	* apps/app_rpt.c: More intptr_t work.

	* /, apps/app_rpt.c: Merged revisions 174369 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r174369 | murf | 2009-02-09 19:27:40 -0700 (Mon, 09 Feb 2009) | 5
	  lines This patch solves some compiler complaints in both 32 and
	  64-bit environments. ........

2009-02-09 17:27 +0000 [r174327]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Fix something I messed up in the merge I
	  just did

2009-02-09 17:26 +0000 [r174325]  David Vossel <dvossel@digium.com>

	* apps/app_externalivr.c: Fixes issue with hangups not being sent
	  and external process never terminating. The ignore_hangup,
	  run_dead, and noanswer flags were never initilized to zero
	  causing hangups to never be issued. If the external script
	  expects to be notified of a hangup and never receives one, it
	  runs indefinitely. (closes issue #14251) Reported by: chris-mac
	  Tested by: dvossel

2009-02-09 17:20 +0000 [r174301]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 174282 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r174282 | mmichelson | 2009-02-09 11:11:05 -0600 (Mon, 09 Feb
	  2009) | 12 lines Don't do an SRV lookup if a port is specified
	  RFC 3263 says to do A record lookups on a hostname if a port has
	  been specified, so that's what we're going to do. See section
	  4.2. (closes issue #14419) Reported by: klaus3000 Patches:
	  patch_chan_sip_nosrvifport_1.4.23.txt uploaded by klaus3000
	  (license 65) ........

2009-02-09 14:49 +0000 [r174219]  Joshua Colp <jcolp@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 174218 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r174218 | file | 2009-02-09 10:48:21 -0400 (Mon, 09 Feb
	  2009) | 4 lines Don't overwrite our pointer to the music class
	  when music on hold stops. We will use this if it starts again to
	  see if we can resume the music where it left off. (closes issue
	  #14407) Reported by: mostyn ........

2009-02-07 16:16 +0000 [r174149]  Russell Bryant <russell@digium.com>

	* /, res/snmp/agent.c: Merged revisions 174148 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r174148 | russell | 2009-02-07 10:15:07 -0600 (Sat, 07 Feb 2009)
	  | 2 lines Fix a race condition that could cause a crash. ........

2009-02-06 23:51 +0000 [r174084]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* /, channels/chan_sip.c: Merged revisions 174082 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r174082 | dhubbard | 2009-02-06 17:36:03 -0600 (Fri, 06 Feb 2009)
	  | 5 lines check ast_strlen_zero() before calling ast_strdupa() in
	  sip_uri_headers_cmp() and sip_uri_params_cmp() The reporter
	  didn't actually upload a properly-formed patch, instead a
	  modified chan_sip.c file was uploaded. I created a patch to
	  determine the changes, then modified the suggested changes to
	  create a proper fix. The summary above is a complete description
	  of the changes. (closes issue #13547) Reported by: tecnoxarxa
	  Patches: chan_sip.c.gz uploaded by tecnoxarxa (license 258)
	  Tested by: tecnoxarxa ........

2009-02-06 20:12 +0000 [r174046]  David Vossel <dvossel@digium.com>

	* configs/iax.conf.sample, CHANGES, channels/chan_iax2.c: Adds
	  immediate yes/no option to iax.conf This is very similar to the
	  DAHDI immediate=yes option. When the phone is picked up, instead
	  of giving a dialtone it connects directly to the "s" extension.
	  Changes where implemented in chan_iax2.c to directly connect to
	  the "s" extension in the appropriate context when this option is
	  enabled. Examples explaining its use are added to
	  iax2.conf.sample. CHANGES has been updated as well. (closes issue
	  #14266) Reported by: jcovert Patches: chan_iax2.c.patch-trunk
	  uploaded by jcovert (license 551) iax.conf.sample.patch uploaded
	  by jcovert (license 551) Tested by: jcovert, dvossel Review:
	  http://reviewboard.digium.com/r/143/

2009-02-06 19:28 +0000 [r173974-174041]  Joshua Colp <jcolp@digium.com>

	* channels/chan_dahdi.c: Don't subscribe to a mailbox on pseudo
	  channels. It is futile. This solves an issue where duplicated
	  pseudo channels would cause a crash because the first one would
	  unsubscribe and the next one would also try to unsubscribe the
	  same subscription. (closes issue #14322) Reported by: amessina

	* /, channels/chan_sip.c: Merged revisions 173967-173968 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173967 | file | 2009-02-06 13:14:15 -0400 (Fri, 06 Feb 2009) | 4
	  lines Some clients do not put the call-id for replaces at the
	  beginning, so support it being anywhere in the string. (closes
	  issue #14350) Reported by: fhackenberger ........ r173968 | file
	  | 2009-02-06 13:15:01 -0400 (Fri, 06 Feb 2009) | 2 lines Remove a
	  debug message I put in by accident. ........

2009-02-06 16:28 +0000 [r173952]  Matthew Nicholson <mnicholson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 173917 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173917 | mnicholson | 2009-02-06 10:20:23 -0600 (Fri, 06 Feb
	  2009) | 7 lines Limit the addition of the Contact header in SIP
	  responses according to various SIP RFCs. (closes issue #13602)
	  Reported by: hjourdain Tested by: mnicholson ........

2009-02-06 15:59 +0000 [r173902]  Joshua Colp <jcolp@digium.com>

	* main/audiohook.c, apps/app_chanspy.c: Always detach and destroy
	  the whisper and barge audiohooks. Additionally also allow an
	  audiohook to be detached if it has not been attached. (closes
	  issue #14414) Reported by: bluecrow76

2009-02-06 10:55 +0000 [r173848-173858]  Russell Bryant <russell@digium.com>

	* include/asterisk/sched.h, channels/chan_iax2.c, main/sched.c: Add
	  a common implementation of a scheduler context with a dedicated
	  thread. This commit expands the Asterisk scheduler API to include
	  a common implementation of a scheduler context being processed by
	  a dedicated thread. chan_iax2 has been updated to use this new
	  code. Also, as a result, this resolves some race conditions
	  related to the previous chan_iax2 scheduler handling. Related to
	  rev 171452 which resolved the same issues in 1.4. Code from
	  team/russell/sched_thread2 Review:
	  http://reviewboard.digium.com/r/129/

	* main/manager.c: Resolve a memory leak that would occur on an
	  invalid channel given to Action: Status

2009-02-05 23:48 +0000 [r173773-173776]  Mark Michelson <mmichelson@digium.com>

	* configs/extensions.conf.sample: Update extensions.conf.sample to
	  be correct. In trunk, the only necessary change pointed out was
	  that the call to ChanIsAvail uses an option that has been
	  removed. For the 1.6.1 branch, however, it appears that the
	  sample file is badly in need of updating since there are |'s used
	  all over the place there. My tentative plan is just to copy
	  trunk's sample config file to those branches since the info there
	  is most up-to-date and should be correct for use in 1.6.1 Thanks
	  to macli in #asterisk-dev for bringing this up

	* apps/app_voicemail.c: Properly set "seen" and "unseen" flags when
	  moving messages from the new to the old folder when using IMAP
	  for voicemail storage (closes issue #13905) Reported by: jaroth
	  Patches: foldermove_v2.patch uploaded by jaroth (license 50)

2009-02-05 21:00 +0000 [r173697]  Jeff Peeler <jpeeler@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 173696 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r173696 | jpeeler | 2009-02-05 14:47:51 -0600 (Thu, 05
	  Feb 2009) | 12 lines Add new configuration option to make shared
	  IMAP mailboxes function as expected. The new option is
	  "imapvmshareid" which is an ID to tag multiple mailboxes using
	  the same IMAP storage location to function as one mailbox. This
	  allows all messages to be retrieved for any user in the group.
	  The patch alters the 'X-Asterisk-VM-Extension' header that is
	  responsible for matching voicemails for a given user. (closes
	  issue #13673) Reported by: howardwilkinson ........

2009-02-05 20:30 +0000 [r173693]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 173692 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173692 | mmichelson | 2009-02-05 14:29:09 -0600 (Thu, 05 Feb
	  2009) | 12 lines Fix situations where queue members could be
	  autopaused unexpectedly Specifically, this patch prevents us from
	  autopausing members when we receive a busy or congestion frame
	  from them. (closes issue #14376) Reported by: fiddur Patches:
	  14376.patch uploaded by putnopvut (license 60) Tested by: fiddur
	  ........

2009-02-05 19:36 +0000 [r173657]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_sqlite.c: Change the first field, or we don't get
	  the necessary field separation.

2009-02-05 18:48 +0000 [r173507-173593]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_mixmonitor.c: Merged revisions 173592 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r173592 | mmichelson | 2009-02-05 12:47:24 -0600 (Thu,
	  05 Feb 2009) | 3 lines Add some missing cleanup to app_mixmonitor
	  ........

	* /, apps/app_mixmonitor.c: Merged revisions 173559 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r173559 | mmichelson | 2009-02-05 11:34:33 -0600 (Thu,
	  05 Feb 2009) | 25 lines Fix a problem where a channel pointer
	  becomes invalid due to masquerading or hanging up. app_mixmonitor
	  runs its own thread to monitor the channel's activity and write
	  the mixed audio to a file. Since this thread runs independently
	  of the channel, it is possible that the mixmonitor thread's
	  channel pointer will point to freed memory when the channel
	  either is masqueraded or hangs up (technically, both cases are
	  hangups, but we need to handle the cases slightly differently).
	  The solution for this is to employ a datastore, which has the
	  nice benefit of allowing us to hook into channel masquerades and
	  hangups and update our pointer as necessary. If this looks
	  familiar, this same technique is employed in app_chanspy.
	  app_chanspy is a bit more involved since it does a lot more
	  operations on the channel that is being spied upon.
	  app_mixmonitor does have an extra touch that app_chanspy doesn't
	  have, though. Since there is a thread race between the channel's
	  thread and the mixmonitor thread on a hangup, we em- ploy a
	  condition-and-boolean combination to ensure that the channel
	  thread finishes with our structure before the mixmonitor thread
	  attempts to free it. No crashes! (closes issue #14374) Reported
	  by: aragon Patches: 14374.patch uploaded by putnopvut (license
	  60) Tested by: aragon, putnopvut ........

	* apps/app_queue.c: Fix some areas where the incorrect interface
	  was passed to ast_device_state I swear it feels like I already
	  did this once... (closes issue #14359) Reported by: francesco_r

2009-02-04 21:26 +0000 [r173503]  Tilghman Lesher <tlesher@digium.com>

	* res/res_jabber.c: Add XML documentation for the applications and
	  functions in res_jabber (closes issue #14405) Reported by: snuffy
	  Patches: xml_jabber.diff uploaded by snuffy (license 35)

2009-02-04 21:25 +0000 [r173502]  David Vossel <dvossel@digium.com>

	* channels/iax2-parser.h, channels/chan_iax2.c: Fixes issue with
	  IAX2 transfer not handing off calls. Reverts changes in 116884
	  Fixes issue with IAX2 transfers not taking place. As it was, a
	  call that was being transfered would never be handed off
	  correctly to the call ends because of how call numbers were
	  stored in a hash table. The hash table, "iax_peercallno_pvt",
	  storing all the current call numbers did not take into account
	  the complications associated with transferring a call, so a
	  separate hash table was required. This second hash table
	  "iax_transfercallno_pvt" handles calls being transfered, once the
	  call transfer is complete the call is removed from the transfer
	  hash table and added to the peer hash table resuming normal
	  operations. Addition functions were created to handle storing,
	  removing, and comparing items in the iax_transfercallno_pvt
	  table. The changes reverted in 116884 caused backwards
	  compatibility issues involving iax2 transfer with 1.6.0, 1.4, and
	  1.2. (closes issue #13468) Reported by: nicox Tested by: dvossel

2009-02-04 21:17 +0000 [r173500]  Jeff Peeler <jpeeler@digium.com>

	* /, main/features.c, include/asterisk/features.h: Merged revisions
	  173211 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173211 | jpeeler | 2009-02-03 15:57:01 -0600 (Tue, 03 Feb 2009)
	  | 17 lines Parking attempts made to one end of a bridge no longer
	  will hang up due to a parking failure. Parking attempts made
	  using either one-touch, or doing either a blind or assisted
	  transfer to the parking extension now keep up the bridge instead
	  of hanging up the attempted parked party. Normal causes for the
	  parking attempt to fail includes the specific specified extension
	  (via PARKINGEXTEN) not being available or if all the parking
	  spaces are currently in use. To avoid having to reverse a
	  masquerade park_space_reserve was made to provide foresight if a
	  parking attempt will succeed and if so reserve the parking space.
	  (closes issue #13494) Reported by: mdu113 Reviewed by Russell:
	  http://reviewboard.digium.com/r/133/ ........

2009-02-04 18:48 +0000 [r173458]  Tilghman Lesher <tlesher@digium.com>

	* main/tcptls.c: When using a socket as a FILE *, the stdio
	  functions will sometimes try to do an fseek() on the stream,
	  which is an invalid operation for a socket. Turning off buffering
	  explicitly lets the stdio functions know they cannot do this,
	  thus avoiding a potential error. (closes issue #14400) Reported
	  by: fnordian Patches: tcptls.patch uploaded by fnordian (license
	  110)

2009-02-04 17:45 +0000 [r173354-173397]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 173396 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173396 | mmichelson | 2009-02-04 11:44:48 -0600 (Wed, 04 Feb
	  2009) | 3 lines Revert my previous change because it was stupid
	  ........

	* /, apps/app_chanspy.c: Merged revisions 173392 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173392 | mmichelson | 2009-02-04 11:40:29 -0600 (Wed, 04 Feb
	  2009) | 3 lines Add a missing unlock. Extremely unlikely to ever
	  matter, but it's needed. ........

	* main/file.c: Fix a problem where file playback would cause fds to
	  remain open forever The problem came from the fact that a frame
	  read from a format interpreter was not freed. Adding a call to
	  ast_frfree fixed this. The explanation for why this caused the
	  problem is a bit complex, but here goes: There was a problem in
	  all versions of Asterisk where the embedded frame of a filestream
	  structure was referenced after the filestream was freed. This was
	  fixed by adding reference counting to the filestream structure.
	  The refcount would increase every time that a filestream's frame
	  pointer was pointing to an actual frame of data. When the frame
	  was freed, the refcount would decrease. Once the refcount reached
	  0, the filestream was freed, and as part of the operation, the
	  open files were closed as well. Thus it becomes more clear why a
	  missing ast_frfree would cause a reference leak and cause the
	  files to not be closed. You may ask then if there was a frame
	  leak before this patch. The answer to that is actually no! The
	  filestream code was "smart" enough to know that since the frame
	  we received came from a format interpreter, the frame had no
	  malloced data and thus didn't need to be freed. Now, however,
	  there is cleanup that needs to be done when we finish with the
	  frame, so we do need to call ast_frfree on the frame to be sure
	  that the refcount for the filestream is decremented
	  appropriately. (closes issue #14384) Reported by: fiddur Patches:
	  14384.patch uploaded by putnopvut (license 60) Tested by: fiddur,
	  putnopvut

2009-02-04 00:43 +0000 [r173311]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, pbx/pbx_config.c: Ensure that commas placed in the
	  middle of extension character classes do not interfere with
	  correct parsing of the extension. Also, if an unterminated
	  character class DOES make its way into the pbx core (through some
	  other method), ensure that it does not crash Asterisk. (closes
	  issue #14362) Reported by: Nick_Lewis Patches:
	  20090129__bug14362.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: Corydon76

2009-02-03 17:35 +0000 [r173169]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c: Broke up the large conditional blocks so
	  it is easy to see if a function is compiled.

2009-02-03 00:29 +0000 [r173104-173130]  Tilghman Lesher <tlesher@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  main/xml.c, include/asterisk/compiler.h, apps/app_stack.c,
	  include/asterisk/optional_api.h: 1. Make OS X compile cleanly
	  with app_stack. 2. Use curl to download sound files, as curl is
	  installed natively on OS X, whereas wget and fetch are not.
	  (closes issue #14332) Reported by: oej Tested by: Corydon76

	* /, configs/extensions.conf.sample: Merged revisions 173070 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173070 | tilghman | 2009-02-02 18:15:59 -0600 (Mon, 02 Feb 2009)
	  | 5 lines Add warning to standard config, that globals may be
	  overridden by other dialplan configuration files. (closes issue
	  #14388) Reported by: macli ........

2009-02-02 23:57 +0000 [r173067]  Terry Wilson <twilson@digium.com>

	* /, main/features.c: Merged revisions 173066 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r173066 | twilson | 2009-02-02 17:48:06 -0600 (Mon, 02 Feb 2009)
	  | 2 lines Fix a feature inheritance bug I added after code review
	  ........

2009-02-02 23:21 +0000 [r173028-173047]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c, CHANGES: Reverting commit number 173028 as there
	  are some potential issues

	* main/manager.c, CHANGES: Add a CLI command to log out a manager
	  user (closes issue #13877) Reported by: eliel Patches:
	  cli_manager_logout.patch.txt uploaded by eliel (license 64)
	  Tested by: eliel, putnopvut

2009-02-02 20:40 +0000 [r172963]  Richard Mudgett <rmudgett@digium.com>

	* /: Recorded merge of revisions 172962 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r172962 | rmudgett | 2009-02-02 14:28:54 -0600 (Mon, 02 Feb 2009)
	  | 11 lines channels/chan_dahdi.c * Added doxygen comments to the
	  major dahdi structures. * Fixed PRI using an incorrect string
	  value if the extension delimiter is not present in the Dial()
	  function. * Fixed some uninitialized string variables on FXS
	  ports. configs/chan_dahdi.conf.sample * Updated some
	  documentation. These changes are already in trunk -r172400
	  ........

2009-02-02 19:02 +0000 [r172929]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, main/features.c, CHANGES,
	  include/asterisk/features.h: This reverts the changes I made for
	  11583; will reviewboard this before committing again... reopened
	  11583 until all Russell's issues are resolved.

2009-02-02 18:13 +0000 [r172894]  Leif Madsen <lmadsen@digium.com>

	* configs/res_ldap.conf.sample: Update the res_ldap.conf file with
	  a better working example. (closes issue #13861) Reported by:
	  scramatte Patches: __20080110-res_ldap.conf-2.patch uploaded by
	  blitzrage (license 10) Tested by: jcovert

2009-02-02 17:37 +0000 [r172890]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, main/features.c, CHANGES,
	  include/asterisk/features.h: This change allows the disconnect
	  feature (as in "one-touch" in features.c) to be used within the
	  dial app, before a call is bridged. Many thanks to sobomax for
	  submitting this patch. Quoting from bug 11582: "So the goal of
	  the patch was to use the user configured feature code during the
	  call setup phase. The original ast_feature_interpret() function
	  is not well suited for this purpose as it uses much call bridge
	  specific data and doesn't separate a detection of feature from a
	  feature handler call. So a new function ast_feature_detect() has
	  been extracted off the ast_feature_interpret() function but
	  keeping the original logic intact except some insignificant
	  changes to locking. "Having created the ast_feature_detect()
	  function the possibility to use feature detection in almost any
	  place of the asterisk code. So a call to this function has been
	  added to wait_for_answer() function of app_dial.so module. This
	  code doesn't call the feature handler however and uses old call
	  leg disconnect logic to make the changes as small and simple as
	  possible to prevent unexpected problems. A disconnect feature
	  currently is the only one supported during call setup as other
	  features as call parking and call transfer don't make much sense
	  during call setup. However if need in some of the features would
	  arise it is much easier to implement as the infrastructure
	  changes are already in place with this patch." I have cleaned up
	  the patch somewhat, and verified that the existing functionality
	  is not harmed, and that the new functionality works. Terry has
	  committed his stuff, and there were no conflicts (see 14274).
	  (closes issue #11583) Reported by: sobomax Patches:
	  patch-apps__app_dial.c uploaded by sobomax (license 359)
	  patch-include__asterisk__features.h uploaded by sobomax (license
	  359) patch-res__res_features.c uploaded by sobomax (license 359)
	  enable-features-during-call-setup.diff uploaded by sobomax
	  (license 359) 11583.newdiff uploaded by murf (license 17)
	  enable-features-during-call-setup-1.diff uploaded by sobomax
	  (license 359) 11583.latest-patch uploaded by murf (license 17)
	  Tested by: sobomax, murf

2009-02-02 16:42 +0000 [r172855]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Fix a spelling mistake.

2009-02-02 10:46 +0000 [r172816-172818]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Add a todo. I do need to really check what's
	  going on with this kill-the-user business ;-) Why do we suddenly
	  have two flags to set peer type?

	* channels/chan_sip.c: Small formatting change

	* channels/chan_sip.c: Add some well-needed improvements to the
	  wishlist in the code, so that we can close some bug reports.

2009-02-02 01:41 +0000 [r172778]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_sip.c: The CID lookup feature wasn't actually
	  working properly with dialog-info+xml supporting devices. The
	  devices (snoms, specifically) need to receive a SIP URI instead
	  of just an extension. This adds that functionality.

2009-02-01 02:44 +0000 [r172706-172741]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c: Blank argument crashes Asterisk (closes
	  issue #14377) Reported by: amorsen

	* funcs/func_strings.c: Don't increment the loop, now that
	  incrementing is taken care of by the decoder function. (closes
	  issue #14363) Reported by: andrew53 Patches:
	  func_strings_filter.patch uploaded by andrew53 (license 519)

2009-01-30 22:22 +0000 [r172598]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/channel.h: Fix redefinition of flag in channel.h

2009-01-30 21:50 +0000 [r172580-172581]  Terry Wilson <twilson@digium.com>

	* configs/features.conf.sample: Remove incorrect line from sample
	  config

	* apps/app_dial.c, main/global_datastores.c, main/features.c,
	  include/asterisk/global_datastores.h, CHANGES,
	  configs/features.conf.sample: Merged revisions 172517 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r172517 | twilson | 2009-01-30 11:47:41 -0600 (Fri, 30 Jan 2009)
	  | 37 lines Fix feature inheritance with builtin features When
	  using builtin features like parking and transfers, the
	  AST_FEATURE_* flags would not be set correctly for all instances
	  when either performing a builtin attended transfer, or parking a
	  call and getting the timeout callback. Also, there was no way on
	  a per-call basis to specify what features someone should have on
	  picking up a parked call (since that doesn't involve the Dial()
	  command). There was a global option for setting whether or not
	  all users who pickup a parked call should have
	  AST_FEATURE_REDIRECT set, but nothing for DISCONNECT, AUTOMON, or
	  PARKCALL. This patch: 1) adds the BRIDGE_FEATURES dialplan
	  variable which can be set either in the dialplan or with setvar
	  in channels that support it. This variable can be set to any
	  combination of 't', 'k', 'w', and 'h' (case insensitive matching
	  of the equivalent dial options), to set what features should be
	  activated on this channel. The patch moves the setting of the
	  features datastores into the bridging code instead of app_dial to
	  help facilitate this. 2) adds global options parkedcallparking,
	  parkedcallhangup, and parkedcallrecording to be similar to the
	  parkedcalltransfers option for globally setting features. 3) has
	  builtin_atxfer call builtin_parkcall if being transfered to the
	  parking extension since tracking everything through multiple
	  masquerades, etc. is difficult and error-prone 4) attempts to fix
	  all cases of return calls from parking and completed builtin
	  transfers not having the correct permissions (closes issue
	  #14274) Reported by: aragon Patches:
	  fix_feature_inheritence.diff.txt uploaded by otherwiseguy
	  (license 396) Tested by: aragon, otherwiseguy Review
	  http://reviewboard.digium.com/r/138/ ........

2009-01-30 18:36 +0000 [r172441-172548]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_aes.c: Parameter position reversed in documentation

	* /, autoconf/ast_func_fork.m4, configure, main/app.c,
	  apps/app_rpt.c, main/asterisk.c: Merged revisions 172438 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r172438 | tilghman | 2009-01-29 16:54:29 -0600 (Thu, 29 Jan 2009)
	  | 9 lines Lose the CAP_NET_ADMIN at every fork, instead of at
	  startup. Otherwise, if Asterisk runs as a non-root user and the
	  administrator does a 'restart now', Asterisk loses the ability to
	  set QOS on packets. (closes issue #14004) Reported by: nemo
	  Patches: 20090105__bug14004.diff.txt uploaded by Corydon76
	  (license 14) Tested by: Corydon76 ........

2009-01-29 23:15 +0000 [r172370-172440]  Richard Mudgett <rmudgett@digium.com>

	* main/cli.c: Remove tabs from comment

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample:
	  channels/chan_dahdi.c * Added doxygen comments to the major dahdi
	  structures. * Fixed PRI and SS7 using an incorrect string value
	  if the extension delimiter is not present in the Dial() function.
	  * Fixed SS7 not checking if the dialed extension is at least as
	  long as the stripmsd option. * Fixed PRI not handling unknown
	  TON/NPI prefix letters correctly. * Fixed some uninitialized
	  string variables on FXS ports. configs/chan_dahdi.conf.sample *
	  Updated some documentation.

	* include/asterisk/say.h: Fixed some doxygen comments

2009-01-29 17:10 +0000 [r172318-172319]  Olle Johansson <oej@edvina.net>

	* channels/chan_local.c: Revert two lines that was extra, but only
	  on fridays.

	* apps/app_dial.c, channels/chan_local.c, channels/chan_sip.c,
	  include/asterisk/causes.h, apps/app_queue.c: Fix "cancel answered
	  elsewhere" through app_queue with members in chan_local. Also,
	  implement a private cause code (as suggested by Tilghman). This
	  works with chan_sip, but doesn't propagate through chan_local.

2009-01-29 16:48 +0000 [r172315]  Tilghman Lesher <tlesher@digium.com>

	* configs/func_odbc.conf.sample: Better document mode=multirow,
	  based upon a conversation with Jared.

2009-01-29 13:47 +0000 [r172271]  Leif Madsen <lmadsen@digium.com>

	* contrib/scripts/realtime_pgsql.sql: The realtime_pgsql.sql script
	  is missing a couple of fields. closes issue #14339) Reported by:
	  fiddur Patches: realtime_pgsql.sql.diff uploaded by fiddur
	  (license 678)

2009-01-29 13:24 +0000 [r172173-172270]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample, CHANGES: Update documentation

	* include/asterisk/app.h, channels/chan_sip.c, main/app.c: - Make
	  sure we set setvar= variables on outbound calls too, not only
	  inbound calls. - Also, change a function in app.c to return a
	  userful value instead of always returning 0. Patch by fnordian,
	  changed by Corydon76 and myself. This does not close the bug
	  report, as fnordian had an additional change we're still
	  discussing. (related to issue #14059) Reported by: fnordian
	  Patches: chan_sip_hfield.patch uploaded by fnordian (license 110)
	  20090116__bug14059.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: fnordian, Corydon76, oej

	* channels/chan_sip.c: Make sure register= line supports both port
	  and expiry at the same time. (closes issue #14185) Reported by:
	  Nick_Lewis Patches: chan_sip.c-expiryrequest6.patch uploaded by
	  Nick (license 657) Tested by: Nick_Lewis

	* /, channels/chan_sip.c: Merged revisions 172169 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r172169 | oej | 2009-01-29 09:48:18 +0100 (Tor, 29 Jan 2009) | 16
	  lines Make sure that we always add the hangupcause headers. In
	  some cases, the owner was disconnected before we checked for the
	  cause. This patch implements a temporary storage in the pvt and
	  use that instead. The code is based on ideas from code from
	  Adomjan in issue #13385 (Add support for Reason: header) Thanks
	  to Klaus Darillion for testing! (closes issue #14294) related to
	  issue #13385 Reported by: klaus3000 and adomjan Patches:
	  bug14294b.diff uploaded by oej (license 306) Based on
	  20080829_chan_sip.c-q850reason_header.patch uploaded by adomjan
	  (license 487) Tested by: oej, klaus3000 ........

2009-01-28 22:52 +0000 [r172132]  Steve Murphy <murf@digium.com>

	* channels/chan_misdn.c: A further correction: cast the sizeof to
	  an int.

2009-01-28 22:48 +0000 [r172131]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_odbc.c: Fix how we skip fields (to avoid fields
	  which don't exist) when doing an UPDATE. (closes issue #14205)
	  Reported by: maxgo Patches: 20090128__bug14205__5.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: blitzrage

2009-01-28 21:48 +0000 [r172063-172099]  Steve Murphy <murf@digium.com>

	* channels/chan_misdn.c: my gcc (Ubuntu 4.3.2-1ubuntu11) 4.3.2
	  didn't like the \%ld and issued a warning, breaking my dev-mode
	  build. This fixes it.

	* apps/app_channelredirect.c, main/pbx.c, main/manager.c, /,
	  main/features.c, include/asterisk/channel.h: Merged revisions
	  172030 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r172030 | murf | 2009-01-28 11:51:16 -0700 (Wed, 28 Jan 2009) |
	  46 lines This patch fixes h-exten running misbehavior in
	  manager-redirected situations. What it does: 1. A new Flag value
	  is defined in include/asterisk/channel.h,
	  AST_FLAG_BRIDGE_HANGUP_DONT, which used as a messenge to the
	  bridge hangup exten code not to run the h-exten there (nor
	  publish the bridge cdr there). It will done at the pbx-loop level
	  instead. 2. In the manager Redirect code, I set this flag on the
	  channel if the channel has a non-null pbx pointer. I did the same
	  for the second (chan2) channel, which gets run if name2 is set...
	  and the first succeeds. 3. I restored the ending of the cdr for
	  the pbx loop h-exten running code. Don't know why it was removed
	  in the first place. 4. The first attempt at the fix for this bug
	  was to place code directly in the async_goto routine, which was
	  called from a large number of places, and could affect a large
	  number of cases, so I tested that fix against a fair number of
	  transfer scenarios, both with and without the patch. In the
	  process, I saw that putting the fix in async_goto seemed not to
	  affect any of the blind or attended scenarios, but still, I was
	  was highly concerned that some other scenarios I had not tested
	  might be negatively impacted, so I refined the patch to its
	  current scope, and jmls tested both. In the process, tho, I saw
	  that blind xfers in one situation, when the one-touch blind-xfer
	  feature is used by the peer, we got strange h-exten behavior. So,
	  I inserted code to swap CDRs and to set the HANGUP_DONT field, to
	  get uniform behavior. 5. I added code to the bridge to obey the
	  HANGUP_DONT flag, skipping both publishing the bridge CDR, and
	  running the h-exten; they will be done at the pbx-loop (higher)
	  level instead. 6. I removed all the debug logs from the patch
	  before committing. 7. I moved the AUTOLOOP set/reset in the
	  h-exten code in res_features so it's only done if the h-exten is
	  going to be run. A very minor performance improvement, but
	  technically correct. (closes issue #14241) Reported by: jmls
	  Patches: 14241_redirect_no_bridgeCDR_or_h_exten_via_transfer
	  uploaded by murf (license 17) Tested by: murf, jmls ........

2009-01-28 17:27 +0000 [r171964]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 171963 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r171963 | tilghman | 2009-01-28 11:25:18 -0600 (Wed, 28
	  Jan 2009) | 2 lines Clarify log message (suggested by manxpower
	  on #asterisk-dev) ........

2009-01-28 14:39 +0000 [r171838-171925]  Olle Johansson <oej@edvina.net>

	* CHANGES: Yep. Documentation is important.

	* apps/app_queue.c: Add final part of previously committed work for
	  answered elsewhere in queue - the missing piece that started with
	  app_dial() earlier on. This is to avoid having the list and
	  counter of missed calls being touched by queue calls. Add the C
	  option to queue() and nothing will be logged on phones that
	  support the Reason: header on SIP cancel, like the SNOM phones.

	* configs/sip.conf.sample: Add some more notes about device
	  matching.

	* /, configs/sip.conf.sample: Merged revisions 171837 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r171837 | oej | 2009-01-28 14:07:27 +0100 (Ons, 28 Jan
	  2009) | 2 lines Add a better explanation of the difference
	  between the device namespace and the dialplan for newbies.
	  ........

2009-01-28 00:17 +0000 [r171797]  Mark Michelson <mmichelson@digium.com>

	* funcs/func_aes.c: Fix some signedness problems in func_aes.c

2009-01-27 23:28 +0000 [r171793]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Don't complain about lack of D-channels on
	  PTMP connections

2009-01-27 22:43 +0000 [r171757]  David Vossel <dvossel@digium.com>

	* funcs/func_aes.c (added), CHANGES: Adding AES_ENCRYPT and
	  AES_DECRYPT dialplan functions. (closes issue #14301) Reported
	  by: amorsen review: http://reviewboard.digium.com/r/128/

2009-01-27 21:58 +0000 [r171618-171691]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_agent.c: Merged revisions 171689 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r171689 | mmichelson | 2009-01-27 15:55:08 -0600 (Tue, 27 Jan
	  2009) | 39 lines Fix devicestate problems for "always-on" agent
	  channels A revision to chan_agent attempted to "inherit" the
	  device state of the underlying channel in order to report the
	  device state of an agent channel more accurately. The problem
	  with the logic here is that it makes no sense to use this for
	  always-on agents. If the agent is logged in, then to the
	  underlying channel, the agent will always appear to be "in use,"
	  no matter if the agent is on a call or not. The reason is that to
	  the underlying channel, the channel is currently in use on a call
	  to the AgentLogin application. The most common cause that I found
	  for this issue to occur was for a SIP channel to be the
	  underlying channel type for an Agent channel. If the SIP phone
	  re-registers, then the registration will cause the device state
	  core to query the device state of the SIP channel. Since the SIP
	  channel is in use, the Agent channel would also inherit this
	  status. Once the agent channel was set to "in use" there was no
	  way that the device state could change on that channel unless the
	  agent logged out. The solution for this problem is a bit
	  different in 1.4 than it is in the other branches. In 1.4, there
	  will be a one-line fix to make sure that only callback agents
	  will inherit device state from their underlying channel type. For
	  the other branches of Asterisk, since callback support has been
	  removed, there is also no need for device state inheritance in
	  chan_agent, so I will simply be removing it from the code. In
	  addition, the 1.4 source is getting a new comment to help the
	  next person who edits chan_agent.c. I'm adding a comment that a
	  agent_pvt's loginchan field may be used to determine if the agent
	  is a callback agent or not. (closes issue #14173) Reported by:
	  nathan Patches: 14173.patch uploaded by putnopvut (license 60)
	  Tested by: nathan, aramirez ........

	* /, main/slinfactory.c: Merged revisions 171621 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r171621 | mmichelson | 2009-01-27 14:06:01 -0600 (Tue, 27 Jan
	  2009) | 18 lines Prevent a crash from occurring when a jitter
	  buffer interpolated frame is removed from a slinfactory
	  slinfactory used the "samples" field of an ast_frame in order to
	  determine the amount of data contained within the frame. In
	  certain cases, such as jitter buffer interpolated frames, the
	  frame would have a non-zero value for "samples" but have NULL
	  "data" This caused a problem when a memcpy call in
	  ast_slinfactory_read would attempt to access invalid memory. The
	  solution in use here is to never feed frames into the slinfactory
	  if they have NULL "data" (closes issue #13116) Reported by:
	  aragon Patches: 13116.diff uploaded by putnopvut (license 60)
	  ........

	* apps/app_queue.c: Fix queue crashes that would occur after the
	  calling channel was masqueraded. The data passed to the
	  end_bridge_callback was assumed to be data which was still
	  stack'd. The problem was that with some call features, attended
	  transfers in particular, a new bridge thread is started once the
	  feature completes, meaning that when the end_bridge_callback is
	  called, the end_bridge_callback_data was invalid. To fix this
	  problem, there are two measures taken 1. Instead of pointing to
	  stacked data, we now used heap-allocated data for passing to the
	  end_bridge_callback in app_queue 2. Since bridges can end
	  multiple times on a single logical call, we wait until the final
	  bridge is broken to actually set any queue variables. This is
	  accomplished through reference-counting and the use of an
	  end_bridge_callback_data_fixup function in app_queue.c (closes
	  issue #14260) Reported by: ccesario Patches: 14260.patch uploaded
	  by putnopvut (license 60) Tested by: ccesario

2009-01-27 15:23 +0000 [r171558]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c: Handle new VMWI ioctl structure (Now there
	  are two VMWI ioctl calls.) (issue #14104) Reported by: alecdavis
	  Tested by: dbailey

2009-01-27 15:00 +0000 [r171263-171528]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Solving the same issue, but a bit
	  different in trunk... Merged revisions 171527 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r171527 | oej | 2009-01-27 15:33:20 +0100 (Tis, 27 Jan 2009) | 13
	  lines Use the same branch tag in CANCEL as in INVITE Originally
	  putnopvut implemented some changes in revision 142079 that
	  according to the bug report seemed to have worked then, but
	  somehow fails now. I guess code, as humans, get old and forget
	  stuff. Anyway, this bug caused CANCEL not to work with picky
	  systems. Thanks Fredrik for pointing out where the bug in the SIP
	  messaging was. (closes issue #14346) Reported by: oej Patches:
	  bug14346.diff uploaded by oej (license 306) Tested by: oej
	  ........

	* channels/chan_sip.c: Moving generic setting to friends

	* channels/chan_sip.c: Continue to move variables into the sip_cfg
	  structure to make them easier to handle in the future as a group
	  of settings for a group of devices. At some point, I want one
	  sip_cfg per domain handled, so we can have "group" settings.

	* channels/chan_sip.c: Just moving around variable declarations so
	  that we have all globals in the same place. Default setting is
	  set before we activate the channel or at reloads, not where we
	  declare the variable.

	* /, channels/chan_sip.c: Merged revisions 171264 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r171264 | oej | 2009-01-26 13:51:53 +0100 (MÃ¥n, 26 Jan 2009) | 9
	  lines Don't retransmit 401 on REGISTER requests when
	  alwaysauthreject=yes (closes issue #14284) Reported by: klaus3000
	  Patches: patch_chan_sip_unreliable_1.4.23_14284.txt uploaded by
	  klaus3000 (license 65) Tested by: klaus3000 ........

	* main/channel.c: Add extensions and context on manager event when
	  new channel is created.

2009-01-25 23:58 +0000 [r171188]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_oss.c: Merged revisions 171187 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r171187 | tilghman | 2009-01-25 17:44:01 -0600 (Sun, 25 Jan 2009)
	  | 6 lines Correctly track the hookstate (closes issue #13686)
	  Reported by: itiliti Patches: 20081013__bug13686.diff.txt
	  uploaded by Corydon76 (license 14) ........

2009-01-25 16:50 +0000 [r171043-171081]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: dont segfault when a MWI event occurs on
	  a line without a registered device

	* configs/skinny.conf.sample: Make the sample skinny.conf work
	  (closes issue #14325) Reported by: DEA Patches:
	  skinny.conf.sample-trunk.txt uploaded by DEA (license 3)

2009-01-25 13:35 +0000 [r170980]  Sean Bright <sean.bright@gmail.com>

	* /, apps/app_page.c: Merged revisions 170979 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170979 | seanbright | 2009-01-25 08:33:20 -0500 (Sun, 25 Jan
	  2009) | 9 lines Resolve a logic error that was causing Page() to
	  crash when more than one channel was specified. (closes issue
	  #14308) Reported by: bluefox Patches: 20090124__bug14308.diff.txt
	  uploaded by seanbright (license 71) Tested by: kc0bvu ........

2009-01-25 02:49 +0000 [r170902-170943]  Russell Bryant <russell@digium.com>

	* include/asterisk/utils.h: Change ARRAY_LEN() to be more C++ safe.
	  When the second part of this macro is written as 0[a] instead of
	  a[0], it will force a failure if the macro is used on a C++
	  object that overloads the [] operator.

	* res/res_agi.c: Add a todo to finish the XML docs in this module

2009-01-24 13:55 +0000 [r170837]  Tilghman Lesher <tlesher@digium.com>

	* /, configs/res_odbc.conf.sample: Merged revisions 170836 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170836 | tilghman | 2009-01-24 07:55:02 -0600 (Sat, 24 Jan 2009)
	  | 2 lines Remove superfluous implementation note (closes issue
	  #14319) ........

2009-01-23 23:10 +0000 [r170794]  Richard Mudgett <rmudgett@digium.com>

	* doc/tex/Makefile: Fix asterisk.pdf generation if branch name has
	  an underscore in it.

2009-01-23 22:58 +0000 [r170790]  Russell Bryant <russell@digium.com>

	* doc/tex/Makefile: Don't blow up if a branch name has an
	  underscore in it

2009-01-23 20:56 +0000 [r170677-170720]  Mark Michelson <mmichelson@digium.com>

	* /, configs/res_odbc.conf.sample: Merged revisions 170719 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170719 | mmichelson | 2009-01-23 14:55:26 -0600 (Fri, 23 Jan
	  2009) | 8 lines Add notes to the idlecheck explanation in
	  res_odbc.conf.sample (closes issue #14319) Reported by: klaus3000
	  Patches: patch_idlecheck_res_odbc.conf.sample.txt uploaded by
	  klaus3000 (license 65) ........

	* /, contrib/i18n.testsuite.conf: Merged revisions 170671 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170671 | mmichelson | 2009-01-23 14:21:51 -0600 (Fri, 23 Jan
	  2009) | 14 lines Update contrib/i18n.testsuite.conf to not use
	  deprecated syntax * Convert Wait,1 to Wait(1) * Convert
	  SetLanguage to Set(CHANNEL(language)) * Use 'n' for all
	  priorities beyond the first Also added test for Chinese numbers,
	  too. (closes issue #14320) Reported by: dant Patches:
	  i18n.testsuite.conf.issue14320.v2.diff uploaded by dant (license
	  670) ........

2009-01-23 20:18 +0000 [r170652]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /: Merged revisions 170648 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170648 | file | 2009-01-23 16:16:39 -0400 (Fri, 23 Jan 2009) | 4
	  lines When a channel is answered make sure any indications
	  currently playing stop. Usually the phone would do this but if
	  the channel was already answered then they are being generated by
	  Asterisk and we darn well need to stop them. (closes issue
	  #14249) Reported by: RadicAlish ........

2009-01-23 19:25 +0000 [r170608]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 170588 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r170588 | tilghman | 2009-01-23 13:20:44 -0600 (Fri, 23
	  Jan 2009) | 2 lines Additions to AST-2009-001 ........

2009-01-23 19:09 +0000 [r170505-170569]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 170568 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170568 | file | 2009-01-23 15:06:54 -0400 (Fri, 23 Jan 2009) | 4
	  lines When a call is forwarded stop any active indications. The
	  new channel will provide an indication, if need be, itself.
	  (closes issue #14310) Reported by: RadicAlish ........

	* /, channels/chan_sip.c: Merged revisions 170504 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170504 | file | 2009-01-23 14:04:08 -0400 (Fri, 23 Jan 2009) | 4
	  lines Use the on hold flag to see if the call is on hold or not.
	  It is possible that our address for them will still be valid even
	  though they are on hold. (closes issue #14295) Reported by:
	  klaus3000 ........

2009-01-23 17:46 +0000 [r170501]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_h323.c: let's use SENTINEL where needed

2009-01-23 17:32 +0000 [r170498]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Reset the ast_str used for escape
	  substitution. We need to do this since it is a thread local
	  variable that may contain the value of a previous substitution.
	  (closes issue #14312) Reported by: pj

2009-01-23 17:03 +0000 [r170463]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: We should not do restart messages if we're
	  in PTMP mode

2009-01-23 16:57 +0000 [r170460]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: Dont clear the display of skinny phones
	  when not needed. (closes issue #13182) Reported by: pj Patches:
	  2009011901_dontcleardisplay.diff.txt uploaded by mvanbaak
	  (license 7) Tested by: mvanbaak, pj

2009-01-23 16:35 +0000 [r170457]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c: MWI messages included in CID spill was not
	  being properly handled and prevented the call from being
	  processed (issue #14313) Reported by: seandarcy Tested by:
	  dbailey

2009-01-23 15:44 +0000 [r170393]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /: Merged revisions 170392 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170392 | mmichelson | 2009-01-23 09:40:39 -0600 (Fri, 23 Jan
	  2009) | 28 lines Fix broken call pickup There was a subtle change
	  in ast_do_masquerade which resulted in failed attempts to pickup
	  calls. The problem was that the value of the AST_FLAG_OUTGOING
	  flag was copied from the clone to the original channel. In the
	  case of call pickup, this meant that the AST_FLAG_OUTGOING flag
	  ended up being cleared on the channel that was attempting to
	  execute the pickup. Because this flag was not set, when ast_read
	  came across an answer frame, it ignored it. The result of this
	  was that the calling channel was never properly answered. This
	  fix changes the behavior in ast_do_masquerade to set the flags on
	  the original channel to the union of the flags on the clone
	  channel. This way, if the AST_FLAG_OUTGOING flag is set on either
	  of the two channels involved in the masquerade, the resulting
	  channel will have the flag set as well. (closes issue #14206)
	  Reported by: francesco_r Patches: 14206.patch uploaded by
	  putnopvut (license 60) Tested by: francesco_r, aragon, putnopvut
	  ........

2009-01-22 23:23 +0000 [r170351]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Make sure we don't set the channel to be
	  inalarm for a D-channel drop on PTMP connections

2009-01-22 21:25 +0000 [r170307]  Tilghman Lesher <tlesher@digium.com>

	* main/abstract_jb.c: Create logfile safely. (closes issue #14160)
	  Reported by: tzafrir Patches: 20090104__bug14160.diff.txt
	  uploaded by Corydon76 (license 14)

2009-01-22 20:04 +0000 [r170240]  Joshua Colp <jcolp@digium.com>

	* /, main/rtp.c: Merged revisions 170239 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170239 | file | 2009-01-22 16:02:35 -0400 (Thu, 22 Jan 2009) | 7
	  lines Don't crash if RTCP is not enabled on an RTP structure but
	  statistics are output. (closes issue #14234) Reported by: jcovert
	  Patches: rtp.c.patch-1.6.0.3 uploaded by jcovert (license 551)
	  rtp.c.patch-svn-165599 uploaded by jcovert (license 551) ........

2009-01-22 17:19 +0000 [r170165]  Tilghman Lesher <tlesher@digium.com>

	* /, pbx/pbx_config.c: Merged revisions 170158 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170158 | tilghman | 2009-01-22 11:18:07 -0600 (Thu, 22 Jan 2009)
	  | 6 lines Allow global variables after substitution to be as long
	  as other variables. (closes issue #14263) Reported by: markd
	  Patches: 20090120__bug14263.diff.txt uploaded by Corydon76
	  (license 14) ........

2009-01-22 16:52 +0000 [r170148]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_meetme.c: Merged revisions 170147 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170147 | file | 2009-01-22 12:50:54 -0400 (Thu, 22 Jan 2009) | 4
	  lines If we are unable to request a DAHDI pseudo channel and we
	  are using the user introduction without review option make sure
	  it gets unset so other code does not blindly assume a DAHDI
	  pseudo channel exists. (closes issue #14282) Reported by:
	  cheesegrits ........

2009-01-22 15:49 +0000 [r170112]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: change VMWI to
	  use new DAHDI_VMWI ioctl call. Change configure script to detect
	  the new ioctl call data structure. (issue #14104) Reported by:
	  alecdavis Patches: mwiioctl_structure_asterisk.diff4.txt uploaded
	  by dbailey (license ) Tested by: alecdavis, dbailey

2009-01-22 15:14 +0000 [r170047-170051]  Joshua Colp <jcolp@digium.com>

	* main/pbx.c, /: Merged revisions 170050 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r170050 | file | 2009-01-22 11:13:56 -0400 (Thu, 22 Jan 2009) | 6
	  lines Do a string comparison instead of pointer comparison since
	  some people specify the context they are actually in as an
	  argument to get around some funkiness. (closes issue #14011)
	  Reported by: dveiga Patches: pbx.c.patch uploaded by dveiga
	  (license 665) ........

	* apps/app_parkandannounce.c: Clear the autoloop flag when parsing
	  and setting the context/extension/priority to go back to. When
	  the channel executes a PBX again we want it to start out at the
	  point we explicitly say and at that point it will not yet be
	  doing autoloop. (closes issue #14304) Reported by: jcovert

2009-01-22 02:10 +0000 [r170007]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c: * Adjust some conditionals to balance
	  curly braces. * Other minor changes.

2009-01-22 00:44 +0000 [r169944]  Tilghman Lesher <tlesher@digium.com>

	* /, include/asterisk/linkedlists.h: Merged revisions 169943 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r169943 | tilghman | 2009-01-21 18:43:31 -0600 (Wed, 21 Jan 2009)
	  | 9 lines AST_RWLOCK_INIT_VALUE is always defined. What we really
	  wanted to ask is whether autoconf detected a static initializer
	  value. This fixes rwlocks on all such platforms (mainly, Mac OS
	  X). (closes issue #13767) Reported by: jcovert Patches:
	  20090121__bug13767.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: jcovert, Corydon76 ........

2009-01-22 00:23 +0000 [r169910]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_dahdi.c: Whitespace changes only

2009-01-21 23:25 +0000 [r169869]  Joshua Colp <jcolp@digium.com>

	* main/pbx.c, /: Merged revisions 169867 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r169867 | file | 2009-01-21 19:20:47 -0400 (Wed, 21 Jan 2009) | 4
	  lines Read lock the contexts to maintain the locking order when
	  we are notified that the state of a device has changed. (closes
	  issue #13839) Reported by: mcallist ........

2009-01-21 23:20 +0000 [r169794-169866]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_dahdi.c: Test commit for test issue #14303

	* main/say.c: Fix a crash when saying certain numbers in Chinese
	  This commit fixes a crash that was occurring when attempting to
	  say a number between 10000 and 100000 due to dividing by 0. This
	  also removes some places where a "zero" is spoken when it should
	  not be. (closes issue #14291) Reported by: dant Patches:
	  say.c-14291.diff uploaded by dant (license 670) Tested by: dant

2009-01-21 22:04 +0000 [r169793]  Michiel van Baak <michiel@vanbaak.info>

	* doc/tex/extensions.tex: remove duplicated sentence.

2009-01-21 21:53 +0000 [r169791]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Further fix some oddities in sip show users
	  and sip show peers logic ccesario on IRC pointed out that his sip
	  peers were not displayed properly when he would issue the command
	  "sip show peers." The problem was that the onlymatchonip field
	  was used to determine if the endpoint was a "peer" or "user." The
	  tricky part is that a "friend" is supposed to be treated as both
	  a "user" and a "peer" but the logic would not allow "friends" to
	  show up as "peers" since onlymatchonip was set to FALSE for
	  friends. I have modified the sip_peer structure to more
	  explicitly keep track of what type endpoint it is so that the
	  various manager and CLI commands will display the expected
	  information Reported by ccesario via IRC Tested by ccesario

2009-01-21 21:03 +0000 [r169723]  Tilghman Lesher <tlesher@digium.com>

	* /, main/asterisk.c: Merged revisions 169722 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r169722 | tilghman | 2009-01-21 15:02:32 -0600 (Wed, 21 Jan 2009)
	  | 8 lines Extra NULLs in the output cause some terminal types to
	  abort in the middle of a color code, causing terminal weirdness.
	  (closes issue #14130) Reported by: coolmig Patches:
	  20090121__bug14130.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: Corydon76, coolmig ........

2009-01-21 17:21 +0000 [r169673]  Steve Murphy <murf@digium.com>

	* utils/refcounter.c: This patch corrects a segfault reported in
	  14289, due to a null ptr being refd. Yes, seanbright is right in
	  the bug comments, that is the fix. Sorry for this oversight; I
	  guess my personal usage didn't have this happen! murf (closes
	  issue #14289) Reported by: jamesgolovich

2009-01-21 10:49 +0000 [r169620-169625]  Russell Bryant <russell@digium.com>

	* /: Remove properties that erroneously got merged into trunk

	* main/tcptls.c: Fix a regression in TCP support. This patch fixes
	  a problem that caused chan_sip to think that every open TCP
	  session was to a remote address of 0.0.0.0:0. (closes issue
	  #14287) Reported by: jamesgolovich Patches: bug-14287.diff.txt
	  uploaded by jamesgolovich (license 176)

2009-01-21 00:33 +0000 [r169557-169611]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix device state parsing issues for channel
	  names with multiple slashes The fix being applied is a bit
	  different for trunk and the 1.6.X branches. For trunk, we only
	  wish to strip off the characters beyond the second slash if the
	  channel is a Local channel (i.e. we are removing the /n from the
	  device name). Other channel technologies with multiple slashes
	  (e.g. DAHDI) need the information after the second slash in order
	  to get the proper device state information. In addition to this
	  fix, the 1.6.X branches are receiving a much more important fix
	  as well. The problem in 1.6.X is that the member's device name
	  was being directly changed instead of having a copy changed. This
	  meant that we would strip off the second slash and trailing
	  characters and then leave the member's device name like that
	  permanently thereafter. (closes issue #14014) Reported by:
	  kebl0155 Patches: 14014_number2.patch uploaded by putnopvut
	  (license 60) Tested by: kebl0155

	* apps/app_queue.c: Use the default timeout for a queue instead of
	  -1 (closes issue #14272) Reported by: timking

	* /, channels/chan_sip.c: Convert the character pointers in a
	  sip_request to be pointer offsets When an ast_str expands to hold
	  more data, any pointers that were pointing to the data prior to
	  the expansion will be pointing at invalid memory. This change
	  makes such pointers used in chan_sip.c instead be offsets from
	  the beginning of the string so that the same math may be applied
	  no matter where in memory the string resides. To help ease this
	  transition, a macro called REQ_OFFSET_TO_STR has been added to
	  chan_sip.c so that given a sip_request and an offset, the string
	  at that offset is returned. (closes issue #14220) Reported by:
	  riksta Tested by: putnopvut Review
	  http://reviewboard.digium.com/r/126/

2009-01-20 19:22 +0000 [r169486-169510]  Terry Wilson <twilson@digium.com>

	* main/features.c: Make a proper builtin attended transfer to
	  parking work This is an ugly hack from 1.4 that allows the
	  timeout callback from a parked call to use the right channel name
	  for the callback when the park is done with a builtin attended
	  transfer (that isn't completed early). This hasn't ever worked in
	  trunk and no one has complained yet, so eh.

	* /, main/features.c: Merged revisions 169485 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r169485 | twilson | 2009-01-20 12:40:56 -0600 (Tue, 20 Jan 2009)
	  | 6 lines Don't play audio to the channel if we've masqueraded
	  (closes issue #14066) Reported by: bluefox Tested by:
	  otherwiseguy, bluefox ........

2009-01-19 21:42 +0000 [r169438]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/res_odbc.h, funcs/func_odbc.c,
	  include/asterisk/strings.h, res/res_odbc.c: ast_str_SQLGetData is
	  *not* part of the ast_str API, it's part of the ast_odbc API and
	  just happens to use an ast_str as the buffer; move all of it to
	  res_odbc.c and res_odbc.h, renaming appropriately along the way
	  fix some minor coding style issues in strings.h and add some
	  attribute_pure annotations to functions in the ast_str API

2009-01-19 20:14 +0000 [r169367-169369]  Michiel van Baak <michiel@vanbaak.info>

	* main/asterisk.c: fix assignment in swapmode plug. Spotted and fix
	  provided by ys (closes issue #14129) Reported by: ys Tested by:
	  ys

	* channels/chan_skinny.c: Redo the event-based MWI in chan_skinny.
	  Dan saw regular segfaults with the old implementation and rewrote
	  it to make it really eventbased. I altered it to be trunk
	  compatible and wedhorn gave some feedback and ideas how to make
	  it even better. (closes issue #13821) Reported by: DEA Patches:
	  chan_skinny-mwi-events.txt uploaded by DEA (license 3) Tested by:
	  mvanbaak, DEA "no probs by me" from wedhorn

2009-01-19 20:05 +0000 [r169365]  Tilghman Lesher <tlesher@digium.com>

	* main/manager.c, /, apps/app_userevent.c: Merged revisions 169364
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r169364 | tilghman | 2009-01-19 13:49:25 -0600 (Mon, 19 Jan 2009)
	  | 4 lines Truncate userevents at the end of a line, when the
	  command exceeds the buffer. (closes issue #14278) Reported by:
	  fnordian ........

2009-01-19 18:36 +0000 [r169327]  Michiel van Baak <michiel@vanbaak.info>

	* main/asterisk.c: Make asterisk compile on non-amd64 versions of
	  OpenBSD. The HW_PHYSMEM64 is only available in latest OpenBSD
	  and/or amd64 versions of OpenBSD. Use HW_PHYSMEM when
	  HW_PHYSMEM64 is not available. (closes issue #14129) Reported by:
	  ys Patches: 2009011600_physmem64.diff.txt uploaded by mvanbaak
	  (license 7) Tested by: mvanbaak, jtodd

2009-01-19 18:22 +0000 [r169277-169325]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c: Get rid of magic number and replace with
	  DAHDI_VMWI_NUMBER_MASK when determining the number of messages
	  pending for MWI call

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample: Add
	  enhanced MWI generation to take advantage of new dahdi line
	  reversal MWI ability. (closes issue #14104) Reported by:
	  alecdavis Patches: asttrunk-14104.diff2.txt uploaded by dbailey
	  (license ) chan_dahdi.rpas_and_fsk.diff.txt uploaded by alecdavis
	  (license 585) Tested by: alecdavis, dbailey

2009-01-19 15:54 +0000 [r169211]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_local.c, /: Merged revisions 169210 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r169210 | mmichelson | 2009-01-19 09:52:15 -0600 (Mon,
	  19 Jan 2009) | 13 lines Prevent a crash in chan_local due to a
	  potential NULL pointer dereference Move the check for if both
	  channels on a local_pvt have generators to below where p->chan is
	  checked for NULLity (NULLness?). This prevents a crash from
	  occurring if p->chan is NULL. (closes issue #14189) Reported by:
	  sascha Patches: 14189.patch uploaded by putnopvut (license 60)
	  Tested by: sascha ........

2009-01-17 18:26 +0000 [r169153]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample: Add
	  discriminator for when ring pulse alert signal is used to preface
	  MWI spills This prevents the situation when MWI messages are
	  added to caller ID spills causing the channel to be hung up

2009-01-17 02:52 +0000 [r169116]  Sean Bright <sean.bright@gmail.com>

	* pbx/pbx_dundi.c: Change intializer types. Found while working on
	  asterisk-cpp. I have a new favorite error message from g++:
	  pbx_dundi.c:4580: sorry, unimplemented: non-trivial designated
	  initializers not supported I like it when compilers are
	  apologetic.

2009-01-17 01:56 +0000 [r169044-169080]  Terry Wilson <twilson@digium.com>

	* main/tcptls.c, main/http.c, include/asterisk/tcptls.h: Fix
	  qualify for TCP peer (closes issue #14192) Reported by:
	  pabelanger Patches: asterisk-bug14192.diff.txt uploaded by
	  jamesgolovich (license 176) Tested by: jamesgolovich

	* channels/chan_sip.c: Fix port :0 added to SIP INVITE URI when
	  outboundproxy used (closes issue #14233) Reported by: chris-mac
	  Patches: asterisk-bug14233.diff.txt uploaded by jamesgolovich
	  (license 176) Tested by: jamesgolovich, chris-mac, otherwiseguy

2009-01-16 22:43 +0000 [r168976]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 168975 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168975 | mmichelson | 2009-01-16 16:42:13 -0600 (Fri, 16 Jan
	  2009) | 18 lines Account for possible NULL pointer when we
	  receive a 408 in response to a REGISTER It may be that by the
	  time we receive a reply to a REGISTER request, the attempt has
	  timed out and thus the registry structure pointed to by the
	  corresponding sip_pvt has gone away. This situation was handled
	  properly for a 200 OK response, but the 408 case assumed that the
	  sip_registry struct was non-NULL, thus potentially causing a
	  crash This commit fixes this assumption and prints out a message
	  to the console if we should receive a late 408 response to a
	  REGISTER (closes issue #14211) Reported by: aborghi Patches:
	  14211.diff uploaded by putnopvut (license 60) Tested by: aborghi
	  ........

2009-01-16 22:16 +0000 [r168941]  Terry Wilson <twilson@digium.com>

	* /, main/features.c: Merged revisions 168716 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168716 | twilson | 2009-01-15 12:22:49 -0600 (Thu, 15 Jan 2009)
	  | 12 lines Convert call to park_call_full to
	  masq_park_call_announce Since we removed the AST_PBX_KEEPALIVE
	  return value, we need to use masqueraded parking, otherwise we
	  will try to call ast_hangup() in __pbx_run() and in
	  do_parking_thread() and then promptly crash. (closes issue
	  #14215) Reported by: waverly360 Tested by: otherwiseguy (closes
	  issue #14228) Reported by: kobaz Tested by: otherwiseguy ........

2009-01-16 19:54 +0000 [r168898]  Mark Michelson <mmichelson@digium.com>

	* res/res_timing_timerfd.c: Fix a logic error that occur when using
	  the timerfd interface This sequence of events posed a problem
	  timerfd_timer_open timerfd_timer_enable_continuous
	  timerfd_timer_set_rate timerfd_timer_disable_continuous The
	  reason was that the timing module was written under the
	  assumption that timerfd_timer_set_rate would not be called
	  between enabling and disabling continuous mode. What happened in
	  this situation was that timerfd_timer_enable_continuous saved off
	  our previously set timer (in this situation a 0 timer, meaning it
	  never runs out). Then timerfd_timer_disable_continuous would
	  restore this 0 timer, even though it logically should set the
	  timer to be whatever was set in timerfd_timer_set_rate. Now the
	  behavior in timerfd_timer_set_rate is to overwrite the saved
	  timer that may or may not have been set in
	  timerfd_timer_enable_continuous. Even if
	  timerfd_timer_enable_continuous has not been previously called,
	  this will not harm the operation. Thanks to Terry Wilson for
	  discovering the problem and giving me a really great debug
	  capture that pointed out the problem clearly

2009-01-16 18:49 +0000 [r168832]  Tilghman Lesher <tlesher@digium.com>

	* /, main/say.c, include/asterisk/say.h, apps/app_voicemail.c:
	  Merged revisions 168828 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168828 | tilghman | 2009-01-16 12:41:35 -0600 (Fri, 16 Jan 2009)
	  | 6 lines Fix the conjugation of Russian and Ukrainian languages.
	  (related to issue #12475) Reported by: chappell Patches:
	  vm_multilang.patch uploaded by chappell (license 8) ........

2009-01-16 17:09 +0000 [r168759-168760]  Russell Bryant <russell@digium.com>

	* CHANGES: Fix a spelling mistake.

	* channels/chan_misdn.c: build in dev mode

2009-01-16 00:34 +0000 [r168737-168746]  Steve Murphy <murf@digium.com>

	* res/ael/pval.c, /: Merged revisions 168745 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168745 | murf | 2009-01-15 17:19:12 -0700 (Thu, 15 Jan 2009) |
	  14 lines This patch fixes a problem where a goto (or jump, in
	  this case) fails a consistency check because it can't find a
	  matching extension. The problem was a missing instruction to end
	  the range notation in the code where it converts the pattern into
	  a regex and uses the regex code to determine the match. I tested
	  using the AEL code the user supplied, and now, the consistency
	  check passes. (closes issue #14141) Reported by: dimas ........

	* main/ast_expr2.h, main/ast_expr2.y, main/ast_expr2.c: This patch
	  allows null args in ast_expr2 func calls, and fixes commas being
	  converted to pipes, which was 1.4 type stuff. If the user says
	  count=ENUMLOOKUP(${EXTEN},ALL,c,,enum.mydomain.tld); then it
	  won't complain about the empty arg (c,,...) and fabled's patch
	  won't let it swap the commas for pipes. Ran it thru my dialplan
	  and no complaints. (closes issue #14169) Reported by: fabled
	  Patches: function-argument-separator-fix.diff uploaded by fabled
	  (license 448)

2009-01-15 20:18 +0000 [r168734]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_config_odbc.c, build_tools/menuselect-deps.in, configure,
	  funcs/func_odbc.c, configure.ac, cdr/cdr_adaptive_odbc.c,
	  cdr/cdr_odbc.c, makeopts.in, res/res_odbc.c,
	  apps/app_voicemail.c: remove the PBX_ODBC logic from the
	  configure script, and add GENERIC_ODCB logic that includes
	  copying the relevant LIB and INCLUDE data from either UnixODBC or
	  iODBC, based on which was found; if both were found, prefer
	  UnixODBC this stops modules from being linked against both sets
	  of libraries on systems that have both installed

2009-01-15 20:00 +0000 [r168725-168732]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Add missing brace

	* channels/chan_sip.c: Fix the compactheaders option in sip.conf

	* channels/chan_sip.c: Remove an unneeded condition for line
	  addition to a SIP request/response In Asterisk 1.4 and 1.6.0, the
	  sip_request structure had a statically allocated buffer to hold
	  the text of the request. There was a check in the add_line
	  function to not attempt to write the line into the buffer if we
	  did not have room for it. In trunk and Asterisk versions starting
	  with 1.6.1, an expandable ast_str structure is used to hold the
	  text. Since it may grow to fit an arbitrarily sized string, this
	  check in add_line is no longer valid. I found this oddity while
	  attempting to fix issue #14220; however, I do not believe that
	  this is the fix for that issue since the output supplied by the
	  reporter did not contain the warning message that would be
	  printed had this condition been satisfied.

2009-01-15 18:47 +0000 [r168722]  Olle Johansson <oej@edvina.net>

	* /, configs/extconfig.conf.sample: Merged revisions 168721 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168721 | oej | 2009-01-15 19:43:43 +0100 (Tor, 15 Jan 2009) | 2
	  lines Meetme actually has realtime but wasn't documented ........

2009-01-15 18:39 +0000 [r168719]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/strings.h: Resolve issue with negative vs
	  non-negative length parameters. (closes issue #14245) Reported
	  by: dveiga

2009-01-15 18:08 +0000 [r168711-168712]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Make sure that we have the same terminology
	  in sip.conf.sample and the source code warning. Thanks Nick Lewis
	  for pointing this out in the bug tracker.

	* configs/sip.conf.sample: Clarify some misunderstandings and make
	  it even more clear that you can refer to a peer in the register=
	  line.

2009-01-15 15:33 +0000 [r168705]  Sean Bright <sean.bright@gmail.com>

	* apps/app_meetme.c: Add a missing unlock and properly handle the
	  'maxusers' setting on MeetMe conferences. We were using the 'user
	  number' field to compare against the maximum allowed users, which
	  works assuming users with lower user numbers didn't leave the
	  conference. (closes issue #14117) Reported by: sergedevorop
	  Patches: 20090114__bug14117-2.diff.txt uploaded by seanbright
	  (license 71) Tested by: sergedevorop

2009-01-15 13:37 +0000 [r168636-168639]  Olle Johansson <oej@edvina.net>

	* CREDITS, CHANGES: Related to issue #14246 Update changes for
	  SIPRemoveHeader()

	* channels/chan_sip.c: Add capability to remove added SIP headers
	  *before* INVITE is generated. (closes issue #14246) Reported by:
	  klaus3000 Patches: 2patch_chan_sip_SIPRemoveHeader_trunk.txt
	  uploaded by klaus3000 (license 65)

	* apps/app_queue.c: Add support for setting the Reason header when
	  cancelling a call in the queue because someone else answered.
	  Previously, only dial() was supported. EDV-102

2009-01-15 00:14 +0000 [r168629]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 168628 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168628 | mmichelson | 2009-01-14 18:11:01 -0600 (Wed, 14 Jan
	  2009) | 16 lines Fix some crashes from bad datastore handling in
	  app_queue.c * The queue_transfer_fixup function was searching for
	  and removing the datastore from the incorrect channel, so this
	  was fixed. * Most datastore operations regarding the
	  queue_transfer datastore were being done without the channel
	  locked, so proper channel locking was added, too. (closes issue
	  #14086) Reported by: ZX81 Patches: 14086v2.patch uploaded by
	  putnopvut (license 60) Tested by: ZX81, festr ........

2009-01-14 23:10 +0000 [r168626]  Sean Bright <sean.bright@gmail.com>

	* main/cli.c: Don't crash when typing 'core set verbose' or 'core
	  set debug' by themselves. (closes issue #14219) Reported by:
	  jamesgolovich Patches: asterisk-setverbosecrash.diff.txt uploaded
	  by jamesgolovich (license 176)

2009-01-14 21:51 +0000 [r168623]  Richard Mudgett <rmudgett@digium.com>

	* /, channels/misdn/isdn_lib.c: Merged revisions 168622 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168622 | rmudgett | 2009-01-14 15:48:22 -0600 (Wed, 14 Jan 2009)
	  | 4 lines * Fixed create_process() allocation of process ID
	  values. The allocated process IDs could overflow their respective
	  NT and TE fields. Affects outgoing calls. ........

2009-01-14 21:19 +0000 [r168619]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c: This fixes a problem where MWI FSK spills
	  were being injected onto off hook fxs lines. (closes issue
	  #14143) Reported by: alecdavis Patches:
	  chan_dahdi-14143.patch.txt uploaded by dbailey (license ) Tested
	  by: alecdavis

2009-01-14 20:58 +0000 [r168615]  Sean Bright <sean.bright@gmail.com>

	* /, contrib/scripts/autosupport: Merged revisions 168614 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168614 | seanbright | 2009-01-14 15:52:00 -0500 (Wed, 14 Jan
	  2009) | 9 lines Update autosupport script to supply info for both
	  Zaptel and DAHDI in 1.4 and be sure to run dahdi_test in 1.6.x
	  and trunk instead of zttest. (closes issue #14132) Reported by:
	  dsedivec Patches: asterisk-1.4-autosupport.patch uploaded by
	  dsedivec (license 638) asterisk-trunk-autosupport.patch uploaded
	  by dsedivec (license 638) ........

2009-01-14 20:51 +0000 [r168613]  Steve Murphy <murf@digium.com>

	* /, apps/app_page.c: Merged revisions 168608 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168608 | murf | 2009-01-14 12:34:35 -0700 (Wed, 14 Jan 2009) | 1
	  line app_page was failing to compile in dev-mode on my gcc-4.2.4
	  system. This change gets rid of the warning. ........

2009-01-14 20:13 +0000 [r168610]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Restore the "sip show users" and "sip show
	  user" CLI commands (closes issue #14180) Reported by: amorsen
	  Patches: sip_show_users_161v3.diff uploaded by putnopvut (license
	  60) Tested by: blitzrage, amorsen

2009-01-14 19:36 +0000 [r168609]  Michiel van Baak <michiel@vanbaak.info>

	* main/asterisk.c: Fix compilation on FreeBSD and OSX This started
	  as work to fix the 'core show sysinfo' CLI command but while
	  working on it oej pointed out that read_credentials did not
	  compile neither. So while being there, fix that as well. Thanks
	  for all the testing oej! (closes issue #14129) Reported by: ys
	  Tested by: oej, mvanbaak

2009-01-14 19:11 +0000 [r168601-168604]  Tilghman Lesher <tlesher@digium.com>

	* main/udptl.c, /: Merged revisions 168603 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168603 | tilghman | 2009-01-14 13:02:55 -0600 (Wed, 14 Jan 2009)
	  | 7 lines Don't read into a buffer without first checking if a
	  value is beyond the end. (closes issue #13600) Reported by: atis
	  Patches: 20090106__bug13600.diff.txt uploaded by Corydon76
	  (license 14) Tested by: atis ........

	* channels/chan_misdn.c: Mostly spacing changes; no functionality
	  change at all.

2009-01-14 02:00 +0000 [r168594]  Terry Wilson <twilson@digium.com>

	* /, apps/app_page.c: Merged revisions 168593 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168593 | twilson | 2009-01-13 19:27:18 -0600 (Tue, 13 Jan 2009)
	  | 20 lines Don't overflow when paging more than 128 extensions
	  The number of available slots for calls in app_page was hardcoded
	  to 128. Proper bounds checking was not in place to enforce this
	  limit, so if more than 128 extensions were passed to the Page()
	  app, Asterisk would crash. This patch instead dynamically
	  allocates memory for the ast_dial structures and removes the
	  (non-functional) arbitrary limit. This issue would have special
	  importance to anyone who is dynamically creating the argument
	  passed to the Page application and allowing more than 128
	  extensions to be added by an outside user via some external
	  interface. The patch posted by a_villacis was slightly modified
	  for some coding guidelines and other cleanups. Thanks,
	  a_villacis! (closes issue #14217) Reported by: a_villacis
	  Patches: 20080912-asterisk-app_page-fix-buffer-overflow.patch
	  uploaded by a (license 660) Tested by: otherwiseguy ........

2009-01-13 23:57 +0000 [r168591]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_misdn.c: Janitor patch for chan_misdn (make channel
	  variable access safe) (closes issue #12887) Reported by: pputman
	  Patches: chan_misdn_threadsafe.patch uploaded by pputman (license
	  81)

2009-01-13 23:05 +0000 [r168585-168588]  Terry Wilson <twilson@digium.com>

	* res/res_http_post.c: Fully overwrite a same-named file when
	  uploading (closes issue #14190) Reported by: timking

	* Makefile, include/asterisk/options.h, main/asterisk.c: Add option
	  to hide console connect messages (closes issue #14222) Reported
	  by: jamesgolovich Patches: asterisk-hideconnect.diff.txt uploaded
	  by jamesgolovich (license 176) Tested by: otherwiseguy

2009-01-13 22:30 +0000 [r168579]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Clarify a message that app_queue prints and
	  change to a debug-level message The "No one is answering..."
	  verbose message contained 3 numbers that were not explained in
	  any way to whoever was viewing the message. It is more helpful
	  now since the message explains what the numbers mean. Also, the
	  message has been downgraded to "DEBUG" level. (closes issue
	  #14172) Reported by: caio1982 Patches: queue_answering_debug.diff
	  uploaded by caio1982 (license 22)

2009-01-13 22:22 +0000 [r168578]  Terry Wilson <twilson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 168551 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168551 | twilson | 2009-01-13 12:34:14 -0600 (Tue, 13 Jan 2009)
	  | 7 lines Don't pass a value with a side effect to a macro
	  (closes issue #14176) Reported by: paraeco Patches:
	  chan_sip.c.diff uploaded by paraeco (license 658) ........

2009-01-13 21:18 +0000 [r168575]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Allow
	  specifying a port number in the user portion of a register =>
	  line in sip.conf With this commit, a register => line in sip.conf
	  may contain a port number in the "user" section of the line.
	  Please see CHANGES and sip.conf.sample for more details regarding
	  this. (closes issue #14198) Reported by: Nick_Lewis Patches:
	  chan_sip.c-domainport2.patch uploaded by Nick (license 657)
	  Tested by: Nick_Lewis

2009-01-13 19:22 +0000 [r168562]  Russell Bryant <russell@digium.com>

	* channels/chan_unistim.c, main/pbx.c, apps/app_read.c, /,
	  include/asterisk/indications.h, apps/app_readexten.c,
	  apps/app_disa.c, include/asterisk/channel.h, main/indications.c,
	  main/channel.c, channels/chan_misdn.c, channels/chan_skinny.c,
	  funcs/func_channel.c, main/app.c, res/snmp/agent.c,
	  res/res_indications.c: Merged revisions 168561 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168561 | russell | 2009-01-13 13:13:05 -0600 (Tue, 13 Jan 2009)
	  | 2 lines Revert unnecessary indications API change from rev
	  122314 ........

2009-01-13 17:51 +0000 [r168547]  Tilghman Lesher <tlesher@digium.com>

	* /, funcs/func_logic.c: Merged revisions 168546 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168546 | tilghman | 2009-01-13 11:48:00 -0600 (Tue, 13 Jan 2009)
	  | 6 lines If either conditional is NULL, don't try copying it.
	  (closes issue #14226) Reported by: caspy Patches:
	  20090113__bug14226.diff.txt uploaded by Corydon76 (license 14)
	  ........

2009-01-13 16:02 +0000 [r168539]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* main/taskprocessor.c: correct a CLI description

2009-01-12 23:45 +0000 [r168526]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_alsa.c: Merged revisions 167095 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r167095 | tilghman | 2008-12-31 18:01:22 -0600 (Wed, 31
	  Dec 2008) | 5 lines Repeat attempts to write when we receive
	  -EAGAIN from the driver, as detailed in the ALSA sample code (see
	  http://www.alsa-project.org/alsa-doc/alsa-lib/_2test_2pcm_8c-example.html#a32)
	  Reported by: Jerry Geis (via the -users list) Fixed by: me
	  (license 14) ........

2009-01-12 23:12 +0000 [r168523]  Mark Michelson <mmichelson@digium.com>

	* main/srv.c: bump the verbosity of a message in srv.c up by one.
	  It used to be at this level prior to a large patch merge which
	  converted ast_verbose calls to ast_verb (closes issue #14221)
	  Reported by: jcovert Patches: srv.c.patch uploaded by jcovert
	  (license 551)

2009-01-12 23:06 +0000 [r168522]  Tilghman Lesher <tlesher@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  main/app.c: Some platforms (notably, the BSDs) have a more
	  efficient implementation called closefrom(3).

2009-01-12 21:51 +0000 [r168508-168517]  Jeff Peeler <jpeeler@digium.com>

	* /, res/res_agi.c: Merged revisions 168516 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168516 | jpeeler | 2009-01-12 15:42:34 -0600 (Mon, 12 Jan 2009)
	  | 5 lines (closes issue #13881) Reported by: hoowa Update the app
	  CDR field for AGI commands that are not executing an application
	  via "exec". ........

	* /, channels/chan_agent.c: Merged revisions 168507 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r168507 | jpeeler | 2009-01-12 14:26:22 -0600 (Mon, 12
	  Jan 2009) | 9 lines (closes issue #12269) Reported by: IgorG
	  Tested by: denisgalvao This gits rid of the notion of an
	  owning_app allowing the request and hangup to be initiated by
	  different threads. Originating from an active agent channel
	  requires this. The implementation primarily changes __login_exec
	  to wait on a condition variable rather than a lock. Review:
	  http://reviewboard.digium.com/r/35/ ........

2009-01-12 16:31 +0000 [r168497]  Olle Johansson <oej@edvina.net>

	* apps/app_minivm.c: Better to use the proper app name

2009-01-12 15:00 +0000 [r168485]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Merged revisions 168482 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168482 | mmichelson | 2009-01-12 08:58:25 -0600 (Mon, 12 Jan
	  2009) | 5 lines I am reverting the fix made in revision 168128
	  (and its upward merges) after being contacted by Olle Johansson
	  and being shown how this fix is incorrect. Thanks to Olle for
	  clearing this up for me. ........

2009-01-12 14:57 +0000 [r168481]  Russell Bryant <russell@digium.com>

	* /, configs/indications.conf.sample: Merged revisions 168480 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168480 | russell | 2009-01-12 08:57:27 -0600 (Mon, 12 Jan 2009)
	  | 2 lines s/ringdance/ringcadence/ for Bulgaria ........

2009-01-12 14:35 +0000 [r168479]  Olle Johansson <oej@edvina.net>

	* main/asterisk.c: Don't include swap.h unless we have swapctl

2009-01-10 01:42 +0000 [r168334]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: sizeof for a stringfield is 4. Kinda low for
	  reconstructing a field value.

2009-01-09 23:16 +0000 [r168270]  Kevin P. Fleming <kpfleming@digium.com>

	* /, sounds/Makefile: Merged revisions 168267 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168267 | kpfleming | 2009-01-09 17:12:29 -0600 (Fri, 09 Jan
	  2009) | 1 line update to use new sound file packages that include
	  license files ........

2009-01-09 23:15 +0000 [r168269]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c: Spacing change

2009-01-09 23:04 +0000 [r168265]  Michiel van Baak <michiel@vanbaak.info>

	* contrib/scripts/sip_nat_settings (added), CHANGES: Add a script
	  to find out the correct settings for Asterisk behind NAT (closes
	  issue #13065) Reported by: tzafrir Patches: sip_nat_settings
	  uploaded by tzafrir (license 46) sip_nat_settings_6 uploaded by
	  mvanbaak (license 7) Tested by: tzafrir, pabelanger, Dovid and
	  moi

2009-01-09 22:21 +0000 [r168200]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 168198 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r168198 | russell | 2009-01-09 16:14:38 -0600 (Fri, 09
	  Jan 2009) | 2 lines Make this compile for mvanbaak ........

2009-01-09 21:53 +0000 [r168193]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 168128 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r168128 | mmichelson | 2009-01-09 14:08:04 -0600 (Fri, 09 Jan
	  2009) | 13 lines Add check_via calls to more request handlers
	  INFO, NOTIFY, OPTIONS, REFER, and MESSAGE requests were not
	  checking the topmost Via to determine where to send the response.
	  Adding check_via calls to those request handlers solves this.
	  (closes issue #13071) Reported by: baron Patches: check_via.patch
	  uploaded by baron (license 531) Tested by: baron ........

2009-01-09 21:43 +0000 [r168192]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 168191 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r168191 | rmudgett | 2009-01-09 15:28:42 -0600 (Fri, 09
	  Jan 2009) | 3 lines * Fix for JIRA AST-175/ABE-1757 *
	  Miscellaneous doxygen comments added. ........

2009-01-09 20:25 +0000 [r168142]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: Don't leak memory if phoneprov.conf does not
	  exist (closes issue #14203) Reported by: jamesgolovich Patches:
	  asterisk-phoneprovleak.diff.txt uploaded by jamesgolovich
	  (license 176)

2009-01-09 18:30 +0000 [r168090]  Tilghman Lesher <tlesher@digium.com>

	* res/res_agi.c, include/asterisk/strings.h: When using ast_str
	  with a non-ast_str-enabled API, we need to update the buffer or
	  otherwise, we cannot use ast_str_strlen().

2009-01-09 18:01 +0000 [r168014-168054]  Matthew Nicholson <mnicholson@digium.com>

	* main/logger.c: Added a comment to logger.c about where to put
	  includes

	* main/logger.c: Use ast_safe_system() in logger.c instead of
	  system() (closes issue #14194) Reported by: pabelanger

2009-01-09 01:15 +0000 [r167935-167973]  Terry Wilson <twilson@digium.com>

	* apps/app_originate.c: Set ORIGINATE_STATUS instead of
	  OUTGOING_STATUS to match the documentation

	* apps/app_dial.c: Set peer context and exten values so MACRO_EXTEN
	  and MACRO_CONTEXT will be set

2009-01-08 22:37 +0000 [r167894]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_agi.c: Merged revisions 167840 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167840 | tilghman | 2009-01-08 16:08:56 -0600 (Thu, 08 Jan 2009)
	  | 6 lines Don't truncate database results at 255 chars. (closes
	  issue #14069) Reported by: evandro Patches:
	  20081214__bug14069.diff.txt uploaded by Corydon76 (license 14)
	  ........

2009-01-08 22:34 +0000 [r167888]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Revert chan_sip changes which were
	  accidentally committed in revision 167792

2009-01-08 21:40 +0000 [r167835-167837]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_minivm.c: Fix variables to comply with documentation
	  changes

	* apps/app_minivm.c: Textual changes, consistency in status
	  variable naming, and other minor bugs. (closes issue #13943)
	  Reported by: Marquis Patches: minivm_trunk_fixes3.patch uploaded
	  by Marquis (license 32)

2009-01-08 19:48 +0000 [r167792]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c, CHANGES, apps/app_queue.c: Add the average
	  talk time for a queue This patch adds the functionality to
	  app_queue of calculating the average amount of time that channels
	  are bridged for a queue. The algorithm used to calculate the
	  average is the same exponential average currently used to
	  calculate the average holdtime. See the CHANGES file to see the
	  methods you may use to view this information. (closes issue
	  #13960) Reported by: coolmig Patches:
	  app_queue.c.diff.trunk-r158840 uploaded by coolmig (license 621)

2009-01-08 19:44 +0000 [r167791]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, CHANGES: Convert dialplan application
	  DAHDISendCallreroutingFacility to use commas. (closes issue
	  #13836) Reported by: eliel Patches: chan_dahdi.c.patch uploaded
	  by eliel (license 64)

2009-01-08 17:26 +0000 [r167700-167720]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c: Merged revisions 167714 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167714 | kpfleming | 2009-01-08 11:24:21 -0600 (Thu, 08 Jan
	  2009) | 1 line remove an unnecessary argument to queue_request()
	  ........

	* channels/chan_sip.c: Merged revisions 167620 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167620 | kpfleming | 2009-01-07 17:32:21 -0600 (Wed, 07 Jan
	  2009) | 5 lines When a SIP request or response arrives for a
	  dialog with an associated Asterisk channel, and the lock on that
	  channel cannot be obtained because it is held by another thread,
	  instead of dropping the request/response, queue it for later
	  processing when the channel lock becomes available.
	  http://reviewboard.digium.com/r/123/ ........

2009-01-08 14:27 +0000 [r167662]  Leif Madsen <lmadsen@digium.com>

	* contrib/scripts/sip-friends.sql: Oops... fix the fieldname I
	  changed yesterday to be right.

2009-01-07 22:36 +0000 [r167542-167569]  Russell Bryant <russell@digium.com>

	* /, main/file.c: Merged revisions 167566 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167566 | russell | 2009-01-07 16:35:36 -0600 (Wed, 07 Jan 2009)
	  | 2 lines Fix the last couple of places where free() was
	  improperly used directly. ........

	* /, main/file.c: Merged revisions 167554 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167554 | russell | 2009-01-07 16:26:42 -0600 (Wed, 07 Jan 2009)
	  | 2 lines Don't fclose() the file early, the filestream
	  destructor will handle it. ........

	* /, main/file.c: Merged revisions 167545 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167545 | russell | 2009-01-07 16:19:47 -0600 (Wed, 07 Jan 2009)
	  | 2 lines Only try to close the file if one was actually opened
	  ........

	* /, main/file.c: Merged revisions 167541 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167541 | russell | 2009-01-07 16:03:59 -0600 (Wed, 07 Jan 2009)
	  | 4 lines Don't use free() directly. This caused a crash since
	  ast_filestream is now an ao2 object. Reported by JunK-Y on IRC,
	  #asterisk-dev ........

2009-01-07 18:20 +0000 [r167478]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_followme.c: Answer the channel if it has not already
	  been answered and we've already found a valid profile for
	  followme. (closes issue #14140) Reported by: dimas Patches:
	  14140.patch uploaded by dimas

2009-01-07 18:18 +0000 [r167477]  Leif Madsen <lmadsen@digium.com>

	* configs/queues.conf.sample: Update queues.conf.sample
	  documentation. Update the queues.conf.sample documentation to
	  mention that you need to preload chan_local.so as well if you
	  plan on using Local channels for queue members, and you're
	  preloading pbx_config.so. (closes issue #14179) Reported by:
	  CrashHD Tested by: CrashHD

2009-01-07 17:35 +0000 [r167442]  Russell Bryant <russell@digium.com>

	* /, main/indications.c: Merged revisions 167432 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167432 | russell | 2009-01-07 11:29:53 -0600 (Wed, 07 Jan 2009)
	  | 4 lines Treat an empty string the same way as a NULL country
	  argument. In passing, simplify the handling of returning a
	  default tone zone. ........

2009-01-07 17:05 +0000 [r167416]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c: Cleanup fsk spill if off hook is detected
	  during mwi spill. Correct logic error in handling events when
	  sending mwi spill (closes issue #14143) Reported by: alecdavis
	  Patches: chan_dahdi.handle_init_event2.diff.txt uploaded by
	  dbailey

2009-01-07 14:26 +0000 [r167373]  Leif Madsen <lmadsen@digium.com>

	* contrib/scripts/sip-friends.sql: Update the sip-friends.sql file
	  to use the non-deprecated 'defaultname' instead of 'username' and
	  remove an extra comma that would cause the script to fail as-is

2009-01-06 21:36 +0000 [r167301]  Mark Michelson <mmichelson@digium.com>

	* /, main/db.c: Merged revisions 167299 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167299 | mmichelson | 2009-01-06 15:35:57 -0600 (Tue, 06 Jan
	  2009) | 8 lines Use the correct variable when creating the format
	  string (closes issue #14177) Reported by: nic_bellamy Patches:
	  asterisk-trunk-svn-r167242-ast_db_gettree.patch uploaded by nic
	  (license 299) ........

2009-01-06 21:02 +0000 [r167265]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 167260 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r167260 | tilghman | 2009-01-06 14:48:05 -0600
	  (Tue, 06 Jan 2009) | 9 lines Merged revisions 167259 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r167259 | tilghman | 2009-01-06 14:44:03 -0600 (Tue, 06
	  Jan 2009) | 2 lines Security fix AST-2009-001. ........
	  ................

2009-01-05 16:59 +0000 [r167180]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 167179 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r167179 | mmichelson | 2009-01-05 10:51:59 -0600 (Mon, 05 Jan
	  2009) | 41 lines A couple of changes to T.38 SDP attribute
	  handling There are some boolean attributes for T.38 such as
	  T38FaxFillBitRemoval, T38FaxTranscodingMMR, and
	  T38FaxTranscodingJBIG. By simply being present, we should treat
	  these as a "true" value. The current code, however, was requiring
	  a 1 or 0 as the value of the attribute in order to parse it. This
	  is due to the fact that there are some T.38 endpoints and
	  gateways that also transmit this information incorrectly. This
	  patch follows the "be liberal in what you accept and strict in
	  what you send" philosophy by accepting both the correctly- and
	  incorrectly-formatted attributes, but only sending information as
	  it is supposed to be sent. It was also discovered that a
	  particular type of T.38 gateway sends some non-standard T.38 SDP
	  attributes. Instead of using T38FaxMaxDatagram and T38MaxBitRate,
	  it used T38MaxDatagram and T38FaxMaxRate respectively. We now
	  will properly accept these attributes as well. Note that there
	  are a lot of patches cited in the below commit message template.
	  This is because the person who submitted these patches is an
	  awesome person and wrote 1.4, 1.6.0, and 1.6.1 variants. (closes
	  issue #13976) Reported by: linulin Patches:
	  chan_sip.c.1.4-update1.diff uploaded by arcivanov (license 648)
	  chan_sip.c.1.6.0-update1.diff uploaded by arcivanov (license 648)
	  chan_sip.c.1.6.1-update1.diff uploaded by arcivanov (license 648)
	  chan_sip.c.1.4-relaxedT38_update1.diff uploaded by arcivanov
	  (license 648) chan_sip.c.1.6.0-relaxedT38_update1.diff uploaded
	  by arcivanov (license 648)
	  chan_sip.c.1.6.1-relaxedT38_update1.diff uploaded by arcivanov
	  (license 648) Tested by: arcivanov ........

2009-01-05 16:44 +0000 [r167176]  Tilghman Lesher <tlesher@digium.com>

	* UPGRADE-1.6.txt: More clearly explain that quote marks are no
	  longer necessary. (closes issue #13718) Reported by: davidw
	  Patches: 20081020__bug13718.diff.txt uploaded by Corydon76
	  (license 14) Tested by: blitzrage

2009-01-03 20:29 +0000 [r167125]  Jeff Peeler <jpeeler@digium.com>

	* main/asterisk.c: When parsing environment variable
	  ASTERISK_PROMPT, make sure to proceed to the next character when
	  a non format specifier is used (no %). Otherwise, the while loop
	  looking for the null byte will never exit.

2008-12-31 23:07 +0000 [r167061]  Sean Bright <sean.bright@gmail.com>

	* doc/CODING-GUIDELINES, include/asterisk.h, channels/h323/README:
	  Mostly just whitespace, but also convert 'CVS' to 'SVN' in a
	  couple places and fix a few typos I found in the
	  CODING_GUIDELINES.

2008-12-31 22:53 +0000 [r167057]  Terry Wilson <twilson@digium.com>

	* main/xmldoc.c: Don't forget to free typename

2008-12-31 21:52 +0000 [r167021]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_dahdi.c: Change some incorrect syntax for pri set
	  debug and correct an off-by-one error in ss7 set debug command

2008-12-31 19:39 +0000 [r166954-166958]  Tilghman Lesher <tlesher@digium.com>

	* main/ast_expr2.h, main/ast_expr2.c: That was weird...

	* channels/chan_local.c, /, main/ast_expr2.h, main/ast_expr2.c:
	  Merged revisions 166953 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r166953 | tilghman | 2008-12-31 13:20:35 -0600 (Wed, 31 Dec 2008)
	  | 5 lines Also inherit the musiconhold class. (Closes #14153)
	  Reported by: Jerry Geis, via the users list. Patch by: me
	  (license 14) ........

2008-12-30 20:50 +0000 [r166908]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c, doc/sip-retransmit.txt,
	  doc/tex/phoneprov.tex, res/res_http_post.c,
	  phoneprov/polycom_line.xml, doc/realtimetext.txt: Fix some
	  svn:keywords

2008-12-29 18:04 +0000 [r166861]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, apps/app_queue.c: Update app_queue to deal with
	  the removal of AST_PBX_KEEPALIVE When placing a call to a queue
	  which ran a gosub on the member's channel, Asterisk would crash
	  every time, stemming from the fact that the member's channel was
	  being hung up unexpectedly when the Gosub completed. The
	  necessary change was pretty much copied and pasted from
	  app_dial's similar changes made last week. I also took the
	  opportunity to change a LOG_DEBUG message in app_dial to use
	  ast_debug. I am guessing this was due to a direct merge from 1.4
	  that was not corrected to use trunk's preferred syntax.

2008-12-28 15:36 +0000 [r166823]  Eliel C. Sardanons <eliels@gmail.com>

	* funcs/func_audiohookinherit.c: Fix a typo in the XML
	  documentation of the AUDIOHOOK_INHERIT dialplan function.

2008-12-28 15:15 +0000 [r166773]  Russell Bryant <russell@digium.com>

	* /, channels/misdn_config.c: Merged revisions 166772 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r166772 | russell | 2008-12-28 09:13:48 -0600 (Sun, 28
	  Dec 2008) | 4 lines Use strncat() instead of an sprintf() in
	  which source and target buffers overlap
	  http://lists.digium.com/pipermail/asterisk-dev/2008-December/035919.html
	  ........

2008-12-24 15:10 +0000 [r166731]  Terry Wilson <twilson@digium.com>

	* channels/chan_sip.c: There is no section 22.2.2 in rfc 3261. I
	  believe 26.2.2 is what was meant: Note that in the SIPS URI
	  scheme, transport is independent of TLS, and thus
	  "sips:alice@atlanta.com;transport=tcp" and
	  "sips:alice@atlanta.com;transport=sctp" are both valid (although
	  note that UDP is not a valid transport for SIPS). The use of
	  "transport=tls" has consequently been deprecated, partly because
	  it was specific to a single hop of the request. This is a change
	  since RFC 2543.

2008-12-23 20:47 +0000 [r166696]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c: Allow semicolons and extended characters in
	  user-specified SIP headers. (closes issue #14110) Reported by:
	  gork Patches: 20081222__bug14110__2.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: gork, putnopvut

2008-12-23 18:13 +0000 [r166665]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, main/pbx.c, /, main/features.c,
	  apps/app_macro.c, include/asterisk/pbx.h, apps/app_queue.c,
	  include/asterisk/features.h: Merged revisions 166093 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4 In
	  order to merge this 1.4 patch into trunk, I had to resolve some
	  conflicts and wait for Russell to make some changes to res_agi. I
	  re-ran all the tests; 39 calls in all, and made fairly careful
	  notes and comparisons: I don't want this to blow up some aspect
	  of asterisk; I completely removed the KEEPALIVE from the pbx.h
	  decls. The first 3 scenarios involving feature park; feature xfer
	  to 700; hookflash park to Park() app call all behave the same,
	  don't appear to leave hung channels, and no crashes. ........
	  r166093 | murf | 2008-12-19 15:30:32 -0700 (Fri, 19 Dec 2008) |
	  131 lines This merges the masqpark branch into 1.4 These changes
	  eliminate the need for (and use of) the KEEPALIVE return code in
	  res_features.c; There are other places that use this result code
	  for similar purposes at a higher level, these appear to be left
	  alone in 1.4, but attacked in trunk. The reason these changes are
	  being made in 1.4, is that parking ends a channel's life, in some
	  situations, and the code in the bridge (and some other places),
	  was not checking the result code properly, and dereferencing the
	  channel pointer, which could lead to memory corruption and
	  crashes. Calling the masq_park function eliminates this danger in
	  higher levels. A series of previous commits have replaced some
	  parking calls with masq_park, but this patch puts them ALL to
	  rest, (except one, purposely left alone because a masquerade is
	  done anyway), and gets rid of the code that tests the KEEPALIVE
	  result, and the NOHANGUP_PEER result codes. While bug 13820
	  inspired this work, this patch does not solve all the problems
	  mentioned there. I have tested this patch (again) to make sure I
	  have not introduced regressions. Crashes that occurred when a
	  parked party hung up while the parking party was listening to the
	  numbers of the parking stall being assigned, is eliminated. These
	  are the cases where parking code may be activated: 1. Feature one
	  touch (eg. *3) 2. Feature blind xfer to parking lot (eg ##700) 3.
	  Run Park() app from dialplan (eg sip xfer to 700) (eg. dahdi
	  hookflash xfer to 700) 4. Run Park via manager. The interesting
	  testing cases for parking are: I. A calls B, A parks B a. B hangs
	  up while A is getting the numbers announced. b. B hangs up after
	  A gets the announcement, but before the parking time expires c. B
	  waits, time expires, A is redialed, A answers, B and A are
	  connected, after which, B hangs up. d. C picks up B while still
	  in parking lot. II. A calls B, B parks A a. A hangs up while B is
	  getting the numbers announced. b. A hangs up after B gets the
	  announcement, but before the parking time expires c. A waits,
	  time expires, B is redialed, B answers, A and B are connected,
	  after which, A hangs up. d. C picks up A while still in parking
	  lot. Testing this throroughly involves acting all the
	  permutations of I and II, in situations 1,2,3, and 4. Since I
	  added a few more changes (ALL references to KEEPALIVE in the
	  bridge code eliimated (I missed one earlier), I retested most of
	  the above cases, and no crashes. H-extension weirdness. Current
	  h-extension execution is not completely correct for several of
	  the cases. For the case where A calls B, and A parks B, the 'h'
	  exten is run on A's channel as soon as the park is accomplished.
	  This is expected behavior. But when A calls B, and B parks A,
	  this will be current behavior: After B parks A, B is hung up by
	  the system, and the 'h' (hangup) exten gets run, but the channel
	  mentioned will be a derivative of A's... Thus, if A is DAHDI/1,
	  and B is DAHDI/2, the h-extension will be run on channel
	  Parked/DAHDI/1-1<ZOMBIE>, and the start/answer/end info will be
	  those relating to Channel A. And, in the case where A is
	  reconnected to B after the park time expires, when both parties
	  hang up after the joyful reunion, no h-exten will be run at all.
	  In the case where C picks up A from the parking lot, when either
	  A or C hang up, the h-exten will be run for the C channel. CDR's
	  are a separate issue, and not addressed here. As to WHY this
	  strange behavior occurs, the answer lies in the procedure
	  followed to accomplish handing over the channel to the parking
	  manager thread. This procedure is called masquerading. In the
	  process, a duplicate copy of the channel is created, and most of
	  the active data is given to the new copy. The original channel
	  gets its name changed to XXX<ZOMBIE> and keeps the PBX
	  information for the sake of the original thread (preserving its
	  role as a call originator, if it had this role to begin with),
	  while the new channel is without this info and becomes a call
	  target (a "peer"). In this case, the parking lot manager thread
	  is handed the new (masqueraded) channel. It will not run an
	  h-exten on the channel if it hangs up while in the parking lot.
	  The h exten will be run on the original channel instead, in the
	  original thread, after the bridge completes. See bug 13820 for
	  our intentions as to how to clean up the h exten behavior.
	  Review: http://reviewboard.digium.com/r/29/ ........

2008-12-23 16:04 +0000 [r166625]  Russell Bryant <russell@digium.com>

	* CHANGES: Fix spelling error.

2008-12-23 15:17 +0000 [r166569]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c, /: Merged revisions 166568 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r166568 | mmichelson | 2008-12-23 09:16:26 -0600 (Tue, 23 Dec
	  2008) | 12 lines Fix a crash resulting from a datastore with
	  inheritance but no duplicate callback The fix for this is to
	  simply set the newly created datastore's data pointer to NULL if
	  it is inherited but has no duplicate callback. (closes issue
	  #14113) Reported by: francesco_r Patches: 14113.patch uploaded by
	  putnopvut (license 60) Tested by: francesco_r ........

2008-12-23 04:32 +0000 [r166533]  Tilghman Lesher <tlesher@digium.com>

	* main/channel.c, /: Merged revisions 166509 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r166509 | tilghman | 2008-12-22 22:05:25 -0600 (Mon, 22 Dec 2008)
	  | 4 lines Use the integer form of condition for integer
	  comparisons. (closes issue #14127) Reported by: andrew ........

2008-12-22 23:25 +0000 [r166470]  Mark Michelson <mmichelson@digium.com>

	* res/res_agi.c: Always use the value of the AGISIGHUP when running
	  an AGI. Prior to this patch, the value of AGISIGUP was not always
	  honored when set on a channel. (closes issue #13711) Reported by:
	  fmueller Patches: 13711.patch uploaded by putnopvut (license 60)

2008-12-22 21:45 +0000 [r166436]  Russell Bryant <russell@digium.com>

	* res/res_musiconhold.c: Cosmetic change - don't mix struct
	  initializer styles.

2008-12-22 21:08 +0000 [r166382]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 166380 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r166380 | mmichelson | 2008-12-22 14:56:29 -0600 (Mon,
	  22 Dec 2008) | 36 lines Fix a deadlock relating to channel locks
	  and autoservice It has been discovered that if a channel is
	  locked prior to a call to ast_autoservice_stop, then it is likely
	  that a deadlock will occur. The reason is that the call to
	  ast_autoservice_stop has a check built into it to be sure that
	  the thread running autoservice is not currently trying to
	  manipulate the channel we are about to pull out of autoservice.
	  The autoservice thread, however, cannot advance beyond where it
	  currently is, though, because it is trying to acquire the lock of
	  the channel for which autoservice is attempting to be stopped.
	  The gist of all this is that a channel MUST NOT be locked when
	  attempting to stop autoservice on the channel. In this particular
	  case, the channel was locked by a call to ast_read. A call to
	  ast_exists_extension led to autoservice being started and stopped
	  due to the existence of dialplan switches. It may be that there
	  are future commits which handle the same symptoms but in a
	  different location, but based on my looks through the code, it is
	  very rare to see a construct such as this one. (closes issue
	  #14057) Reported by: rtrauntvein Patches: 14057v3.patch uploaded
	  by putnopvut (license 60) Tested by: rtrauntvein Review:
	  http://reviewboard.digium.com/r/107/ ........

2008-12-22 20:26 +0000 [r166273-166377]  Russell Bryant <russell@digium.com>

	* res/res_musiconhold.c: Fix a bad typo.

	* main/astobj2.c: Remove some error messages. This is the default
	  handler that is valid to use.

	* /, main/utils.c: Merged revisions 166297 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r166297 | russell | 2008-12-22 11:22:56 -0600 (Mon, 22 Dec 2008)
	  | 2 lines Fix up timeout handling in ast_carefulwrite(). ........

	* include/asterisk/utils.h, main/manager.c, main/utils.c: Introduce
	  ast_careful_fwrite() and use in AMI to prevent partial writes.
	  This patch introduces a function to do careful writes on a file
	  stream which will handle timeouts and partial writes. It is
	  currently used in AMI to address the issue that has been
	  reported. However, there are probably a few other places where
	  this could be used. (closes issue #13546) Reported by: srt Tested
	  by: russell http://reviewboard.digium.com/r/104/

	* res/res_musiconhold.c: Re-work ref count handling of MoH classes
	  using astobj2 to resolve crashes. (closes issue #13566) Reported
	  by: igorcarneiro Tested by: russell Review:
	  http://reviewboard.digium.com/r/106/

2008-12-22 16:08 +0000 [r166268]  Joshua Colp <jcolp@digium.com>

	* main/dnsmgr.c: Record the previous port in the temporary address
	  structure so that the comparison does not treat the host as
	  having changed even if it did not. This would have been
	  uninitialized before and would have led to a baddddd port.
	  (closes issue #13628) Reported by: pananix Patches:
	  bug13628.patch uploaded by jpeeler (license 325) Tested by: file,
	  blitzrage

2008-12-22 16:07 +0000 [r166267]  Mark Michelson <mmichelson@digium.com>

	* funcs/func_timeout.c, main/file.c: Fix a file playback crash and
	  explicitly initialize values in func_timeout.c A crash was
	  brought up on the bugtracker. The first run through valgrind was
	  full of legitimate complaints of uninitialized values in
	  func_timeout when setting a response timeout. These were fixed
	  but the crash persisted. A second run through showed the real
	  problem. The reference counting used for filestreams was
	  incorrect because there were some missing increments when a frame
	  was read from a format module. (closes issue #14118) Reported by:
	  blitzrage Patches: 14118v2.patch uploaded by putnopvut (license
	  60) Tested by: blitzrage

2008-12-22 14:16 +0000 [r166258]  Russell Bryant <russell@digium.com>

	* res/res_agi.c: Remove AST_PBX_KEEPALIVE usage from res_agi. This
	  patch removes the usage of AST_PBX_KEEPALIVE from res_agi. The
	  only usage was for the AGI command, "asyncagi break". This patch
	  removes this feature. Normally, a feature would not be removed
	  like this. However, this code is broken and usage of it will
	  result in a memory leak. Usage of this feature will make the AGI
	  code return a result of AST_PBX_KEEPALIVE. The PBX handler
	  assumes that another thread has assumed ownership of the channel.
	  The channel thread will exit without destroying the channel.
	  Unfortunately, _no_ thread has ownership of the channel at this
	  point. There are a couple of serious problems here: 1) The only
	  way to recover the caller is to issue a channel redirect. This
	  will work, but this will be done with a masquerade, and the old
	  ast_channel structure will be lost. 2) Until the channel redirect
	  happens, there is no code servicing the channel. That means
	  nothing is reading audio or handling events coming from the
	  channel. This is very bad. The recommended way to get this same
	  "break" functionality is to issue the redirect while the channel
	  is still being handled by the AGI code. That way, there will be
	  no memory leak, and there will be no period of time that the
	  channel is not being serviced.

2008-12-20 01:37 +0000 [r166219]  Russell Bryant <russell@digium.com>

	* include/asterisk/doxyref.h: Make a note about formatting the
	  review URL in commit messages

2008-12-19 23:45 +0000 [r166092-166162]  Mark Michelson <mmichelson@digium.com>

	* main/audiohook.c: Get rid of an extra space. I don't know how
	  this crept back in when I had already fixed it earlier

	* funcs/func_audiohookinherit.c: Remove the verbatim tag from the
	  author line I could have sworn I already did that before,
	  though...

	* main/channel.c, funcs/func_audiohookinherit.c (added),
	  include/asterisk/audiohook.h, main/audiohook.c, CHANGES: Adding a
	  new dialplan function AUDIOHOOK_INHERIT This function is being
	  added as a method to allow for an audiohook to move to a new
	  channel during a channel masquerade. The most obvious use for
	  such a facility is for MixMonitor when a transfer is performed.
	  Prior to the addition of this functionality, if a channel running
	  MixMonitor was transferred by another party, then the recording
	  would stop once the transfer had completed. By using
	  AUDIOHOOK_INHERIT, you can make MixMonitor continue recording the
	  call even after the transfer has completed. It has also been
	  determined that since this is seen by most as a bug fix and is
	  not an invasive change, this functionality will also be
	  backported to 1.4 and merged into the 1.6.0 branches, even though
	  they are feature-frozen. (closes issue #13538) Reported by: mbit
	  Patches: 13538.patch uploaded by putnopvut (license 60) Tested
	  by: putnopvut Review: http://reviewboard.digium.com/r/102/

2008-12-19 21:44 +0000 [r166058]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Add configuration
	  support for half_full DAHDI buffer policy

2008-12-19 18:20 +0000 [r165954]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_record.c: Fix the XML documentation for Record().
	  <value> tags inside <variable> elements must have CDATA and no
	  another XML node.

2008-12-19 15:05 +0000 [r165801-165890]  Russell Bryant <russell@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 165889 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r165889 | russell | 2008-12-19 09:03:02 -0600 (Fri, 19 Dec 2008)
	  | 9 lines Ensure that the chanspy datastore is fully initialized.
	  This patch resolved some random crash issues observed by a user
	  on a BSD system (closes issue #14111) Reported by: ys Patches:
	  app_chanspy.c.diff uploaded by ys (license 281) ........

	* include/asterisk/doxyref.h: Disable some automatic links
	  generated by doxygen.

	* include/asterisk/doxyref.h: Introduce commit message formatting
	  guidelines. This documents the recommended outline to use for
	  commit message. It also covers information on special tags that
	  can be used in commit messages, as well as the template
	  functionality that is available on bugs.digium.com. Review:
	  http://reviewboard.digium.com/r/96/

	* /, main/utils.c: Merged revisions 165796 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r165796 | russell | 2008-12-18 15:39:25 -0600 (Thu, 18 Dec 2008)
	  | 11 lines Make ast_carefulwrite() be more careful. This patch
	  handles some additional cases that could result in partial writes
	  to the file description. This was done to address complaints
	  about partial writes on AMI. (issue #13546) (more changes needed
	  to address potential problems in 1.6) Reported by: srt Tested by:
	  russell Review: http://reviewboard.digium.com/r/99/ ........

2008-12-18 21:43 +0000 [r165798]  Jeff Peeler <jpeeler@digium.com>

	* main/manager.c: (closes issue #13993) Reported by: mika Add
	  ActionID response to ping if sent with request.

2008-12-18 21:41 +0000 [r165797]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 165767 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r165767 | tilghman | 2008-12-18 15:14:47 -0600 (Thu, 18
	  Dec 2008) | 8 lines Add mutexes around accesses to the IMAP
	  library interface. This prevents certain crashes, especially when
	  shared mailboxes are used. (closes issue #13653) Reported by:
	  howardwilkinson Patches:
	  asterisk-1.4.21.2-appvoicemail-sharedimap-lock.patch uploaded by
	  howardwilkinson (license 590) Tested by: jpeeler ........

2008-12-18 21:21 +0000 [r165792]  Joshua Colp <jcolp@digium.com>

	* channels/chan_dahdi.c, channels/chan_misdn.c,
	  channels/chan_sip.c, pbx/pbx_ael.c, apps/app_queue.c,
	  channels/chan_oss.c: Numerous documentation updates. (closes
	  issue #13970) Reported by: pkempgen Patches:
	  __20081217_cli_usage_fixes.patch.txt uploaded by blitzrage
	  (license 10)

2008-12-18 19:34 +0000 [r165724]  Mark Michelson <mmichelson@digium.com>

	* res/res_odbc.c: Fix crashes in res_odbc. The variable "class" was
	  being set NULL just prior to being dereferenced in an ao2_link
	  call. I have moved the setting of the variable to NULL until
	  after the ao2_link call.

2008-12-18 19:33 +0000 [r165662-165723]  Russell Bryant <russell@digium.com>

	* apps/app_dial.c, main/pbx.c, include/asterisk/pbx.h: Remove the
	  need for AST_PBX_KEEPALIVE with the GoSub option from Dial. This
	  is part of an effort to completely remove AST_PBX_KEEPALIVE and
	  other similar return codes from the source. While this usage was
	  perfectly safe, there are others that are problematic. Since we
	  know ahead of time that we do not want to PBX to destroy the
	  channel, the PBX API has been changed so that information can be
	  provided as an argument, instead, thus removing the need for the
	  KEEPALIVE return value. Further changes to get rid of KEEPALIVE
	  and related code is being done by murf. There is a patch up for
	  that on review 29. Review: http://reviewboard.digium.com/r/98/

	* /, res/res_musiconhold.c: Merged revisions 165661 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r165661 | russell | 2008-12-18 12:52:18 -0600 (Thu, 18
	  Dec 2008) | 7 lines Set the process group ID on the MOH process
	  so that all children will get killed (closes issue #14099)
	  Reported by: caspy Patches: res_musiconhold.c.patch.killpg.try2
	  uploaded by caspy (license 645) ........

2008-12-18 18:36 +0000 [r165658]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_voicemail.c: Fix 2 resource leaks and fix another
	  pipe-to-comma conversion

2008-12-18 17:13 +0000 [r165599]  Joshua Colp <jcolp@digium.com>

	* /, main/rtp.c: Merged revisions 165591 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r165591 | file | 2008-12-18 13:11:42 -0400 (Thu, 18 Dec 2008) | 4
	  lines Only care about a compatible codec for early bridging if we
	  are actually bridging to another channel. If we are not we
	  actually want to bring the audio back to us. (closes issue
	  #13545) Reported by: davidw ........

2008-12-18 16:36 +0000 [r165541]  Tilghman Lesher <tlesher@digium.com>

	* res/res_odbc.c: Fix reference counts of the class and add an
	  assertion to the end.

2008-12-18 15:25 +0000 [r165502]  Eliel C. Sardanons <eliels@gmail.com>

	* main/strings.c, include/asterisk/strings.h: Remove duplicate code
	  from the ast_str API. We now use __AST_STR_* to access 'struct
	  ast_str' members, but this must only be used inside the API
	  implementation. (closes issue #14098) Reported by: eliel Patches:
	  ast_str.patch uploaded by eliel (license 64)

2008-12-18 14:23 +0000 [r165433-165469]  Russell Bryant <russell@digium.com>

	* apps/app_originate.c: Add a \todo note for app_originate. Jared
	  Smith suggested that we add a way to be able to set variables and
	  functions on the outbound channel. I think that it's a great
	  idea, so I have added it as a todo so that it gets done at some
	  point.

	* apps/app_originate.c (added), CHANGES: Add a new application,
	  Originate. (closes issue #14075) Reported by: rcasas Patches:
	  app_originate.c uploaded by rcasas (license 641), heavily
	  modified by me Tested by: russell Review:
	  http://reviewboard.digium.com/r/95/

2008-12-17 23:39 +0000 [r165397]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_record.c: Add RECORD_STATUS variable, as requested on
	  the -users list. Patch by me (license 14)

2008-12-17 21:46 +0000 [r165326-165330]  Mark Michelson <mmichelson@digium.com>

	* res/res_odbc.c: Fix a refcount leak in res_odbc

	* apps/app_meetme.c, res/res_realtime.c: Fix the build

2008-12-17 21:28 +0000 [r165319-165325]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_macro.c: Oops, broke trunk

	* /, apps/app_macro.c: Merged revisions 165317 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r165317 | tilghman | 2008-12-17 15:14:37 -0600 (Wed, 17 Dec 2008)
	  | 4 lines Reverse the fix from issue #6176 and add proper
	  handling for that issue. (Closes issue #13962, closes issue
	  #13363) Fixed by myself (license 14) ........

2008-12-17 21:17 +0000 [r165318]  Mark Michelson <mmichelson@digium.com>

	* apps/app_meetme.c, res/res_realtime.c, apps/app_directory.c,
	  apps/app_queue.c, apps/app_voicemail.c: Merged revisions 165255
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r165255 | mmichelson | 2008-12-17 14:51:38 -0600 (Wed, 17 Dec
	  2008) | 7 lines Fix some memory leaks found while looking at how
	  realtime configs are handled. Also cleaned up some coding
	  guidelines violations in app_realtime.c, mostly related to
	  spacing ........

2008-12-17 20:50 +0000 [r165254]  Steve Murphy <murf@digium.com>

	* utils/extconf.c: This patch is here committed to satisfy the
	  buildbot, who has a problem with the const.

2008-12-17 19:55 +0000 [r165219]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: Polycom phones close the connection after
	  reading a little bit of the firmware files, we should stop
	  sending in that case. Also, make that case print out a debug
	  statement instead of a scary WARNING.

2008-12-17 19:52 +0000 [r165216]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Call proxy_update so that the IP address
	  gets populated. Sending stuff to 0.0.0.0 is silly! (closes issue
	  #14055) Reported by: chris-mac

2008-12-17 18:49 +0000 [r165180]  Matthew Nicholson <mnicholson@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: This patch
	  adds a new 'ignoresdpversion' option to sip.conf. When this is
	  enabled (either globally or for a specific peer), chan_sip will
	  treat any SDP data it receives as new data and update the media
	  stream accordingly. By default, Asterisk will only modify the
	  media stream if the SDP session version received is different
	  from the current SDP session version. This option is required to
	  interoperate with devices that have non-standard SDP session
	  version implementations (observed by toc on the bug tracker with
	  Microsoft OCS which always uses 0 as the session version).
	  http://reviewboard.digium.com/r/94/ (closes issue #13958)
	  Reported by: toc Tested by: toc

2008-12-17 17:56 +0000 [r165145]  Russell Bryant <russell@digium.com>

	* doc/appdocsxml.dtd: argsep is used as an attribute for an
	  argument, as well

2008-12-17 17:53 +0000 [r165142-165143]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: And actually assign the function to a
	  pointer...

	* apps/app_voicemail.c: Use the create_vm_state_from_user function
	  in a place where it was not being used before. Also, I've moved
	  the urgent folder check in messagecount() up a bit so that the
	  flow is a bit better. This was something I noticed while taking a
	  look at issue #13973, although I don't think this is the
	  underlying cause of the issue.

2008-12-17 16:41 +0000 [r165108]  Kevin P. Fleming <kpfleming@digium.com>

	* utils: ignore this copied file

2008-12-17 05:04 +0000 [r165039-165071]  Steve Murphy <murf@digium.com>

	* utils/Makefile, pbx/pbx_ael.c, utils/ael_main.c, utils/extconf.c,
	  utils/conf2ael.c, utils/check_expr.c: A possibly "horrible fix"
	  for a "horribly broken" situation. As stuff shifts around in the
	  asterisk code, the miscellaneous inclusions from the standalone
	  stuff gets broken. There's no easy fix for this situation. I made
	  sure that everything in utils builds without problem ***AND***
	  that aelparse runs the regressions correctly with the following
	  make menuselect options both on and off: DONT_OPTIMIZE
	  DEBUG_THREADS DEBUG_CHANNEL_LOCKS MALLOC_DEBUG MTX_PROFILE
	  DEBUG_SCHEDULER DEBUG_THREADLOCALS DETECT_DEADLOCKS CHANNEL_TRACE
	  I think from now on, I'm going to #undef all these features in
	  the various utils native files; I guess I could do the same for
	  the copied-in files, surrounded by STANDALONE ifdef. A standalone
	  isn't going to care about threads, mutexes, etc.

	* pbx/ael/ael-test/ref.ael-vtest17,
	  pbx/ael/ael-test/ref.ael-vtest13: fixed the regressions

2008-12-16 23:06 +0000 [r164978]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 164977 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164977 | mmichelson | 2008-12-16 17:04:27 -0600 (Tue, 16 Dec
	  2008) | 7 lines After looking through SIP registration code most
	  of the day, this is one of the few things I could find that was
	  just plain wrong. Even though it probably isn't possible for it
	  to happen, it seems weird to have code that checks if a pointer
	  is NULL and then immediately dereferences that pointer if it was
	  NULL. ........

2008-12-16 22:57 +0000 [r164976]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c, doc/api-1.6.2-changes.txt (added),
	  funcs/func_logic.c, include/asterisk/pbx.h, utils/extconf.c,
	  CHANGES, configs/extensions.conf.sample: Add timezone to the
	  possible fields in a timespec. (closes issue #14028) Reported by:
	  mostyn Patches: timezone-v2.patch uploaded by mostyn (license
	  398) (with additional code guideline fixes and a memory leak fix
	  by me - license 14)

2008-12-16 22:45 +0000 [r164942]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_record.c: (closes issue #13669) Reported by: pj Delete
	  file recording if recording terminated from a hangup.

2008-12-16 22:31 +0000 [r164941]  Terry Wilson <twilson@digium.com>

	* channels/chan_sip.c: Make a note of the feature request in bug
	  #11157 as per the reporter and oej, and suspend the bug since no
	  one seems to be keen on implementing it any time soon.

2008-12-16 21:39 +0000 [r164821-164882]  Russell Bryant <russell@digium.com>

	* /, main/utils.c: Merged revisions 164881 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164881 | russell | 2008-12-16 15:38:29 -0600 (Tue, 16 Dec 2008)
	  | 9 lines Fix an issue where DEBUG_THREADS may erroneously report
	  that a thread is exiting while holding a lock. If the last lock
	  attempt was a trylock, and it failed, it will still be in the
	  list of locks so that it can be reported. (closes issue #13219)
	  Reported by: pj ........

	* /, apps/app_macro.c: Merged revisions 164876 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164876 | russell | 2008-12-16 15:10:44 -0600 (Tue, 16 Dec 2008)
	  | 6 lines Do not dereference the channel if AST_PBX_KEEPALIVE has
	  been returned. This is a bug I noticed while looking at the code
	  for app_macro. This return code means that another thread has
	  assumed ownership of the channel and it can no longer be touched.
	  (I hate this return code with a passion, by the way.) ........

	* main/asterisk.c: Fix build issues on Linux after sysinfo related
	  changes

2008-12-16 20:47 +0000 [r164809-164814]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Qualify
	  trumps poke per lmadsen.

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Add
	  configuration options for finer control over how Asterisk handles
	  having to poke all peers at seemingly the same time. (closes
	  issue #13217) Reported by: cervajs

2008-12-16 20:41 +0000 [r164807]  Russell Bryant <russell@digium.com>

	* main/manager.c, /: Merged revisions 164806 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164806 | russell | 2008-12-16 14:35:25 -0600 (Tue, 16 Dec 2008)
	  | 9 lines Add "restart gracefully" to the AMI blacklist of CLI
	  commands. "module unload" was already identified as a command
	  that can not be used from the AMI. "restart gracefully"
	  effectively unloads all modules, and will run in to the same
	  problems. (closes issue #13894) Reported by: kernelsensei
	  ........

2008-12-16 20:08 +0000 [r164802]  Michiel van Baak <michiel@vanbaak.info>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  main/asterisk.c: introduce 'core show sysinfo' for systems that
	  dont have the Linux-ish sysinfo stuff but do have sysctl. (closes
	  issue #13433) Reported by: mvanbaak Patches:
	  2008121300_sysinfosysctl.diff.txt uploaded by mvanbaak (license
	  7) with two free calls replaced with ast_free based on feedback
	  on reviewboard Review: http://reviewboard.digium.com/r/91/

2008-12-16 20:04 +0000 [r164801]  Steve Murphy <murf@digium.com>

	* main/pbx.c: (closes issue #14076) Reported by: toc Tested by:
	  murf OK, Well this issue has had its share of flip-flopping. I
	  found the following: 1. the code in question, in ext_cmp1 in
	  pbx.c, would not allow two extensions that vary only by any
	  dashes contained within them, to be defined in the same context.
	  2. for input dialstrings, dashes are NOT ignored. So, skipping
	  them when sorting patterns seemed a bit silly. Thus, you might
	  declare ext 891 in a context, but if you try dialing 8-9-1, it
	  will NOT match 891. So, I proposed to remove the code from
	  ext_cmp1 to skip the spaces and dashes. Just kept us from
	  declaring 891 and 8-9-1 in the same context, forcing users to
	  generate otherwise uselessly obfuscated dialplan code to get the
	  same effect. Then, I tried out 1.4, and found that: 1. you can
	  declare 891 and 8-9-1 in the same context! 2. You can't define
	  891, and have 8-9-1 match it! Nor can you define 8-9-1, and have
	  891 match it! So, it appears that my proposal simply restores the
	  pbx to behaving as it did in 1.4.

2008-12-16 19:54 +0000 [r164798]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/safe_asterisk: Set up umask as a possible
	  configuration option. (closes issue #13753) Reported by: irroot

2008-12-16 17:14 +0000 [r164737]  Russell Bryant <russell@digium.com>

	* /, main/threadstorage.c, include/asterisk/threadstorage.h: Merged
	  revisions 164736 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164736 | russell | 2008-12-16 11:06:29 -0600 (Tue, 16 Dec 2008)
	  | 14 lines Fix memory leak and invalid reporting issues with
	  DEBUG_THREADLOCALS. One issue was that the ast_mutex_* API was
	  being used within the context of the thread local data
	  destructors. We would go off and allocate more thread local data
	  while the pthread lib was in the middle of destroying it all.
	  This led to a memory leak. Another issue was an invalid argument
	  being provided to the the object_add API call. (closes issue
	  #13678) Reported by: ys Tested by: Russell ........

2008-12-16 16:50 +0000 [r164733]  Joshua Colp <jcolp@digium.com>

	* pbx/pbx_config.c: Be more detailed about why the include did not
	  get included. (closes issue #14071) Reported by: kshumard
	  Patches: pbx_config.patch.improvederroroutput.txt uploaded by
	  kshumard (license 92)

2008-12-16 16:00 +0000 [r164675]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 164672 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164672 | russell | 2008-12-16 09:56:37 -0600 (Tue, 16 Dec 2008)
	  | 11 lines Fix a memory leak related to the use of the "setvar"
	  configuration option. The problem was that these variables were
	  being appended to the list of vars on the sip_pvt every time a
	  re-registration or re-subscription came in. Since it's just a
	  waste of memory to put them there unless the request was an
	  INVITE, then the fix is to check the request type before copying
	  the vars. (closes issue #14037) Reported by: marvinek Tested by:
	  russell ........

2008-12-16 15:44 +0000 [r164659]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: When using externhost make sure the port
	  gets set to the bindaddr port if one was not specified in the
	  externhost value itself. (closes issue #13634) Reported by:
	  performer

2008-12-16 15:31 +0000 [r164648]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /: Merged revisions 164634 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164634 | murf | 2008-12-16 08:15:58 -0700 (Tue, 16 Dec 2008) | 5
	  lines I added a sentence to clarify why - and ' ' are ignored in
	  patterns as per bug 14076. Leif says he'll put some stuff about
	  it in the extensions.conf sample, etc. ........

2008-12-16 15:00 +0000 [r164602-164623]  Russell Bryant <russell@digium.com>

	* apps/app_minivm.c: Set MINIVM_ACCMESS_STATUS in all cases. Also,
	  remove a variable that was not needed. (closes issue #14081)
	  Reported by: pkempgen

	* /, res/res_musiconhold.c: Merged revisions 164605 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r164605 | russell | 2008-12-16 08:28:10 -0600 (Tue, 16
	  Dec 2008) | 5 lines Don't try to change working directory if a
	  directory was not configured. (closes issue #14089) Reported by:
	  caspy ........

	* channels/chan_dahdi.c: Fix usage of the DAHDI_VMWI ioctl. (closes
	  issue #14090) Reported by: alecdavis Patches:
	  chan_dahdi.VMWI_ioctl.diff.txt uploaded by alecdavis (license
	  585)

2008-12-16 01:52 +0000 [r164565]  Sean Bright <sean.bright@gmail.com>

	* doc/tex/odbcstorage.tex: Use tables instead of ASCII art. Also
	  change a bit of minor formatting.

2008-12-15 22:25 +0000 [r164519-164525]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Open a timer before loading configuration
	  so that the trunking configuration option will take effect.
	  (closes issue #14082) Reported by: seandarcy

	* channels/chan_iax2.c: Fix log message to refer to the generic
	  timing interface, not DAHDI specifically (inspired by issue
	  #14082)

	* main/frame.c: Make sure we handle a uint32_t payload in
	  ast_frdup() (closes issue #14080) Reported by: fnordian Patches:
	  frame.patch uploaded by fnordian (license 110)

2008-12-15 21:17 +0000 [r164485]  Tilghman Lesher <tlesher@digium.com>

	* configs/extconfig.conf.sample, pbx/pbx_realtime.c, CHANGES: Allow
	  disabling pattern match searches within the Realtime dialplan
	  switch. (closes issue #13698) Reported by: fhackenberger Patches:
	  20081211__bug13698.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: fhackenberger

2008-12-15 20:07 +0000 [r164419-164428]  Mark Michelson <mmichelson@digium.com>

	* apps/app_page.c: Add an 'i' option to app_page. This option works
	  the same as the 'i' options for app_dial and app_queue, in that
	  they will ignore any attempts by phones to forward the call.
	  (closes issue #13977) Reported by: putnopvut Patches:
	  page_ignore_forwards.patch uploaded by putnopvut (license 60)
	  Tested by: putnopvut, acunningham

	* /, include/asterisk/pbx.h: Merged revisions 164422 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r164422 | mmichelson | 2008-12-15 13:53:08 -0600 (Mon,
	  15 Dec 2008) | 3 lines Add the deadlock note to
	  ast_spawn_extension as well ........

	* /, include/asterisk/channel.h, include/asterisk/pbx.h: Merged
	  revisions 164416 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164416 | mmichelson | 2008-12-15 13:45:07 -0600 (Mon, 15 Dec
	  2008) | 4 lines Add notes to autoservice and pbx doxygen
	  regarding a potential deadlock scenario so that it is avoided in
	  the future ........

2008-12-15 19:48 +0000 [r164417]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_sip.c, include/asterisk/strings.h: Revert ast_str
	  opacity in chan_sip for now, since something wasn't quite right
	  in the merge.

2008-12-15 19:42 +0000 [r164415]  Steve Murphy <murf@digium.com>

	* include/asterisk/strings.h: I was getting this warning during a
	  compile on a 64-bit machine running ubuntu server 8.10, and
	  gcc-4.3.2: [CXXi] chan_vpb.ii -> chan_vpb.oo cc1plus: warnings
	  being treated as errors In file included from
	  /home/murf/asterisk/trunk/include/asterisk/utils.h:671, from
	  chan_vpb.cc:46:
	  /home/murf/asterisk/trunk/include/asterisk/strings.h: In function
	  ‘char* ast_str_truncate(ast_str*, ssize_t)’:
	  /home/murf/asterisk/trunk/include/asterisk/strings.h:479: error:
	  comparison between signed and unsigned integer expressions
	  make[1]: *** [chan_vpb.oo] Error 1 make: *** [channels] Error 2
	  which this fix silences

2008-12-15 18:12 +0000 [r164351]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 164350 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164350 | file | 2008-12-15 14:11:21 -0400 (Mon, 15 Dec 2008) | 6
	  lines Do not try to unlock a non-existant channel if the transfer
	  fails. (closes issue #13800) Reported by: dwagner Patches:
	  asterisk-1.4.22-chan-sip-nullp.patch uploaded by tweety (license
	  608) ........

2008-12-15 18:09 +0000 [r164349]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c: When querying for the structure of the CDR
	  table, remove the schema, if it exists. (Closes issue #14058)

2008-12-15 17:24 +0000 [r164312]  Joshua Colp <jcolp@digium.com>

	* main/file.c: Use ast_seekstream to return the file stream back to
	  the beginning instead of directly seeking to zero. This is
	  because some audio formats have headers at the front that need to
	  be skipped, which will be done by the format module. (closes
	  issue #14079) Reported by: elguero

2008-12-15 17:21 +0000 [r164272-164309]  Russell Bryant <russell@digium.com>

	* channels/h323/ast_h323.cxx, include/asterisk/strings.h: Fix a
	  couple more build issues related to ast_str_opaque

	* pbx/pbx_dundi.c: When a reload is issued, always process the
	  configuration for dundi.conf. The reason is that a reload can be
	  used to refresh DNS lookups for defined peers. Even if the config
	  file hasn't changed, we want to process it for that purpose.
	  (closes issue #13776) Reported by: kombjuder

2008-12-15 16:16 +0000 [r164268-164270]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix a compile warning and a logic error that
	  could have been bad for non-realtime queues

	* apps/app_queue.c: Fix up a few issues with regards to queues *
	  Fix reference counting used in the __queues_show function * Add
	  code to be sure that the "queue show" command does not print
	  information for a realtime queue which has been deleted from the
	  backend * Add a missing unref to the realtime queue loading
	  function for the case where a queue is in the module's container
	  but has been deleted from the realtime backend (closes issue
	  #14033) Reported by: cristiandimache Patches: 14033.patch
	  uploaded by putnopvut (license 60) Tested by: cristiandimache

2008-12-15 15:41 +0000 [r164208-164257]  Joshua Colp <jcolp@digium.com>

	* configure, include/asterisk/autoconfig.h.in, apps/app_fax.c,
	  configure.ac: Make app_fax compatible with newer versions of
	  spandsp. This remains backwards compatible with earlier versions
	  though so do not fret. (closes issue #14073) Reported by:
	  seandarcy

	* main/utils.c: Update to work with new ast_str changes.

2008-12-15 14:40 +0000 [r164202-164203]  Russell Bryant <russell@digium.com>

	* main/channel.c, /, main/features.c: Merged revisions 164201 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r164201 | russell | 2008-12-15 08:31:37 -0600 (Mon, 15 Dec 2008)
	  | 31 lines Handle a case where a call can be bridged to a channel
	  that is still ringing. The issue that was reported was about a
	  case where a RINGING channel got redirected to an extension to
	  pick up a call from parking. Once the parked call got taken out
	  of parking, it heard silence until the other side answered.
	  Ideally, the caller that was parked would get a ringing
	  indication. This patch fixes this case so that the caller
	  receives ringback once it comes out of parking until the other
	  side answers. The fixes are: - Make sure we remember that a
	  channel was an outgoing channel when doing a masquerade. This
	  prevents an erroneous ast_answer() call on the channel, which
	  causes a bogus 200 OK to be sent in the case of SIP. - Add some
	  additional comments to explain related parts of code. - Update
	  the handling of the ast_channel visible_indication field. Storing
	  values that are not stateful is pointless. Control frames that
	  are events or commands should be ignored. - When a bridge first
	  starts, check to see if the peer channel needs to be given
	  ringing indication because the calling side is still ringing. -
	  Rework ast_indicate_data() a bit for the sake of readability.
	  (closes issue #13747) Reported by: davidw Tested by: russell
	  Review: http://reviewboard.digium.com/r/90/ ........

	* apps/app_jack.c: Fix build WRT ast_str_opaque

2008-12-14 18:16 +0000 [r164168]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/strings.h: Don't pass a negative to an unsigned
	  type and expect things to work correctly.

2008-12-14 15:26 +0000 [r164054-164137]  Sean Bright <sean.bright@gmail.com>

	* doc/tex/cdrdriver.tex: Use a \picture instead of ASCII art.

	* res/snmp/agent.c: Use ast_str_strlen() instead of recalculating
	  the string length.

2008-12-13 13:26 +0000 [r164028]  Michiel van Baak <michiel@vanbaak.info>

	* res/snmp/agent.c: nuke another use of the ast_str internals.

2008-12-13 08:36 +0000 [r163991]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_sqlite3_custom.c, apps/app_meetme.c,
	  funcs/func_strings.c, utils/hashtest.c, cdr/cdr_adaptive_odbc.c,
	  main/utils.c, apps/app_chanisavail.c, include/asterisk/tcptls.h,
	  cdr/cdr_pgsql.c, res/res_http_post.c, apps/app_followme.c,
	  res/res_config_sqlite.c, main/config.c, main/cli.c, main/cdr.c,
	  channels/chan_dahdi.c, res/res_config_odbc.c, main/manager.c,
	  configure, funcs/func_odbc.c, res/res_agi.c, apps/app_dumpchan.c,
	  main/logger.c, main/http.c, main/app.c, apps/app_externalivr.c,
	  res/res_config_ldap.c, include/asterisk/threadstorage.h,
	  cdr/cdr_manager.c, res/res_clialiases.c, utils/refcounter.c,
	  res/res_config_pgsql.c, main/strings.c (added), main/pbx.c,
	  channels/chan_sip.c, main/Makefile, main/translate.c,
	  include/asterisk/cdr.h, apps/app_queue.c, channels/iax2-parser.c,
	  funcs/func_realtime.c, utils/Makefile, res/res_config_curl.c,
	  main/tcptls.c, include/asterisk/app.h, funcs/func_curl.c,
	  utils/hashtest2.c, include/asterisk/strings.h,
	  include/asterisk/pbx.h, main/asterisk.c, main/xmldoc.c,
	  apps/app_voicemail.c, utils/check_expr.c: Merge ast_str_opaque
	  branch (discontinue usage of ast_str internals)

2008-12-13 03:03 +0000 [r163951-163952]  Sean Bright <sean.bright@gmail.com>

	* doc/tex/asterisk.tex: This shouldn't have gotten commited. We
	  might want to generate this into a separate file instead of the
	  version controlled one.

	* doc/tex/qos.tex, doc/tex/asterisk.tex: Use actual tables instead
	  of ASCII art ones.

2008-12-13 00:59 +0000 [r163912]  Joshua Colp <jcolp@digium.com>

	* apps/app_chanspy.c: Only detach and destroy the whisper
	  audiohooks if they are actually in use.

2008-12-12 23:48 +0000 [r163873]  Terry Wilson <twilson@digium.com>

	* apps/app_queue.c: When using realtime queues, app_queue wasn't
	  updating the strategy if it was changed in the realtime backend.
	  This patch resolves the issue for almost all situations. It is
	  currently not supported to switch to the linear strategy via
	  realtime since the ao2_container for members will have been set
	  to have multiple buckets and therefore the members would be
	  unordered. (closes issue #14034) Reported by: cristiandimache
	  Tested by: otherwiseguy, cristiandimache

2008-12-12 23:06 +0000 [r163828]  Russell Bryant <russell@digium.com>

	* res/res_clioriginate.c: Add a note to indicate why this only
	  supports one channel for now.

2008-12-12 22:04 +0000 [r163762]  Tilghman Lesher <tlesher@digium.com>

	* main/editline/read.c, /, main/asterisk.c: Merged revisions 163761
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163761 | tilghman | 2008-12-12 16:03:10 -0600 (Fri, 12 Dec 2008)
	  | 7 lines Simple fix for Ctrl-C not immediately exiting Asterisk,
	  but also add a pointer inside editline to look back to
	  asterisk.c, so others don't spend as much time as I did looking
	  (in the wrong place) for the appropriate function. Reported by:
	  ZX81, via the #asterisk-users channel Fixed by: me (license 14)
	  ........

2008-12-12 20:12 +0000 [r163716]  Russell Bryant <russell@digium.com>

	* CHANGES, res/res_clioriginate.c: Add a new CLI command, "channel
	  redirect", which is similar in operation to AMI Redirect. Review:
	  http://reviewboard.digium.com/r/89/

2008-12-12 19:16 +0000 [r163675]  Steve Murphy <murf@digium.com>

	* channels/chan_dahdi.c: demote always-appearing debug message (for
	  certain boards) to ast_debug lev 3 msg instead

2008-12-12 18:45 +0000 [r163642-163670]  Russell Bryant <russell@digium.com>

	* main/tcptls.c, channels/chan_sip.c: Rename a number of
	  tcptls_session variables. There are no functional changes here.
	  The name "ser" was used in a lot of places. However, it is a
	  relic from when the struct was a server_instance, not a
	  session_instance. It was renamed since it represents both a
	  server or client connection.

	* channels/chan_sip.c: Fix a small race condition in
	  sip_tcp_locate(). We must increase the reference count on the
	  tcptls_session _before_ unlocking the thread list.

	* channels/chan_sip.c: Resolve crashes when using SIP TCP/TLS with
	  qualify. The problem was a reference count error on the
	  tcptls_session structure. (closes issue #13989) Reported by:
	  Nugget

2008-12-12 18:17 +0000 [r163629]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: When a device registers we need to unlink
	  them (if linked) from the peers_by_ip container and link them
	  back in since their IP address has changed. This would have
	  manifested itself if you configured a new device (as type=peer),
	  registered, and then tried to place a call from the device. Since
	  the peer was not linked into the peers_by_ip container it would
	  have never been found. (closes issue #13811) Reported by: pj

2008-12-12 17:22 +0000 [r163582-163612]  Michiel van Baak <michiel@vanbaak.info>

	* res/res_monitor.c: Document default Monitor file location.
	  (closes issue #14065) Reported by: kshumard Patches:
	  res_monitor.documentation.patch.txt uploaded by kshumard (license
	  92)

	* channels/chan_skinny.c: Fix codec capability setup in chan_skinny
	  Behaviour now is that general codec config flows to default_line
	  and default_device. [devices] stuff amends default_device and
	  similar for [lines]. These are copied to individual device and
	  line as they are created. Added confcapability and confprefs for
	  the configured stuff which doesn't change as device and so on are
	  connected. prefs are based on line prefs if they exist, else the
	  device prefs are used (prefs identifies codec order). (closes
	  issue #13806) Reported by: pj Patches: codecs.diff uploaded by
	  wedhorn (license 30) Tested by: pj and me

2008-12-12 16:55 +0000 [r163579]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, channels/chan_sip.c: Since chan_sip is callback
	  devicestate driven do not pass in actual states, pass in unknown
	  so we get asked. Additionally do not pass in an actual device
	  state value in ast_setstate since the channel may be callback
	  driven. (closes issue #13525) Reported by: pj

2008-12-12 15:10 +0000 [r163516]  Doug Bailey <dbailey@digium.com>

	* configs/phoneprov.conf.sample: Add internationalization to sample
	  configuration file

2008-12-12 14:44 +0000 [r163449-163512]  Russell Bryant <russell@digium.com>

	* /, pbx/pbx_dundi.c: Merged revisions 163511 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163511 | russell | 2008-12-12 08:40:31 -0600 (Fri, 12 Dec 2008)
	  | 5 lines Specify uint32_t for variables storing a CRC32 so that
	  it is actually 32 bits on 64-bit machines, as well. (inspired by
	  issue #13879) ........

	* main/channel.c, main/autoservice.c, /,
	  include/asterisk/channel.h: Merged revisions 163448 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r163448 | russell | 2008-12-12 07:44:08 -0600 (Fri, 12
	  Dec 2008) | 26 lines Resolve issues that could cause DTMF to be
	  processed out of order. These changes come from
	  team/russell/issue_12658 1) Change autoservice to put digits on
	  the head of the channel's frame readq instead of the tail. If
	  there were frames on the readq that autoservice had not yet read,
	  the previous code would have resulted in out of order processing.
	  This required a new API call to queue a frame to the head of the
	  queue instead of the tail. 2) Change up the processing of DTMF in
	  ast_read(). Some of the problems were the result of having two
	  sources of pending DTMF frames. There was the dtmfq and the more
	  generic readq. Both were used for pending DTMF in various
	  scenarios. Simplifying things to only use the frame readq avoids
	  some of the problems. 3) Fix a bug where a DTMF END frame could
	  get passed through when it shouldn't have. If code set
	  END_DTMF_ONLY in the middle of digit emulation, and a digit
	  arrived before emulation was complete, digits would get processed
	  out of order. (closes issue #12658) Reported by: dimas Tested by:
	  russell, file Review: http://reviewboard.digium.com/r/85/
	  ........

2008-12-11 23:38 +0000 [r163384]  Tilghman Lesher <tlesher@digium.com>

	* /, main/asterisk.c: Merged revisions 163383 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163383 | tilghman | 2008-12-11 17:35:55 -0600 (Thu, 11 Dec 2008)
	  | 9 lines When a Ctrl-C or Ctrl-D ends a remote console, on
	  certain shells, the terminal is messed up. By intercepting those
	  events with a signal handler in the remote console, we can avoid
	  those issues. (closes issue #13464) Reported by: tzafrir Patches:
	  20081110__bug13464.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: blitzrage ........

2008-12-11 22:49 +0000 [r163317]  Matthew Nicholson <mnicholson@digium.com>

	* /, pbx/pbx_dundi.c: Merged revisions 163316 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163316 | mnicholson | 2008-12-11 16:44:31 -0600 (Thu, 11 Dec
	  2008) | 9 lines Clean up the dundi cache every 5 minutes. (closes
	  issue #13819) Reported by: adomjan Patches:
	  pbx_dundi.c-clearcache.patch uploaded by adomjan (license 487)
	  dundi_clearecache3.diff uploaded by mnicholson (license 96)
	  Tested by: adomjan ........

2008-12-11 21:48 +0000 [r163241-163254]  Russell Bryant <russell@digium.com>

	* /, funcs/func_strings.c, funcs/func_cut.c: Merged revisions
	  163253 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163253 | russell | 2008-12-11 15:46:29 -0600 (Thu, 11 Dec 2008)
	  | 8 lines Fix some observed slowdowns in dialplan processing. The
	  change is to remove autoservice usage from dialplan functions
	  that do not need it because they do not perform operations that
	  potentially block. (closes issue #13940) Reported by: tbelder
	  ........

	* res/res_timing_pthread.c: Fix a problem where continuous mode
	  will get inadvertently get turned off if set_rate() is used while
	  continuous mode was already turned on. (closes issue #13738)
	  Reported by: smurfix Patches: res.patch.fixed uploaded by smurfix
	  (license 547)

2008-12-11 20:57 +0000 [r163198-163213]  Mark Michelson <mmichelson@digium.com>

	* configs/voicemail.conf.sample, apps/app_voicemail.c: Add an
	  option to voicemail.conf to allow urgent messages to be forwarded
	  as not urgent. (closes issue #14063) Reported by: jaroth Patches:
	  urgfwd_v2.patch uploaded by jaroth (license 50)

	* main/features.c: Add an appropriate goto if ast_call fails

2008-12-11 20:07 +0000 [r163171]  Russell Bryant <russell@digium.com>

	* main/channel.c: Fix the "failed" extension for outgoing calls.
	  The conversion to use ast_check_hangup() everywhere instead of
	  checking the softhangup flag directly introduced this problem.
	  The issue is that ast_check_hangup() checked for tech_pvt to be
	  NULL. Unfortunately, this will be NULL is some valid
	  circumstances, such as with a dummy channel. The fix is simple.
	  Don't check tech_pvt. It's pointless, because the code path that
	  sets this to NULL is when the channel hangup callback gets
	  called. This happens inside of ast_hangup(), which is the same
	  function responsible for freeing the channel. Any code calling
	  ast_check_hangup() better not be calling it after that point, and
	  if so, we have a bigger problem at hand. (closes issue #14035)
	  Reported by: erogoza

2008-12-11 20:02 +0000 [r163168]  Tilghman Lesher <tlesher@digium.com>

	* configure, configure.ac: Sometimes even Linux needs -lm to link
	  libtonezone, such as when libtonezone is compiled statically.
	  (closes issue #13887) Reported by: tzafrir

2008-12-11 19:40 +0000 [r163166]  Mark Michelson <mmichelson@digium.com>

	* main/features.c: Reduce indentation level of
	  ast_feature_request_and_dial

2008-12-11 17:06 +0000 [r163094]  Russell Bryant <russell@digium.com>

	* /, main/features.c: Merged revisions 163092 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163092 | russell | 2008-12-11 10:54:51 -0600 (Thu, 11 Dec 2008)
	  | 11 lines Fix an issue that made it so you could only have a
	  single caller executing a custom feature at a time. This was
	  especially problematic when custom features ran for any
	  appreciable amount of time. The fix turned out to be quite
	  simple. The dynamic features are now stored in a read/write list
	  instead of a list using a mutex. (closes issue #13478) Reported
	  by: neutrino88 Fix suggested by file ........

2008-12-11 16:52 +0000 [r163089]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_agi.c: Merged revisions 163088 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163088 | tilghman | 2008-12-11 10:51:27 -0600 (Thu, 11 Dec 2008)
	  | 6 lines Don't wait forever, if there's a specified recording
	  timeout. (closes issue #13885) Reported by: bamby Patches:
	  res_agi.c.patch uploaded by bamby (license 430) ........

2008-12-11 16:47 +0000 [r163081-163085]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_queue.c: Merged revisions 163084 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163084 | mmichelson | 2008-12-11 10:46:22 -0600 (Thu, 11 Dec
	  2008) | 4 lines Revert this cast to long. Using time_t here
	  causes build failures on a FreeBSD 32-bit build. ........

	* /, apps/app_queue.c: Merged revisions 163080 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r163080 | mmichelson | 2008-12-11 10:24:43 -0600 (Thu, 11 Dec
	  2008) | 14 lines Fix a potential crash due to unsafe datastore
	  handling. This patch also contains a conversion from using long
	  to time_t for representing times for a queue, as well as some
	  whitespace fixes. (closes issue #14060) Reported by: nivek
	  Patches: datastore_fixup.patch.corrected uploaded by nivek
	  (license 636) with slight modification from me Tested by: nivek
	  ........

2008-12-11 15:40 +0000 [r163037]  Sean Bright <sean.bright@gmail.com>

	* doc/tex/qos.tex: Fix some of the grammar issues in
	  doc/tex/qos.tex. (closes issue #14049) Reported by: kshumard
	  Patches: doc.tex.qos.tex.patch uploaded by kshumard (license 92)
	  (Slight modifications by seanbright)

2008-12-11 15:05 +0000 [r162997]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: When a device registers to use it is
	  entirely possible that they may be in use, so tell the core that
	  we don't know the devstate and have it ask us for it. (closes
	  issue #13525) Reported by: pj

2008-12-10 23:01 +0000 [r162930]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c: Previously missing line, now the substitution works
	  correctly

2008-12-10 22:53 +0000 [r162927]  Jeff Peeler <jpeeler@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 162926 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r162926 | jpeeler | 2008-12-10 16:52:51 -0600 (Wed, 10
	  Dec 2008) | 3 lines Oops, inverted logic for a strcasecmp check.
	  Pointed out by mmichelson, thanks! ........

2008-12-10 22:48 +0000 [r162923]  Joshua Colp <jcolp@digium.com>

	* res/res_clialiases.c: Fix reloads of aliased CLI commands. Due to
	  changes done to turn it into a single memory allocation we can't
	  just use the existing CLI alias structure. We have to destroy all
	  existing ones and then create new ones. (closes issue #14054)
	  Reported by: pj

2008-12-10 22:48 +0000 [r162922]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c: Checking global variables here actually overwrote the
	  previous substitution by channel variables, and in any case, was
	  redundant; pbx_substitute_variables_helper ALREADY does
	  substitution for global variables. (closes issue #13327) Reported
	  by: pj

2008-12-10 22:11 +0000 [r162891]  Jeff Peeler <jpeeler@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 162874 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r162874 | jpeeler | 2008-12-10 16:04:18 -0600 (Wed, 10
	  Dec 2008) | 5 lines (closes issue #13229) Reported by:
	  clegall_proformatique Ensure that moh_generate does not return
	  prematurely before local_ast_moh_stop is called. Also, the sleep
	  in mp3_spawn now only occurs for http locations since it seems to
	  have been added originally only for failing media streams.
	  ........

2008-12-10 19:02 +0000 [r162739-162805]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 162804 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162804 | file | 2008-12-10 15:01:17 -0400 (Wed, 10 Dec 2008) | 6
	  lines Fix subscription based MWI up a bit. We only want to put
	  sip: at the beginning of the URI if it is not already there and
	  revert code to ignore destination check if subscribing for MWI.
	  (closes issue #12560) Reported by: vsauer Patches: patch001.diff
	  uploaded by ramonpeek (license 266) ........

	* /, channels/chan_sip.c: Merged revisions 162738 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162738 | file | 2008-12-10 13:50:43 -0400 (Wed, 10 Dec 2008) | 6
	  lines When a SIP peer unregisters set the expiry time back to 0
	  so that the 200 OK contains an expires of 0. (closes issue
	  #13599) Reported by: hjourdain Patches: chan_sip.c.diff uploaded
	  by hjourdain (license 583) ........

2008-12-10 17:09 +0000 [r162687]  Michiel van Baak <michiel@vanbaak.info>

	* include/asterisk.h, main/asterisk.c, main/cli.c: add tab
	  completion for 'core set debug X filename.c' (closes issue
	  #13969) Reported by: jtodd Patches: 20081205__bug13969.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: mvanbaak, eliel

2008-12-10 16:39 +0000 [r162664-162667]  Mark Michelson <mmichelson@digium.com>

	* doc/tex/misdn.tex, /: Merged revisions 162659 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162659 | mmichelson | 2008-12-10 10:10:25 -0600 (Wed, 10 Dec
	  2008) | 8 lines Add missing documentation to misdn.txt (closes
	  issue #14052) Reported by: festr Patches: misdn.txt.patch
	  uploaded by festr (license 443) ........

	* /, channels/chan_sip.c: Merged revisions 162663 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162663 | mmichelson | 2008-12-10 10:24:56 -0600 (Wed, 10 Dec
	  2008) | 11 lines Revert fix for issue 13570. It has caused more
	  problems than it helped to fix. (closes issue #13783) Reported
	  by: navkumar (closes issue #14025) Reported by: ffs ........

2008-12-10 16:11 +0000 [r162619-162660]  Joshua Colp <jcolp@digium.com>

	* res/res_http_post.c: FreeBSD also needs libgen.h (closes issue
	  #14051) Reported by: ys Patches: res_http_post.c.diff uploaded by
	  ys (license 281)

	* /, main/rtp.c: Merged revisions 162653 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162653 | file | 2008-12-10 12:05:29 -0400 (Wed, 10 Dec 2008) | 6
	  lines Increment the sequence number on the end packets for
	  RFC2833. After reading the RFC some more and doing some testing I
	  agree with this change. (closes issue #12983) Reported by: vt
	  Patches: dtmf_inc_seqnum_on_end_pkts.diff uploaded by vt (license
	  520) ........

	* channels/chan_sip.c: When transmitting a register set the socket
	  port to the local one for the transport being used, not the port
	  for the remote server. (closes issue #13633) Reported by:
	  performer

2008-12-10 11:34 +0000 [r162583]  Michiel van Baak <michiel@vanbaak.info>

	* res/snmp/agent.c: Make res_snmp.so compile on OpenBSD. OpenBSD
	  uses an old version of gcc which throws an error if you use a
	  macro that's not #defined

2008-12-10 01:09 +0000 [r162542]  Joshua Colp <jcolp@digium.com>

	* doc/janitor-projects.txt, channels/iax2-parser.c,
	  apps/app_voicemail.c: Finish conversion to using ARRAY_LEN and
	  remove it as a janitor project. (closes issue #14032) Reported
	  by: bkruse Patches: 14032.patch uploaded by bkruse (license 132)

2008-12-09 23:41 +0000 [r162488]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/stringfields.h: it does help if the compiler
	  attribute syntax is correct

2008-12-09 23:10 +0000 [r162466]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 162463 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r162463 | tilghman | 2008-12-09 17:08:53 -0600 (Tue, 09
	  Dec 2008) | 2 lines Oops, should be "tz", not "zonetag". ........

2008-12-09 22:38 +0000 [r162414-162418]  Russell Bryant <russell@digium.com>

	* include/asterisk/doxyref.h, contrib/asterisk-ng-doxygen,
	  main/asterisk.c: Add some additional Asterisk project developer
	  documentation. After the nightly update of the documentation on
	  asterisk.org, I'll post an update to asterisk-dev with a pointer
	  to the changes. This covers some release branch and commit policy
	  information. None of this should be a surprise, since it's just
	  documenting what we have already been doing.

	* include/asterisk/utils.h, /, main/utils.c, main/asterisk.c:
	  Merged revisions 162413 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162413 | russell | 2008-12-09 16:17:39 -0600 (Tue, 09 Dec 2008)
	  | 8 lines Remove the test_for_thread_safety() function
	  completely. The test is not valid. Besides, if we actually
	  suspected that recursive mutexes were not working, we would get a
	  ton of LOG_ERROR messages when DEBUG_THREADS is turned on.
	  (inspired by a discussion on the asterisk-dev list) ........

2008-12-09 21:57 +0000 [r162355]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 162348 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r162348 | tilghman | 2008-12-09 15:53:25 -0600 (Tue, 09
	  Dec 2008) | 4 lines We appear to have documented tz= in the
	  [general] section of voicemail.conf, without actually having
	  implemented it. Oops. (Reported by Olivier on the -users list)
	  ........

2008-12-09 21:16 +0000 [r162342]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_directed_pickup.c: Merged revisions 162341 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162341 | file | 2008-12-09 17:14:29 -0400 (Tue, 09 Dec 2008) | 4
	  lines Add 'down' as a valid state for directed call pickup. This
	  creeps up when we receive session progress when dialing a device
	  and not ringing. (closes issue #14005) Reported by: ddl ........

2008-12-09 20:59 +0000 [r162291]  Russell Bryant <russell@digium.com>

	* /, apps/app_meetme.c: Merged revisions 162286 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162286 | russell | 2008-12-09 14:57:35 -0600 (Tue, 09 Dec 2008)
	  | 9 lines Fix an issue where callers on an incoming call on an
	  SLA trunk would not hear ringback. We need to make sure that we
	  don't start writing audio to the trunk channel until we're
	  actually ready to answer it. Otherwise, the channel driver will
	  treat it as inband progress, even though all they are getting is
	  silence. (closes issue #12471) Reported by: mthomasslo ........

2008-12-09 20:46 +0000 [r162275]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_festival.c: Merged revisions 162273 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162273 | file | 2008-12-09 16:44:32 -0400 (Tue, 09 Dec 2008) | 4
	  lines Fix double declaration of 'x' on the PPC platform. (closes
	  issue #14038) Reported by: ffloimair ........

2008-12-09 20:40 +0000 [r162271]  Steve Murphy <murf@digium.com>

	* /, res/ael/ael_lex.c, res/ael/ael.flex: Merged revisions 162264
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162264 | murf | 2008-12-09 13:20:54 -0700 (Tue, 09 Dec 2008) | 1
	  line In discussion with seanbright on #asterisk-dev, I have added
	  a default rule, and an option to suppress the default rule from
	  being generated in the flex output, for the sake of those OS's
	  where they didn't tweak flex's ECHO macro, and the compiler
	  doesn't like it. The regressions are OK with this. ........

2008-12-09 20:30 +0000 [r162266]  Mark Michelson <mmichelson@digium.com>

	* main/pbx.c, /: Merged revisions 162265 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162265 | mmichelson | 2008-12-09 14:28:44 -0600 (Tue, 09 Dec
	  2008) | 6 lines If we fail to start a thread for the pbx to run
	  in, we need to be sure to decrease the number of active calls on
	  the system. This fix may relate to ABE-1713, but it is not
	  certain yet. ........

2008-12-09 19:48 +0000 [r162197-162205]  Joshua Colp <jcolp@digium.com>

	* /, main/rtp.c: Merged revisions 162204 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162204 | file | 2008-12-09 15:47:07 -0400 (Tue, 09 Dec 2008) | 7
	  lines Make sure that the timestamp for DTMF is not the same as
	  the previous voice frame and do not send audio when transmitting
	  DTMF as this confuses some equipment. (closes issue #13209)
	  Reported by: ip-rob Patches: 13209.diff uploaded by file (license
	  11) Tested by: ip-rob, bujones ........

	* /, main/rtp.c: Merged revisions 162188 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162188 | file | 2008-12-09 15:06:14 -0400 (Tue, 09 Dec 2008) | 4
	  lines Take video into account when early bridging RTP. (closes
	  issue #13535) Reported by: davidw ........

2008-12-09 18:35 +0000 [r162079-162140]  Steve Murphy <murf@digium.com>

	* /, res/ael/ael_lex.c, res/ael/ael.flex: Merged revisions 162136
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162136 | murf | 2008-12-09 11:13:39 -0700 (Tue, 09 Dec 2008) | 1
	  line Previous fix used ast_malloc and ast_copy_string and messed
	  up the standalone stuff. Fixed. ........

	* res/ael/pval.c, /, include/asterisk/pval.h, res/ael/ael_lex.c,
	  res/ael/ael.flex: Merged revisions 162013 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162013 | murf | 2008-12-09 09:31:55 -0700 (Tue, 09 Dec 2008) |
	  45 lines (closes issue #14019) Reported by: ckjohnsonme Patches:
	  14019.diff uploaded by murf (license 17) Tested by: ckjohnsonme,
	  murf This crash was the result of a few small errors that would
	  combine in 64-bit land to result in a crash. 32-bit land might
	  have seen these combine to mysteriously drop the args to an
	  application call, in certain circumstances. Also, in trying to
	  find this bug, I spotted a situation in the flex input, where, in
	  passing back a 'word' to the parser, it would allocate a buffer
	  larger than necessary. I changed the usage in such situations, so
	  that strdup was not used, but rather, an ast_malloc, followed by
	  ast_copy_string. I removed a field from the pval struct, in u2,
	  that was never getting used, and set in one spot in the code. I
	  believe it was an artifact of a previous fix to make switch cases
	  work invisibly with extens. And, for goto's I removed a '!' from
	  before a strcmp, that has been there since the initial merging of
	  AEL2, that might prevent the proper target of a goto from being
	  found. This was pretty harmless on its own, as it would just
	  louse up a consistency check for users. Many thanks to
	  ckjohnsonme for providing a simplified and complete set of
	  information about the bug, that helped considerably in finding
	  and fixing the problem. Now, to get aelparse up and running again
	  in trunk, and out of its "horribly broken" state, so I can run
	  the regression suite! ........

2008-12-09 16:47 +0000 [r161951-162016]  Russell Bryant <russell@digium.com>

	* /, apps/app_disa.c: Merged revisions 162014 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r162014 | russell | 2008-12-09 10:46:53 -0600 (Tue, 09 Dec 2008)
	  | 5 lines Allow DISA to handle extensions that start with #.
	  (closes issue #13330) Reported by: jcovert ........

	* /, main/app.c: Merged revisions 161948 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r161948 | russell | 2008-12-09 08:52:25 -0600 (Tue, 09 Dec 2008)
	  | 15 lines Fix a problem with GROUP() settings on a masquerade.
	  The previous code carried over group settings from the old
	  channel to the new one. However, it did nothing with the group
	  settings that were already on the new channel. This patch removes
	  all group settings that already existed on the new channel. I
	  have a more complicated version of this patch which addresses
	  only the most blatant problem with this, which is that a channel
	  can end up with multiple group settings in the same category.
	  However, I could not think of a use case for keeping any of the
	  group settings from the old channel, so I went this route for
	  now. (closes AST-152) ........

2008-12-09 14:49 +0000 [r161947]  Eliel C. Sardanons <eliels@gmail.com>

	* funcs/func_odbc.c: Avoid allocating memory for a thread that
	  don't need it. Also, this memory was not being freed until the
	  main thread ends. (That is never). (closes issue #14040) Reported
	  by: eliel Patches: func_odbc.c.patch uploaded by eliel (license
	  64)

2008-12-08 23:04 +0000 [r161911]  Brandon Kruse <bkruse@digium.com>

	* main/pbx.c: Note that the recently changed waittime parameter is
	  in milliseconds.

2008-12-08 21:41 +0000 [r161830-161869]  Joshua Colp <jcolp@digium.com>

	* formats/format_pcm.c: Add alw as a valid file extension for alaw
	  and ulw as a valid file extension for ulaw. (closes issue #14001)
	  Reported by: henrikw Patches: alw.diff uploaded by henrikw
	  (license 627)

	* contrib/scripts/autosupport.8, contrib/scripts/autosupport:
	  Update autosupport script with a few changes.

2008-12-08 18:49 +0000 [r161790]  Tilghman Lesher <tlesher@digium.com>

	* main/manager.c: Allocate enough space initially for the message.
	  (closes issue #14027) Reported by: junky Patches: M14027.diff
	  uploaded by junky (license 177)

2008-12-08 18:47 +0000 [r161726-161787]  Joshua Colp <jcolp@digium.com>

	* main/pbx.c: Fix a regression introduced when the PBX timeouts
	  were converted to milliseconds. collect_digits now gets
	  milliseconds fed to it, not seconds. (closes issue #14012)
	  Reported by: dveiga Patches: 14012.patch uploaded by bkruse
	  (license 132)

	* /, channels/chan_sip.c: Merged revisions 161725 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r161725 | file | 2008-12-08 13:52:10 -0400 (Mon, 08 Dec 2008) | 6
	  lines Make the usereqphone option work again. (closes issue
	  #13474) Reported by: mmaguire Patches: 20080912_bug13474.diff
	  uploaded by mmaguire (license 571) ........

2008-12-08 17:23 +0000 [r161721]  Matthew Nicholson <mnicholson@digium.com>

	* channels/chan_sip.c: Fix a crash that can occur on a transfer in
	  chan_sip when attempting to collect rtp stats. (closes issue
	  #13956) Reported by: chris-mac Tested by: chris-mac

2008-12-08 16:02 +0000 [r161679]  Terry Wilson <twilson@digium.com>

	* channels/chan_sip.c, CHANGES: Add the ability to play a courtesy
	  tone to the transfer target in a native SIP attended transfer by
	  setting the variable ATTENEDED_TRANSFER_COMPLETE_SOUND.

2008-12-08 04:23 +0000 [r161571-161637]  Eliel C. Sardanons <eliels@gmail.com>

	* main/xmldoc.c: - Fix a leak while printing an argument
	  description. - Avoid printing the name of an argument in the
	  [Arguments] tag if there is no description for that argument.

	* apps/app_voicemail.c: Add voicemail related applications and
	  functions XML documentation: applications: - VoiceMail() -
	  VoiceMailMain() - MailboxExists() - VMAuthenticate() functions: -
	  MAILBOX_EXISTS()

	* apps/app_sms.c: Introduce SMS() application XML documentation.

2008-12-06 21:18 +0000 [r161536]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_speech_utils.c: Move Speech* applications and functions
	  documentation to XML.

2008-12-05 23:24 +0000 [r161493]  Mark Michelson <mmichelson@digium.com>

	* apps/app_stack.c: If the autoloop flag is set on a channel, then
	  we need to add 1 to the priority when checking if the extension
	  exists. Otherwise, gosubs will fail. This was discovered when
	  investigating an asterisk-users mailing list post made by Gary
	  Hawkins.

2008-12-05 21:08 +0000 [r161349-161427]  Sean Bright <sean.bright@gmail.com>

	* /, include/asterisk/astobj2.h, main/astobj2.c: Merged revisions
	  161426 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r161426 | seanbright | 2008-12-05 16:02:20 -0500
	  (Fri, 05 Dec 2008) | 15 lines Merged revisions 161421 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r161421 | seanbright | 2008-12-05 15:50:23 -0500 (Fri, 05 Dec
	  2008) | 8 lines Fix build errors on FreeBSD (uint -> unsigned
	  int). (closes issue #14006) Reported by: alphaque Patches:
	  astobj2.h-patch uploaded by alphaque (license 259) (Slightly
	  modified by seanbright) ........ ................

	* apps/app_voicemail.c: Use ast_free() instead of free(), pointed
	  out by eliel on IRC.

	* apps/app_voicemail.c: When using IMAP_STORAGE, it's important to
	  convert bare newlines (\n) in emailbody and pagerbody to CR-LF so
	  that the IMAP server doesn't spit out an error. This was
	  informally reported on #asterisk-dev a few weeks ago. Reviewed by
	  Mark M. on IRC.

2008-12-05 14:16 +0000 [r161252-161288]  Russell Bryant <russell@digium.com>

	* main/pbx.c, /: Merged revisions 161287 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r161287 | russell | 2008-12-05 08:12:14 -0600 (Fri, 05 Dec 2008)
	  | 2 lines Fix a NULL format string warning found by buildbot.
	  ........

	* apps/app_minivm.c: Resolve a compiler warning from buildbot about
	  a NULL format string.

2008-12-05 10:31 +0000 [r161218]  Eliel C. Sardanons <eliels@gmail.com>

	* main/udptl.c, main/frame.c, res/res_musiconhold.c,
	  channels/chan_iax2.c, res/res_jabber.c, res/res_config_sqlite.c,
	  main/config.c, main/cli.c, channels/chan_dahdi.c, main/manager.c,
	  channels/chan_skinny.c, res/res_agi.c, main/features.c,
	  apps/app_minivm.c, pbx/pbx_ael.c, main/logger.c, main/http.c,
	  res/res_realtime.c, channels/chan_alsa.c, res/res_config_ldap.c,
	  apps/app_rpt.c, main/db.c, res/res_config_pgsql.c, main/pbx.c,
	  channels/chan_sip.c, main/translate.c, channels/chan_agent.c,
	  res/res_convert.c, res/res_crypto.c, apps/app_queue.c,
	  channels/chan_oss.c, apps/app_playback.c,
	  channels/chan_usbradio.c, main/file.c, main/astmm.c,
	  pbx/pbx_dundi.c, res/res_indications.c, pbx/pbx_config.c,
	  apps/app_mixmonitor.c, res/res_odbc.c, main/asterisk.c,
	  apps/app_voicemail.c: Janitor, use ARRAY_LEN() when possible.
	  (closes issue #13990) Reported by: eliel Patches: array_len.diff
	  uploaded by eliel (license 64)

2008-12-05 05:41 +0000 [r161181]  Tilghman Lesher <tlesher@digium.com>

	* main/config.c: The first file should have a blank config filename
	  in the structure, so that when a save occurs to a different
	  filename, everything goes to the alternate filename, instead of
	  appending to the original. This is important for the AMI command
	  UpdateConfig. (closes issue #13301) Reported by: trevo Patches:
	  20081113__bug13301.diff.txt uploaded by Corydon76 (license 14)
	  20081113__bug13301__1.6.0.diff.txt uploaded by Corydon76 (license
	  14) Tested by: Corydon76, blitzrage

2008-12-05 02:47 +0000 [r161147]  Sean Bright <sean.bright@gmail.com>

	* apps/app_voicemail.c: Check the return value of fread/fwrite so
	  the compiler doesn't complain. Only a problem when IMAP_STORAGE
	  is enabled.

2008-12-04 23:00 +0000 [r161115]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: If
	  'faxdetect=yes' in sip.conf, switch to a 'fax' extension (if it
	  exists) after T38 is negotiated. Terry Wilson created the
	  original patch for this functionality, which I slightly modified
	  and added the faxdetect=yes|no configuration option. This patch
	  is only for T38 fax detection and does not do anything for G711
	  over SIP fax detection. By default, this option is disabled.
	  Reviewboard: http://reviewboard.digium.com/r/69/ This
	  functionality is for issue AST-140.

2008-12-04 19:31 +0000 [r161077]  Eliel C. Sardanons <eliels@gmail.com>

	* main/cli.c: Fix minor coding guidelines introduced with CLI
	  permissions.

2008-12-04 18:32 +0000 [r161014]  Jeff Peeler <jpeeler@digium.com>

	* /, main/rtp.c: Merged revisions 161013 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r161013 | jpeeler | 2008-12-04 12:30:41 -0600 (Thu, 04 Dec 2008)
	  | 9 lines (closes issue #13835) Reported by: matt_b Tested by:
	  jpeeler This mirrors a check that was present in ast_rtp_read to
	  also be in ast_rtp_raw_write to not schedule sending the receiver
	  report if the remote RTCP endpoint address isn't present in the
	  RTCP structure. Closes AST-142. ........

2008-12-04 16:45 +0000 [r160945]  Mark Michelson <mmichelson@digium.com>

	* /, main/callerid.c: Merged revisions 160943 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r160943 | mmichelson | 2008-12-04 10:44:18 -0600 (Thu, 04 Dec
	  2008) | 15 lines Fix a callerid parsing issue. If someone
	  formatted callerid like the following: "name <number>" (including
	  the quotation marks), then the parts would be parsed as name:
	  "name number: number This is because the closing quotation mark
	  was not discovered since the number and everything after was
	  parsed out of the string earlier. Now, there is a check to see if
	  the closing quote occurs after the number, so that we can know if
	  we should strip off the opening quote on the name. Closes AST-158
	  ........

2008-12-04 16:37 +0000 [r160938]  Michiel van Baak <michiel@vanbaak.info>

	* build_tools/cflags-devmode.xml, channels/chan_skinny.c: Add debug
	  flag so skinny debug will show information about packets. We dont
	  want to scare users with this, so we added a devmode compile flag
	  (closes issue #13952) Reported by: wedhorn Patches:
	  packetdebug3.diff uploaded by wedhorn (license 30) Tested by:
	  mvanbaak, wedhorn

2008-12-04 13:45 +0000 [r160896]  Eliel C. Sardanons <eliels@gmail.com>

	* res/res_agi.c: Added XML documentation for the following AGI
	  commands: - get option - get variable - hangup - noop

2008-12-04 01:36 +0000 [r160854-160856]  Richard Mudgett <rmudgett@digium.com>

	* funcs/func_callerid.c: Jcolp pointed out that num will also match
	  number

	* funcs/func_callerid.c: * Found a couple more places where
	  num/number needed to be done so 1.4 upgraders will not have
	  problems. * Added curly braces and minor tweaks.

2008-12-03 21:58 +0000 [r160791]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 160770 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r160770 | tilghman | 2008-12-03 15:54:07 -0600 (Wed, 03
	  Dec 2008) | 2 lines Some compilers warn on null format strings;
	  some don't (caught by buildbot) ........

2008-12-03 21:09 +0000 [r160760]  Steve Murphy <murf@digium.com>

	* /, funcs/func_callerid.c: Merged revisions 160703 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r160703 | murf | 2008-12-03 13:41:42 -0700 (Wed, 03 Dec
	  2008) | 11 lines (closes issue #13597) Reported by: john8675309
	  Patches: patch.13597 uploaded by murf (license 17) Tested by:
	  murf, john8675309 This patch causes the setcid func to update the
	  CDR clid after setting the channel field. I also notice that in
	  trunk, the num/number of 1.4 is left out; I decided to include
	  the option to use either in trunk, so as not to have 1.4
	  upgraders not to have problems. ........

2008-12-03 20:35 +0000 [r160699-160700]  Jason Parker <jparker@digium.com>

	* main/manager.c: Another place this is missing

	* main/manager.c: Fix typo when ListCategories returns none.
	  (closes issue #13994) Reported by: mika Patches:
	  ListCategoriesActionPatch.diff uploaded by mika (license 624)

2008-12-03 19:25 +0000 [r160663]  Eliel C. Sardanons <eliels@gmail.com>

	* channels/iax2-provision.c: - iax2-provision was not freeing
	  iax_templates structure when unloading the chan_iax2.so module. -
	  Move the code to start using the LIST macros. Review:
	  http://reviewboard.digium.com/r/72 (closes issue #13232) Reported
	  by: eliel Patches: iax2-provision.patch.txt uploaded by eliel
	  (license 64) (with minor changes pointed by Mark Michelson on
	  review board) Tested by: eliel

2008-12-03 18:37 +0000 [r160626]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, apps/app_queue.c, apps/app_stack.c: Add some
	  safety measures when using gosub, especially when using the
	  options for app_dial and app_queue to run a gosub when the call
	  is answered. * Check for the existence of the gosub target in
	  gosub_exec. If it is nonexistent, then this will cause errors
	  when we attempt to actually run the gosub, including a definite
	  memory leak and potential crashes. Return an error in this
	  situation * Check the return value of pbx_exec in app_dial and
	  app_queue before attempting to actually run the gosub routine. If
	  there was an error, we should not attempt to run the gosub. *
	  Change a '|' to a ',' in app_queue. * Add some extra curly braces
	  where they had been missing previously. (closes issue #13548)
	  Reported by: fiddur

2008-12-03 17:48 +0000 [r160562]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_minivm.c: - Add <variable /> tags when naming a channel
	  variable. - Add <filename /> tags when naming a filename. -
	  Simplify the xml formatting putting some enters.

2008-12-03 17:38 +0000 [r160559]  Tilghman Lesher <tlesher@digium.com>

	* pbx/pbx_spool.c, /: Merged revisions 160558 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r160558 | tilghman | 2008-12-03 11:34:34 -0600 (Wed, 03 Dec 2008)
	  | 7 lines If an entry is added to the directory during a scan
	  when another entry expires, then that new entry will not be
	  processed promptly, but must wait for either a future entry to
	  start or a current entry's retry to occur. If no other entries
	  exist in the directory (other than the new entries) when a bunch
	  expire, then the new entries must wait until another new entry is
	  added to be processed. This was a rather weird race condition,
	  really. Fixes AST-147. ........

2008-12-03 17:07 +0000 [r160555]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: When investigating issue #13548, I found that
	  gosub handling in app_queue was just completely wrong, mostly
	  because the channel operations being performed were being done on
	  the incorrect channel. With this set of changes, a gosub will
	  correctly run on the answering queue member's channel. There are
	  still crash issues which occur if there are dialplan syntax
	  errors, so I cannot yet close the referenced issue.

2008-12-03 17:01 +0000 [r160481-160552]  Tilghman Lesher <tlesher@digium.com>

	* pbx/pbx_spool.c, /: Merged revisions 160551 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r160551 | tilghman | 2008-12-03 10:58:34 -0600 (Wed, 03 Dec 2008)
	  | 4 lines Don't start scanning the directory until all modules
	  are loaded, because some required modules (channels, apps,
	  functions) may not yet be in memory yet. Fixes AST-149. ........

	* /, channels/chan_sip.c: Merged revisions 160480 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r160480 | tilghman | 2008-12-03 08:09:35 -0600 (Wed, 03 Dec 2008)
	  | 7 lines Jon Bonilla (Manwe) pointed out on the -dev list: "I
	  guess that having only ip-phones in mind is not a good approach.
	  Since it is possible to have a sip proxy connected to asterisk we
	  could receive a 407 (unauthorized) or 483 (too many hops) as
	  response and dialog ending would not be a good behavior." So
	  modified. ........

2008-12-03 11:01 +0000 [r160447]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_stack.c: - Avoid setting .synopsis and .syntax if we are
	  using XML documentation (or the xml documentation wont be
	  loaded). - Use <variable></variable> to refer to a dialplan
	  variable.

2008-12-02 18:48 +0000 [r160344-160346]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Info on LOCAL_PEEK function.

	* apps/app_stack.c: Add LOCAL_PEEK function, as requested by
	  lmadsen.

2008-12-02 18:04 +0000 [r160319-160333]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: remove duplicate comment that I
	  accidentally merged

	* channels/chan_dahdi.c: (closes issue #13786) Reported by: tzafrir
	  Readding DAHDI_CHECK_HOOKSTATE define that was removed in r134260
	  which fixes not being able to make outgoing calls on some FXO
	  adapters:
	  http://lists.digium.com/pipermail/asterisk-users/2008-November/thread.html#221553

2008-12-02 17:56 +0000 [r160208-160308]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 160297 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r160297 | tilghman | 2008-12-02 11:42:09 -0600 (Tue, 02 Dec 2008)
	  | 10 lines When the text does not match exactly (e.g. RTP/SAVP),
	  then the %n conversion fails, and the resulting integer is
	  garbage. Thus, we must initialize the integer and check it
	  afterwards for success. (closes issue #14000) Reported by: folke
	  Patches: asterisk-sipbg-sscanf-1.4.22.diff uploaded by folke
	  (license 626) asterisk-sipbg-sscanf-1.6.0.1.diff uploaded by
	  folke (license 626) asterisk-sipbg-sscanf-trunk-r159896.diff
	  uploaded by folke (license 626) ........

	* main/pbx.c, main/frame.c, /, channels/chan_features.c,
	  include/asterisk/stringfields.h, apps/app_voicemail.c,
	  main/cli.c: Merged revisions 160207 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r160207 | tilghman | 2008-12-01 18:25:16 -0600 (Mon, 01 Dec 2008)
	  | 3 lines Ensure that Asterisk builds with --enable-dev-mode,
	  even on the latest gcc and glibc. ........

2008-12-01 23:37 +0000 [r160170-160172]  Sean Bright <sean.bright@gmail.com>

	* main/manager.c, /: Merged revisions 159976 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r159976 | mvanbaak | 2008-12-01 11:08:36 -0500 (Mon, 01 Dec 2008)
	  | 3 lines Get rid of the useless format string and argument in
	  the Bogus/ manager channelname. Noted by kpfleming and name
	  Bogus/manager suggested by eliel ........

	* channels/chan_phone.c: Silence a build warning.
	  (chan_phone.c:810: warning: value computed is not used)

	* utils/smsq.c: Pay attention to the return value of system(), even
	  if we basically ignore it.

2008-12-01 21:23 +0000 [r160097]  Tilghman Lesher <tlesher@digium.com>

	* configure, configure.ac: Use AST_EXT_LIB_SETUP before using
	  AST_EXT_LIB_CHECK or bad things happen.

2008-12-01 18:52 +0000 [r160062]  Eliel C. Sardanons <eliels@gmail.com>

	* configs/cli_permissions.conf.sample (added), configure,
	  include/asterisk/autoconfig.h.in, configure.ac,
	  include/asterisk/cli.h, include/asterisk/_private.h, CHANGES,
	  main/asterisk.c, main/cli.c: Introduce CLI permissions. Based on
	  cli_permissions.conf configuration file, we are able to permit or
	  deny cli commands based on some patterns and the local user and
	  group running rasterisk. (Sorry if I missed some of the testers).
	  Reviewboard: http://reviewboard.digium.com/r/11/ (closes issue
	  #11123) Reported by: eliel Tested by: eliel, IgorG, Laureano,
	  otherwiseguy, mvanbaak

2008-12-01 17:34 +0000 [r159911-160004]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 160003 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r160003 | russell | 2008-12-01 11:27:30 -0600 (Mon, 01
	  Dec 2008) | 6 lines Apply some logic used in iax2_indicate() to
	  iax2_setoption(), as well, since they both have the potential to
	  send control frames in the middle of call setup. We have to wait
	  until we have received a message back from the remote end before
	  we try to send any more frames. Otherwise, the remote end will
	  consider it invalid, and we'll get stuck in an INVAL/VNAK storm.
	  ........

	* /, .cleancount: Merged revisions 159900 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r159900 | russell | 2008-12-01 08:52:56 -0600 (Mon, 01 Dec 2008)
	  | 2 lines Force a "make clean" to avoid a bizarre build issue ...
	  ........

2008-12-01 14:09 +0000 [r159898]  Michiel van Baak <michiel@vanbaak.info>

	* main/manager.c, /: Merged revisions 159897 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r159897 | mvanbaak | 2008-12-01 15:05:41 +0100 (Mon, 01 Dec 2008)
	  | 4 lines make manager compile on OpenBSD. The last (10th)
	  argument to ast_channel_alloc here should be a pointer and NULL
	  is not really a pointer. ........

2008-11-29 18:33 +0000 [r159853]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_readexten.c: Allow the '#' sign to exist within an
	  extension (inspired by issue #13330)

2008-11-29 17:57 +0000 [r159774-159818]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_vpb.cc, /, main/utils.c, channels/chan_iax2.c,
	  utils/frame.c, include/asterisk/astmm.h, configure,
	  include/asterisk/compat.h, main/features.c,
	  include/asterisk/module.h, main/logger.c,
	  include/asterisk/dlinkedlists.h, main/dns.c,
	  include/asterisk/utils.h, include/asterisk/devicestate.h,
	  channels/chan_sip.c, include/asterisk/dundi.h,
	  include/asterisk/enum.h, configure.ac, channels/chan_agent.c,
	  include/asterisk/config.h, utils/astman.c,
	  include/asterisk/cli.h, include/asterisk/channel.h,
	  include/jitterbuf.h, include/asterisk/manager.h,
	  utils/conf2ael.c, cdr/cdr_tds.c, main/ast_expr2.c,
	  include/asterisk/logger.h, Makefile, include/asterisk/res_odbc.h,
	  main/srv.c, channels/chan_misdn.c,
	  include/asterisk/linkedlists.h, main/event.c,
	  include/asterisk/lock.h, include/asterisk/strings.h,
	  utils/extconf.c, makeopts.in, include/asterisk/stringfields.h,
	  main/xmldoc.c, utils/check_expr.c: incorporates r159808 from
	  branches/1.4:
	  ------------------------------------------------------------------------
	  r159808 | kpfleming | 2008-11-29 10:58:29 -0600 (Sat, 29 Nov
	  2008) | 7 lines update dev-mode compiler flags to match the ones
	  used by default on Ubuntu Intrepid, so all developers will see
	  the same warnings and errors since this branch already had some
	  printf format attributes, enable checking for them and tag
	  functions that didn't have them format attributes in a consistent
	  way
	  ------------------------------------------------------------------------
	  in addition: move some format attributes from main/utils.c to the
	  header files they belong in, and fix up references to the
	  relevant functions based on new compiler warnings

	* Makefile, funcs/func_sprintf.c (added), main/Makefile,
	  channels/misdn/ie.c, funcs/func_strings.c, UPGRADE.txt,
	  res/res_config_sqlite.c, channels/misdn_config.c, funcs/Makefile:
	  we can now build with -Wformat=2, which found a couple of real
	  bugs because SPRINTF() use non-literal format strings (which
	  cannot be checked), move it into its own module so the rest of
	  func_strings can benefit from format string checking

2008-11-28 14:20 +0000 [r159734]  Michiel van Baak <michiel@vanbaak.info>

	* res/Makefile: Make res_config_ldap compile with the official
	  OpenLDAP 2.3.X versions. They removed the LDAP_DEPRECATED define
	  from their source and since we are using a couple of deprecated
	  function calls we should define it with a CFLAG. Tested by me on
	  OpenBSD 4.4 and snuff-home on Linux to make sure everything keeps
	  compiling. It shouldn't break, we only define the LDAP_DEPRECATED
	  with this which is what all 2.2.X and older versions of OpenLDAP
	  did in their own tree.

2008-11-27 20:29 +0000 [r159701]  Philippe Sultan <philippe.sultan@gmail.com>

	* res/res_jabber.c: Removed duplicate code

2008-11-26 22:11 +0000 [r159664-159666]  Russell Bryant <russell@digium.com>

	* main/pbx.c: Make a formatting change to test a new post-commit
	  hook for reviewboard. http://reviewboard.digium.com/r/65/

	* main/pbx.c: Make a formatting change to test a new post-commit
	  hook for reviewboard. http://reviewboard.digium.com/r/65/

	* main/pbx.c: Make a formatting change to test a new post-commit
	  hook for reviewboard. http://reviewboard.digium.com/r/65/

2008-11-26 21:20 +0000 [r159629-159631]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/agi.h, configure,
	  include/asterisk/autoconfig.h.in, contrib/asterisk-ng-doxygen,
	  autoconf/ast_gcc_attribute.m4, configure.ac, res/res_agi.c,
	  apps/app_stack.c, include/asterisk/optional_api.h (added):
	  improve handling of API calls provided by loaded modules through
	  use of some GCC features; this makes app_stack's usage of AGI
	  APIs even cleaner, and will allow it to work 'as expected' either
	  with or without res_agi being loaded reviewed at
	  http://reviewboard.digium.com/r/62

	* main/manager.c, CHANGES: add support for event suppression for
	  AMI-over-HTTP

2008-11-26 19:57 +0000 [r159554]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c: Add some necessary hangup commands in the case
	  that forwarding a call fails 1) Hang up the original destination
	  if the local channel cannot be requested. 2) Hang up the local
	  channel (in addition to the original destination) if ast_call
	  fails when calling the newly created local channel. This prevents
	  channels from sticking around forever in the case of a botched
	  call forward (e.g. to an extension which does not exist). (closes
	  issue #13764) Reported by: davidw Patches: 13764_v2.patch
	  uploaded by putnopvut (license 60) Tested by: putnopvut, davidw

2008-11-26 19:08 +0000 [r159534]  Kevin P. Fleming <kpfleming@digium.com>

	* agi/Makefile, utils/Makefile, /, Makefile.moddir_rules,
	  Makefile.rules: Merged revisions 159476 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r159476 | kpfleming | 2008-11-26 12:36:24 -0600 (Wed, 26 Nov
	  2008) | 7 lines simplify (and slightly bug-fix) the recent
	  developer-oriented COMPILE_DOUBLE mode ensure that 'make clean'
	  removes dependency files for .i files that are created in
	  COMPILE_DOUBLE mode ........

2008-11-26 18:33 +0000 [r159475]  Tilghman Lesher <tlesher@digium.com>

	* main/udptl.c: If the config file does not exist, then the first
	  use crashes Asterisk. (closes issue #13848) Reported by:
	  klaus3000 Patches: udptl.c.patch uploaded by eliel (license 64)
	  Tested by: blitzrage

2008-11-26 14:58 +0000 [r159437]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_agent.c: Don't allow for configuration options to
	  overwrite options set via channel variables on a reload. (closes
	  issue #13921) Reported by: davidw Patches: 13921.patch uploaded
	  by putnopvut (license 60) Tested by: davidw

2008-11-26 03:18 +0000 [r159402]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c: Always parse arguments in park_call_exec so that
	  app_args is valid. This prevents a crash when executing Park from
	  the dialplan with no arguments.

2008-11-25 23:03 +0000 [r159360]  Steve Murphy <murf@digium.com>

	* main/cdr.c, /, channels/chan_iax2.c: Merged revisions 159316 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r159316 | murf | 2008-11-25 15:41:10 -0700 (Tue, 25 Nov 2008) |
	  15 lines (closes issue #12694) Reported by: yraber Patches:
	  12694.2nd.diff uploaded by murf (license 17) Tested by: murf,
	  laurav Thanks to file (Joshua Colp) for his IAX fix. the change
	  to cdr.c allows no-answer to percolate up into CDR's, and feels
	  like the right place to locate this fix; if BUSY is done here,
	  no-answer should be, too. ........

2008-11-25 22:45 +0000 [r159276-159317]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample,
	  include/asterisk/dsp.h, CHANGES, main/dsp.c: Add an option,
	  waitfordialtone, for UK analog lines which do not end a call
	  until the originating line hangs up. (closes issue #12382)
	  Reported by: one47 Patches:
	  zap-waitfordialtone-trunk.080901.patch uploaded by one47 (license
	  23) zap-waitfordialtone-bra-1.4.21.2.patch uploaded by fleed
	  (license 463) Tested by: fleed

	* /, channels/chan_iax2.c: Merged revisions 159269 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r159269 | tilghman | 2008-11-25 15:56:48 -0600 (Tue, 25
	  Nov 2008) | 7 lines Don't try to send a response on a NULL pvt.
	  (closes issue #13919) Reported by: barthpbx Patches:
	  chan_iax2.c.patch uploaded by eliel (license 64) Tested by:
	  barthpbx ........

2008-11-25 21:49 +0000 [r159250]  Mark Michelson <mmichelson@digium.com>

	* apps/app_followme.c: Make the options for the general and
	  profiles more consistent for the "pls_hold_prompt" option. This
	  does not affect any released version of Asterisk, so there is no
	  need to update the CHANGES file for this. (closes issue #13893)
	  Reported by: eliel

2008-11-25 21:42 +0000 [r159162-159247]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 159246 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ................ r159246 | tilghman | 2008-11-25 15:40:28 -0600
	  (Tue, 25 Nov 2008) | 14 lines Merged revisions 159245 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r159245 | tilghman | 2008-11-25 15:37:06 -0600 (Tue, 25 Nov 2008)
	  | 7 lines Regression fix for last security fix. Set the iseqno
	  correctly. (closes issue #13918) Reported by: ffloimair Patches:
	  20081119__bug13918.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: ffloimair ........ ................

	* pbx/pbx_realtime.c: Don't actually do anything with a negative
	  priority, because we ignore it in the result, anyway.

	* main/pbx.c: Don't limit the length of the hint at the final step
	  (from ~8100 chars max (or ~500 chars max on LOW_MEMORY) to 80
	  chars max). This will allow more channels to be used in a single
	  hint.

2008-11-25 16:18 +0000 [r159093]  Terry Wilson <twilson@digium.com>

	* apps/app_festival.c: Add missing variable declaration for PPC
	  code

2008-11-25 05:19 +0000 [r159050-159054]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_readexten.c: Copyright clarification; also, have
	  variable set to "t" or "i" on timeout or invalid extension,
	  respectively. (closes issue #13944) Reported by: chappell

	* channels/chan_usbradio.c, /, configure,
	  include/asterisk/autoconfig.h.in, configure.ac,
	  channels/xpmr/xpmr.c, apps/app_rpt.c: Merged revisions 159025 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r159025 | tilghman | 2008-11-24 22:50:00 -0600 (Mon, 24 Nov 2008)
	  | 3 lines System call ioperm is non-portable, so check for its
	  existence in autoconf. (Closes issue #13863) ........

2008-11-25 03:49 +0000 [r158992]  Terry Wilson <twilson@digium.com>

	* channels/chan_usbradio.c: Make chan_usbradio compile under dev
	  mode

2008-11-25 01:01 +0000 [r158959]  Sean Bright <sean.bright@gmail.com>

	* funcs/func_dialgroup.c, channels/chan_sip.c,
	  include/asterisk/astobj2.h, res/res_phoneprov.c,
	  main/taskprocessor.c, channels/chan_console.c,
	  channels/chan_iax2.c, apps/app_queue.c, main/astobj2.c,
	  main/config.c, main/manager.c, res/res_timing_pthread.c,
	  main/features.c, res/res_timing_timerfd.c, utils/hashtest2.c,
	  res/res_clialiases.c: This is basically a complete rollback of
	  r155401, as it was determined that it would be best to maintain
	  API compatibility. Instead, this commit introduces
	  ao2_callback_data() which is functionally identical to
	  ao2_callback() except that it allows you to pass arbitrary data
	  to the callback. Reviewed by Mark Michelson via ReviewBoard:
	  http://reviewboard.digium.com/r/64

2008-11-25 00:19 +0000 [r158876-158925]  Matthew Nicholson <mnicholson@digium.com>

	* main/file.c: Fix compiling in dev mode.

	* UPGRADE.txt, apps/app_queue.c: Make the Join event from app_queue
	  use CallerIDNum insead of CallerID for indicating the callerid
	  number just like the rest of asterisk. (closes issue #13883)
	  Reported by: davidw

	* main/manager.c, res/res_agi.c, include/asterisk/manager.h: Added
	  EVENT_FLAG_AGI and used it for manager calls in res_agi.c (closes
	  issue #13873) Reported by: fnordian Patches: ami_agievent.patch
	  uploaded by fnordian (license 110)

2008-11-24 21:52 +0000 [r158857]  Tilghman Lesher <tlesher@digium.com>

	* main/dsp.c: Add a bit of documentation (thanks, I-MOD) on what
	  the silence threshold constant actually does and what values are
	  valid for it.

2008-11-24 21:27 +0000 [r158851]  Matthew Nicholson <mnicholson@digium.com>

	* main/file.c: Make ast_streamfile() check the result of
	  ast_openstream() before doing anything with it. (closes issue
	  #13955) Reported by: chris-mac

2008-11-24 18:11 +0000 [r158808]  Terry Wilson <twilson@digium.com>

	* apps/app_minivm.c: This patch adds a new application for sending
	  MWI to phones via Asterisk's event subsystem. Also, the minivm
	  documentation is all converted to use xmldocs. (closes issue
	  #13946) Reported by: Marquis Patches:
	  minivmmwi_plus_xmldocs.patch uploaded by Marquis (license 32)
	  Tested by: otherwiseguy, Marquis

2008-11-23 03:36 +0000 [r158754-158756]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_sip.c, configs/sip.conf.sample: If you enabled
	  'notifycid' one of the limitations is that the calling channel is
	  only found if it dialed the extension that was subscribed to. You
	  can now specify 'ignore-context' for the 'notifycid' option in
	  sip.conf which will, as it's value implies, ignore the current
	  context of the caller when doing the lookup.

	* channels/chan_sip.c: No need to use a separate structure for this
	  since we can just pass our sip_pvt pointer in directly.

2008-11-22 17:17 +0000 [r158686-158723]  Michiel van Baak <michiel@vanbaak.info>

	* funcs/func_realtime.c: last commit worked on OpenBSD but still
	  generated warning on Ubuntu. Initialise a variable so
	  --enable-dev-mode does not complain

	* channels/chan_skinny.c: dont send reorder tone after a device is
	  hungup if a dialout is abandoned or failed. Without this reorder
	  tone will play after hangup and both wedhorn's and my wife have
	  threatened to use an axe on our asterisk box (closes issue
	  #13948) Reported by: wedhorn Patches: switch.diff uploaded by
	  wedhorn (license 30)

	* channels/chan_skinny.c: Add Media Source Update to skinny's
	  control2str (issue #13948)

	* channels/chan_skinny.c: fix a very occasional core dump in
	  chan_skinny found by wedhorn. (issue #13948)

	* funcs/func_realtime.c: make this compile under devmode

2008-11-21 23:40 +0000 [r158606]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 158603 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r158603 | murf | 2008-11-21 16:14:50 -0700 (Fri, 21 Nov 2008) |
	  11 lines In reference to the fix made for 13871, I was merging
	  the fix into 1.6.0 and realized I missed the code in the h-exten
	  block, and didn't catch it because my test case had the h-exten
	  commented out. So, this corrects the code I missed, as a
	  preventative against another crash report. Tested with the
	  h-exten defined, all is well. ........

2008-11-21 23:33 +0000 [r158602-158605]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c: Allow space within an extension, when the space is
	  within a character class. (requested by lmadsen on -dev, patch by
	  me)

	* main/pbx.c, /: Merged revisions 158600 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r158600 | tilghman | 2008-11-21 17:07:46 -0600 (Fri, 21 Nov 2008)
	  | 5 lines The passed extension may not be the same in the list as
	  the current entry, because we strip spaces when copying the
	  extension into the structure. Therefore, use the copied item to
	  place the item into the list. (found by lmadsen on -dev, fixed by
	  me) ........

2008-11-21 22:12 +0000 [r158540]  Russell Bryant <russell@digium.com>

	* /, include/asterisk/astobj2.h, main/astobj2.c: Merged revisions
	  158539 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r158539 | russell | 2008-11-21 16:05:55 -0600 (Fri, 21 Nov 2008)
	  | 2 lines When compiling with DEBUG_THREADS, report the real
	  file/func/line for ao2_lock/ao2_unlock ........

2008-11-21 21:47 +0000 [r158484]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 158483 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r158483 | murf | 2008-11-21 14:19:47 -0700 (Fri, 21 Nov 2008) |
	  11 lines (closes issue #13871) Reported by: mdu113 This one is
	  totally my fault. The code doesn't even create a bridge CDR if
	  the channel CDR has POST_DISABLED. I didn't check for that at the
	  end of the bridge. Fixed with a few small insertions. Tested.
	  Looks good. No cdr generated, no crash, no unnecc. data objects
	  created either. ........

2008-11-21 21:06 +0000 [r158482]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Fix for #13963. Make physical channel
	  mapping unconfigured default

2008-11-21 20:42 +0000 [r158449]  Kevin P. Fleming <kpfleming@digium.com>

	* UPGRADE-1.2.txt, UPGRADE-1.4.txt, UPGRADE.txt, UPGRADE-1.6.txt,
	  CHANGES: as suggested by jtodd, document the purposes of the
	  CHANGES and UPGRADE files

2008-11-21 19:40 +0000 [r158414]  Jason Parker <jparker@digium.com>

	* main/manager.c: Make sure we add the Event header for
	  CoreShowChannels. (closes issue #13334) Reported by: srt Patches:
	  13334_missing_event_header_in_core_show_channel.diff uploaded by
	  srt (license 378)

2008-11-21 17:08 +0000 [r158374]  Terry Wilson <twilson@digium.com>

	* cdr/cdr_csv.c: Reloading the config and having no changes still
	  initialized some settings to 0. Initialize settings after doing
	  all of the cfg checks. (closes issue #13942) Reported by: davidw
	  Patches: cdr_diff.txt uploaded by otherwiseguy (license 396)
	  Tested by: davidw

2008-11-21 15:53 +0000 [r158315]  Doug Bailey <dbailey@digium.com>

	* channels/chan_sip.c: Add fix to prevent crash during reload if
	  there is an outstanding MWI registration message pending.

2008-11-21 01:22 +0000 [r158230-158266]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Use a more expressive constant for a 64-bit
	  scanned int

	* channels/chan_sip.c: Use some magic constants to get the right
	  size for this sscanf statement. Thanks Richard!

	* channels/chan_sip.c: Fix the build for 32-bit systems. %lu is
	  only 32-bits on 32-bit systems, so we need to use %llu instead.
	  Of course %llu is 128-bits on 64-bit systems, so we have to cast
	  to unsigned long long. No harm, but it's sure annoying.

	* channels/chan_sip.c: Change the remote user agent session version
	  variable from an int to a uint64_t. This prevents potential
	  comparison problems from happening if the version string exceeds
	  INT_MAX. This was an apparent problem for one user who could not
	  properly place a call on hold since the version in the SDP of the
	  re-INVITE to place the call on hold greatly exceeded INT_MAX.
	  This also aligns with RFC 2327 better since it recommends using
	  an NTP timestamp for the version (which is a 64-bit number).
	  (closes issue #13531) Reported by: sgofferj Patches: 13531.patch
	  uploaded by putnopvut (license 60) Tested by: sgofferj

2008-11-20 19:41 +0000 [r158188]  Sean Bright <sean.bright@gmail.com>

	* res/ael/pval.c: Fix one case where the application argument was
	  not converted from a pipe to a comma. This was causing problems
	  with switch statements with empty expressions. (closes issue
	  #13901) Reported by: smurfix Patches: 20081118_bug13901.diff
	  uploaded by seanbright (license 71) Tested by: seanbright
	  Reviewed by: murf

2008-11-20 18:20 +0000 [r158082-158133]  Mark Michelson <mmichelson@digium.com>

	* include/asterisk/file.h, main/frame.c, /, channels/chan_sip.c,
	  main/file.c, include/asterisk/frame.h: Merged revisions 158072
	  via svnmerge from https://origsvn.digium.com/svn/asterisk/trunk
	  ........ r158072 | twilson | 2008-11-20 11:48:58 -0600 (Thu, 20
	  Nov 2008) | 2 lines Begin on a crusade to end trailing
	  whitespace! ........

	* /, channels/chan_sip.c: Merged revisions 158071 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r158071 | mmichelson | 2008-11-20 11:48:42 -0600 (Thu, 20 Nov
	  2008) | 16 lines We don't handle 4XX responses to BYE well.
	  According to section 15 of RFC 3261, we should terminate a dialog
	  if we receive a 481 or 408 in response to our BYE. Since I am
	  aware of at least one phone manufacturer who may sometimes send a
	  404 as well, I am being liberal and saying that any 4XX response
	  to a BYE should result in a terminated dialog. (closes issue
	  #12994) Reported by: pabelanger Patches: 12994.patch uploaded by
	  putnopvut (license 60) Closes AST-129 ........

2008-11-20 17:53 +0000 [r158078]  Ryan Brindley <rbrindley@digium.com>

	* main/config.c: more formatting corrections :: one line for loops
	  and if statements still need {}

2008-11-20 17:48 +0000 [r158072]  Terry Wilson <twilson@digium.com>

	* cdr/cdr_sqlite3_custom.c, cdr/cdr_sqlite.c, cdr/Makefile,
	  cdr/cdr_adaptive_odbc.c, cdr/cdr_pgsql.c, cdr/cdr_odbc.c,
	  cdr/cdr_radius.c, cdr/cdr_custom.c, cdr/cdr_manager.c,
	  cdr/cdr_csv.c: Begin on a crusade to end trailing whitespace!

2008-11-20 17:46 +0000 [r158070]  Ryan Brindley <rbrindley@digium.com>

	* main/config.c: formatting changes :: one line for loops and if
	  statements should have {}

2008-11-20 17:39 +0000 [r158066]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, /, channels/chan_sip.c: Merged revisions 158053
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r158053 | mmichelson | 2008-11-20 11:33:06 -0600 (Thu, 20 Nov
	  2008) | 12 lines Make sure to set the hangup cause on the calling
	  channel in the case that ast_call() fails. For incoming SIP
	  channels, this was causing us to send a 603 instead of a 486 when
	  the call-limit was reached on the destination channel. (closes
	  issue #13867) Reported by: still_nsk Patches: 13867.diff uploaded
	  by putnopvut (license 60) Tested by: blitzrage ........

2008-11-20 17:37 +0000 [r158062]  Jeff Peeler <jpeeler@digium.com>

	* main/file.c: (closes issue #12929) Reported by: snyfer This
	  handles the case for a zero length file to attempt to be
	  streamed. Instead of failing from not playing any data, go ahead
	  and return success as ast_streamfile should consider playing
	  nothing a success when there is nothing to play.

2008-11-20 17:37 +0000 [r158061]  Jason Parker <jparker@digium.com>

	* README: Whitespace fix

2008-11-20 00:08 +0000 [r157974]  Kevin P. Fleming <kpfleming@digium.com>

	* main/stdtime, /, main/db1-ast/hash, codecs/gsm/Makefile,
	  Makefile.moddir_rules, main/db1-ast/db, channels/misdn,
	  main/db1-ast/mpool, res/ais, res/Makefile, pbx/Makefile,
	  Makefile.rules, res/snmp, main/stdtime/Makefile, codecs/gsm/src,
	  main/db1-ast/btree, channels/misdn/Makefile, main/db1-ast/recno,
	  res/ael, pbx/ael, channels, main/db1-ast/Makefile: Merged
	  revisions 157859 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r157859 | kpfleming | 2008-11-19 15:34:47 -0600 (Wed, 19 Nov
	  2008) | 7 lines the gcc optimizer frequently finds broken code
	  (use of uninitalized variables, unreachable code, etc.), which is
	  good. however, developers usually compile with the optimizer
	  turned off, because if they need to debug the resulting code,
	  optimized code makes that process very difficult. this means that
	  we get code changes committed that weren't adequately checked
	  over for these sorts of problems. with this build system change,
	  if (and only if) --enable-dev-mode was used and DONT_OPTIMIZE is
	  turned on, when a source file is compiled it will actually be
	  preprocessed (into a .i or .ii file), then compiled once with
	  optimization (with the result sent to /dev/null) and again
	  without optimization (but only if the first compile succeeded, of
	  course). while making these changes, i did some cleanup work in
	  Makefile.rules to move commonly-used combinations of flag
	  variables into their own variables, to make the file easier to
	  read and maintain ........

2008-11-20 00:06 +0000 [r157973]  Terry Wilson <twilson@digium.com>

	* res/res_timing_timerfd.c: Fix compiling

2008-11-19 23:30 +0000 [r157906-157940]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Add a space to the output

	* apps/app_queue.c: Add a RES_NOT_DYNAMIC case for the CLI command
	  'queue remove member'

	* CHANGES: Commit CHANGES change I promised when submitting
	  res_timing_timerfd

2008-11-19 22:01 +0000 [r157893]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: Add info about REALTIME_FIELD and REALTIME_HASH

2008-11-19 21:55 +0000 [r157874]  Mark Michelson <mmichelson@digium.com>

	* res/res_timing_timerfd.c: Cast this value since a uint64_t is not
	  the same as an unsigned long long on a 64-bit machine. Reported
	  by kpfleming on IRC

2008-11-19 21:54 +0000 [r157870]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_realtime.c: Two new functions, REALTIME_FIELD, and
	  REALTIME_HASH, which should make querying realtime from the
	  dialplan a little more consistent and easy to use. The original
	  REALTIME function is preserved, for those who are already
	  accustomed to that interface. (closes issue #13651) Reported by:
	  Corydon76 Patches: 20081119__bug13651__2.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: blitzrage, Corydon76

2008-11-19 19:37 +0000 [r157820]  Mark Michelson <mmichelson@digium.com>

	* build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, res/res_timing_pthread.c,
	  configure.ac, res/res_timing_dahdi.c, res/res_timing_timerfd.c
	  (added), makeopts.in: Merge the changes from the
	  res_timing_timerfd branch. This provides a new timing interface.
	  In order to use it, you must be running a Linux with a kernel
	  version of 2.6.25 or newer and glibc 2.8 or newer. This timing
	  interface is a good alternative if a timing source is necessary
	  (e.g. for IAX trunking) but DAHDI is otherwise unnecessary for
	  the system. For now, this commit contains the actual work done in
	  the res_timing_timerfd branch. There are no notices in the README
	  or CHANGES files yet, but they will be added in my next commit.
	  The timing API of Asterisk also needs to have a bit of work done
	  with regards to choosing which timing interface to use. This
	  commit makes the choice a build-time decision, by only allowing
	  one of the timer interfaces to be chosen in menuselect. It would
	  be preferable if the choice could be made at run-time, however.
	  The preferred timing interface could be loaded and tested, and if
	  it does not work, choice number two may be used instead. That
	  sort of thing. That is beyond the scope of work in this branch
	  though.

2008-11-19 19:25 +0000 [r157818]  Terry Wilson <twilson@digium.com>

	* channels/chan_vpb.cc, cdr/cdr_sqlite3_custom.c,
	  channels/iax2-provision.c, cdr/cdr_adaptive_odbc.c,
	  cdr/cdr_pgsql.c, cdr/cdr_radius.c, cdr/cdr_tds.c,
	  channels/misdn_config.c, cdr/cdr_csv.c, channels/chan_usbradio.c,
	  channels/chan_skinny.c, main/logger.c, res/ais/evt.c,
	  pbx/pbx_dundi.c, cdr/cdr_odbc.c, cdr/cdr_custom.c,
	  cdr/cdr_manager.c, main/xmldoc.c, res/res_clialiases.c: Fix
	  checking for CONFIG_STATUS_FILEINVALID so that modules don't
	  crash upon trying to parse an invalid config

2008-11-19 18:28 +0000 [r157784]  Tilghman Lesher <tlesher@digium.com>

	* configure, configure.ac: Add check for t38_terminal_init in
	  spandsp (not found in 0.0.6, so it should fail reasonably)
	  (closes issue #13473) Reported by: genie Patches:
	  20080916__bug13473.diff.txt uploaded by Corydon76 (license 14)

2008-11-19 13:45 +0000 [r157706-157743]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_agi.c: correct small bug introduced during API conversion

	* UPGRADE.txt, UPGRADE-1.6.txt: move relevant entries into
	  UPGRADE.txt and resync UPGRADE-1.6.txt with previous branches

	* include/asterisk/agi.h, res/res_agi.c, UPGRADE.txt,
	  UPGRADE-1.6.txt (added), apps/app_stack.c: make some corrections
	  to the ast_agi_register_multiple(), ast_agi_unregister_multiple()
	  and ast_agi_fdprintf() API calls to be consistent with API
	  guidelines also, move UPGRADE.txt to UPGRADE-1.6.txt and make the
	  new UPGRADE.txt contain information about upgrading between
	  Asterisk 1.6 releases

2008-11-19 05:37 +0000 [r157675]  Terry Wilson <twilson@digium.com>

	* configs/cdr_adaptive_odbc.conf.sample: Comment out config line
	  that is in a commented out context

2008-11-19 01:02 +0000 [r157639]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/logger.h, main/logger.c, main/utils.c,
	  include/asterisk/strings.h: Starting with a change to ensure that
	  ast_verbose() preserves ABI compatibility in 1.6.1 (as compared
	  to 1.6.0 and versions of 1.4), this change also deprecates the
	  use of Asterisk with FreeBSD 4, given the central use of va_copy
	  in core functions. va_copy() is C99, anyway, and we already
	  require C99 for other purposes, so this isn't really a big change
	  anyway. This change also simplifies some of the core ast_str_*
	  functions.

2008-11-19 00:59 +0000 [r157632]  Mark Michelson <mmichelson@digium.com>

	* main/astmm.c: If malloc returns NULL, we need to return NULL
	  immediately or else Asterisk will crash when attempting to
	  dereference the NULL pointer (closes issue #13858) Reported by:
	  eliel Patches: astmm.c.patch uploaded by eliel (license 64)

2008-11-19 00:27 +0000 [r157600]  Sean Bright <sean.bright@gmail.com>

	* Makefile, build_tools/make_version, configure, configure.ac,
	  build_tools/make_buildopts_h, makeopts.in: Fix a few build
	  problems on Solaris (and check for an md5 utility in configure
	  instead of the icky loop I was doing before). (closes issue
	  #13842) Reported by: snuffy Patches: bug13842_20081106.diff
	  uploaded by snuffy (license 35) 13842.diff uploaded by seanbright
	  (license 71) Tested by: snuffy

2008-11-18 23:59 +0000 [r157496-157592]  Mark Michelson <mmichelson@digium.com>

	* res/res_musiconhold.c: This change prevents a crash from
	  occurring if res_musiconhold.so is unloaded and then Asterisk is
	  stopped. The problem was that we are not unregistering the
	  ast_moh_destroy function at exit. (closes issue #13761) Reported
	  by: eliel Patches: res_musiconhold.c.patch uploaded by eliel
	  (license 64)

	* Makefile: Add some missing $(DESTDIR)s to the bininstall target
	  of the Makefile. (closes issue #13875) Reported by: pabelanger
	  Patches: Makefile.155928 uploaded by pabelanger (license 224)

	* apps/app_voicemail.c: Fix the logic for when delete=yes when IMAP
	  storage is in use so that the message is deleted from both local
	  and IMAP storage. (closes issue #13642) Reported by: jaroth
	  Patches: deleteyes.patch uploaded by jaroth (license 50)

	* channels/chan_sip.c: Merged revisions 157503 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r157503 | mmichelson | 2008-11-18 16:47:57 -0600 (Tue, 18 Nov
	  2008) | 13 lines Add some missing invite state changes necessary
	  in the sip_write function. Not setting the invite state correctly
	  on the call was resulting in the Record application leaving empty
	  files. I also have updated the doxygen comment next to the
	  declaration of the INV_EARLY_MEDIA constant to reflect that we
	  also use this state when we *send* a 18X response to an INVITE.
	  (closes issue #13878) Reported by: nahuelgreco Patches:
	  sip-early-media-recording-1.4.22.patch uploaded by nahuelgreco
	  (license 162) Tested by: putnopvut ........

	* channels/chan_sip.c: Based on Russell's advice on the
	  asterisk-dev list, I have changed from using a global lock in
	  update_call_counter to using the locks within the sip_pvt and
	  sip_peer structures instead.

2008-11-18 21:15 +0000 [r157460-157463]  Jason Parker <jparker@digium.com>

	* Makefile: Remove echo line that is unnecessary (Thanks
	  seanbright).

	* contrib/init.d/rc.archlinux.asterisk: Make this executable

	* Makefile, contrib/init.d/rc.archlinux.asterisk (added): Add init
	  script for ArchLinux (closes issue #13667) Reported by: sherif
	  Patches: archlinux_rc_makefile.patch uploaded by sherif (license
	  591) archlinux_rc_makefile-2.patch uploaded by mvanbaak (license
	  7)

2008-11-18 20:23 +0000 [r157427]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: * Add a lock to be used in the
	  update_call_counter function. * Revert logic to mirror 1.4's in
	  the sense that it will not allow the call counter to dip below 0.
	  These two measures prevent potential races that could cause a SIP
	  peer to appear to be busy forever. (closes issue #13668) Reported
	  by: mjc Patches: hintfix_trunk_rev152649.patch uploaded by
	  wolfelectronic (license 586)

2008-11-18 19:16 +0000 [r157366]  Jeff Peeler <jpeeler@digium.com>

	* /, apps/app_meetme.c: Merged revisions 157365 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r157365 | jpeeler | 2008-11-18 13:13:33 -0600 (Tue, 18 Nov 2008)
	  | 6 lines (closes issue #13899) Reported by: akkornel This fix is
	  the result of a bug fix in ast_app_separate_args r124395. If an
	  argument does not exist it should always be set to a null string
	  rather than a null pointer. ........

2008-11-18 18:31 +0000 [r157306]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, channels/chan_local.c, /, main/features.c,
	  include/asterisk/channel.h, apps/app_followme.c: Merged revisions
	  157305 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r157305 | mmichelson | 2008-11-18 12:25:55 -0600 (Tue, 18 Nov
	  2008) | 12 lines Fix a crash in the end_bridge_callback of
	  app_dial and app_followme which would occur at the end of an
	  attended transfer. The error occurred because we initially stored
	  a pointer to an ast_channel which then was hung up due to a
	  masquerade. This commit adds a "fixup" callback to the
	  bridge_config structure to allow for end_bridge_callback_data to
	  be changed in the case that a new channel pointer is needed for
	  the end_bridge_callback. ........

2008-11-18 18:07 +0000 [r157302]  Steve Murphy <murf@digium.com>

	* main/config.c: (closes issue #13420) Reported by: alex70 Patches:
	  13420.13539.patch uploaded by murf (license 17) Tested by: murf,
	  awk This fixes two problems: a spurious linefeed insertion
	  probably left over from pre-precomment times. Only generated when
	  category had no previous comments. The other problem: Insertions
	  could get the line-numbering out of whack and generate negative
	  line numbers, causing chunks of line numbers to be emitted, on
	  the scale of the number of lines up to that point in the file. In
	  such cases, abort the looping, and all is well.

2008-11-17 22:25 +0000 [r157253]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c: Can't use items duplicated off the stack frame
	  in an element returned from a function: in these cases, we have
	  to use the heap, or garbage will result. (closes issue #13898)
	  Reported by: alecdavis Patches: 20081114__bug13898__2.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: alecdavis

2008-11-15 19:51 +0000 [r157105-157167]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile.rules: ensure that if a .i file (preprocessed source) is
	  present, the .o file is made from it, not from the .c file (this
	  only works because GNU makes respects the order the rules are
	  defined)

	* Makefile, /, Makefile.moddir_rules, Makefile.rules: Merged
	  revisions 157162-157163 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r157162 | kpfleming | 2008-11-15 20:24:24 +0100 (Sat, 15 Nov
	  2008) | 1 line dist-clean should remove dependency information
	  files as well ........ r157163 | kpfleming | 2008-11-15 20:31:03
	  +0100 (Sat, 15 Nov 2008) | 1 line when an individual directory
	  dist-clean is run, run clean in that directory first, and when
	  running top-level dist-clean, do not run subdirectory clean
	  operations twice ........

	* /, contrib/asterisk-ng-doxygen: Merged revisions 157104 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r157104 | kpfleming | 2008-11-15 19:00:32 +0100 (Sat, 15 Nov
	  2008) | 13 lines major update to doxygen configuration file: 1)
	  update to doxygen 1.5.x style file, as used in trunk 2) tell
	  doxygen where are header files are, so include-file processing
	  can be done 3) make all macros that are used to define
	  variables/functions be expanded, so that doxygen will properly
	  document the resulting variable/function 4) make all macros that
	  are used to provide the contents of a variable (structure) be
	  expanded, so that doxygen will be able to document the resulting
	  fields 5) suppress compiler attributes (__attribute__(xxx)) from
	  being seen by doxygen, so it will properly match up function
	  definition and usage (for an example of th effect of this, look
	  at the doxygen docs for ast_log() from before and afte this
	  commit) ........

2008-11-15 15:37 +0000 [r157073]  Eliel C. Sardanons <eliels@gmail.com>

	* main/xmldoc.c: Avoid a not needed cast, making code more
	  readable.

2008-11-15 04:25 +0000 [r157039-157041]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c, main/features.c, main/taskprocessor.c: Fix a
	  few more places where the case insensitive hash should be used
	  since the comparison is case insensitive.

	* channels/chan_console.c: Use the new case insensitive hash
	  function for console interfaces. The comparison function is case
	  insensitive.

2008-11-14 22:36 +0000 [r157006]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_adaptive_odbc.c, configs/cdr_adaptive_odbc.conf.sample:
	  Allow setting static values in CDRs

2008-11-14 21:19 +0000 [r156962]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Revision 155513 of chan_sip.c in trunk
	  inadvertently removed a very important line to set the "len"
	  field for incoming SIP requests. The result was that all incoming
	  SIP messages appeared to be 0-length, meaning Asterisk could do
	  no meaningful processing of anything SIP-related

2008-11-14 17:35 +0000 [r156916-156918]  Terry Wilson <twilson@digium.com>

	* res/res_phoneprov.c: Cleanup whitespace issues

	* res/res_phoneprov.c: Use Mark's new ast_str_case_hash function
	  instead of jumping through hoops to do insensitive case lookups

2008-11-14 17:02 +0000 [r156911]  Tilghman Lesher <tlesher@digium.com>

	* main/manager.c: Ping is missing the standard double-newline after
	  the event. (closes issue #13903) Reported by: kebl0155

2008-11-14 16:53 +0000 [r156883]  Mark Michelson <mmichelson@digium.com>

	* UPGRADE.txt, include/asterisk/strings.h, apps/app_queue.c: Fix
	  some refcounting in app_queue.c and change the hashing used by
	  app_queue.c to be case-insensitive. This is accomplished by
	  adding a new case-insensitive hashing function. This was
	  necessary to prevent bad refcount errors (and potential crashes)
	  which would occur due to the fact that queues were initially read
	  from the config file in a case-sensitive manner. Then, when a
	  user issued a CLI command or manager action, we allowed for
	  case-insensitive input and used that input to directly try to
	  find the queue in the hash table. The result was either that we
	  could not find a queue that was input or worse, we would end up
	  hashing to a completely bogus value based on the input. This
	  commit resolves the problem presented in issue #13703. However,
	  that issue was reported against 1.6.0. Since this fix introduces
	  a behavior change, I am electing to not place this same fix in to
	  the 1.6.0 or 1.6.1 branches, and instead will opt for a change
	  which does not change behavior.

2008-11-14 16:34 +0000 [r156874]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c: Remove some useless locking and make sure
	  we hangup channels on a link when we get a GRS.

2008-11-14 15:20 +0000 [r156817]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 156816 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r156816 | mmichelson | 2008-11-14 09:18:59 -0600 (Fri,
	  14 Nov 2008) | 10 lines If the prompt to reenter a voicemail
	  password timed out, it resulted in the password not being saved,
	  even if the input matched what you gave when first prompted to
	  enter a new password. This is because the return value of
	  ast_readstring was checked, but not checked properly. This bug
	  was discovered by Jared Smith during an Asterisk training course.
	  Thanks for reporting it! ........

2008-11-14 00:43 +0000 [r156690-156756]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_while.c: Merged revisions 156755 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156755 | tilghman | 2008-11-13 18:41:37 -0600 (Thu, 13 Nov 2008)
	  | 6 lines ast_waitfordigit() requires that the channel be up, for
	  no good logical reason. This prevents While/EndWhile from working
	  within the "h" extension. Reported by: jgalarneau (for ABE C.2)
	  Fixed by: me ........

	* main/manager.c, /: Merged revisions 156688 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156688 | tilghman | 2008-11-13 15:24:00 -0600 (Thu, 13 Nov 2008)
	  | 7 lines Provide more space for all the data which can appear in
	  an originating channel name. (closes issue #13398) Reported by:
	  bamby Patches: manager.c.diff uploaded by bamby (license 430)
	  ........

2008-11-13 19:17 +0000 [r156649]  Jeff Peeler <jpeeler@digium.com>

	* main/pbx.c: (closes issue #13891) Reported by: smurfix This
	  reverts a change I made in 116297. At the time it seemed the
	  change was required to solve an issue with attempting a transfer
	  but then letting it timeout without dialing any digits. However,
	  I didn't realize that having an empty extension was possible. I'm
	  removing the immediate return that was added in
	  pbx_find_extension if the extension is null.

2008-11-13 19:10 +0000 [r156647]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c: Command offsets were not changed correctly
	  when the command syntax for 'pri set debug' was changed from 'pri
	  debug'.

2008-11-13 17:07 +0000 [r156612]  Mark Michelson <mmichelson@digium.com>

	* configure, autoconf/ast_c_compile_check.m4: Kevin sent a note
	  indicating that this change is not necessary, so I am reverting
	  it

2008-11-13 15:46 +0000 [r156535-156575]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_meetme.c, doc/appdocsxml.dtd, main/xmldoc.c: Introduce
	  XML documentation for: - MeetMe() - MeetMeCount() -
	  MeetMeChannelAdmin() - MeetMeAdmin() - SLAStation() - SLATrunk()
	  - Add an attribute to optionlist 'hasparams' with the same
	  functionality as the one we have in <parameter> and <argument>
	  (the DTD was updated) - Fix a leak when getting an attribute
	  while parsing an <optionlist>.

	* main/xmldoc.c: Fix a typo introduced when changing
	  xmldoc_has_arguments() to xmldoc_has_inside() we need to pass the
	  name of the node that we are looking for.

	* include/asterisk/xml.h, include/asterisk/xmldoc.h, main/xmldoc.c:
	  Remove trailing whitespaces using ':%s/\s\+$//' pointed by
	  seanbright on #asterisk-dev

2008-11-12 23:13 +0000 [r156443]  Sean Bright <sean.bright@gmail.com>

	* /: Use the reviewboard:url SVN property so post-review will work
	  without modification.

2008-11-12 21:34 +0000 [r156388]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c, /: Merged revisions 156386 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156386 | tilghman | 2008-11-12 15:18:57 -0600 (Wed, 12 Nov 2008)
	  | 5 lines When using call limits under 1 second, infinite call
	  lengths are allowed, instead. (closes issue #13851) Reported by:
	  ruddy ........

2008-11-12 20:27 +0000 [r156355]  Eliel C. Sardanons <eliels@gmail.com>

	* res/res_clialiases.c: - Make alias->real_cmd point to the
	  allocated space outside alias->alias. - Register the aliased cli
	  command (or we will not alias anything). - Use ARRAY_LEN() when
	  possible.

2008-11-12 19:47 +0000 [r156299]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /: Merged revisions 156297 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156297 | murf | 2008-11-12 12:36:16 -0700 (Wed, 12 Nov 2008) |
	  18 lines It turns out that the 0x0XX00 codes being returned for
	  N, X, and Z are off by one, as per conversation with jsmith on
	  #asterisk-dev; he was teaching a class and disconcerted that this
	  published rule was not being followed, with patterns _NXX,
	  _[1-8]22 and _[2-9]22... and NXX was winning, but [1-8] should
	  have been. This change, tested on these 3 patterns now picks the
	  proper one. However, this change may surprise users who set up
	  dialplans based on previous behavior, which has been there for
	  what, 2 and half years or so now. ........

2008-11-12 19:38 +0000 [r156298]  Russell Bryant <russell@digium.com>

	* res/res_clialiases.c: Fix a bug caused by using sizeof(pointer)
	  instead of sizeof(the struct)

2008-11-12 19:28 +0000 [r156295]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_meetme.c: Merged revisions 156294 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156294 | tilghman | 2008-11-12 13:26:45 -0600 (Wed, 12 Nov 2008)
	  | 6 lines If the SLA thread is not started, then reload causes a
	  memory leak. (closes issue #13889) Reported by: eliel Patches:
	  app_meetme.c.patch uploaded by eliel (license 64) ........

2008-11-12 19:11 +0000 [r156290]  Jeff Peeler <jpeeler@digium.com>

	* /, apps/app_meetme.c: Merged revisions 156289 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156289 | jpeeler | 2008-11-12 13:10:12 -0600 (Wed, 12 Nov 2008)
	  | 3 lines For whatever reason, gcc only warned me about the
	  possible use of an uninitialized variable when compiling 1.6.1.
	  ........

2008-11-12 18:55 +0000 [r156243]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 156229 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r156229 | tilghman | 2008-11-12 12:39:21 -0600 (Wed, 12
	  Nov 2008) | 11 lines Revert revision 132506, since it
	  occasionally caused IAX2 HANGUP packets not to be sent, and
	  instead, schedule a task to destroy the iax2 pvt structure 10
	  seconds later. This allows the IAX2 HANGUP packet to be queued,
	  transmitted, and ACKed before the pvt is destroyed. (closes issue
	  #13645) Reported by: dzajro Patches:
	  20081111__bug13645__3.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: vazir Reviewed: http://reviewboard.digium.com/r/51/
	  ........

2008-11-12 18:32 +0000 [r156228]  Jeff Peeler <jpeeler@digium.com>

	* /, apps/app_meetme.c: Merged revisions 156178 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156178 | jpeeler | 2008-11-12 11:53:44 -0600 (Wed, 12 Nov 2008)
	  | 8 lines (closes issue #13173) Reported by: pep This change adds
	  an announce_thread responsible for playing announcements to an
	  existing conference. This allows all announcing to be immediately
	  stopped if necessary but more importantly allows other threads
	  that need to play something to not block. There are multiple
	  benefits to this, but the actual bug is for solving the scenario
	  for a channel to be unusable after hang up for the entire
	  duration of the parting announcement. The parting announcement
	  can be extremely long depending on what the user recorded upon
	  joining the conference. Reviewed by Russell on Review Board:
	  http://reviewboard.digium.com/r/25/ ........

2008-11-12 17:41 +0000 [r156169]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, /: Merged revisions 156167 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156167 | mmichelson | 2008-11-12 11:38:33 -0600 (Wed, 12 Nov
	  2008) | 7 lines When doing some tests, I was having a crash at
	  the end of every call if an attended transfer occurred during the
	  call. I traced the cause to the CDR on one of the channels being
	  NULL. murf suggested a check in the end bridge callback to be
	  sure the CDR is non-NULL before proceeding, so that's what I'm
	  adding. ........

2008-11-12 17:38 +0000 [r156166]  Russell Bryant <russell@digium.com>

	* /, main/asterisk.c: Merged revisions 156164 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r156164 | russell | 2008-11-12 11:29:52 -0600 (Wed, 12 Nov 2008)
	  | 7 lines Move the sanity check that makes sure "always fork" is
	  not set along with the console option to be after the code that
	  reads options from asterisk.conf. This resolves a situation where
	  Asterisk can start taking up 100% when misconfigured. (Thanks to
	  Bryce Porter (x86 on IRC) for letting me log in to his system to
	  figure out what was causing the 100% CPU problem.) ........

2008-11-12 17:28 +0000 [r156162]  Eliel C. Sardanons <eliels@gmail.com>

	* main/xmldoc.c: - The paramname is a pointer allocated with
	  strdup() or malloc(), so, we need to free it with ast_free().

2008-11-12 15:33 +0000 [r156127]  Mark Michelson <mmichelson@digium.com>

	* configure, autoconf/ast_c_compile_check.m4: Add a couple of
	  AC_SUBST calls to the AST_C_COMPILE_CHECK macro. These missing
	  calls were discovered when working on timerfd support in a
	  separate branch.

2008-11-12 13:43 +0000 [r156125]  Eliel C. Sardanons <eliels@gmail.com>

	* res/res_agi.c: Add XML documentation for AGI commands: - database
	  deltree - database get - exec - get data - get full variable

2008-11-12 06:46 +0000 [r156120]  Michiel van Baak <michiel@vanbaak.info>

	* main/udptl.c, main/pbx.c, channels/chan_sip.c,
	  configs/cli_aliases.conf.sample (added), include/asterisk/cli.h,
	  CHANGES, res/res_jabber.c, main/rtp.c, main/cli.c, main/cdr.c,
	  channels/chan_skinny.c, res/res_agi.c, pbx/pbx_ael.c,
	  pbx/pbx_dundi.c, funcs/func_devstate.c, main/asterisk.c,
	  channels/chan_mgcp.c, res/res_clialiases.c (added): This commit
	  does two things: - Add CLI aliases module to asterisk. - Remove
	  all deprecated CLI commands from the code Initial work done by
	  file. Junk-Y and lmadsen did a lot of work and testing to get the
	  list of deprecated commands into the configuration file.
	  Deprecated CLI commands are now handled by this new module, see
	  cli_aliases.conf for more info about that. ok russellb@ via
	  reviewboard (closes issue #13735) Reported by: mvanbaak

2008-11-12 02:20 +0000 [r156051-156087]  Eliel C. Sardanons <eliels@gmail.com>

	* res/res_agi.c, doc/appdocsxml.dtd: - Add 'database del',
	  'database put' and 'set music' AGI commands XML documentation. -
	  Add to the DTD the possibility to put a parameter inside an
	  <enum>.

	* include/asterisk/agi.h, res/res_agi.c, doc/appdocsxml.dtd,
	  main/xmldoc.c: Implement AGI XML documentation parsing functions.
	  A new <agi> element is used to describe the XML documentation. We
	  have the usual synopsis,syntax,description and seealso for AGI
	  commands. The CLI 'agi show commands' command was changed to show
	  all the documentation se ctions.

2008-11-11 23:32 +0000 [r156017-156018]  Pari Nannapaneni <paripurnachand@digium.com>

	* main/manager.c: changing comment style to conform coding
	  guidelines

	* main/manager.c: Patch by Ryan Brindley -- Make sure that manager
	  refuses any duplicate 'new category' requests in updateconfig

2008-11-11 17:57 +0000 [r155967]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/strings.h: use some fancy compiler magic (thanks
	  to Matthew Woehlke on the gcc-help mailing list) to restore
	  type-safety to S_OR by going back to a macro, but preserve the
	  side-effect-safe usage of the macro arguments

2008-11-11 16:46 +0000 [r155934]  Doug Bailey <dbailey@digium.com>

	* res/res_phoneprov.c, phoneprov/polycom_line.xml: Add LINEKEYS
	  variable to allow for a user to set the number of keys assigned
	  to a line on a polycom phone

2008-11-11 16:07 +0000 [r155929]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Remove commentary from the issues list for
	  SIP TCP/TLS

2008-11-10 21:14 +0000 [r155863]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_agent.c: Merged revisions 155861 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r155861 | mmichelson | 2008-11-10 15:07:39 -0600 (Mon,
	  10 Nov 2008) | 14 lines Channel drivers assume that when their
	  indicate callback is invoked, that the channel on which the
	  callback was called is locked. This patch corrects an instance in
	  chan_agent where a channel's indicate callback is called directly
	  without first locking the channel. This was leading to some
	  observed locking issues in chan_local, but considering that all
	  channel drivers operate under the same expectations, the generic
	  fix in chan_agent is the right way to go. AST-126 ........

2008-11-10 21:12 +0000 [r155763-155862]  Tilghman Lesher <tlesher@digium.com>

	* res/res_realtime.c: Make documentation of update method match
	  documentation and update update2 method to match. Reported by:
	  atis, via -dev mailing list. Fixed by: me

	* /, doc/valgrind.txt: Merged revisions 155803 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r155803 | tilghman | 2008-11-10 14:49:59 -0600 (Mon, 10 Nov 2008)
	  | 1 line I got tired of saying this in every single bugnote
	  referring to this file. ........

	* main/editline/readline.c: Fix memory leak when MALLOC_DEBUG is
	  enabled. (closes issue #13864) Reported by: eliel Patches:
	  readline.c.patch uploaded by eliel (license 64)

2008-11-10 13:53 +0000 [r155711]  Eliel C. Sardanons <eliels@gmail.com>

	* main/pbx.c, main/Makefile, include/asterisk/xmldoc.h (added),
	  include/asterisk/term.h, include/asterisk/_private.h,
	  main/asterisk.c, main/xmldoc.c (added): Move all the XML
	  documentation API from pbx.c to xmldoc.c. Export the XML
	  documentation API: ast_xmldoc_build_synopsis()
	  ast_xmldoc_build_syntax() ast_xmldoc_build_description()
	  ast_xmldoc_build_seealso() ast_xmldoc_build_arguments()
	  ast_xmldoc_printable() ast_xmldoc_load_documentation()

2008-11-09 16:30 +0000 [r155554-155671]  Sean Bright <sean.bright@gmail.com>

	* configs/chan_dahdi.conf.sample: Fix this as well. Pointed out by
	  tzafrir.

	* configs/chan_dahdi.conf.sample: Fix some spelling errors, and
	  convert tabs to spaces.

	* main/channel.c, channels/chan_sip.c, apps/app_directed_pickup.c,
	  main/features.c, include/asterisk/channel.h: In order to move
	  away from nested function use, some changes to the recently
	  introduced ast_channel_search_locked need to be made.
	  Specifically, the caller needs to be able to pass arbitrary data
	  which in turn is passed to the callback. This patch addresses all
	  of the nested functions currently in asterisk trunk.

	* apps/app_dial.c, /, main/features.c, include/asterisk/channel.h,
	  apps/app_followme.c, apps/app_queue.c: Merged revisions 155553
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r155553 | seanbright | 2008-11-08 20:08:07 -0500 (Sat, 08 Nov
	  2008) | 6 lines Use static functions here instead of nested ones.
	  This requires a small change to the ast_bridge_config struct as
	  well. To understand the reason for this change, see the following
	  post: http://gcc.gnu.org/ml/gcc-help/2008-11/msg00049.html
	  ........

2008-11-08 21:46 +0000 [r155513-155516]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c, include/asterisk/strings.h: - Check for
	  failure when putting the packet in the ast_str - fix a spelling
	  error in a header file

	* channels/chan_sip.c: Remove some code that is basically a no-op.
	  Code above this already ensures that the buffer is terminated.

2008-11-07 23:41 +0000 [r155467]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Set the invite state to INV_CANCELLED in a
	  place that makes more sense. Where it was set before, it was
	  impossible to actually delay sending a CANCEL if we had not yet
	  received a provisional response to an INVITE. (closes issue
	  #13626) Reported by: atis Patches: 13626.patch uploaded by
	  putnopvut (license 60) Tested by: atis

2008-11-07 22:39 +0000 [r155401]  Sean Bright <sean.bright@gmail.com>

	* main/manager.c, channels/chan_sip.c, funcs/func_dialgroup.c,
	  res/res_timing_pthread.c, include/asterisk/astobj2.h,
	  main/features.c, res/res_phoneprov.c, utils/hashtest2.c,
	  channels/chan_console.c, main/taskprocessor.c, apps/app_queue.c,
	  channels/chan_iax2.c, main/astobj2.c, main/config.c: Add ability
	  to pass arbitrary data to the ao2_callback_fn (called from
	  ao2_callback and ao2_find). Currently, passing OBJ_POINTER to
	  either of these mandates that the passed 'arg' is a hashable
	  object, making searching for an ao2 object based on outside
	  criteria difficult. Reviewed by Russell and Mark M. via
	  ReviewBoard: http://reviewboard.digium.com/r/36/

2008-11-07 22:28 +0000 [r155395-155399]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c: Merged revisions 155398 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r155398 | tilghman | 2008-11-07 16:27:32 -0600 (Fri, 07 Nov 2008)
	  | 7 lines Clarify error message. (closes issue #13809) Reported
	  by: denke Patches: 20081104__bug13809.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: denke ........

	* funcs/func_odbc.c: Two bugs relating to colnames found by
	  Marquis42 on #asterisk-dev

2008-11-07 21:14 +0000 [r155360]  Mark Michelson <mmichelson@digium.com>

	* configs/voicemail.conf.sample: Remove one more instance of the
	  sample configuration lying about what's possible. The tz cannot
	  be set in a context like this. It can only be set in the general
	  section or per-mailbox. Thanks to sasargen on #asterisk-dev for
	  pointing this out

2008-11-07 20:13 +0000 [r155324]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c: Send call release with unallocated cause
	  instead of normal call clearing, when invalid extension is
	  called. (closes issue #13408) Reported by: adomjan Patches:
	  chan_dahdi.c-ss7-unallocated-2 uploaded by adomjan (license 487)

2008-11-07 16:18 +0000 [r155284]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk/indications.h, res/res_indications.c,
	  main/indications.c: Convert open-coded linked list in indications
	  to the AST_LIST_* macros. This cleans the code up some and should
	  make it more maintainable as time goes on. Reviewed by Russell,
	  Kevin, Mark M., and Tilghman via ReviewBoard:
	  http://reviewboard.digium.com/r/34/

2008-11-07 15:52 +0000 [r155282]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: stringfields conversion for struct sip_peer,
	  as requested :-)

2008-11-07 15:42 +0000 [r155241-155264]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Remove a bogus ast_free() that Kevin
	  noticed. This was probably just left over from pre-astobj2ified
	  chan_sip.

	* include/asterisk/astobj2.h: Clarify which part of OBJ_MULTIPLE is
	  not implemented, and under what case it is perfectly fine to use.
	  (Inspired by a question I received about my last commit.)

	* main/pbx.c, channels/chan_sip.c: Fix some code in chan_sip that
	  was intended to unlink multiple objects from a container. The
	  OBJ_MULTIPLE flag must be provided here. Otherwise, this would
	  only remove a single object.

2008-11-07 03:09 +0000 [r155206]  Kevin P. Fleming <kpfleming@digium.com>

	* pbx/pbx_config.c: correct logic error noticed by rmudgett
	  (thanks!)

2008-11-07 03:02 +0000 [r155175-155204]  Eliel C. Sardanons <eliels@gmail.com>

	* main/pbx.c: If 'asterisk.conf' is not found, instead of giving
	  up, load documentation for the 'en_US' language (fix my last
	  commit).

	* main/pbx.c: Fix an asterisk crash if no asterisk.conf
	  configuration file is present.

2008-11-06 22:49 +0000 [r155066-155121]  Kevin P. Fleming <kpfleming@digium.com>

	* res/ael/ael_lex.c, utils/extconf.c, res/ael/ael.flex: don't
	  blindly assume that Darwin and Cygwin need GLOB_ABORTED defined;
	  only define it if it is not already defined

	* pbx/pbx_config.c: coding style/guidelines cleanup, plus use new
	  side-effect safe S_OR

	* include/asterisk/strings.h: make S_OR and S_COR safe to use even
	  if the parameters are function calls or have side effects. it
	  still bothers me that these are called S_OR and not something
	  like ast_string_or, but that's water over the bridge

	* channels/chan_dahdi.c: put ifdef protection around the rest of
	  the libpri function calls that were added at the same time as
	  progress_with_cause move parsing of the qsig channel mapping
	  configuration option outside ifdef HAVE_PRI_INBANDDISCONNECT and
	  into a properly ifdef'd block

2008-11-06 19:46 +0000 [r155012]  Mark Michelson <mmichelson@digium.com>

	* /, configs/voicemail.conf.sample: Merged revisions 155011 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r155011 | mmichelson | 2008-11-06 13:45:52 -0600 (Thu, 06 Nov
	  2008) | 8 lines The documentation listed the ability to set
	  'maxmsg' per context. The truth is that you can only set this in
	  the general section or per mailbox. Thus I am updating the sample
	  config file to be more accurate. Thanks to sasargen on IRC for
	  bringing up this issue. ........

2008-11-06 18:19 +0000 [r154967]  Eliel C. Sardanons <eliels@gmail.com>

	* main/pbx.c: Simplify the output of [See Also]. Functions are
	  printed without parenthesis like: FUNTION Applications are
	  printed with parenthesis like: AppName() Cli commands are printed
	  like: 'core show application' The other type of references are
	  printed as they are inside the <ref> tag.

2008-11-05 22:22 +0000 [r154923-154926]  Sean Bright <sean.bright@gmail.com>

	* apps/app_directed_pickup.c: Fix some whitespace.

	* apps/app_directed_pickup.c, main/features.c: Update a couple
	  places to use the new ast_channel_search_locked API call.

2008-11-05 22:19 +0000 [r154922]  Tilghman Lesher <tlesher@digium.com>

	* main/asterisk.c: Don't read history on -rx commands. (Closes
	  issue #13571) Reported by: tzafrir Patch
	  '0001-no-need-for-history-on-asterisk-rx.patch' uploaded by
	  tzafrir.

2008-11-05 22:01 +0000 [r154919]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk.h: Fix a problem found while building res_snmp.

2008-11-05 21:58 +0000 [r154915]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/app.h, funcs/func_strings.c, main/app.c,
	  CHANGES: Add LISTFILTER dialplan function, along with supporting
	  documentation. See documentation for more information on how to
	  use it.

2008-11-05 20:45 +0000 [r154875]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Make compilation
	  of chan_dahdi so that it does not require the new
	  pri_progress_with_cause function to have libpri support work.

2008-11-05 20:33 +0000 [r154839]  Michiel van Baak <michiel@vanbaak.info>

	* res/res_http_post.c: make this compile on OpenBSD again.

2008-11-05 20:17 +0000 [r154796-154837]  Eliel C. Sardanons <eliels@gmail.com>

	* channels/chan_agent.c: Add AgentLogin(), AgentMonitorOutgoing()
	  applications and AGENT() function XML documentation.

	* apps/app_test.c: Add TestClient() and TestServer() applications
	  XML documentation.

	* apps/app_mixmonitor.c: Add more [see also] references based on
	  TFOT.

	* apps/app_macro.c: Add Macro(), MacroExit(), MacroExclusive() and
	  MacroIf() applications XML documentation. (closes issue #13699)
	  Reported by: snuffy Patches: bug13699_20081016.diff uploaded by
	  snuffy (license 35)

2008-11-05 16:11 +0000 [r154687]  Steve Murphy <murf@digium.com>

	* main/channel.c, /: Merged revisions 154685 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r154685 | murf | 2008-11-05 09:06:53 -0700 (Wed, 05 Nov 2008) | 1
	  line This fix was prompted by communication from user, who was
	  seeing thousands of error logs... looks like EAGAIN. Made such
	  uninteresting. ........

2008-11-05 14:37 +0000 [r154467-154647]  Eliel C. Sardanons <eliels@gmail.com>

	* main/pbx.c, apps/app_privacy.c, apps/app_sayunixtime.c,
	  main/features.c, apps/app_morsecode.c, apps/app_alarmreceiver.c,
	  apps/app_amd.c: Add more SeeAlso references based on TFOT.

	* doc/appdocsxml.dtd: We now can have a reference to a filename
	  inside a <see-also> tag.

	* apps/app_parkandannounce.c: - Add ParkAndAnnounce() application
	  XML documentation.

	* main/pbx.c, apps/app_page.c, apps/app_authenticate.c,
	  apps/app_dumpchan.c, apps/app_disa.c, apps/app_image.c,
	  apps/app_chanspy.c, apps/app_stack.c, apps/app_adsiprog.c: - Add
	  more <see-also> based on TFOT. - Add the 'filename' type to the
	  see-also ref. To be able to reference a filename.

	* apps/app_readfile.c, funcs/func_db.c, apps/app_sendtext.c,
	  funcs/func_blacklist.c, apps/app_url.c, apps/app_queue.c,
	  apps/app_senddtmf.c, apps/app_db.c: - Add some see-also
	  references based on TFOT.

	* apps/app_read.c: - Add Read() application XML documentation.

	* apps/app_followme.c: - Add FollowMe() application XML
	  documentation.

	* apps/app_forkcdr.c, res/res_indications.c: - Add PlayTones() and
	  StopPlayTones() applications XML documentation. - Fix a dot that
	  was outside of the <para> in the ForkCDR() XML documentation.

2008-11-04 23:23 +0000 [r154429]  Sean Bright <sean.bright@gmail.com>

	* main/channel.c, channels/chan_sip.c, include/asterisk/channel.h:
	  Introduce a new API call ast_channel_search_locked, which
	  iterates through the channel list calling a caller-defined
	  callback. The callback returns non-zero if a match is found. This
	  should speed up some of the code that I committed earlier today
	  in chan_sip (which is also updated by this commit). Reviewed by
	  russellb and kpfleming via ReviewBoard:
	  http://reviewboard.digium.com/r/28/

2008-11-04 23:03 +0000 [r154366-154428]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_iax2.c: Switch to using a thread condition to
	  signal that a child thread is ready for work, rather than a busy
	  wait. (closes issue #13011) Reported by: jpgrayson Patches:
	  chan_iax2_find_idle.patch uploaded by jpgrayson (license 492)

	* /, channels/chan_iax2.c: Merged revisions 154365 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r154365 | tilghman | 2008-11-04 14:49:33 -0600 (Tue, 04
	  Nov 2008) | 9 lines On busy systems, it's possible for the values
	  checked within a single line of code to change, unless the
	  structure is locked to ensure a consistent state. (closes issue
	  #13717) Reported by: kowalma Patches: 20081102__bug13717.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: kowalma ........

2008-11-04 20:12 +0000 [r154329]  Eliel C. Sardanons <eliels@gmail.com>

	* Makefile: We need to pass the DTD to xmlstarlet to validate
	  against it the XML. (I thought it was being read within the
	  DOCTYPE definition inside the XML).

2008-11-04 19:07 +0000 [r154268]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 154266 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r154266 | rmudgett | 2008-11-04 13:01:08 -0600 (Tue, 04
	  Nov 2008) | 4 lines JIRA ABE-1703 mISDN sets the channel to the
	  wrong state when it receives the indication AST_CONTROL_RINGING.
	  ........

2008-11-04 18:59 +0000 [r154260-154264]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_skinny.c, channels/chan_h323.c: Recorded merge
	  of revisions 154263 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r154263 | tilghman | 2008-11-04 12:58:05 -0600 (Tue, 04 Nov 2008)
	  | 3 lines Make the monitor thread non-detached, so it can be
	  joined (suggested by Russell on -dev list). ........

	* include/asterisk/devicestate.h, main/manager.c, apps/app_page.c,
	  include/asterisk/config.h, main/features.c, main/devicestate.c,
	  apps/app_queue.c, main/config.c, apps/app_voicemail.c: Slightly
	  optimize ast_devstate_str and rename global functions
	  devstate2str and config_text_file_save to have an ast_ prefix

2008-11-04 18:06 +0000 [r154225]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_forkcdr.c: Add XML documentation for the ForkCDR()
	  application.

2008-11-04 17:23 +0000 [r154186-154191]  Sean Bright <sean.bright@gmail.com>

	* main/pbx.c: GLOB_BRACE is already added to MY_GLOB_FLAGS if it is
	  supported on the platform. This should resolve some build errors
	  on Solaris. (issue #13704) Reported by: dougm

	* channels/chan_sip.c, configs/sip.conf.sample: Allow devices that
	  accept dialog-info+xml (like snoms) to get the Caller ID of the
	  calling party when subscribed to the state of an extension that
	  is ringing. This has some limitations which are documented in
	  sip.conf.sample. (closes issue #13827) Reported by: seanbright
	  Patches: issue13827.patch uploaded by seanbright (license 71)
	  Reviewed by: russellb

	* main/Makefile: Fix build errors.

2008-11-04 15:07 +0000 [r154151]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_vpb.cc, res/res_crypto.c, configure.ac,
	  cdr/cdr_adaptive_odbc.c, channels/chan_oss.c,
	  channels/chan_usbradio.c, res/res_config_odbc.c,
	  apps/app_osplookup.c, funcs/func_odbc.c, configure,
	  build_tools/menuselect-deps.in, channels/chan_alsa.c,
	  makeopts.in, cdr/cdr_odbc.c, res/res_odbc.c,
	  apps/app_voicemail.c: improve configure script to remember the
	  previous value of each dependency in build_tools/menuselect-deps,
	  so that (once it has been written) menuselect can use this
	  information to warn the user when a previously met dependency is
	  no longer met along the way, change tags used in configure
	  script, menuselect-deps and code for various dependencies to be
	  consistently named

2008-11-04 14:38 +0000 [r154149]  Eliel C. Sardanons <eliels@gmail.com>

	* channels/chan_dahdi.c: Add XML documentation for: Applications -
	  DAHDISendKeypadFacility() - DAHDISendCallreroutingFacility()

2008-11-03 22:28 +0000 [r154023-154072]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 154066 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r154066 | tilghman | 2008-11-03 16:27:10 -0600 (Mon, 03
	  Nov 2008) | 5 lines Attempting to expunge a mailbox when the
	  mailstream is NULL will crash Asterisk. (Closes issue #13829)
	  Reported by: jaroth Patch by: me (modified jaroth's patch)
	  ........

	* /, main/rtp.c: Merged revisions 154060 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r154060 | tilghman | 2008-11-03 15:48:21 -0600 (Mon, 03 Nov 2008)
	  | 3 lines Remove the potential for a division by zero error.
	  (Closes issue #13810) ........

	* funcs/func_odbc.c: Should have passed the string pointer, not the
	  ast_str structure. (closes issue #13830) Reported by: Marquis

2008-11-03 18:02 +0000 [r153983]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Updating docs

2008-11-03 17:11 +0000 [r153947]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_stack.c: Add LOCAL() function XML documentation.

2008-11-03 15:25 +0000 [r153904-153905]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Spaces to replace tabs...

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Adding a
	  separation of remote authentication and our authentication.
	  remotesecret => our password for a remote service secret => our
	  authentication when someone calls us Secret => still has both
	  functions if remotesecret is not used.

2008-11-03 13:33 +0000 [r153803-153852]  Eliel C. Sardanons <eliels@gmail.com>

	* channels/chan_iax2.c: Add XML documentation for: Functions -
	  IAXPEER() - IAXVAR()

	* channels/chan_sip.c: Add XML documentation for: Applications -
	  SIPDtmfMode() - SIPAddHeader() Functions - SIP_HEADER() -
	  SIPPEER() - SIPCHANINFO() - CHECKSIPDOMAIN()

2008-11-03 12:26 +0000 [r153787]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, autoconf/ast_ext_lib.m4: when --without-<foo> is
	  passed to the configure script, explicitly inform menuselect that
	  the package was disabled by the user

2008-11-03 01:01 +0000 [r153747]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_waitforring.c, apps/app_waitforsilence.c, apps/app_db.c,
	  apps/app_ivrdemo.c: Add XML documentation for: - WaitForSilence()
	  - WaitForNoise() - WaitForRing() - IVRDemo() - DBDel() -
	  DBDeltree() (issue #13699) Reported by: snuffy Patches:
	  bug13699_20081016.diff uploaded by snuffy (license 35) (With
	  minor changes)

2008-11-02 23:34 +0000 [r153709]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/agi.h, configure,
	  include/asterisk/autoconfig.h.in, autoconf/ast_gcc_attribute.m4,
	  configure.ac, include/asterisk/compiler.h, apps/app_stack.c:
	  instead of trying to forcibly load res_agi when app_stack is
	  loaded (even if the administrator didn't want it loaded), use GCC
	  weak symbols to determine whether it was loaded already or not;
	  if it was loaded, then use it.

2008-11-02 20:06 +0000 [r153652]  Russell Bryant <russell@digium.com>

	* /, include/asterisk/features.h: Merged revisions 153651 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r153651 | russell | 2008-11-02 13:51:17 -0600 (Sun, 02 Nov 2008)
	  | 2 lines features.h depends on linkedlists.h, so include it
	  ........

2008-11-02 19:39 +0000 [r153616-153650]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c: fix one more warning missed because i did
	  not have new enough libpri installed

	* res/res_musiconhold.c: fix small bug introduced while cleaning up
	  compiler warnings

	* /: mark this revision as merged manually

	* utils/muted.c, apps/app_authenticate.c, res/res_phoneprov.c,
	  main/utils.c, formats/format_wav_gsm.c, res/res_http_post.c,
	  res/res_musiconhold.c, channels/chan_iax2.c, res/res_jabber.c,
	  res/res_config_sqlite.c, utils/frame.c, utils/stereorize.c,
	  main/channel.c, channels/chan_dahdi.c, main/manager.c,
	  res/ael/ael.tab.c, funcs/func_odbc.c, main/ast_expr2f.c,
	  res/res_agi.c, main/http.c, main/logger.c, formats/format_gsm.c,
	  apps/app_adsiprog.c, apps/app_dial.c, channels/chan_sip.c,
	  apps/app_festival.c, formats/format_wav.c, res/ael/ael.y,
	  main/db1-ast/hash/hash_page.c, agi/eagi-test.c, res/res_crypto.c,
	  utils/astman.c, pbx/pbx_lua.c, formats/format_ogg_vorbis.c,
	  utils/astcanary.c, apps/app_queue.c, channels/chan_oss.c,
	  agi/eagi-sphinx-test.c, res/ael/ael_lex.c, channels/chan_h323.c,
	  main/file.c, apps/app_sms.c, pbx/pbx_dundi.c, res/ael/ael.flex,
	  pbx/pbx_config.c, apps/app_chanspy.c, apps/app_stack.c,
	  utils/streamplayer.c, main/asterisk.c, apps/app_voicemail.c:
	  bring over all the fixes for the warnings found by gcc 4.3.x from
	  the 1.4 branch, and add the ones needed for all the new code here
	  too

2008-11-02 06:24 +0000 [r153582]  Eliel C. Sardanons <eliels@gmail.com>

	* channels/chan_iax2.c: Add IAX2Provision() application XML
	  documentation.

2008-11-02 05:56 +0000 [r153577-153580]  Russell Bryant <russell@digium.com>

	* Makefile: validate-docs is a PHONY target

	* Makefile, configure, configure.ac, makeopts.in: Add a handy
	  makefile target so that you can validate the documentation
	  against the DTD by running "make validate-docs"

	* Makefile: Modify the Makefile logic for extracting documentation.
	  - Build the documentation when you run "make", as opposed to
	  "make install" - Only rebuild the documentation when source code
	  has been changed

2008-11-02 05:10 +0000 [r153541-153543]  Eliel C. Sardanons <eliels@gmail.com>

	* apps/app_flash.c: Add Flash() application XML documentation.

	* apps/app_talkdetect.c: Fix a typo in the name of the application.

2008-11-02 04:14 +0000 [r153472-153507]  Sean Bright <sean.bright@gmail.com>

	* channels/Makefile: There is a troublesome assert() in the
	  alsa/control.h header that causes GCC 4.3.2 to complain that the
	  passed argument will always evaluate to true. So to get things to
	  compile, disable assert when building chan_usbradio.so.

	* apps/app_record.c: Another little one.

2008-11-02 02:55 +0000 [r153362-153470]  Russell Bryant <russell@digium.com>

	* apps/app_page.c: fix a typo (thanks sean)

	* apps/app_dial.c, funcs/func_speex.c, apps/app_page.c,
	  apps/app_record.c, funcs/func_env.c, apps/app_dahdiras.c,
	  funcs/func_math.c, funcs/func_strings.c, apps/app_userevent.c,
	  apps/app_exec.c, apps/app_chanspy.c, apps/app_playback.c: Fix
	  various spelling and grammatical issues in documentation

	* apps/app_voicemail.c: - Use a for loop instead of a while loop -
	  Get rid of an unnecessary variable

	* apps/app_directed_pickup.c: Instead of doing a couple of strlen()
	  calls each iteration of the loop, only do it once at the
	  beginning of the function

	* channels/chan_sip.c: Don't ignore the result of find_peer() when
	  looking for a peer by IP in check_peer_ok().

	* funcs/func_speex.c, apps/app_dahdibarge.c, funcs/func_rand.c,
	  apps/app_readfile.c, funcs/func_module.c, funcs/func_dialgroup.c,
	  include/asterisk/autoconfig.h.in, funcs/func_env.c,
	  apps/app_dahdiscan.c, apps/app_record.c, funcs/func_strings.c,
	  apps/app_sayunixtime.c, include/asterisk/extconf.h,
	  apps/app_alarmreceiver.c, apps/app_image.c,
	  apps/app_chanisavail.c, apps/app_ices.c, apps/app_exec.c,
	  main/config.c, main/term.c, include/asterisk/compat.h, configure,
	  funcs/func_shell.c, apps/app_skel.c, apps/app_dumpchan.c,
	  include/asterisk/module.h, main/features.c, apps/app_amd.c,
	  apps/app_url.c, apps/app_milliwatt.c, apps/app_dial.c,
	  main/pbx.c, include/asterisk/xml.h (added), apps/app_page.c,
	  funcs/func_timeout.c, main/Makefile, apps/app_privacy.c,
	  apps/app_echo.c, apps/app_softhangup.c, apps/app_fax.c,
	  funcs/func_math.c, apps/app_dahdiras.c, configure.ac,
	  apps/app_disa.c, apps/app_morsecode.c, funcs/func_cut.c,
	  apps/app_talkdetect.c, apps/app_transfer.c, apps/app_playback.c,
	  doc/tex/asterisk-conf.tex, Makefile, apps/app_sendtext.c,
	  funcs/func_channel.c, funcs/func_cdr.c, apps/app_zapateller.c,
	  build_tools/get_documentation (added), funcs/func_iconv.c,
	  apps/app_mixmonitor.c, apps/app_chanspy.c, main/asterisk.c,
	  apps/app_cdr.c, funcs/func_base64.c, funcs/func_md5.c,
	  apps/app_dictate.c, apps/app_authenticate.c,
	  apps/app_readexten.c, apps/app_userevent.c, funcs/func_vmcount.c,
	  main/xml.c (added), funcs/func_sha1.c, funcs/func_logic.c,
	  funcs/func_uri.c, apps/app_controlplayback.c, funcs/func_enum.c,
	  apps/app_setcallerid.c, funcs/func_groupcount.c,
	  funcs/func_config.c, funcs/func_volume.c, funcs/func_odbc.c,
	  apps/app_mp3.c, apps/app_directory.c, apps/app_jack.c,
	  apps/app_adsiprog.c, apps/app_while.c, apps/app_nbscat.c,
	  funcs/func_dialplan.c, funcs/func_db.c, funcs/func_version.c,
	  apps/app_festival.c, funcs/func_lock.c, apps/app_waituntil.c,
	  doc, include/asterisk/term.h, include/asterisk/_private.h,
	  apps/app_system.c, apps/app_getcpeid.c, apps/app_queue.c,
	  funcs/func_global.c, funcs/func_extstate.c,
	  funcs/func_realtime.c, apps/app_channelredirect.c,
	  funcs/func_blacklist.c, apps/app_directed_pickup.c,
	  include/asterisk/pbx.h, include/asterisk/strings.h, makeopts.in,
	  apps/app_senddtmf.c, funcs/func_devstate.c,
	  funcs/func_callerid.c, doc/appdocsxml.dtd (added),
	  apps/app_verbose.c, apps/app_stack.c: Merge changes from
	  team/group/appdocsxml This commit introduces the first phase of
	  an effort to manage documentation of the interfaces in Asterisk
	  in an XML format. Currently, a new format is available for
	  applications and dialplan functions. A good number of conversions
	  to the new format are also included. For more information, see
	  the following message to asterisk-dev:
	  http://lists.digium.com/pipermail/asterisk-dev/2008-October/034968.html

	* channels/chan_sip.c: Ensure that the sip_pvt properly has its
	  refcount incremented when the scheduler holds a reference to it
	  for session timer processing.

2008-11-01 01:55 +0000 [r153296]  Sean Bright <sean.bright@gmail.com>

	* configs/sip.conf.sample: The default in chan_sip for
	  notifyringing is yes, so update the sample conf to reflect that.

2008-10-31 20:05 +0000 [r153223]  Mark Michelson <mmichelson@digium.com>

	* main/dial.c, apps/app_page.c, include/asterisk/dial.h, CHANGES: *
	  Fixed timeout logic in the dialing API as setting timeouts had no
	  effect * Updated dialing API documentation to indicate that
	  timeouts are specified in milliseconds * Added a new timeout
	  argument to the Page application. If time expires, any endpoints
	  which have not answered will be hung up.

2008-10-31 18:55 +0000 [r153181]  Terry Wilson <twilson@digium.com>

	* apps/app_dial.c, main/features.c, include/asterisk/channel.h,
	  apps/app_followme.c, apps/app_queue.c: Recent CDR fixes moved
	  execution of the 'h' exten into the bridging code, so variables
	  that were set after ast_bridge_call was called would not show up
	  in the 'h' exten. Added a callback function to handle setting
	  variables, etc. from w/in the bridging code. Calls back into a
	  nested function within the function calling ast_bridge_call
	  (closes issue #13793) Reported by: greenfieldtech

2008-10-31 17:18 +0000 [r153122-153124]  Tilghman Lesher <tlesher@digium.com>

	* configs/func_odbc.conf.sample, funcs/func_odbc.c, CHANGES:
	  Failover for func_odbc, allowing an INSERT query to be performed
	  when the UPDATE query initially affects 0 rows. (closes issue
	  #13083) Reported by: Corydon76 Patches:
	  20081031__bug13083.diff.txt uploaded by Corydon76 (license 14)

	* /, channels/chan_sip.c: Merged revisions 153114 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r153114 | tilghman | 2008-10-31 11:30:32 -0500 (Fri, 31 Oct 2008)
	  | 3 lines Turn off qualify on uncached realtime peers. (Closes
	  issue #13383) ........

2008-10-31 09:31 +0000 [r153057]  Russell Bryant <russell@digium.com>

	* main/channel.c: Use the ast_str API call to reset the string
	  instead of manually editing its internals (closes issue #13816)
	  Reported by: eliel Patches: channel.c.patch uploaded by eliel
	  (license 64)

2008-10-30 20:59 +0000 [r152993]  Sean Bright <sean.bright@gmail.com>

	* /, bootstrap.sh: Merged revisions 152992 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r152992 | seanbright | 2008-10-30 16:58:24 -0400 (Thu, 30 Oct
	  2008) | 2 lines The -I argument to aclocal needs a space before
	  the include directory name. ........

2008-10-30 20:46 +0000 [r152990]  Russell Bryant <russell@digium.com>

	* include/asterisk/timing.h: Add a todo for a new timing API
	  implementation that would work for Linux systems as of kernel
	  2.6.25 and glibc 2.8

2008-10-30 20:35 +0000 [r152923-152969]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_h323.c: Merged revisions 152958 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r152958 | tilghman | 2008-10-30 15:33:28 -0500 (Thu, 30
	  Oct 2008) | 3 lines Cannot join detached threads. See
	  http://www.opengroup.org/onlinepubs/000095399/functions/pthread_join.html
	  (Closes issue #13400) ........

	* channels/chan_local.c, /: Merged revisions 152922 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r152922 | tilghman | 2008-10-30 14:43:38 -0500 (Thu, 30
	  Oct 2008) | 6 lines Unlock before returning, when extension
	  doesn't exist. (closes issue #13807) Reported by: eliel Patches:
	  chan_local.c.patch uploaded by eliel (license 64) ........

2008-10-30 19:40 +0000 [r152887-152920]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Fix the sip_peer reference count with
	  respect to scheduler entries for scheduling peer pokes, and
	  scheduling peer poke expirations.

	* channels/chan_sip.c: Fix the sip_peer reference count with
	  respect to scheduler entries for registration expirations.

	* include/asterisk/sched.h: Fix a bug in AST_SCHED_REPLACE_UNREF().
	  The reference count of the object _must_ be increased before
	  creating the scheduler entry. Otherwise, you create a race
	  condition where the reference count may hit zero and the object
	  can disappear out from under you. This could also would have
	  incorrectly decreased the reference count in the case that the
	  scheduler add failed.

2008-10-30 19:23 +0000 [r152879]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: I just noticed this construct and thought it
	  was silly to have a bunch of case statements with duplicated code
	  in each case. Instead, just use the built-in fallthrough
	  capability of case statements and reduce the code to a single
	  instance

2008-10-30 19:21 +0000 [r152875-152877]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Modify the documentation of the sip_registry
	  struct - Remove a comment that says that the monitor thread is
	  the only one that ever touches these objects. This is no longer
	  the case with TCP. Also, I would eventually like to get the
	  scheduler in its own thread, so this is just a poor assumption to
	  make. - Note that reference counting of these objects with
	  respect to scheduler entries is not complete. There are some
	  leaked references when deleting scheduler entries.

	* funcs/func_db.c: - spaces to tabs - add some braces - remove
	  unnecessary cast

2008-10-30 16:54 +0000 [r152809-152812]  Kevin P. Fleming <kpfleming@digium.com>

	* main/cdr.c, /: Merged revisions 152811 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r152811 | kpfleming | 2008-10-30 11:53:48 -0500 (Thu, 30 Oct
	  2008) | 3 lines instead of comparing the string pointer to 0,
	  let's compare the value that was actually parsed out of the
	  string (found by sparse) ........

	* include/asterisk/buildinfo.h (added): try to get this committed
	  before the buildbot complains about a broken tree

	* channels/misdn/isdn_lib_intern.h, channels/misdn/isdn_lib.h,
	  main/dial.c, main/dnsmgr.c, main/buildinfo.c,
	  codecs/lpc10/chanwr.c, utils/astcanary.c,
	  channels/misdn/isdn_lib.c, main/asterisk.c, apps/app_adsiprog.c:
	  fix a few small things found by using sparse

2008-10-30 16:38 +0000 [r152807]  Mark Michelson <mmichelson@digium.com>

	* main/features.c, CHANGES, configs/features.conf.sample: After
	  seeing another problem in #asterisk stemming from the low default
	  value of featuredigittimeout, I decided it was high time to
	  change it. I have changed the default to 2000 ms based on a
	  suggestion from Leif Madsen.

2008-10-30 04:26 +0000 [r152689-152765]  Tilghman Lesher <tlesher@digium.com>

	* configs/extensions.conf.sample: Set up an example stdexten that
	  preserves the original context and extension in the CDR. (Related
	  to issue #13799) Reported by: davidw

	* CHANGES, apps/app_directory.c: Pay attention to the
	  searchcontexts entry in voicemail.conf (related to AST-125)

	* main/pbx.c: Track down and fix annoying lock errors

2008-10-29 20:53 +0000 [r152646]  Mark Michelson <mmichelson@digium.com>

	* apps/app_directory.c: If there was no named defined in a
	  voicemail.conf mailbox entry, then app_directory would crash when
	  attempting to read that entry from the file. We now check for the
	  NULL or empty string properly so that there will be no crash.
	  (closes issue #13804) Reported by: bluecrow76

2008-10-29 05:47 +0000 [r152605]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, /, apps/app_queue.c,
	  configs/features.conf.sample: Merged revisions 152538 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r152538 | murf | 2008-10-28 23:19:04 -0600 (Tue, 28 Oct 2008) |
	  14 lines A little documentation cross-ref between features and
	  dial and queue... I wasted some time (stupidly) trying to get the
	  one-touch parking stuff working, because it didn't occur to me
	  that I had to also have the corresponding options in the dial
	  command! Duh! (In all this time, I never set this up before!) So,
	  to keep some poor fool from suffering the same fate, I made the
	  features.conf.sample file mention the corresponding opts in
	  dial/queue; and the docs for dial/app specifically mention the
	  corresponding decls in the feature.conf file. I hope this doesn't
	  spoil some vast, eternal plan... ........

2008-10-29 05:34 +0000 [r152569]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 152539 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r152539 | russell | 2008-10-29 00:23:51 -0500 (Wed, 29 Oct 2008)
	  | 7 lines Fix an incorrect usage of sizeof() (closes issue
	  #13795) Reported by: andrew53 Patches: chan_sip_sizeof.patch
	  uploaded by andrew53 (license 519) ........

2008-10-29 05:01 +0000 [r152536]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, /, main/features.c, include/asterisk/pbx.h,
	  apps/app_queue.c, include/asterisk/features.h: Merged revisions
	  152535 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r152535 | murf | 2008-10-28 22:36:32 -0600 (Tue, 28 Oct 2008) |
	  46 lines The magic trick to avoid this crash is not to try to
	  find the channel by name in the list, which is slow and resource
	  consuming, but rather to pay attention to the result codes from
	  the ast_bridge_call, to which I added the
	  AST_PBX_NO_HANGUP_PEER_PARKED value, which now are returned when
	  a channel is parked. Why? because CDR's aren't generated via
	  parking, so nothing is needed, but if a transfer occurred, there
	  are critical things I need. If you get AST_PBX_KEEPALIVE, then
	  don't touch the channel pointer. If you get
	  AST_PBX_NO_HANGUP_PEER, or AST_PBX_NO_HANGUP_PEER_PARKED, then
	  don't touch the peer pointer. Updated the several places where
	  the results from a bridge were not being properly obeyed, and
	  fixed some code I had introduced so that the results of the
	  bridge were not overridden (in trunk). All the places that
	  previously tested for AST_PBX_NO_HANGUP_PEER now have to check
	  for both AST_PBX_NO_HANGUP_PEER and
	  AST_PBX_NO_HANGUP_PEER_PARKED. I tested this against the 4 common
	  parking scenarios: 1. A calls B; B answers; A parks B; B hangs up
	  while A is getting the parking slot announcement, immediately
	  after being put on hold. 2. A calls B; B answers; A parks B; B
	  hangs up after A has been hung up, but before the park times out.
	  3. A calls B; B answers; B parks A; A hangs up while B is getting
	  the parking slot announcement, immediately after being put on
	  hold. 4. A calls B; B answers; B parks A; A hangs up after B has
	  been hung up, but before the park times out. No crash. I also ran
	  the scenarios above against valgrind, and accesses looked good.
	  ........

2008-10-28 22:33 +0000 [r152467]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 152463 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r152463 | tilghman | 2008-10-28 17:32:34 -0500 (Tue, 28
	  Oct 2008) | 3 lines Quoting in the wrong direction (Fixes
	  AST-107) ........

2008-10-28 22:26 +0000 [r152448]  Doug Bailey <dbailey@digium.com>

	* configs/phoneprov.conf.sample: Add more polycom firmware files to
	  static mapping

2008-10-28 21:38 +0000 [r152369-152442]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_mgcp.c: Only re-add the io port if it was closed,
	  otherwise reload causes a memory leak. (closes issue #13785)
	  Reported by: eliel Patches: chan_mgcp.c.patch uploaded by eliel
	  (license 64)

	* apps/app_dial.c, /: Merged revisions 152368 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r152368 | tilghman | 2008-10-28 12:04:56 -0500 (Tue, 28 Oct 2008)
	  | 8 lines Reset all DIAL variables back to blank, in case Dial is
	  called multiple times per call (which could otherwise lead to
	  inconsistent status reports). (closes issue #13216) Reported by:
	  ruddy Patches: 20081014__bug13216.diff.txt uploaded by Corydon76
	  (license 14) Tested by: ruddy ........

2008-10-27 23:31 +0000 [r152287]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 152286 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r152286 | jpeeler | 2008-10-27 18:28:49 -0500 (Mon, 27
	  Oct 2008) | 2 lines Buffer policy setting for half is not needed.
	  ........

2008-10-27 21:34 +0000 [r152134-152216]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_local.c, /: Merged revisions 152215 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r152215 | tilghman | 2008-10-27 16:32:00 -0500 (Mon, 27
	  Oct 2008) | 6 lines Inherit ALL elements of CallerID across a
	  local channel. (closes issue #13368) Reported by: Peter Schlaile
	  Patches: 20080826__bug13368.diff.txt uploaded by Corydon76
	  (license 14) ........

	* apps/app_stack.c: Set ARGC in subroutines with the number of
	  arguments passed.

	* apps/app_stack.c: Oops, only delete the ARG variables once upon
	  release. The following section would have removed them again
	  (removing variables from 2 stack frames, instead of just one).

2008-10-27 16:03 +0000 [r152132]  Jason Parker <jparker@digium.com>

	* apps/app_transfer.c: Remove options argument parsing/syntax (it
	  isn't used any longer) (closes issue #13789) Reported by: IgorG
	  Patches: app_transfer.c.diff uploaded by IgorG (license 20)

2008-10-26 20:25 +0000 [r152060]  Sean Bright <sean.bright@gmail.com>

	* /, funcs/func_strings.c: Merged revisions 152059 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r152059 | seanbright | 2008-10-26 16:23:36 -0400 (Sun,
	  26 Oct 2008) | 7 lines Since passing \0 as the second argument to
	  strchr is valid (and will match the trailing \0 of a string) we
	  need to check that first, otherwise we end up with incorrect
	  results. Fix suggested by reporter. (closes issue #13787)
	  Reported by: meitinger ........

2008-10-26 10:23 +0000 [r151980-152020]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Trying to fix the user/peer matching
	  correctly. This will need some testing before getting merged into
	  1.6.1

	* channels/chan_sip.c: Moving more variables to the sip_cfg
	  structure, as I have some future ideas for the usage of that
	  structure.

	* channels/chan_sip.c: Doxygen changes and some formatting.

2008-10-25 11:02 +0000 [r151906]  Russell Bryant <russell@digium.com>

	* /, main/asterisk.c: Merged revisions 151905 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r151905 | russell | 2008-10-25 05:59:02 -0500 (Sat, 25 Oct 2008)
	  | 8 lines Move AMI initialization to occur after loading modules.
	  This prevents a deadlock when someone tries to initiate a module
	  reload from the AMI just as Asterisk is starting. (closes issue
	  #13778) Reported by: hotsblanc Fix suggested by hotsblanc
	  ........

2008-10-23 21:27 +0000 [r151830]  Terry Wilson <twilson@digium.com>

	* funcs/func_odbc.c: allow to compile under --enable-dev-mode (gcc
	  didn't actually complain when I was using ccache...)

2008-10-23 15:54 +0000 [r151762]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/vmdb.sql: Clarify documentation, following merge
	  of realtime_update2 branch

2008-10-23 15:38 +0000 [r151739-151761]  Olle Johansson <oej@edvina.net>

	* CHANGES: Thanks russellb for reminding an old man....

	* channels/chan_sip.c, doc/tex/channelvariables.tex: Adding a small
	  new feature. Setting _SIPFROMDOMAIN in a channel will set the
	  domain we use for the URI in the outbound call leg.

2008-10-23 15:28 +0000 [r151732]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_odbc.c: Simplify some nested functions, as suggested
	  by Russell on -dev

2008-10-23 15:09 +0000 [r151722]  Doug Bailey <dbailey@digium.com>

	* res/res_http_post.c: Add patch to handle how IE7 issues POST
	  requests using Window path spec including backslash delimiters

2008-10-22 22:11 +0000 [r151682]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_odbc.c, CHANGES: Added debugging CLI functions

2008-10-22 20:45 +0000 [r151642]  BJ Weschke <bweschke@btwtech.com>

	* channels/chan_sip.c: revert the changes in issue #13705 - it's
	  being re-opened as while the results fixed the complaint in the
	  issue, it introduced other more undesirable issues than what was
	  already reported

2008-10-22 20:05 +0000 [r151601]  Tilghman Lesher <tlesher@digium.com>

	* contrib/scripts/live_ast (added): Add a contributed script for
	  running Asterisk without installing it, first. (closes issue
	  #11680) Reported by: tzafrir Patches: live_ast_6 uploaded by
	  tzafrir (license 46)

2008-10-22 20:05 +0000 [r151600]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_dahdi.c: Change some logical ands to bitwise ands
	  and add messages alerting that a channel is being ignored if the
	  PROC_DAHDI_NOCHAN option is set in process_dahdi. (closes issue
	  #13759) Reported by: smurfix Patches: dahdi.patch uploaded by
	  smurfix (license 547)

2008-10-22 17:45 +0000 [r151554-151555]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Print out the right var in the log message

	* channels/chan_sip.c: Fix this check to use the proper variable
	  (the result from get_in_brackets)

2008-10-22 15:08 +0000 [r151420-151512]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: The logic of a strncasecmp call was
	  reversed. (closes issue #13706) Reported by: andrew53 Patches:
	  sip_notify_from_rfc3265.patch uploaded by andrew53 (license 519)

	* channels/chan_sip.c: Make the sip_standard_port function more
	  granular by allowing separate type and port arguments. This is
	  necessary because when building our From and Contact headers, we
	  need to be absolutely sure that we are placing our source port
	  there and not the peer's source port. (closes issue #12761)
	  Reported by: asbestoshead Patches:
	  patch-chan-sip-contact-port.txt uploaded by asbestoshead (license
	  455)

	* channels/chan_sip.c: Get this compiling in dev-mode

	* channels/chan_sip.c: If a peer uses any transport other than UDP,
	  then MWI will fail for that peer since sip_alloc will allocate a
	  sip_pvt with a default transport of UDP. This change resets the
	  socket type immediately after allocating the sip_pvt in
	  sip_send_mwi_from_peer, so that the proceeding call to
	  create_addr_from_peer does not fail right away. The socket data
	  from the peer is properly copied to the sip_pvt in
	  create_addr_from_peer. (closes issue #13710) Reported by:
	  andrew53 Patches: sip_notify_use_tcp.patch uploaded by andrew53
	  (license 519)

	* channels/chan_sip.c: When attempting to resolve hostnames, we
	  need to be sure to remove any parameters from the string so that
	  name resolution succeeds. (closes issue #13727) Reported by:
	  fnordian Patches: resolvewithouturiparameter.patch uploaded by
	  fnordian (license 110)

2008-10-21 15:20 +0000 [r151371]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_mixmonitor.c: Default file modes should always be full
	  read and write, to allow the system administrator to make the
	  decision of what permissions will actually be given, through the
	  use of the process umask. (Closes issue# 13751)

2008-10-21 11:02 +0000 [r151327]  BJ Weschke <bweschke@btwtech.com>

	* channels/chan_sip.c: Fix configuration parsing so type=friend
	  still identifies "friend" as a peer even though it is now a
	  legacy configuration verb. (closes issue #13705) reported by:
	  blitzrage patched by: bweschke

2008-10-20 05:07 +0000 [r151246]  BJ Weschke <bweschke@btwtech.com>

	* pbx/pbx_config.c, main/config.c: Do NOT attempt to do anything
	  with the ast_config struct when it's been returned as INVALID by
	  the config file interpreter. (closes issue #13741)

2008-10-20 05:00 +0000 [r151242-151243]  Kevin P. Fleming <kpfleming@digium.com>

	* autoconf/ast_check_pwlib.m4, /, autoconf/ast_check_openh323.m4,
	  configure.ac: Merged revisions 151241 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r151241 | kpfleming | 2008-10-20 07:57:33 +0300 (Mon, 20 Oct
	  2008) | 2 lines rename this macro to properly reflect what it
	  does ........

	* autoconf/ast_prog_egrep.m4, autoconf/ast_c_define_check.m4,
	  autoconf/ast_ext_tool_check.m4 (added),
	  autoconf/ast_check_mandatory.m4 (added), /,
	  autoconf/ast_check_openh323.m4, autoconf/ast_prog_ld_gnu.m4,
	  autoconf/ast_prog_sed.m4, acinclude.m4 (removed),
	  autoconf/ast_check_pwlib.m4, autoconf (added),
	  autoconf/acx_pthread.m4, autoconf/ast_func_fork.m4, configure,
	  autoconf/ast_gcc_attribute.m4, bootstrap.sh,
	  autoconf/ast_check_gnu_make.m4, autoconf/ast_ext_lib.m4,
	  autoconf/ast_prog_ld.m4, autoconf/ast_c_compile_check.m4: Merged
	  revisions 151240 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r151240 | kpfleming | 2008-10-20 07:45:56 +0300 (Mon, 20 Oct
	  2008) | 3 lines break up acinclude.m4 into individual files,
	  which will make it easier to maintain, easier to add new macros
	  (less patching) and will ease maintenance of these macros across
	  Asterisk branches ........

2008-10-19 20:30 +0000 [r151188-151190]  BJ Weschke <bweschke@btwtech.com>

	* /: Block 151167 from coming forward into the /trunk this is a 1.4
	  fix only.

	* /: Block 151100 from coming forward into the /trunk this is a 1.4
	  fix only.

2008-10-19 19:11 +0000 [r151101]  Kevin P. Fleming <kpfleming@digium.com>

	* main/tcptls.c, main/manager.c, channels/chan_sip.c, main/http.c,
	  apps/app_externalivr.c, include/asterisk/tcptls.h: cleaup of the
	  TCP/TLS socket API: 1) rename 'struct server_args' to 'struct
	  ast_tcptls_session_args', to follow coding guidelines 2) make
	  ast_make_file_from_fd() static and rename it to something that
	  indicates what it really is for (again coding guidelines) 3)
	  rename address variables inside 'struct ast_tcptls_session_args'
	  to be more descriptive (dare i say it... coding guidelines) 4)
	  change ast_tcptls_client_start() to use the new 'remote_address'
	  field of the session args for the destination of the connection,
	  and use the 'local_address' field to bind() the socket to the
	  proper source address, if one is supplied 5) in chan_sip, ensure
	  that we pass in the PP address we are bound to when creating
	  outbound (client) connections, so that our connections will
	  appear from the correct address

2008-10-19 13:10 +0000 [r151060]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: dont segfault when placing a call to a
	  line that has no registered device.

2008-10-19 07:20 +0000 [r151019]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Adding changes from train and flight back
	  home from SIPit23 in Lannion, France. - Additional comments on
	  TCP/TLS implementation - Some additions for new drafts/rfcs (no
	  new functionality really, mostly documentation) - Other random
	  small fixes

2008-10-18 10:27 +0000 [r150930-150971]  Michiel van Baak <michiel@vanbaak.info>

	* Makefile: Make sure we support nested functions and generation of
	  trampolines under OpenBSD. (closes issue #13724) Reported by:
	  mvanbaak

	* contrib/init.d/rc.mandriva.asterisk,
	  contrib/init.d/rc.debian.asterisk,
	  contrib/init.d/rc.redhat.asterisk,
	  contrib/init.d/rc.suse.asterisk: dont use deprecated commands in
	  the init scripts. (closes issue #13720) Reported by:
	  decryptus_proformatique Patches:
	  contrib_initd_module_reload.patch uploaded by decryptus (license
	  555) With mods by me to fix stop commands as well

2008-10-18 03:35 +0000 [r150773-150887]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_authenticate.c, CHANGES: Give app_authenticate the
	  ability to select a prompt other than the default. (closes issue
	  #13734) reported and patched by: jvandal

	* main/manager.c, /: Using the GetVar handler in AMI is potentially
	  dangerous (insta-crash [tm]) when you use a dialplan function
	  that requires a channel and then you don't provide one or provide
	  an invalid one in the Channel: parameter. We'll handle this
	  situation exactly the same way it was handled in pbx.c back on
	  r61766. We'll create a bogus channel for the function call and
	  destroy it when we're done. If we have trouble allocating the
	  bogus channel then we're not going to try executing the function
	  call at all and run the risk of crashing. (closes issue #13715)
	  reported by: makoto patch by: bweschke

	* doc/manager_1_1.txt, CHANGES, apps/app_queue.c: The QueueEntry
	  event now has the uniqueid of the channel included. (closes issue
	  #13731) reported and patched by: caio1982

2008-10-17 21:48 +0000 [r150731]  Matthew Fredrickson <creslin@digium.com>

	* configure, configure.ac: Update configure check to check for new
	  function in libpri (pri_progress_with_cause)

2008-10-17 21:35 +0000 [r150729]  Jason Parker <jparker@digium.com>

	* codecs/codec_adpcm.c, codecs/ex_g722.h (added),
	  codecs/codec_gsm.c, codecs/ex_adpcm.h (added), codecs/ex_alaw.h
	  (added), codecs/ex_g726.h (added), codecs/ex_gsm.h (added),
	  codecs/slin_ulaw_ex.h (removed), codecs/slin_lpc10_ex.h
	  (removed), codecs/codec_resample.c, codecs/slin_g722_ex.h
	  (removed), codecs/g722_slin_ex.h (removed), codecs/ex_ulaw.h
	  (added), codecs/adpcm_slin_ex.h (removed), codecs/ex_ilbc.h
	  (added), codecs/slin_adpcm_ex.h (removed), codecs/g726_slin_ex.h
	  (removed), codecs/slin_g726_ex.h (removed), codecs/codec_lpc10.c,
	  codecs/gsm_slin_ex.h (removed), codecs/slin_gsm_ex.h (removed),
	  codecs/codec_a_mu.c, codecs/codec_g722.c, codecs/ex_lpc10.h
	  (added), codecs/codec_alaw.c, codecs/codec_speex.c,
	  codecs/codec_g726.c, include/asterisk/slin.h (added),
	  codecs/ex_speex.h (added), codecs/slin_resample_ex.h (removed),
	  codecs/ulaw_slin_ex.h (removed), codecs/slin_ilbc_ex.h (removed),
	  codecs/ilbc_slin_ex.h (removed), codecs/lpc10_slin_ex.h
	  (removed), codecs/codec_ulaw.c, codecs/codec_ilbc.c,
	  codecs/speex_slin_ex.h (removed), codecs/slin_speex_ex.h
	  (removed): Merge codec_consistency branch. This should make
	  sample usage much happier.

2008-10-17 17:31 +0000 [r150664]  Michiel van Baak <michiel@vanbaak.info>

	* main/cli.c: Fix CLI command 'channel request hangup' Prodded on
	  IRC by Russell and fixed by eliel (closes issue #13730) Reported
	  by: eliel Patches: main_cli.patch uploaded by eliel (license 64)

2008-10-17 17:25 +0000 [r150640]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_dahdi.c, configs/chan_dahdi.conf.sample: Merge in
	  patch for #13454. Includes CallRereouting dialplan application,
	  option for discard of remote hold messages, and using the
	  alternate logical channel mapping in Q.SIG instead of the default
	  physical channel mapping.

2008-10-17 17:09 +0000 [r150580-150635]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_iax2.c: Make helper call a little safer (suggested
	  by Russell on IRC)

	* include/asterisk/sched.h, channels/chan_iax2.c: Fix the FRACK!
	  warnings in chan_iax2 when POKE/LAGRQ packets are not answered.

2008-10-17 08:42 +0000 [r150469-150510]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Adding some additional thoughts on
	  configuration changes to TCP/TLS

	* Makefile: Make sure we support nested functions with GCC 4.01
	  OS/X. This might not be OS/X only, but I'll leave it to kpfleming
	  to add this to the configure script for testing.

2008-10-17 06:00 +0000 [r150426]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c, UPGRADE.txt, configs/skinny.conf.sample,
	  CHANGES: Break up skinny.conf into seperate sections for devices
	  and lines. (closes issue #13412) Reported by: wedhorn Patches:
	  config-restruct-v4.diff uploaded by wedhorn (license 30)

2008-10-17 04:28 +0000 [r150384]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_meetme.c: Fix option handling code. (closes issue
	  #11040) Reported by: DEA Patches: rt-meetme-flag-fixes-v2.txt
	  uploaded by DEA (license 3) with additional fixes by me

2008-10-17 00:18 +0000 [r150311]  Mark Michelson <mmichelson@digium.com>

	* doc/manager_1_1.txt, CHANGES, channels/chan_iax2.c: Add an
	  IAXregistry manager command. See doc/manager_1_1.txt for more
	  details of this command. (closes issue #13326) Reported by: ib2
	  Patches: bug13326_trunk_20080822.diff uploaded by snuffy (license
	  35)

2008-10-17 00:14 +0000 [r150309]  Jeff Peeler <jpeeler@digium.com>

	* apps/app_meetme.c: Initialize character arrays as they are not
	  guaranteed to be set.

2008-10-17 00:13 +0000 [r150207-150307]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: After a long discussion on #asterisk-bugs,
	  it seems kind of odd that a channel would be named after the
	  originating port. For endpoints that always include ":5060" as
	  part of the From: header, it will mean that you have a ton of
	  channels with names like "SIP/5060-3ea38a8b." I am boldly moving
	  forward with this change in trunk, but I'm not touching other
	  branches with this one since this definitely would qualify as a
	  behavior change. If there is a problem with this commit, and I
	  haven't seen the obvious reason why you'd want to name the
	  channel after the port from which the call originated, then
	  please feel free to revert this

	* main/manager.c, /: Merged revisions 150304 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r150304 | mmichelson | 2008-10-16 18:40:54 -0500 (Thu, 16 Oct
	  2008) | 6 lines Reverting changes from commits 150298 and 150301
	  since I was mistakenly under the assumption that dialplan
	  functions *always* required that a channel be present. I need to
	  go home earlier, I think :) ........

	* main/manager.c: Merged revisions 150298,150301 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r150298 | mmichelson | 2008-10-16 18:34:37 -0500 (Thu, 16 Oct
	  2008) | 10 lines Don't try to call a dialplan function's read
	  callback from the manager's GetVar handler if an invalid channel
	  has been specified. Several dialplan functions, including CHANNEL
	  and SIP_HEADER, do not check for NULL-ness of the channel being
	  passed in. (closes issue #13715) Reported by: makoto ........
	  r150301 | mmichelson | 2008-10-16 18:35:07 -0500 (Thu, 16 Oct
	  2008) | 3 lines And don't forget to return on the error condition
	  ........

	* apps/app_sms.c: Answer the channel prior to checking for the 'a'
	  option in app_sms. (closes issue #13675) Reported by: alecdavis
	  Patches: app_sms.bug13675.148985.diff.txt uploaded by alecdavis
	  (license 585)

	* apps/app_skel.c: Updating app_skel.c to follow coding guidelines
	  with regards to braces used on if statements. (closes issue
	  #13696) Reported by: alecdavis Patches:
	  app_skel.bug13696B.115850.diff.txt uploaded by alecdavis (license
	  585)

	* channels/chan_iax2.c: Remove an odd redundant comparison

	* configure, configure.ac: Change configure script to search for
	  openais in both /usr/lib and /usr/lib64 since some distros place
	  64-bit libraries only in the /usr/lib64 directory. (closes issue
	  #13721) Reported by: jcollie Patches:
	  0007-Look-in-64bit-dirs-for-openais.patch uploaded by jcollie
	  (license 412)

	* channels/chan_sip.c: INVITES with proxy auth were sent with a
	  different branch than what was in the invite_branch of a sip_pvt,
	  meaning that if a CANCEL were sent later, the branch in the
	  CANCEL would not match the branch in the latest INVITE sent out,
	  leading to some endpoints responding to the CANCEL with a 481.
	  (closes issue #13714) Reported by: fnordian Patches:
	  invite_branch.patch uploaded by fnordian (license 110)

2008-10-16 16:04 +0000 [r150125]  Richard Mudgett <rmudgett@digium.com>

	* channels/chan_misdn.c, /: Merged revisions 150124 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r150124 | rmudgett | 2008-10-16 10:56:06 -0500 (Thu, 16
	  Oct 2008) | 1 line Fix memory leak found by customer ........

2008-10-16 15:48 +0000 [r150118-150121]  Terry Wilson <twilson@digium.com>

	* configs/modules.conf.sample: This is nolonger needed

	* res/res_phoneprov.c: func_strings isn't a dependency of this
	  module anymore

2008-10-16 15:02 +0000 [r150052]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: ensure that type=peer entries are only
	  matched on IP/port, not on name (after oej audits all the calls
	  to find_peer() to make sure that forcenamematch is set correctly
	  in each case)

2008-10-16 15:00 +0000 [r150008-150051]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Doxygen addition

	* channels/chan_sip.c: Add some notes on problems with the TCP/TLS
	  implementation

2008-10-16 13:28 +0000 [r149917-149981]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: return this logic to where it used to be,
	  *after* the dialog->needdestroy flag has been determined to be
	  set; otherwise, we generate these debug messages every time we
	  inspect every active dialog

	* channels/chan_sip.c: some additional debugging tools added at
	  SIPit23: - move all setting of 'needdestroy' on dialog structures
	  into the history - report all tags involved when a pedantic check
	  fails on a REFER

	* res/res_phoneprov.c: inter-module dependencies should be included
	  in the source code, not just in sample config files

	* res/res_phoneprov.c: correct file name in message

	* configs/musiconhold.conf.sample, res/res_musiconhold.c, CHANGES:
	  support relative paths in musiconhold.conf, which makes moh work
	  by default when Asterisk was configured using --prefix and 'make
	  samples' is run

2008-10-15 21:36 +0000 [r149848]  BJ Weschke <bweschke@btwtech.com>

	* /: Blocking 149840 from coming forward.

2008-10-15 20:55 +0000 [r149802]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Make the sip_proxy struct reference counted.
	  This is necessary to allow for a sip_pvt to maintain a reference
	  to a sip_peer's outboundproxy even after the peer has been freed.
	  (closes issue #13700) Reported by: fnordian Patches: 13700.patch
	  uploaded by putnopvut (license 60) Tested by: fnordian

2008-10-15 20:14 +0000 [r149756]  BJ Weschke <bweschke@btwtech.com>

	* configs/agents.conf.sample, /: Merged revisions 149683 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149683 | bweschke | 2008-10-15 14:28:54 -0400 (Wed, 15 Oct 2008)
	  | 4 lines An update to the documentation/example of
	  agents.conf.sample with the correct parameter for this feature as
	  defined in chan_agent.c (closes issue #13709) ........

2008-10-15 19:07 +0000 [r149588-149687]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_odbc.c: Permit data fields to contain more than 255
	  characters. (closes issue #13631) Reported by: seanbright
	  Patches: 20081015__bug13631.diff.txt uploaded by Corydon76
	  (license 14) Tested by: blitzrage

	* funcs/func_odbc.c: Only set buf to blank before the goto.

	* codecs/lpc10/lpcini.c: When using MALLOC_DEBUG, codec_lpc10 leaks
	  memory, because it matches a library malloc() with an ast_free
	  (which, of course, doesn't match up with known allocated memory,
	  so the free fails). (closes issue #13702) Reported by: eliel
	  Patches: codec_lpc10_lpcini.c uploaded by eliel (license 64)

	* apps/app_echo.c: Minor spacing change (closes issue #13697)
	  Reported by: alecdavis Patches: app_echo.bug13697.103249.diff.txt
	  uploaded by alecdavis (license 585)

2008-10-15 13:52 +0000 [r149542]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Adding a note about a missing part of
	  "kill-the-user" - I got lost in the Ao2 world... We're going to
	  try to get time to fix this and kpfleming believes that there's
	  code in ao2 so that we can solve it...

2008-10-15 11:26 +0000 [r149384-149487]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c: Merged revisions 149452 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149452 | kpfleming | 2008-10-15 12:30:40 +0200 (Wed, 15 Oct
	  2008) | 3 lines fix some problems when parsing SIP messages that
	  have the maximum number of headers or body lines that we support
	  ........

	* configure, configure.ac: reverting this change... had not read
	  the commit list yet, didn't realize the code had been upgraded

	* configure, configure.ac: do complete version check for SpanDSP,
	  since the app_fax code is not compatible with 0.0.6 yet

	* apps/app_stack.c: building this module depends on res_agi being
	  built as well

2008-10-15 07:45 +0000 [r149342]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Fixing sytax errors ;-)

2008-10-14 23:57 +0000 [r149201-149279]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c, CHANGES: When specifying an invalid timeout to
	  Dial, take it to mean that no timeout is desired. (closes issue
	  #13625) Reported by: atis

	* /, channels/chan_sip.c: Merged revisions 149266 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149266 | mmichelson | 2008-10-14 18:43:58 -0500 (Tue, 14 Oct
	  2008) | 4 lines Change this warning to an error message.
	  Suggestion comes from Sean Bright. Thanks Sean! ........

	* /, channels/chan_sip.c: Merged revisions 149207 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149207 | mmichelson | 2008-10-14 18:10:26 -0500 (Tue, 14 Oct
	  2008) | 9 lines Call register_peer_exten even in the case that
	  the peer's IP/port does not change. (closes issue #13309)
	  Reported by: dimas Patches: v2-13309.patch uploaded by dimas
	  (license 88) ........

	* /, include/asterisk/audiohook.h, main/audiohook.c: Merged
	  revisions 149204 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149204 | mmichelson | 2008-10-14 18:00:01 -0500 (Tue, 14 Oct
	  2008) | 12 lines Add a tolerance period for sync-triggered
	  audiohooks so that if packetization of audio is close (but not
	  equal) we don't end up flushing the audiohooks over small
	  inconsistencies in synchronization. Related to issue #13005, and
	  solves the issue for most people who were experiencing the
	  problem. However, a small number of people are still experiencing
	  the problem on long calls, so I am not closing the issue yet
	  ........

	* /, apps/app_queue.c: Merged revisions 149200 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149200 | mmichelson | 2008-10-14 17:40:42 -0500 (Tue, 14 Oct
	  2008) | 12 lines Update the queue with the correct number of
	  calls and whether the call was completed within the service level
	  when a transfer takes place. This way, we do not "break" the
	  leastrecent and fewestcalls strategies by not logging a call
	  until after the transferred call has ended. (closes issue #13395)
	  Reported by: Marquis Patches: app_queue.c.transfer.patch uploaded
	  by Marquis (license 32) ........

2008-10-14 22:38 +0000 [r149199]  Tilghman Lesher <tlesher@digium.com>

	* main/hashtab.c, pbx/pbx_spool.c, channels/chan_sip.c,
	  include/asterisk/chanvars.h, include/asterisk/config.h,
	  include/asterisk/strings.h, res/res_indications.c,
	  include/asterisk/hashtab.h, main/chanvars.c, main/config.c: Add
	  additional memory debugging to several core APIs, and fix several
	  memory leaks found with these changes. (Closes issue #13505,
	  closes issue #13543) Reported by: mav3rick, triccyx Patches:
	  20081001__bug13505.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: mav3rick, triccyx

2008-10-14 21:08 +0000 [r149131]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 149130 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149130 | mmichelson | 2008-10-14 15:49:02 -0500 (Tue, 14 Oct
	  2008) | 7 lines Don't allow reserved characters to be used in
	  register lines in sip.conf. (closes issue #13570) Reported by:
	  putnopvut ........

2008-10-14 20:16 +0000 [r149062]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_waitforsilence.c: Merged revisions 149061 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r149061 | tilghman | 2008-10-14 15:09:06 -0500 (Tue, 14 Oct 2008)
	  | 6 lines Check correct values in the return of ast_waitfor();
	  also, get rid of a possible memory leak. (closes issue #13658)
	  Reported by: explidous Patch by: me ........

2008-10-14 19:35 +0000 [r149040]  Leif Madsen <lmadsen@digium.com>

	* doc/manager_1_1.txt: Add missing documentation for
	  SipShowRegistry action and RegistryEntry event. (closes issue
	  #13342) Reported and patch by: Laureano

2008-10-14 19:03 +0000 [r148917-148988]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 148987 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r148987 | tilghman | 2008-10-14 14:03:08 -0500 (Tue, 14
	  Oct 2008) | 2 lines Some compilers warn, some don't. Fixing.
	  ........

	* apps/app_sms.c: App is ignoring 'p' parameter -- initial pause.
	  (closes issue #13617) Reported by: alecdavis Patches:
	  app_sms.13oct.diff.txt uploaded by alecdavis (license 585)

	* /, apps/app_voicemail.c: Merged revisions 148916 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r148916 | tilghman | 2008-10-14 12:41:08 -0500 (Tue, 14
	  Oct 2008) | 4 lines Ensure that mail headers are 7-bit clean,
	  even when UTF-8 characters are used in headers like 'Subject' and
	  'To'. Closes AST-107. ........

2008-10-14 17:38 +0000 [r148913]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_local.c, /: Merged revisions 148912 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r148912 | mmichelson | 2008-10-14 12:33:38 -0500 (Tue,
	  14 Oct 2008) | 9 lines Deadlock prevention in chan_local. (closes
	  issue #13676) Reported by: tacvbo Patches: 13676.patch uploaded
	  by putnopvut (license 60) Tested by: tacvbo ........

2008-10-14 15:15 +0000 [r148868]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_fax.c: API differences in spandsp 0.0.6pre1 and higher
	  (closes issue #13688) Reported by: irroot Patches:
	  app_fax-span6.patch uploaded by irroot (license 52) with minor
	  modifications by me

2008-10-14 15:00 +0000 [r148867]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix reference count issue that Russell
	  brought up in SIP MWI NOTIFY support. Bump the reference count up
	  before we add it to the scheduler, duh.

2008-10-14 14:18 +0000 [r148825]  Doug Bailey <dbailey@digium.com>

	* phoneprov/polycom.xml: Allow MWI registration for all configured
	  lines.

2008-10-14 11:31 +0000 [r148695-148754]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: fix some references to the owner of a
	  private structure that may not be present

	* Makefile, /: Merged revisions 148736 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r148736 | kpfleming | 2008-10-14 12:30:54 +0200 (Tue, 14 Oct
	  2008) | 3 lines on Ubuntu (at least), recent versions of ld in
	  binutils delete all debugging symbols when -x is supplied; since
	  the reasons why -x is being passed are lost in the mists of time,
	  remove it so debugging will work properly ........

	* channels/chan_sip.c: this structure should be static

	* channels/chan_sip.c: ensure that *all* fields in the req
	  structure are cleared out before reusing it; has_to_tag was not
	  cleared, which caused the second incoming call over a TCP socket
	  to fail if pedantic checking was enabled

2008-10-14 09:16 +0000 [r148679]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Adding some clarifications

2008-10-14 08:06 +0000 [r148612]  Kevin P. Fleming <kpfleming@digium.com>

	* /, main/translate.c: Merged revisions 148611 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r148611 | kpfleming | 2008-10-14 02:54:41 -0500 (Tue, 14 Oct
	  2008) | 3 lines it would be nice if this message printing code
	  had actually been tested before it was committed... ........

2008-10-14 00:08 +0000 [r148570]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_curl.c, res/res_config_pgsql.c,
	  res/res_config_odbc.c, include/asterisk/config.h,
	  res/res_realtime.c, include/asterisk/strings.h,
	  res/res_config_ldap.c, res/res_config_sqlite.c, main/config.c,
	  apps/app_voicemail.c: Merge realtime_update2 branch, which adds a
	  new realtime API call named 'update2', which permits updates
	  which match across multiple columns, instead of requiring all
	  tables to have a single unique identifier. All of the other API
	  calls with the exception of 'update' already had the ability to
	  match on multiple fields, so it was a missing and very desireable
	  feature that an API call implementing an update should have this,
	  too. This does not change any outward performance of Asterisk,
	  but it should make life easier for application developers who use
	  the RealTime framework.

2008-10-13 17:14 +0000 [r148519]  Steve Murphy <murf@digium.com>

	* main/pbx.c: Hmmm. Nobody (but me) is interested in seeing the
	  trie info when they do 'dialplan show ...' (even with debug set
	  to non-zero); so I set up a 'dialplan debug [context]' cli
	  command instead, to explicitly show just the trie info. I even
	  added an extension_exists() call to make sure the trie info is
	  built. I moved the explanatory header to above the extension loop
	  to ensure it only prints once. And it will do this now, whether
	  debug is set or not. I removed the trie printing from the
	  'dialplan show' command entirely.

2008-10-13 15:56 +0000 [r148471-148474]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - Doxygen formatting. (tss tss) - Fixing
	  language

	* main/tcptls.c, channels/chan_sip.c: Highlightning even more bugs
	  in the current tcp/tls implementation.

	* channels/chan_sip.c: Sending a 403 after a 200 is considered very
	  bad. (found at SIPit)

2008-10-12 09:19 +0000 [r148425]  Michiel van Baak <michiel@vanbaak.info>

	* res/res_agi.c: fix the 'agi show commands' CLI function. (closes
	  issue #13666) Reported by: eliel Patches: res_agi.c.patch
	  uploaded by eliel (license 64)

2008-10-10 21:21 +0000 [r148373-148376]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: The logic used when checking a peer got
	  changed subtly in the "kill the user" commit and caused calls
	  relying on the insecure setting to not work properly. I changed
	  for finding a peer back to how it was prior to that commit.
	  (closes issue #13644) Reported by: pj Patches:
	  13644_trunkv2.patch uploaded by putnopvut (license 60) Tested by:
	  pj

	* channels/chan_sip.c: Make sure that the inUse and inRinging
	  fields for a sip peer cannot go below zero. This is a regression
	  from 1.4 and so it will be applied to 1.6.0 as well. (closes
	  issue #13668) Reported by: mjc

2008-10-10 18:59 +0000 [r148268-148329]  Tilghman Lesher <tlesher@digium.com>

	* pbx/pbx_config.c: Reset continuation items at the beginning of
	  each context (suggested by kpfleming).

	* CHANGES, pbx/pbx_config.c: Add keyword "same", which allows you
	  to create multiple steps in a dialplan, without needing to
	  respecify an extension pattern multiple times. (closes issue
	  #13632) Reported by: blitzrage Patches:
	  20081006__bug13632.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: blitzrage, Corydon76

	* /, apps/app_voicemail.c: Merged revisions 148257 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r148257 | tilghman | 2008-10-10 11:25:31 -0500 (Fri, 10
	  Oct 2008) | 7 lines User not notified of temporary greeting, if
	  ODBC storage is in use. (closes issue #13659) Reported by:
	  moliveras Patches: 20081009__bug13659.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: moliveras ........

2008-10-10 00:42 +0000 [r148200]  Sean Bright <sean.bright@gmail.com>

	* include/asterisk.h, main/tdd.c, main/cryptostub.c,
	  res/res_config_sqlite.c, apps/app_voicemail.c: Don't include
	  logger.h in asterisk.h by default as it is causing problems
	  building app_voicemail. Instead, include it where it is needed.
	  This turned out to be a relatively minor issue because other
	  headers include logger.h as well. Need to test -addons before
	  merging this back to 1.6.0. (closes issue #13605) Reported by:
	  tomo1657 Patches: 13605_seanbright.diff uploaded by seanbright
	  (license 71) Tested by: mmichelson

2008-10-09 23:54 +0000 [r148144-148160]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c: The priority was unnecessary for the manager
	  atxfer, so it has been removed. Furthermore, now we actually use
	  the Context argument passed to set the transfer context and don't
	  error out if no context is specified. This addresses the actual
	  problems outlined in issue 12158. Regarding the other points
	  brought up, regarding the inability to not transfer to extensions
	  which cannot be represented by DTMF, it is not enough of a
	  constraint that it is worth attempting to rework the feature.
	  (closes issue #12158) Reported by: davidw

	* apps/app_voicemail.c: Read the callerid in the correct order and
	  make sure to read the Urgent flag value from the IMAP headers.
	  (closes issue #13652) Reported by: jaroth Patches:
	  imapheaders.patch uploaded by jaroth (license 50)

2008-10-09 23:25 +0000 [r148120]  Tilghman Lesher <tlesher@digium.com>

	* configs/res_ldap.conf.sample: Fix example schema (closes issue
	  #12860) Reported by: flyn Patches: res_ldap.conf.patch uploaded
	  by flyn (license 503)

2008-10-09 23:15 +0000 [r148112]  Mark Michelson <mmichelson@digium.com>

	* /, main/features.c: Merged revisions 146026 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r146026 | murf | 2008-10-03 12:12:54 -0500 (Fri, 03 Oct 2008) |
	  18 lines (closes issue #13579) Reported by: dwagner (closes issue
	  #13584) Reported by: dwagner Tested by: murf, putnopvut The
	  thought occurred to me that the res= from the extension spawn was
	  ending up being returned from the bridge. "Thou shalt not poison
	  the return value". Made the change and it appears to allow blind
	  xfers to work as normal. If I'm wrong, reopen the bugs. But it
	  looks good to me! Many thanks to putnopvut for helping me
	  reproduce this! ........

2008-10-09 21:47 +0000 [r148000-148071]  Tilghman Lesher <tlesher@digium.com>

	* formats/format_wav.c, apps/app_minivm.c, channels/chan_agent.c,
	  main/file.c, res/res_monitor.c, apps/app_voicemail.c: Reverting
	  format addition for now

	* apps/app_minivm.c, channels/chan_agent.c, main/file.c,
	  res/res_monitor.c, apps/app_voicemail.c: Fudges for wav16, just
	  like wav49

	* formats/format_wav.c: Add native 16kHz format for wav file
	  format. (Closes issue #13657)

	* sounds/sounds.xml, sounds/Makefile: Publish MOH files in sln16
	  format

	* /, apps/app_voicemail.c: Merged revisions 147997 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r147997 | tilghman | 2008-10-09 14:38:33 -0500 (Thu, 09
	  Oct 2008) | 4 lines When blank, callerid name and number should
	  display "unknown caller" in voicemail emails. (Closes issue
	  #13643) ........

2008-10-09 19:27 +0000 [r147952]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c: (closes issue #13139) Reported by: krisk84
	  Tested by: krisk84 This change prevents a call that is placed in
	  the parkinglot to be picked up before the PBX is finished. If
	  another extension dials the parking extension before the PBX
	  thread has completed at minimum warnings will occur about the PBX
	  not properly being terminated. At worst, a crash could occur.

2008-10-09 17:48 +0000 [r147899]  Michiel van Baak <michiel@vanbaak.info>

	* include/asterisk/endian.h: only include this for OpenBSD. At
	  least FreeBSD is borked when including it (closes issue #13649)
	  Reported by: ys

2008-10-09 17:46 +0000 [r147896]  Tilghman Lesher <tlesher@digium.com>

	* configs/extensions.conf.sample: Remove "second form" of
	  extensions, as it no longer applies. Also, cleanup the grammar,
	  formatting, and introduce several clarifications to the text.
	  (Closes issue #13654)

2008-10-09 17:04 +0000 [r147854]  Terry Wilson <twilson@digium.com>

	* phoneprov/000000000000.cfg, res/res_phoneprov.c,
	  configs/phoneprov.conf.sample: Make phoneprov case-insensitive to
	  remove the func_strings dependency of the default config

2008-10-09 17:01 +0000 [r147853]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_dahdi.c, channels/chan_misdn.c,
	  channels/chan_h323.c: fix some CLI commands we borked during
	  devcon2008 Thanks rmudget for letting me know and providing hints
	  on how to fix it best.

2008-10-09 14:17 +0000 [r147807]  Steve Murphy <murf@digium.com>

	* main/pbx.c, include/asterisk.h, doc/CODING-GUIDELINES,
	  include/asterisk/autoconfig.h.in, channels/vcodecs.c,
	  main/translate.c, configure.ac, channels/console_video.c,
	  channels/chan_iax2.c, main/astobj2.c, channels/chan_oss.c,
	  main/rtp.c, main/config.c, main/cli.c, channels/chan_usbradio.c,
	  configure, channels/console_gui.c, utils/extconf.c: (closes issue
	  #13557) Reported by: nickpeirson Patches: pbx.c.patch uploaded by
	  nickpeirson (license 579) replace_bzero+bcopy.patch uploaded by
	  nickpeirson (license 579) Tested by: nickpeirson, murf 1.
	  replaced all refs to bzero and bcopy to memset and memmove
	  instead. 2. added a note to the CODING-GUIDELINES 3. add two
	  macros to asterisk.h to prevent bzero, bcopy from creeping back
	  into the source 4. removed bzero from configure, configure.ac,
	  autoconfig.h.in

2008-10-09 01:43 +0000 [r147760-147761]  Joshua Colp <jcolp@digium.com>

	* configs/sip.conf.sample: *whistle*

	* channels/chan_sip.c, configs/sip.conf.sample, CHANGES: Add
	  support for subscribing to a voice mailbox on a remote SIP server
	  and making the new/old message count available to local devices.
	  (issue #AST-77)

2008-10-08 22:32 +0000 [r147714]  Mark Michelson <mmichelson@digium.com>

	* apps/app_meetme.c: Some small tweaks regarding realtime
	  conference announcements. (closes issue #13522) Reported by: DEA
	  Patches: meetme-rt-fixes.txt uploaded by DEA (license 3)

2008-10-08 22:26 +0000 [r147689]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 147681 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r147681 | kpfleming | 2008-10-08 17:22:09 -0500 (Wed, 08
	  Oct 2008) | 3 lines when parsing a text configuration option,
	  ensure that the buffer on the stack is actually large enough to
	  hold the legal values of that option, and also ensure that
	  sscanf() knows to stop parsing if it would overrun the buffer
	  (without these changes, specifying "buffers=...,immediate" would
	  overflow the buffer on the stack, and could not have worked as
	  expected) ........

2008-10-08 20:07 +0000 [r147635]  Sean Bright <sean.bright@gmail.com>

	* configs/voicemail.conf.sample: Add some examples of IMAP
	  accounts.

2008-10-08 19:08 +0000 [r147592]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_sms.c: Correct a typo in the help; also, ensure that the
	  date and time are correctly set, if not specified in the message.
	  (Closes issue #13594, closes issue #13595) Reported by: alecdavis
	  Patches: 20081001__bug13595.diff.txt uploaded by Corydon76
	  (license 14) Tested by: alecdavis

2008-10-08 14:53 +0000 [r147518]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_speech_utils.c: Merged revisions 147517 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r147517 | file | 2008-10-08 11:51:42 -0300 (Wed, 08 Oct
	  2008) | 2 lines If we receive DTMF make sure that the state of
	  the speech structure goes back to being not ready. (issue
	  #LUMENVOX-8) ........

2008-10-08 12:28 +0000 [r147476]  Bradley Latus <brad.latus@gmail.com>

	* configs/iax.conf.sample: Adjust commented default trunkmtu value
	  to match documentation above it

2008-10-08 12:15 +0000 [r147388-147457]  Sean Bright <sean.bright@gmail.com>

	* funcs/func_curl.c, apps/app_meetme.c, cdr/cdr_adaptive_odbc.c,
	  res/res_odbc.c: Keep up with shadow warnings. One day I'll
	  actually enable this in the Makefile.

	* utils/Makefile: When echoing our copies, strip off ASTTOPDIR from
	  the front of the source file.

	* apps/app_dial.c, channels/chan_dahdi.c, channels/chan_iax2.c:
	  Move the DAHDI-to-DAHDI operator mode check from app_dial into
	  chan_dahdi so we don't have to hardcode anything. (closes issue
	  #13636) Reported by: seanbright Patches: 13636.diff uploaded by
	  seanbright (license 71) Reviewed by: russellb, putnopvut

2008-10-07 20:15 +0000 [r147266-147347]  Michiel van Baak <michiel@vanbaak.info>

	* configure, configure.ac: Make format_vorbis_ogg compile on
	  OpenBSD (closes issue #13639) Reported by: mvanbaak Patches:
	  2008100700_oggsupportOBSD.diff.txt uploaded by mvanbaak (license
	  7) 2008100700_oggsupportOBSD-configurescript.diff.txt uploaded by
	  mvanbaak (license 7) Tested by: mvanbaak

	* channels/Makefile: make this work on OpenBSD

	* configure, configure.ac: Make sure the configs on OpenBSD are in
	  /etc/asterisk by default (closes issue #13641) Reported by: jtodd

	* contrib/scripts/safe_asterisk_restart,
	  contrib/scripts/safe_asterisk: use pkill instead of killall to be
	  more portable

2008-10-07 18:00 +0000 [r147265]  Sean Bright <sean.bright@gmail.com>

	* apps/app_voicemail.c: This was flawed. The issue that I was
	  trying to address was addressed by adding the imapsecret alias
	  for imappassword. Will rethink this one and give it another shot
	  on a rainy day TBD.

2008-10-07 17:49 +0000 [r147264]  Michiel van Baak <michiel@vanbaak.info>

	* CHANGES: fix wording as pointed out by Corydon

2008-10-07 17:44 +0000 [r147262]  Tilghman Lesher <tlesher@digium.com>

	* UPGRADE.txt, include/asterisk/options.h, main/asterisk.c,
	  main/term.c: Allow people to select the old console behavior of
	  white text on a black background, by using the startup flag '-B'.

2008-10-07 16:52 +0000 [r147191-147194]  Sean Bright <sean.bright@gmail.com>

	* /, apps/app_voicemail.c: Merged revisions 147193 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r147193 | seanbright | 2008-10-07 12:48:30 -0400 (Tue,
	  07 Oct 2008) | 2 lines Make 'imapsecret' an alias to
	  'imappassword' in voicemail.conf. ........

	* apps/app_voicemail.c: Or not.

	* apps/app_voicemail.c: There was a boo-boo in TFOT that is causing
	  some confusion on the mailing lists so include 'imapsecret' as an
	  alias to 'imappassword' (and print a little notice nudging users
	  toward the right option name).

2008-10-07 16:04 +0000 [r147146]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c: Explicitly setting these fields to NULL was done
	  because I wasn't sure if they would be NULL otherwise. Since they
	  will be set automatically, removing.

2008-10-07 14:59 +0000 [r147050-147099]  Sean Bright <sean.bright@gmail.com>

	* apps/app_voicemail.c: If we encounter something in mailbox
	  options that we don't grok, then spit out a warning instead of
	  just silently ignoring it.

	* apps/app_dial.c: Make sure to compare the correct number of
	  characters when special-casing our DAHDI operator mode stuff.
	  Technically, it would work fine, as 'DAH' is currently unique
	  amongst our channel technologies, but as Jared points out:
	  <@jsmith> Sure... as long as the technology starts whith DAH....
	  but it could be DAHDOO!

2008-10-07 02:02 +0000 [r147011]  Richard Mudgett <rmudgett@digium.com>

	* funcs/func_callerid.c: Independent change from branch issue8824
	  that is not part of COLP. (-r142574 rmudgett)

2008-10-07 00:02 +0000 [r146970]  Terry Wilson <twilson@digium.com>

	* channels/chan_sip.c: A blind transfer to the parking thread would
	  cause a segfault because copy_request accesses dst->data w/o
	  being able to tell whether it is proerly initialized

2008-10-06 23:21 +0000 [r146928]  Tilghman Lesher <tlesher@digium.com>

	* include/asterisk/threadstorage.h: Update documentation;
	  AST_THREADSTORAGE() in trunk only takes a single argument.

2008-10-06 23:14 +0000 [r146925]  Michiel van Baak <michiel@vanbaak.info>

	* res/res_config_odbc.c, build_tools/menuselect-deps.in, configure,
	  funcs/func_odbc.c, include/asterisk/autoconfig.h.in,
	  configure.ac, cdr/cdr_adaptive_odbc.c, cdr/cdr_odbc.c,
	  makeopts.in, res/res_odbc.c, apps/app_voicemail.c: All ODBC parts
	  can now use either unixodbc or iodbc. This allows for the ODBC
	  parts to work on OpenBSD as well. 99.99% of the work is done by
	  seanbright (bow, bow) and I actually did nothing but test and
	  yell at him that it still didn't work :) Thanks for helping out !

2008-10-06 23:08 +0000 [r146875-146923]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c, res/res_agi.c, include/asterisk/features.h:
	  Similar to r143204, masquerade the channel in the case of Park
	  being called from AGI.

	* include/asterisk/endian.h: Mvanbaak said this was needed to
	  compile on OpenBSD, so put it in the OpenBSD section.

	* main/features.c: This commit squashes together three commits
	  because the wrong approach was originally used. (One of the
	  commits was only one line.) 1) r143204: The main change here was
	  to masquerade the channel if the channel that was to be parked
	  was running a PBX on it. The PBX thread can then maintain full
	  control of the channel (the zombie) as it expects to while
	  allowing the parking thread full control of the real (parked)
	  channel. 2) r143270: Changed park_call_full to hold the
	  parkinglot lock a little longer, which protects the parkeduser
	  struct from being freed out from underneath. Made sure that the
	  parking extension is added to the parking context while holding
	  the lock thereby ensuring that there are no spurious warnings
	  from removal attempts when a hangup occurs while the parking lot
	  is being announced. 3) r143475: (the one liner) compare peer and
	  chan instead of looking at the parked user (pu), which could have
	  possibly already have been freed by the parking thread

	* main/features.c: fix some comment placement

	* main/features.c: Explicitly set args in park_call_exec NULL so in
	  the case of no options being passed in, there is no garbage
	  attempted to be used. Also, do not set args to unknown value
	  again if there are no options passed in.

2008-10-06 21:18 +0000 [r146807]  Michiel van Baak <michiel@vanbaak.info>

	* include/asterisk/endian.h: make aescrypt.c compile on OpenBSD
	  again

2008-10-06 21:09 +0000 [r146802]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_curl.c, funcs/func_groupcount.c, res/res_smdi.c, /,
	  channels/chan_sip.c, funcs/func_timeout.c, funcs/func_odbc.c,
	  funcs/func_cdr.c, funcs/func_math.c, channels/chan_iax2.c,
	  funcs/func_callerid.c, apps/app_speech_utils.c: Merged revisions
	  146799 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r146799 | tilghman | 2008-10-06 15:52:04 -0500 (Mon, 06 Oct 2008)
	  | 8 lines Dialplan functions should not actually return 0, unless
	  they have modified the workspace. To signal an error (and no
	  change to the workspace), -1 should be returned instead. (closes
	  issue #13340) Reported by: kryptolus Patches:
	  20080827__bug13340__2.diff.txt uploaded by Corydon76 (license 14)
	  ........

2008-10-06 17:32 +0000 [r146738]  Sean Bright <sean.bright@gmail.com>

	* configure, configure.ac: Pretty-print a couple configure options

2008-10-06 16:52 +0000 [r146713]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_local.c, /: Merged revisions 146711 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r146711 | tilghman | 2008-10-06 11:51:21 -0500 (Mon, 06
	  Oct 2008) | 9 lines Check whether an extension exists in the
	  _call method, rather than the _alloc method, because we need to
	  evaluate the callerid (since that data affects whether an
	  extension exists). (closes issue #13343) Reported by: efutch
	  Patches: 20080915__bug13343.diff.txt uploaded by Corydon76
	  (license 14) Tested by: efutch ........

2008-10-06 16:03 +0000 [r146644]  Kevin P. Fleming <kpfleming@digium.com>

	* /: Merged revisions 146643 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r146643 | kpfleming | 2008-10-06 10:57:49 -0500 (Mon, 06 Oct
	  2008) | 8 lines ensure that the private structure for pseudo
	  channels is created without 'leaking' configuration data from
	  other configured channels (closes issue #13555) Reported by:
	  jeffg Patches: issue_13555.patch uploaded by kpfleming (license
	  421) Tested by: jeffg ........

2008-10-06 15:29 +0000 [r146640]  Mark Michelson <mmichelson@digium.com>

	* configs/queues.conf.sample, CHANGES, apps/app_queue.c: This
	  commit introduces a change to how the "joinempty" and
	  "leavewhenempty" options are configured in queues.conf. Instead
	  of using vague terms like "yes," "no," "loose," and "strict," we
	  now accept a comma-separated list of values to determine when to
	  consider a member available. Extended details can be found in the
	  queues.conf.sample file. Note also that the above four referenced
	  values are still accepted for backwards-compatibility, but are
	  mapped internally to the new method of representing the option.
	  AST-105

2008-10-06 00:36 +0000 [r146555-146597]  Sean Bright <sean.bright@gmail.com>

	* utils/Makefile: Make NOISY_BUILD work for the calls to cp in
	  utils/Makefile

	* utils/Makefile: Quote arguments to cp so we can handle spaces in
	  our paths.

2008-10-05 22:11 +0000 [r146514]  Russell Bryant <russell@digium.com>

	* utils/muted.c: Make this build on my mac.

2008-10-05 21:21 +0000 [r146449]  Jason Parker <jparker@digium.com>

	* /, channels/chan_sip.c: Recorded merge of revisions 146448 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r146448 | qwell | 2008-10-05 16:17:44 -0500 (Sun, 05 Oct 2008) |
	  1 line Fix silly formatting. ........

2008-10-05 01:59 +0000 [r146312-146407]  Sean Bright <sean.bright@gmail.com>

	* build_tools/make_buildopts_h: This is far from optimal, but I
	  just found a FreeBSD system without md5 installed on it. So look
	  around for all of the different binaries that we could possibly
	  use. I'd wager this gets completely replaced by someone else in
	  less than 24 hours... :)

	* main/asterisk.c: Fix a bug with the last item in CLI history
	  getting duplicated when read from the .asterisk_history file (and
	  subsequently being duplicated when written). We weren't checking
	  the result of fgets() which meant that we read the same line
	  twice before feof() actually returned non- zero. Also, stop
	  writing out an extra blank line between each item in the history
	  file, fix a minor off-by-one error, and use symbolic constants
	  rather than a hardcoded integer.

	* configs/sip_notify.conf.sample: Add ability to remotely reboot
	  snom phones. Also cleaned up and reorganized
	  sip_notify.conf.sample a bit as well. Tested snom reboot on snom
	  360 and verified snom-check-cfg worked as well. (closes issue
	  #13601) Reported by: mjc Tested by: seanbright

2008-10-03 22:40 +0000 [r146242]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c: remove superfluous reference counting operations
	  in manage_parkinglot since ao2_interator_next increments the ref
	  count automatically

2008-10-03 22:10 +0000 [r146198]  Sean Bright <sean.bright@gmail.com>

	* main/cli.c: Resolve a subtle bug where we would never
	  successfully be able to get the first item in the CLI entry list.
	  This was preventing '!' from showing up in either 'help' or in
	  tab completion. (closes issue #13578) Reported by: mvanbaak

2008-10-03 18:30 +0000 [r146081]  Tilghman Lesher <tlesher@digium.com>

	* CHANGES: document meetme schedule changes (related to issue
	  #11040)

2008-10-03 17:36 +0000 [r146053]  Michiel van Baak <michiel@vanbaak.info>

	* CHANGES: put a note in CHANGES about the cli_cleanup done during
	  AstriDevCon

2008-10-03 17:35 +0000 [r146052]  Terry Wilson <twilson@digium.com>

	* main/dial.c: The dialing API should inherit datastores as well as
	  variables

2008-10-02 19:30 +0000 [r145959-145962]  Russell Bryant <russell@digium.com>

	* CHANGES: The 'P' command for ExternalIVR was also added in 1.6.0

	* CHANGES: TCP support for ExternalIVR went in to 1.6.1, not 1.6.0

2008-10-02 18:02 +0000 [r145915]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_meetme.c: fix the 'meetme list', 'meetme list concise',
	  'meetme list $confno' and 'meetme list $confno concise' CLI
	  commands (closes issue #13586) Reported by: john8675309 Help and
	  feedback from eliel, thanks!

2008-10-02 17:16 +0000 [r145846]  Tilghman Lesher <tlesher@digium.com>

	* configs/func_odbc.conf.sample, funcs/func_odbc.c, CHANGES: Permit
	  the syntax and synopsis fields to be set (for func_odbc).

2008-10-02 16:42 +0000 [r145842]  Michiel van Baak <michiel@vanbaak.info>

	* apps/app_meetme.c: make this compile under devmode again

2008-10-02 15:28 +0000 [r145771]  Sean Bright <sean.bright@gmail.com>

	* configure, configure.ac: This is much cleaner, methinks.

2008-10-02 15:17 +0000 [r145752]  Tilghman Lesher <tlesher@digium.com>

	* /, res/res_odbc.c: Merged revisions 145751 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r145751 | tilghman | 2008-10-02 10:13:21 -0500 (Thu, 02 Oct 2008)
	  | 3 lines Some sanity checks that may have led to prior crashes,
	  found by codefreeze-lap (murf) on IRC. Also some cleanup of
	  incorrectly-used constants. ........

2008-10-01 23:48 +0000 [r145692]  Sean Bright <sean.bright@gmail.com>

	* configure, configure.ac: Try a test compile using the GMime
	  library. Some distros install gmime-config in the base package
	  instead of the -devel package. Now we print a notice and disable
	  GMime support instead of bombing during the main compilation.
	  (closes issue #13583) Reported by: arkadia

2008-10-01 23:02 +0000 [r145649]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_meetme.c, funcs/func_strings.c,
	  include/asterisk/localtime.h, main/stdtime/localtime.c: Add
	  schedule extensions to app_meetme. In addition, the reporter
	  found a problem within strptime(3), which we are correcting here
	  with ast_strptime(). (closes issue #11040) Reported by: DEA
	  Patches: 20080910__bug11040.diff.txt uploaded by Corydon76
	  (license 14) Tested by: DEA

2008-10-01 22:23 +0000 [r145553-145606]  Mark Michelson <mmichelson@digium.com>

	* main/features.c: Okay, this should really do it now. While I did
	  manage to fix blind transfers with my last commit here, I also
	  caused an unwanted side-effect. That is, only the first priority
	  of the 'h' extension would be executed when a blind transfer
	  occurred instead of all priorities. Essentially, my last commit
	  corrected the return value of ast_bridge_call. However, the
	  implementation still was not 100% correct. Now it is.

	* main/features.c: if (!(x) == 0) is the same as if (x).

	* main/features.c: The logic surrounding the return value of
	  ast_spawn_extension within ast_bridge_call was reversed. This
	  problem was observed when a blind transfer placed from the callee
	  channel of a test call failed. While the problem I am solving
	  here is exactly the same as what was reported in issue #13584,
	  the difference is that this fix I am applying is trunk-only.
	  Issue #13584 was reported against the 1.4 branch, and my tests of
	  1.4's blind transfers appear to work fine.

2008-10-01 17:26 +0000 [r145487]  Leif Madsen <lmadsen@digium.com>

	* contrib/scripts/realtime_pgsql.sql, /: Merged revisions 145479
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r145479 | lmadsen | 2008-10-01 13:18:30 -0400 (Wed, 01 Oct 2008)
	  | 6 lines Update the realtime_pgsql.sql script to create the
	  setinterfacevar column. (closes issue #13549) Reported by: fiddur
	  ........

2008-10-01 15:44 +0000 [r145428]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_sms.c: Initializing buffer prevents a segfault when
	  arguments are incomplete. (closes issue #13471) Reported by:
	  alecdavis Patches: 20080916__bug13471.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: alecdavis

2008-10-01 14:44 +0000 [r145381]  Mark Michelson <mmichelson@digium.com>

	* Makefile: Too many times have I mistyped the word 'install' as
	  'isntall' Now this typo shall no longer be a problem since 'make
	  isntall' just builds the 'install' target.

2008-10-01 12:29 +0000 [r145329]  Russell Bryant <russell@digium.com>

	* CHANGES: tabs to spaces

2008-09-30 22:21 +0000 [r145249]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_sip.c: (closes issue #13337) Reported by: pj Tested
	  by: pj Set transport to SIP_TRANSPORT_UDP mode if not specified
	  which fixes calls to get_transport returning UNKNOWN.

2008-09-30 21:32 +0000 [r145226]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c, CHANGES: Add support for call pickup on Snom
	  phones. Asterisk now includes a magic call-id in the dialog-info
	  event package used with extension state subscriptions on Snom
	  phones. Then, when the phone sends an INVITE with Replaces for
	  the special callid, Asterisk will perform a pickup on the
	  extension that was subscribed to. The original code on this issue
	  was submitted by xylome. However, contributions have been made by
	  (at least) mgernoth and pkempgen. The final patch was written by
	  seanbright, and includes the necessary logic to allow this work
	  in a technology independent way. (closes issue #5014) Reported
	  by: xylome Patches: issue5014-trunk.diff uploaded by seanbright
	  (license 71)

2008-09-30 21:00 +0000 [r145200]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib.h, doc/tex/misdn.tex,
	  channels/chan_misdn.c, channels/misdn/isdn_lib.c: * Miscellaneous
	  formatting changes to make v1.4 and trunk more merge compatible
	  in the mISDN area. channels/chan_misdn.c * Eliminated redundant
	  code in cb_events() EVENT_SETUP

2008-09-28 23:32 +0000 [r145121]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_unistim.c, res/res_config_pgsql.c,
	  apps/app_meetme.c, res/ais/clm.c, res/res_limit.c,
	  main/taskprocessor.c, channels/chan_console.c, apps/app_queue.c,
	  channels/chan_oss.c, main/astobj2.c, main/cli.c,
	  channels/chan_dahdi.c, main/manager.c, channels/chan_misdn.c,
	  channels/chan_features.c, res/res_agi.c, channels/chan_h323.c,
	  res/ais/evt.c, res/res_config_ldap.c, apps/app_mixmonitor.c,
	  res/res_clioriginate.c: Merge the cli_cleanup branch. This work
	  is done by lmadsen, junky and mvanbaak during AstriDevCon. This
	  is the second audit the CLI got, and this time lmadsen made sure
	  he had _ALL_ modules loaded that have CLI commands in them.

2008-09-28 21:39 +0000 [r145076]  Tilghman Lesher <tlesher@digium.com>

	* res/res_config_pgsql.c: Change several improper "sizeof" to
	  "strlen", as sizeof in that context would incorrectly use the
	  size of a pointer, rather than the length of a string. (Closes
	  issue #13574)

2008-09-28 17:08 +0000 [r145027]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_dahdi.c: rename chandup() and clarify its usage

2008-09-27 16:17 +0000 [r144949-144951]  Kevin P. Fleming <kpfleming@digium.com>

	* utils/Makefile: remove incorrect comment

	* agi/Makefile, utils/Makefile, include/asterisk/astmm.h: fix bugs
	  caused by r144949 when MALLOC_DEBUG is defined

	* include/asterisk.h, /, main/Makefile, main/ast_expr2.y,
	  Makefile.moddir_rules, utils/astman.c, main/ast_expr2.c,
	  Makefile, utils/Makefile, main/ast_expr2f.c, pbx/pbx_ael.c,
	  main/astmm.c, utils/ael_main.c, main/stdtime/localtime.c,
	  utils/extconf.c, main/ast_expr2.fl: Merged revisions
	  144924-144925 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r144924 | kpfleming | 2008-09-27 10:00:48 -0500 (Sat, 27 Sep
	  2008) | 6 lines improve header inclusion process in a few small
	  ways: - it is no longer necessary to forcibly include
	  asterisk/autoconfig.h; every module already includes asterisk.h
	  as its first header (even before system headers), which serves
	  the same purpose - astmm.h is now included by asterisk.h when
	  needed, instead of being forced by the Makefile; this means
	  external modules will build properly against installed headers
	  with MALLOC_DEBUG enabled - simplify the usage of some of these
	  headers in the AEL-related stuff in the utils directory ........
	  r144925 | kpfleming | 2008-09-27 10:13:30 -0500 (Sat, 27 Sep
	  2008) | 2 lines fix some minor issues with rev 144924 ........

2008-09-27 00:49 +0000 [r144879]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_dahdi.c, apps/app_queue.c: fix a couple of CLI
	  commands that did not have a help description.

2008-09-26 23:12 +0000 [r144829]  Joshua Colp <jcolp@digium.com>

	* configs/rtp.conf.sample: Update documentation to include default
	  setting. This is for you jtodd!

2008-09-26 18:02 +0000 [r144482-144681]  Steve Murphy <murf@digium.com>

	* pbx/pbx_lua.c: (closes issue #13564) Reported by: mnicholson
	  Patches: pbx_lua9.diff uploaded by mnicholson (license 96) Many
	  thanks to Matt for his upgrade to the lua dialplan option! the
	  Description from the bug: This patch adds a stack trace to errors
	  encountered while executing lua extensions. The patch also
	  handles out of memory errors reported by lua.

	* main/pbx.c, /: Merged revisions 144677 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r144677 | murf | 2008-09-26 11:47:13 -0600 (Fri, 26 Sep 2008) |
	  12 lines (closes issue #13563) Reported by: mnicholson Patches:
	  found1.diff uploaded by mnicholson (license 96) This patch was
	  mainly meant to apply to trunk and 1.6.x, but I'm applying it to
	  1.4 also, which should be a perfectly harmless fix to the vast
	  majority of users who are not using external switches, but the
	  few who might be affected will not have to go to the pain of
	  filing a bug report. ........

	* utils/build-extensions-conf.lua (removed): Matt suggests we
	  remove utils/build-extensions-conf.lua, as per bug 12961, it is
	  no longer necessary.

	* main/pbx.c, funcs/func_cut.c, channels/chan_oss.c,
	  apps/app_playback.c: (closes issue #13557) Reported by:
	  nickpeirson The user attached a patch, but the license is not yet
	  recorded. I took the liberty of finding and replacing ALL index()
	  calls with strchr() calls, and that involves more than just
	  main/pbx.c; chan_oss, app_playback, func_cut also had calls to
	  index(), and I changed them out. 1.4 had no references to index()
	  at all.

	* pbx/pbx_lua.c: (closes issue #13559) Reported by: mnicholson
	  Patches: pbx_lua8.diff uploaded by mnicholson (license 96)

	* pbx/pbx_lua.c, configs/extensions.lua.sample,
	  include/asterisk/hashtab.h: I added a little verbage to hashtab
	  for the hashtab_destroy func. It was pretty sparsely documented.
	  This update fleshes out the pbx_lua module, to add the switch
	  statements to the extensions in the extensions.lua file, as well
	  as removing them when the module is unloaded. Many thanks to Matt
	  Nicholson for his fine contribution!

	* pbx/pbx_lua.c: (closes issue #13558) Reported by: mnicholson
	  Considering that the example extensions.lua used nothing but
	  ["12345"] notation, and that the resulting error message: [Sep 24
	  17:01:16] ERROR[12393]: pbx_lua.c:1204 exec: Error executing lua
	  extension: attempt to call a nil value is not very informative as
	  to the nature of the problem, I think this bug fix is a big win!

2008-09-25 01:46 +0000 [r144357]  Tilghman Lesher <tlesher@digium.com>

	* /: Recorded merge of revisions 144356 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r144356 | tilghman | 2008-09-24 20:44:47 -0500 (Wed, 24 Sep 2008)
	  | 6 lines Backport Hebrew language to voicemail. (closes issue
	  #13155) Reported by: greenfieldtech Patches:
	  voicemail-hebrew-patch-1.4-SVN.c.patch uploaded by greenfieldtech
	  (license 369) ........

2008-09-24 22:05 +0000 [r144314]  Doug Bailey <dbailey@digium.com>

	* res/res_phoneprov.c: Blanch the 404 error message for those with
	  no sense of humor

2008-09-24 08:42 +0000 [r144257]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 144238 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r144238 | crichter | 2008-09-24 10:20:52 +0200 (Mi, 24
	  Sep 2008) | 1 line improved helptext of misdn_set_opt. ........

2008-09-24 06:43 +0000 [r144199]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_curl.c: Create a 'hashcompat' option that permits the
	  results of a CURL() able to be passed directly into the HASH()
	  function. Requested via the -users list, and committed at
	  Astricon in the Code Zone.

2008-09-23 23:33 +0000 [r144149]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Fix a conflict in flag values

2008-09-23 16:52 +0000 [r144067]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 144066 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r144066 | murf | 2008-09-23 10:41:49 -0600 (Tue, 23 Sep 2008) |
	  29 lines (closes issue #13489) Reported by: DougUDI Tested by:
	  murf (closes issue #13490) Reported by: seanbright Tested by:
	  murf (closes issue #13467) Reported by: edantie Tested by: murf,
	  edantie, DougUDI This crash happens because we are unsafely
	  handling old pointers. The channel whose cdr is being handled,
	  has been hung up and destroyed already. I reorganized the code a
	  bit, and tried not to lose the fork-cdr-chain concepts of the
	  previous code. I now verify that the 'previous' channel (the
	  channel we had when the bridge was started), still exists, by
	  looking it up by name in the channel list. I also do not try to
	  reset the CDR's of channels involved in bridges. Testing shows it
	  solves the crash problem, and should not negatively impact
	  previous fixes involving CDR's generated during/after blind
	  transfers. (The reason we need to reset the CDR's on the
	  "beginning" channels in the first place). ........

2008-09-23 15:37 +0000 [r144025]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: When a promiscuous redirect contained both a
	  user and host portion in the Contact URI and specifies a
	  transport, the parsing done in parse_moved_contact resulted in a
	  malformed URI. This commit fixes the parsing so that a proper
	  Dial string may be formed when the forwarded call is placed.
	  (closes issue #13523) Reported by: mattdarnell Patches:
	  13523v2.patch uploaded by putnopvut (license 60) Tested by:
	  mattdarnell

2008-09-22 22:50 +0000 [r143904]  Sean Bright <sean.bright@gmail.com>

	* /, formats/format_pcm.c: Merged revisions 143903 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r143903 | seanbright | 2008-09-22 18:49:00 -0400 (Mon,
	  22 Sep 2008) | 8 lines Use the advertised header size in .au
	  files instead of just assuming they are 24 bytes (the minimum).
	  (closes issue #13450) Reported by: jamessan Patches:
	  pcm-header.diff uploaded by jamessan (license 246) ........

2008-09-21 09:53 +0000 [r143799-143843]  Michiel van Baak <michiel@vanbaak.info>

	* doc/tex/privacy.tex: fix privacymanager example so it shows how
	  to use the PRIVACYMRGSTATUS variable

	* doc/tex/privacy.tex: document the new context argument for
	  privacymanager so people can do pattern matching on the input

	* doc/tex/privacy.tex: fix privacy documentation. We no longer do
	  priority jumping +101

	* channels/chan_skinny.c: make 'module unload chan_skinny.so'
	  actually work. (closes issue #13524) Reported by: wedhorn
	  Patches: unload.diff uploaded by wedhorn (license 30) With small
	  tweak by me to prevent a crash

2008-09-20 00:52 +0000 [r143737]  Sean Bright <sean.bright@gmail.com>

	* /, contrib/scripts/vmail.cgi: Merged revisions 143736 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143736 | seanbright | 2008-09-19 20:50:10 -0400 (Fri, 19 Sep
	  2008) | 9 lines Make vmail.cgi work with mailboxes defined in
	  users.conf, too. (closes issue #13187) Reported by: netvoice
	  Patches: 20080911__bug13187.diff.txt uploaded by Corydon76
	  (license 14) (Slightly modified to take alchamist's comments on
	  mantis into account) Tested by: msales, alchamist, seanbright
	  ........

2008-09-19 21:41 +0000 [r143697]  Steve Murphy <murf@digium.com>

	* /: This blocks 143674 from trunk; it appears to already done in
	  trunk, since ast_odbc_direct_execute creates a new stmt for each
	  attempt.

2008-09-19 15:43 +0000 [r143609]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_agent.c: We should only unsubscribe to the device
	  state event subscription if we have previously subscribed.
	  Otherwise a segfault will occur. (closes issue #13476) Reported
	  by: jonnt Patches: 13476.patch uploaded by putnopvut (license 60)
	  Tested by: jonnt

2008-09-18 23:41 +0000 [r143559]  Steve Murphy <murf@digium.com>

	* /, channels/chan_sip.c: Merged revisions 143534 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143534 | murf | 2008-09-18 16:11:51 -0600 (Thu, 18 Sep 2008) | 1
	  line A micro-fix, in sip_park_thread, where d is freed before the
	  func is done using it. ........

2008-09-17 20:57 +0000 [r143405]  Tilghman Lesher <tlesher@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 143404 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r143404 | tilghman | 2008-09-17 15:55:47 -0500 (Wed, 17
	  Sep 2008) | 6 lines When callerid is blank, we want to use
	  "unknown caller" in those cases, too. (closes issue #13486)
	  Reported by: tomo1657 Patches: 20080917__bug13486.diff.txt
	  uploaded by Corydon76 (license 14) ........

2008-09-17 20:25 +0000 [r143340-143400]  Mark Michelson <mmichelson@digium.com>

	* main/astmm.c: If attempting to free a NULL pointer when
	  MALLOC_DEBUG is set, don't bother searching for a region to free,
	  just immediately exit. This has the dual benefit of suppressing a
	  warning message about freeing memory at (nil) and of optimizing
	  the free() replacement by not having to do any futile searching
	  for the proper region to free. (closes issue #13498) Reported by:
	  pj Patches: 13498.patch uploaded by putnopvut (license 60) Tested
	  by: pj

	* /, main/rtp.c: Merged revisions 143337 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r143337 | mmichelson | 2008-09-17 13:24:15 -0500 (Wed, 17 Sep
	  2008) | 6 lines Allow for "G.729" if offered in an SDP even
	  though it is not RFC 3551 compliant. Some Cisco switches will
	  send this in an SDP, and it doesn't hurt to be able to accept
	  this. ........

2008-09-15 21:31 +0000 [r143141]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 143140 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r143140 | tilghman | 2008-09-15 16:29:32 -0500 (Mon, 15
	  Sep 2008) | 6 lines Set the raw formats at the same time as the
	  other formats. (closes issue #13240) Reported by: jvandal
	  Patches: 20080813__bug13240.diff.txt uploaded by Corydon76
	  (license 14) ........

2008-09-14 22:16 +0000 [r143082]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: plug a couple of memleaks in chan_skinny.
	  (closes issue #13452) Reported by: pj Patches: memleak5.diff
	  uploaded by wedhorn (license 30) Tested by: wedhorn, pj, mvanbaak
	  (closes issue #13294) Reported by: pj

2008-09-13 14:15 +0000 [r143034]  Sean Bright <sean.bright@gmail.com>

	* apps/app_osplookup.c: Everytime a compile fails, a puppy dies.

2008-09-13 13:54 +0000 [r142992-143031]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_dial.c, channels/chan_iax2.c, channels/iax2-parser.c:
	  Repair IAXVAR implementation so that it works again (regression?)
	  (closes issue #13354) Reported by: adomjan Patches:
	  20080828__bug13354.diff.txt uploaded by Corydon76 (license 14)
	  20080829__bug13354__1.6.0.diff.txt uploaded by Corydon76 (license
	  14) Tested by: Corydon76, adomjan

	* channels/chan_unistim.c, main/udptl.c, apps/app_meetme.c,
	  res/res_snmp.c, codecs/codec_adpcm.c, res/res_phoneprov.c,
	  codecs/codec_gsm.c, apps/app_alarmreceiver.c,
	  channels/chan_gtalk.c, res/res_http_post.c,
	  res/res_musiconhold.c, channels/chan_iax2.c, apps/app_followme.c,
	  res/res_jabber.c, main/enum.c, res/res_config_sqlite.c,
	  main/config.c, main/loader.c, main/cdr.c, channels/chan_dahdi.c,
	  channels/chan_phone.c, res/res_smdi.c, main/manager.c,
	  funcs/func_config.c, apps/app_osplookup.c,
	  channels/chan_skinny.c, funcs/func_odbc.c, main/features.c,
	  apps/app_minivm.c, main/http.c, channels/chan_alsa.c,
	  apps/app_amd.c, apps/app_directory.c, res/res_config_ldap.c,
	  apps/app_rpt.c, channels/chan_mgcp.c, codecs/codec_lpc10.c,
	  res/res_config_pgsql.c, main/dnsmgr.c, codecs/codec_g722.c,
	  channels/chan_sip.c, apps/app_festival.c, codecs/codec_speex.c,
	  codecs/codec_alaw.c, res/res_adsi.c, include/asterisk/config.h,
	  channels/chan_agent.c, codecs/codec_g726.c,
	  channels/chan_console.c, apps/app_queue.c, channels/chan_oss.c,
	  main/rtp.c, apps/app_playback.c, channels/chan_jingle.c,
	  channels/chan_h323.c, codecs/codec_ulaw.c, codecs/codec_dahdi.c,
	  res/res_indications.c, main/asterisk.c, res/res_odbc.c,
	  main/dsp.c, apps/app_voicemail.c: Create a new config file
	  status, CONFIG_STATUS_FILEINVALID for differentiating when a file
	  is invalid from when a file is missing. This is most important
	  when we have two configuration files. Consider the following
	  example: Old system: sip.conf users.conf Old result New result
	  ======== ========== ========== ========== Missing Missing SIP
	  doesn't load SIP doesn't load Missing OK SIP doesn't load SIP
	  doesn't load Missing Invalid SIP doesn't load SIP doesn't load OK
	  Missing SIP loads SIP loads OK OK SIP loads SIP loads OK Invalid
	  SIP loads incompletely SIP doesn't load Invalid Missing SIP
	  doesn't load SIP doesn't load Invalid OK SIP doesn't load SIP
	  doesn't load Invalid Invalid SIP doesn't load SIP doesn't load So
	  in the case when users.conf doesn't load because there's a typo
	  that disrupts the syntax, we may only partially load users,
	  instead of failing with an error, which may cause some calls not
	  to get processed. Worse yet, the old system would do this with no
	  indication that anything was even wrong. (closes issue #10690)
	  Reported by: dtyoo Patches: 20080716__bug10690.diff.txt uploaded
	  by Corydon76 (license 14)

2008-09-12 22:24 +0000 [r142929]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_local.c, /: Merged revisions 142927 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r142927 | jpeeler | 2008-09-12 17:22:28 -0500 (Fri, 12
	  Sep 2008) | 6 lines (closes issue #12965) Reported by: rlsutton2
	  Prevents local channels from playing MOH at each other which was
	  causing ast_generic_bridge to loop much faster. ........

2008-09-12 20:49 +0000 [r142866]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c, configs/sip.conf.sample: Merged revisions
	  142865 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142865 | tilghman | 2008-09-12 15:37:18 -0500 (Fri, 12 Sep 2008)
	  | 11 lines Create rules for disallowing contacts at certain
	  addresses, which may improve the security of various
	  installations. As this does not change any default behavior, it
	  is not classified as a direct security fix for anything within
	  Asterisk, but may help PBX admins better secure their SIP
	  servers. (closes issue #11776) Reported by: ibc Patches:
	  20080829__bug11776.diff.txt uploaded by Corydon76 (license 14)
	  Tested by: Corydon76, blitzrage ........

2008-09-12 18:22 +0000 [r142808]  Michiel van Baak <michiel@vanbaak.info>

	* /: Recorded merge of revisions 142807 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142807 | mvanbaak | 2008-09-12 19:59:25 +0200 (Fri, 12 Sep 2008)
	  | 2 lines fix copyright year range ........

2008-09-12 16:54 +0000 [r142741-142748]  Tilghman Lesher <tlesher@digium.com>

	* main/app.c: When checking for an encoded character, make sure the
	  string isn't blank, first. (Closes issue #13470)

	* /, apps/app_voicemail.c: Merged revisions 142744 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r142744 | tilghman | 2008-09-12 11:38:02 -0500 (Fri, 12
	  Sep 2008) | 4 lines Missing merge from 1.2 fixes errant exit on
	  DTMF, only when language is Italian (cf commit 34242) (Closes
	  issue #7353) ........

	* /, main/file.c: Merged revisions 142740 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142740 | tilghman | 2008-09-12 11:27:32 -0500 (Fri, 12 Sep 2008)
	  | 4 lines Don't return a free'd pointer, when a file cannot be
	  opened. (closes issue #13462) Reported by: wackysalut ........

2008-09-12 04:50 +0000 [r142676]  Steve Murphy <murf@digium.com>

	* apps/app_dial.c, main/pbx.c, /, main/features.c,
	  include/asterisk/channel.h, apps/app_queue.c: Merged revisions
	  142675 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142675 | murf | 2008-09-11 22:29:34 -0600 (Thu, 11 Sep 2008) |
	  29 lines Tested by: sergee, murf, chris-mac, andrew, KNK This is
	  a "second attempt" to restore the previous "endbeforeh" behavior
	  in 1.4 and up. In order to capture information concerning all the
	  legs of transfers in all their infinite combinations, I was
	  forced to this particular solution by a chain of logical
	  necessities, the first being that I was not allowed to rewrite
	  the CDR mechanism from the ground up! This change basically
	  leaves the original machinery alone, which allows IVR and local
	  channel type situations to generate CDR's as normal, but a
	  channel flag can be set to suppress the normal running of the h
	  exten. That flag would be set by the code that runs the h exten
	  from the ast_bridge_call routine, to prevent the h exten from
	  being run twice. Also, a flag in the ast_bridge_config struct
	  passed into ast_bridge_call can be used to suppress the running
	  of the h exten in that routine. This would happen, for instance,
	  if you use the 'g' option in the Dial app. Running this routine
	  'early' allows not only the CDR() func to be used in the h
	  extension for reading CDR variables, but also allows them to be
	  modified before the CDR is posted to the backends. While I dearly
	  hope that this patch overcomes all problems, and introduces no
	  new problems, reality suggests that surely someone will have
	  problems. In this case, please re-open 13251 (or 13289), and
	  we'll see if we can't fix any remaining issues. ** trunk note:
	  some code to suppress the h exten being run from app_queue was
	  added; for the 'continue' option available only in trunk/1.6.x.
	  ........

2008-09-12 00:49 +0000 [r142635]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_adaptive_odbc.c: Build under dev-mode

2008-09-11 23:12 +0000 [r142576]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 142575 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142575 | murf | 2008-09-11 16:55:49 -0600 (Thu, 11 Sep 2008) |
	  20 lines (closes issue #13364) Reported by: mdu113 Well,
	  fundamentally, the problems revealed in 13364 are because of the
	  ForkCDR call that is done before the dial. When the bridge is in
	  place, it's dealing with the first (and wrong) cdr in the list.
	  So, I wrote a little func to zip down to the first non-locked cdr
	  in the chain, and thru-out the ast_bridge_call, these results are
	  used instead of raw chan->cdr and peer->cdr pointers. This
	  shouldn't affect anyone who isn't forking cdrs before a dial, and
	  should correct the cdr's of those that do. So, this change ends
	  up correcting the dstchannel and userfield; the disposition was
	  fixed by a previous patch, it was OK coming into this problem.
	  ........

2008-09-11 21:45 +0000 [r142536]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_adaptive_odbc.c, configs/cdr_adaptive_odbc.conf.sample:
	  Add usegmtime, as per the recent -users list discussion, and also
	  add my explanation to the file, since that additional text helps
	  people understand the concept.

2008-09-10 22:11 +0000 [r142475]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 142474 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142474 | murf | 2008-09-10 15:58:17 -0600 (Wed, 10 Sep 2008) |
	  30 lines (closes issue #12318) Reported by: krtorio I made a
	  small change to the code that handles local channel situations.
	  In that code, I copy the answer time from the peer cdr, to the
	  bridge_cdr, but I wasn't also copying the disposition from the
	  peer cdr. So, Now I copy the disposition, and I've tested against
	  these cases: 1. phone 1 never answers the phone; no cdr is
	  generated at all. this should show up as a manager command
	  failure or something. 2. phone 2 never answers. CDR is generated,
	  says NO ANSWER 3. phone 2 is busy. CDR is generated, says BUSY 4.
	  phone 2 answers: CDR is generated, times are correct; disposition
	  is ANSWERED, which is correct. The start time is the time that
	  the manager dialed the first phone. The answer time is the time
	  the second phone picks up. I purposely left the cid and src
	  fields blank; since this call really originates from the manager,
	  there is no 'easy' data to put in these fields. If you feel
	  strongly that these fields should be filled in, re-open this bug
	  and I'll dig further. ........

2008-09-10 19:09 +0000 [r142417]  Sean Bright <sean.bright@gmail.com>

	* /, configure, acinclude.m4: Merged revisions 142416 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r142416 | seanbright | 2008-09-10 15:05:46 -0400 (Wed,
	  10 Sep 2008) | 9 lines Fix detection of PWLIB and OpenH323
	  version when spacing in the headers isn't consistent. (closes
	  issue #13426) Reported by: bamby Patches: detect_openh323.diff
	  uploaded by bamby (license 430) (Modified by me to use sed
	  instead of tr) ........

2008-09-10 16:55 +0000 [r142359]  Tilghman Lesher <tlesher@digium.com>

	* /, sounds/Makefile: Merged revisions 142358 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142358 | tilghman | 2008-09-10 11:54:29 -0500 (Wed, 10 Sep 2008)
	  | 2 lines Publish new extra sounds version. ........

2008-09-10 16:41 +0000 [r142318-142355]  Russell Bryant <russell@digium.com>

	* /, main/sched.c: Merged revisions 142354 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142354 | russell | 2008-09-10 11:39:53 -0500 (Wed, 10 Sep 2008)
	  | 7 lines It is a normal situation that a task gets put in the
	  scheduler that should run as soon as possible. Accept "0" as an
	  acceptable time to run, and also treat negative as "run now", and
	  don't print a debug message about it. (inspired by a message
	  asking about the "request to schedule in the past" debug message
	  on the -dev list) ........

	* CHANGES: Move last change to CHANGES up to the 1.6.2 section

2008-09-09 22:08 +0000 [r142280]  Philippe Sultan <philippe.sultan@gmail.com>

	* configs/jabber.conf.sample, CHANGES, res/res_jabber.c: Disable
	  autoprune by default. (closes issue #13411) Reported by: caio1982
	  Patches: res_jabber_autoprune1.diff uploaded by caio1982 (license
	  22) Tested by: caio1982

2008-09-09 19:16 +0000 [r142219]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 142218 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142218 | mmichelson | 2008-09-09 14:15:28 -0500 (Tue, 09 Sep
	  2008) | 14 lines Make sure that the branch sent in CANCEL
	  requests matches the branch of the INVITE it is cancelling.
	  (closes issue #13381) Reported by: atca_pres Patches:
	  13381v2.patch uploaded by putnopvut (license 60) Tested by:
	  atca_pres (closes issue #13198) Reported by: rickead2000 Tested
	  by: rickead2000 ........

2008-09-09 17:30 +0000 [r142181]  Richard Mudgett <rmudgett@digium.com>

	* main/callerid.c: Cleaned up comment

2008-09-09 17:15 +0000 [r142080-142146]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: This is the trunk version of the patch to close
	  issue 12979. The difference between this and the 1.6.0 and 1.6.1
	  versions is that this is a much more invasive change. With this,
	  we completely get rid of the interfaces list, along with all its
	  helper functions. Let me take a moment to say that this change
	  personally excites me since it may mean huge steps forward
	  regarding proper lock order in app_queue without having to strew
	  seemingly unnecessary locks all over the place. It also results
	  in a huge reduction in lines of code and complexity. Way to go
	  Brett! (closes issue #12979) Reported by: sigxcpu Patches:
	  20080710_issue12979_queue_custom_state_interface_trunk_2.diff
	  uploaded by bbryant (license 36) Tested by: sigxcpu, putnopvut

	* /, channels/chan_sip.c: Merged revisions 142079 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142079 | mmichelson | 2008-09-09 11:19:17 -0500 (Tue, 09 Sep
	  2008) | 21 lines When determining if codecs used by SIP peers
	  allow the media to be natively bridged, use the jointcapability
	  instead of the peercapability. It seems that the intent of using
	  the peercapability was to expand the choice of codecs for the
	  call to increase the chances of being able to native bridge the
	  channels. The problem is that if a codec were settled on for the
	  native bridge and that wasn't a codec that was configured to be
	  used by Asterisk for that peer, then Asterisk would send a
	  REINVITE with no codecs in the SDP which is a bug no matter how
	  you slice it. (closes issue #13076) Reported by: ramonpeek
	  Patches: 13076.patch uploaded by putnopvut (license 60) Tested
	  by: tbelder ........

2008-09-09 15:44 +0000 [r142064]  Russell Bryant <russell@digium.com>

	* /, main/features.c: Merged revisions 142063 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r142063 | russell | 2008-09-09 10:40:24 -0500 (Tue, 09 Sep 2008)
	  | 5 lines Ensure that the stored CDR reference is still valid
	  after the bridge before poking at it. Also, keep the channel
	  locked while messing with this CDR. (fixes crashes reported in
	  issue #13409) ........

2008-09-09 12:34 +0000 [r142000]  Bradley Latus <brad.latus@gmail.com>

	* include/asterisk/astobj2.h: Minor fix to doco

2008-09-09 12:32 +0000 [r141995-141998]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Use ast_debug for debug messages. I was
	  wondering why debug messages weren't showing up when I had set
	  the debug level high for just app_queue.c. It's because we were
	  only checking the global option_debug variable instead of using
	  the awesome macro which checks both the global and file-specific
	  value

	* channels/chan_oss.c: Fix a memory leak in chan_oss (closes issue
	  #13311) Reported by: eliel Patches: chan_oss.c.patch uploaded by
	  eliel (license 64)

2008-09-09 01:47 +0000 [r141949]  Russell Bryant <russell@digium.com>

	* main/channel.c: Modify ast_answer() to not hold the channel lock
	  while calling ast_safe_sleep() or when calling ast_waitfor().
	  These are inappropriate times to hold the channel lock. This is
	  what has caused "could not get the channel lock" messages from
	  chan_sip and has likely caused a negative impact on performance
	  results of SIP in Asterisk 1.6. Thanks to file for pointing out
	  this section of code. (closes issue #13287) (closes issue #13115)

2008-09-08 23:00 +0000 [r141810-141906]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Optimization: The only reason we should check
	  member status is if the queue has a joinempty or a leavewhenempty
	  setting which could cause the caller to not join the queue or
	  exit the queue. Prior to this patch, we could potentially
	  traverse the entire queue's member list for no reason since even
	  if the members are currently not available in some way we're
	  going to let the caller join the queue anyway.

	* channels/chan_sip.c: Um, apparently I didn't actually finish
	  merging before committing. Bad bad bad

	* /, channels/chan_sip.c: Merged revisions 141809 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141809 | mmichelson | 2008-09-08 16:10:10 -0500 (Mon, 08 Sep
	  2008) | 14 lines Fix pedantic mode of chan_sip to only check the
	  remote tag of an endpoint once a dialog has been confirmed. Up
	  until that point, it is possible and legal for the far-end to
	  send provisional responses with a different To: tag each time.
	  With this patch applied, these provisional messages will not
	  cause a matching problem. (closes issue #11536) Reported by: ibc
	  Patches: 11536v2.patch uploaded by putnopvut (license 60)
	  ........

2008-09-08 21:05 +0000 [r141807]  Russell Bryant <russell@digium.com>

	* main/pbx.c, /: Merged revisions 141806 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141806 | russell | 2008-09-08 16:02:36 -0500 (Mon, 08 Sep 2008)
	  | 7 lines When doing an async goto, detect if the channel is
	  already in the middle of a masquerade. This can happen when
	  chan_local is trying to optimize itself out. If this happens,
	  fail the async goto instead of bursting into flames. (closes
	  issue #13435) Reported by: geoff2010 ........

2008-09-08 20:18 +0000 [r141745]  Jason Parker <jparker@digium.com>

	* Makefile, /, redhat (removed): Merged revisions 141741 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141741 | qwell | 2008-09-08 15:15:42 -0500 (Mon, 08 Sep 2008) |
	  8 lines Remove RPM package targets from Makefile (and all
	  associated parts). This has never worked in 1.4, and we decided
	  that it makes no sense to be done here. There are many distros
	  out there that already have "proper" spec files that can be
	  (re)used. Closes issue #13113 Closes issue #10950 Closes issue
	  #10952 ........

2008-09-08 17:13 +0000 [r141682]  Sean Bright <sean.bright@gmail.com>

	* build_tools/make_buildopts_h: Quote the arguments to grep so that
	  sh on various platforms doesn't choke on the special characters
	  (like ^). (closes issue #13417) Reported by: dougm Patches:
	  13417.make_buildopts_h.patch uploaded by seanbright (license 71)
	  Tested by: dougm

2008-09-07 00:04 +0000 [r141626]  Michiel van Baak <michiel@vanbaak.info>

	* funcs/func_curl.c: make func_curl.c compile under devmode.

2008-09-06 20:19 +0000 [r141566]  Steve Murphy <murf@digium.com>

	* /, channels/chan_sip.c: Merged revisions 141565 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141565 | murf | 2008-09-06 14:13:16 -0600 (Sat, 06 Sep 2008) | 1
	  line This fix comes from Joshua Colp The Brilliant, who, given
	  the trace, came up with a solution. This will most likely will
	  close 13235 and 13409. I'll wait till Monday to verify, and then
	  close these bugs. ........

2008-09-06 15:40 +0000 [r141504-141507]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_curl.c: Get rid of the casts that cause warnings on
	  OpenBSD. The compiler is errantly detecting warnings when we
	  redefine a structure each time it is used, even though the
	  structure is identical. Reported by: mvanbaak, via #asterisk-dev

	* /, res/res_agi.c: Merged revisions 141503 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141503 | tilghman | 2008-09-06 10:23:42 -0500 (Sat, 06 Sep 2008)
	  | 4 lines Reverting behavior change (AGI should not exit non-zero
	  on SUCCESS) (closes issue #13434) Reported by: francesco_r
	  ........

2008-09-06 12:03 +0000 [r141464]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_sip.c, channels/chan_iax2.c, main/cli.c: Some fixes
	  to autocompletion in some commands. Changes applied by this
	  patch: - Fix autocompletion in 'sip prune realtime', sip peers
	  where never auto completed. Now we complete this command with:
	  'sip prune realtime peer' -> all | like | sip peers Also I have
	  modified the syntax in the usage, was wrong... - Pass
	  ast_cli_args->argv and ast_cli_args->argc while running
	  autocompletion on CLI commands (CLI_GENERATE). With this we avoid
	  comparisons on ast_cli_args->line like this: strcasestr(a->line,
	  " description") strcasestr(a->line, "descriptions ")
	  strcasestr(a->line, "realtime peer"), and so on.. Making the code
	  more confusing (check the spaces in description!). The only thing
	  we must be sure is to first check a->pos or a->argc. - Fix 'iax2
	  prune realtime' autocompletion, now we autocomplete this command
	  with 'all' & 'iax2 peers', check a look that iax2 peers where all
	  the peers, now only the ones in the cache.. (closes issue #13133)
	  Reported by: eliel Patches: clichanges.patch uploaded by eliel
	  (license 64)

2008-09-05 22:03 +0000 [r141367-141425]  Mark Michelson <mmichelson@digium.com>

	* funcs/func_curl.c: Fix func_curl compilation

	* /, channels/chan_agent.c: Merged revisions 141366 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r141366 | mmichelson | 2008-09-05 16:10:32 -0500 (Fri,
	  05 Sep 2008) | 7 lines Agent's should not try to call a channel's
	  indicate callback if the channel has been hung up. It will likely
	  crash otherwise ABE-1159 ........

2008-09-05 19:12 +0000 [r141328]  Tilghman Lesher <tlesher@digium.com>

	* funcs/func_curl.c, CHANGES: Add the CURLOPT dialplan function,
	  which permits setting various options for use with the CURL
	  dialplan function. (closes issue #12920) Reported by: davevg
	  Patches: 20080904__bug12920.diff.txt uploaded by Corydon76
	  (license 14) Tested by: Corydon76, davevg

2008-09-05 14:18 +0000 [r141115-141157]  Steve Murphy <murf@digium.com>

	* main/channel.c, /: Merged revisions 141156 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141156 | murf | 2008-09-05 08:15:43 -0600 (Fri, 05 Sep 2008) | 1
	  line A small change to prevent double-posting of CDR's; thanks to
	  Daniel Ferrer for bringing it to our attention ........

	* pbx/ael/ael-test/ref.ael-vtest25 (added), /,
	  pbx/ael/ael-test/ael-vtest25/extensions.ael,
	  pbx/ael/ael-test/ael-vtest25 (added), res/ael/ael_lex.c,
	  pbx/ael/ael-test/ref.ael-test6, res/ael/ael.flex: Merged
	  revisions 141094 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141094 | murf | 2008-09-04 17:15:07 -0600 (Thu, 04 Sep 2008) |
	  70 lines (closes issue #13357) Reported by: pj Tested by: murf
	  (closes issue #13416) Reported by: yarns Tested by: murf If you
	  find this message overly verbose, relax, it's probably not meant
	  for you. This message is meant for probably only two people in
	  the whole world: me, or the poor schnook that has to maintain
	  this code because I'm either dead or unavailable at the moment.
	  This fix solves two reports, both having to do with embedding a
	  function call in a ${} construct. It was tricky because the
	  funccall syntax has parenthesis () in it. And up till now, the
	  'word' token in the flex stuff didn't allow that, because it
	  would tend to steal the LP and RP tokens. To be truthful, the
	  "word" token was the trickiest, most unstable thing in the whole
	  lexer. I was lucky it made this long without complaints. I had to
	  choose every character in the pattern with extreme care, and I
	  knew that someday I'd have to revisit it. Well, the day has come.
	  So, my brilliant idea (and I'm being modest), was to use the
	  surrounding ${} construct to make a state machine and capture
	  everything in it, no matter what it contains. But, I have to now
	  treat the word token like I did with comments, in that I turn the
	  whole thing into a state-machine sort of spec, with new contexts
	  "curlystate", "wordstate", and "brackstate". Wait a minute,
	  "brackstate"? Yes, well, it didn't take very many regression
	  tests to point out if I do this for ${} constructs, I also have
	  to do it with the $[] constructs, too. I had to create a separate
	  pcbstack2 and pcbstack3 because these constructs can occur inside
	  macro argument lists, and when we have two state machines
	  operating on the same structures we'd get problems otherwise. I
	  guess I could have stopped at pcbstack2 and had the brackstate
	  stuff share it, but it doesn't hurt to be safe. So, the pcbpush
	  and pcbpop routines also now have versions for "2" and "3". I had
	  to add the {KEYWORD} construct to the initial pattern for "word",
	  because previously word would match stuff like "default7",
	  because it was a longer match than the keyword "default". But,
	  not any more, because the word pattern only matches only one or
	  two characters now, and it will always lose. So, I made it the
	  winner again by making an optional match on any of the keywords
	  before it's normal pattern. I added another regression test to
	  make sure we don't lose this in future edits, and had to fix just
	  one regression, where it no longer reports a 'cascaded' error,
	  which I guess is a plus. I've given some thought as to whether to
	  apply these fixes to 1.4 and the 1.6.x releases, vs trunk; I
	  decided to put it in 1.4 because one of the bug reports was
	  against 1.4; and it is unexpected that AEL cannot handle this
	  situation. It actually reduced the amount of useless "cascade"
	  error messages that appeared in the regressions (by one line,
	  ehhem). There is a possible side-effect in that it does now do
	  more careful checking of what's in those ${} constructs, as far
	  as matching parens, and brackets are concerned. Some users may
	  find a an insidious problem and correct it this way. This should
	  be exceedingly rare, I hope. ........

2008-09-04 17:27 +0000 [r141039]  Jeff Peeler <jpeeler@digium.com>

	* /, main/features.c, res/res_agi.c: Merged revisions 141028 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r141028 | jpeeler | 2008-09-04 12:00:29 -0500 (Thu, 04 Sep 2008)
	  | 7 lines (closes issue #11979) Fixes multiple parking problems:
	  Crash when executing a park on an extension dialed by AGI due to
	  not returning the proper return code. Crash when using a builtin
	  feature that was a subset of a enabled dynamic feature. Crash due
	  to always hanging up the peer despite the fact that the peer was
	  supposed to be parked. ........

2008-09-03 20:16 +0000 [r140975]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fix some locking order issues in app_queue.
	  This was brought up by atis on IRC a while ago.

2008-09-03 18:06 +0000 [r140938]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c, CHANGES: Added 'skinny show lines
	  verbose' This will print the subs and their status for every line
	  (if any). wedhorn did most of the work with his patch which
	  introduced 'skinny show debug' but a discussion on IRC stated
	  that it should be added to 'skinny show lines' Input on the
	  output format by Qwell on IRC. (closes issue #13344) Reported by:
	  wedhorn

2008-09-03 14:41 +0000 [r140860-140887]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fix compilation

	* /, apps/app_voicemail.c: Merged revisions 140850 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r140850 | mmichelson | 2008-09-03 09:29:15 -0500 (Wed,
	  03 Sep 2008) | 9 lines Fix voicemail forwarding when using ODBC
	  storage. (closes issue #13387) Reported by: moliveras Patches:
	  13387.patch uploaded by putnopvut (license 60) Tested by:
	  putnopvut, moliveras ........

2008-09-03 14:01 +0000 [r140824]  Steve Murphy <murf@digium.com>

	* res/ael/pval.c, main/pbx.c, res/ael/ael.tab.c, res/ael/ael.y,
	  res/ael/ael.tab.h: In these changes, I have added some
	  explanation of changes to the Set and MSet apps, so people aren't
	  so shocked and surprised when they upgrade from 1.4 to 1.6. Also,
	  for the sake of those upgrading from 1.4 to 1.6 with AEL, I
	  provide automatic support for the "old" way of using Set(), that
	  still does the exact same old thing with quotes and backslashes
	  and so on as 1.4 did, by having AEL compile in the use of MSet()
	  instead of Set(), everywhere it inserts this code. But, if the
	  app_set var is set to 1.6 or higher, it uses the "new",
	  non-evaluative Set(). This only usually happens if the user
	  manually inserts this into the asterisk.conf file, or runs the
	  "make samples" command.

2008-09-03 13:48 +0000 [r140821]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_sqlite.c: Move some duplicated code into a separate
	  function. Also try to do some wacky stuff in the commit message,
	  like: a newline \n a bell \a a tab \t a format specification %p
	  That is all.

2008-09-03 13:41 +0000 [r140817-140820]  Russell Bryant <russell@digium.com>

	* main/pbx.c: Formatting change to test something on the svn server

	* /, main/poll.c: Merged revisions 140816 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140816 | russell | 2008-09-03 08:24:35 -0500 (Wed, 03 Sep 2008)
	  | 4 lines Don't freak out if the poll emulation receives NULL for
	  the pollfds array (closes issue #13307) Reported by: jcovert
	  ........

2008-09-02 23:48 +0000 [r140752]  Mark Michelson <mmichelson@digium.com>

	* /, apps/app_voicemail.c: Merged revisions 140751 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r140751 | mmichelson | 2008-09-02 18:47:49 -0500 (Tue,
	  02 Sep 2008) | 6 lines After adding the context checking to
	  app_voicemail for IMAP storage, I left out a crucial place to
	  copy the context to the vm_state structure. This is the
	  correction. ........

2008-09-02 23:44 +0000 [r140691-140749]  Steve Murphy <murf@digium.com>

	* main/cdr.c, /: Merged revisions 140747 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140747 | murf | 2008-09-02 17:36:56 -0600 (Tue, 02 Sep 2008) | 1
	  line I am turning the warnings generated in ast_cdr_free and
	  post_cdr into verbose level 2 messages. Really, they matter
	  little to end users. You either get the CDR's you wanted, or you
	  don't, and it is a bug. For trunk, I am going one step further.
	  These messages were pretty worthless even for debug, so I'm
	  completely removing them. ........

	* main/channel.c, /: Merged revisions 140690 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140690 | murf | 2008-09-02 16:40:13 -0600 (Tue, 02 Sep 2008) | 1
	  line After reconsidering, with respect to 13409, ast_cdr_detach
	  should be OK, better in fact, than ast_cdr_free, which generates
	  lots of useless warnings that will undoubtably generate
	  complaints. Hmmm. It doesn't hush the useless warnings, but it
	  does allow control of posting via the detach and post routines,
	  for those possible situations, where you'd want to post
	  single-channel cdrs. ........

	* main/channel.c, main/pbx.c, /: Merged revisions 140670 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140670 | murf | 2008-09-02 16:15:57 -0600 (Tue, 02 Sep 2008) |
	  14 lines (closes issue #13409) Reported by: tomaso Patches:
	  asterisk-1.6.0-rc2-cdrmemleak.patch uploaded by tomaso (license
	  564) I basically spent the day, verifying that this patch solves
	  the problem, and doesn't hurt in non-problem cases. Why valgrind
	  did not plainly reveal this leak absolutely mystifies and stuns
	  me. Many, many thanks to tomaso for finding and providing the
	  fix. ........

2008-09-02 18:15 +0000 [r140606]  Sean Bright <sean.bright@gmail.com>

	* /, channels/chan_iax2.c: Merged revisions 140605 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r140605 | seanbright | 2008-09-02 14:14:57 -0400 (Tue,
	  02 Sep 2008) | 8 lines Make sure to use the correct length of the
	  mohinterpret and mohsuggest buffers when copying configuration
	  values. (closes issue #13336) Reported by:
	  decryptus_proformatique Patches:
	  chan_iax2_mohinterpret_mohsuggest_general_settings.patch uploaded
	  by decryptus (license 555) ........

2008-09-02 15:11 +0000 [r140563-140566]  Russell Bryant <russell@digium.com>

	* codecs/codec_resample.c, apps/app_jack.c: Update instructions for
	  getting libresample

	* res/ais/lck.c (removed), res/ais/ckpt.c (removed), res/ais/amf.c
	  (removed): I'm not sure how these files got to trunk (probably my
	  fault), but they should not be here

2008-09-02 14:41 +0000 [r140559]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_sip.c: When a call is rejected because of
	  call-limit, the channel driver is behaving as expected, so we
	  shouldn't report it as an error. Change to LOG_NOTICE instead.

2008-08-29 17:53 +0000 [r140491]  Jeff Peeler <jpeeler@digium.com>

	* main/features.c, CHANGES: Added the option s to the Park
	  application which will silence the announcement of the parking
	  space number. Also, fixes the bug of just clearing the flags
	  instead of actually parsing the arguments to Park.

2008-08-29 17:47 +0000 [r140418-140489]  Mark Michelson <mmichelson@digium.com>

	* main/manager.c, res/ais/lck.c, /, channels/chan_sip.c,
	  funcs/func_dialgroup.c, res/res_timing_pthread.c,
	  main/features.c, res/res_phoneprov.c, utils/hashtest2.c,
	  channels/chan_console.c, main/taskprocessor.c, apps/app_queue.c,
	  channels/chan_iax2.c, main/config.c: Merged revisions 140488 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140488 | mmichelson | 2008-08-29 12:34:17 -0500 (Fri, 29 Aug
	  2008) | 22 lines After working on the ao2_containers branch, I
	  noticed something a bit strange. In all cases where we provide a
	  callback function to ao2_container_alloc, the callback function
	  would only return 0 or CMP_MATCH. After inspecting the
	  ao2_callback() code carefully, I found that if you're only
	  looking for one specific item, then you should return CMP_MATCH |
	  CMP_STOP. Otherwise, astobj2 will continue traversing the current
	  bucket until the end searching for more matches. In cases like
	  chan_iax2 where in 1.4, all the peers are shoved into a single
	  bucket, this makes for potentially terrible performance since the
	  entire bucket will be traversed even if the peer is one of the
	  first ones come across in the bucket. All the changes I have made
	  were for cases where the callback function defined was passed to
	  ao2_container_alloc so that calls to ao2_find could find a unique
	  instance of whatever object was being stored in the container.
	  ........

	* main/file.c: Allow for video files to be opened as well as audio
	  files. (closes issue #13372) Reported by: epicac Patches:
	  13372.patch uploaded by putnopvut (license 60) Tested by: epicac

	* /, apps/app_voicemail.c: Merged revisions 140421 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r140421 | mmichelson | 2008-08-29 11:01:07 -0500 (Fri,
	  29 Aug 2008) | 12 lines Add context checking when retrieving a
	  vm_state. This was causing a problem for people who had
	  identically named mailboxes in separate voicemail contexts. This
	  commit affects IMAP storage only. (closes issue #13194) Reported
	  by: moliveras Patches: 13194.patch uploaded by putnopvut (license
	  60) Tested by: putnopvut, moliveras ........

	* channels/chan_sip.c: Merged revisions 140417 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140417 | mmichelson | 2008-08-29 10:26:52 -0500 (Fri, 29 Aug
	  2008) | 10 lines Fix SIP's parsing so that if a port is specified
	  in a string to Dial(), it is not ignored. (closes issue #13355)
	  Reported by: acunningham Patches: 13355v2.patch uploaded by
	  putnopvut (license 60) Tested by: acunningham ........

2008-08-27 23:23 +0000 [r140355]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c: Oops

2008-08-27 20:11 +0000 [r140301]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Merged revisions 140299 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140299 | mmichelson | 2008-08-27 14:49:20 -0500 (Wed, 27 Aug
	  2008) | 11 lines Fix tag checking in get_sip_pvt_byid_locked when
	  in pedantic mode. The problem was that the wrong tags would be
	  compared depending on the direction of the call. (closes issue
	  #13353) Reported by: flefoll Patches:
	  chan_sip.c.br14.139015.patch-refer-pedantic uploaded by flefoll
	  (license 244) ........

2008-08-26 21:59 +0000 [r140246]  Doug Bailey <dbailey@digium.com>

	* channels/chan_dahdi.c: Move the mwi send thread functionality
	  back into the do_monitor thread so that it is easier to manage
	  CID spill resources when do_monitor needs to be killed. (closes
	  issue #13213) Reported by: bbryant

2008-08-26 18:48 +0000 [r140205]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 140056 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r140056 | jpeeler | 2008-08-26 10:57:02 -0500 (Tue, 26
	  Aug 2008) | 9 lines (closes issue #12071) Reported by: tzafrir
	  Patches: dahdi_close.diff uploaded by tzafrir (license 46) Tested
	  by: tzafrir, jpeeler This patch fixes closing open file
	  descriptors in the case of an error. ........

2008-08-26 18:46 +0000 [r140201]  Tilghman Lesher <tlesher@digium.com>

	* apps/app_followme.c: OpenBSD compat fix (reminded by mvanbaak on
	  #asterisk-dev)

2008-08-26 18:11 +0000 [r140169]  Russell Bryant <russell@digium.com>

	* Makefile: Fix building menuselect-tree with PRINT_DIR set. We
	  _must_ use the --quiet flag here, or else some arbitrary text
	  will end up in the resulting menuselect-tree file and things will
	  explode.

2008-08-26 18:05 +0000 [r140167]  Tilghman Lesher <tlesher@digium.com>

	* configs/followme.conf.sample, apps/app_followme.c: Standardize
	  the option names for consistency (but continue to work with the
	  existing names for backwards compatibility). (closes issue
	  #13370) Reported by: jsturtevant

2008-08-26 16:10 +0000 [r140061]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 140060 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r140060 | russell | 2008-08-26 11:07:58 -0500 (Tue, 26 Aug 2008)
	  | 6 lines Fix some bogus scheduler usage in chan_sip. This code
	  used the return value of a completely unrelated function to
	  determine whether the scheduler should be run or not. This would
	  have caused the scheduler to not run in cases where it should
	  have. Also, leave a note about another scheduler issue that needs
	  to be addressed at some point. ........

2008-08-26 15:57 +0000 [r140057]  Steve Murphy <murf@digium.com>

	* main/cdr.c, configs/cdr.conf.sample, CHANGES,
	  include/asterisk/options.h: (closes issue #13366) Reported by:
	  erousseau This was a reasonable enhancement request, which was
	  easy to implement. Since it's an enhancement, it could only be
	  applied to trunk. Basically, for accounting where "initiated"
	  seconds are billed for, if the microseconds field on the end time
	  is greater than the microseconds field for the answer time, add
	  one second to the billsec field. The implementation was requested
	  by erousseau, and I've implemented it as requested. I've updated
	  the CHANGES, the cdr.conf.sample, and the .h files accordingly,
	  to accept and set a flag for the corresponding new option. cdr.c
	  adds in the extra second based on the usec fields if the option
	  is set. Tested, seems to be working fine.

2008-08-26 15:29 +0000 [r140053]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 140051 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r140051 | russell | 2008-08-26 10:27:23 -0500 (Tue, 26
	  Aug 2008) | 15 lines Fix a race condition with the IAX scheduler
	  thread. A lock and condition are used here to allow newly
	  scheduled tasks to wake up the scheduler just in case the new
	  task needs to run sooner than the current wakeup time when the
	  thread is sleeping. However, there was a race condition such that
	  a newly scheduled task would not properly wake up the scheduler
	  or affect the wake up period. The order of execution would have
	  been: 1) Scheduler thread determines wake up time of N ms. 2)
	  Another thread schedules a task and signals the condition, with
	  an execution time of < N ms. 3) Scheduler thread locks and goes
	  to sleep for N ms. By moving the sleep time determination to
	  inside the critical section, this possibility is avoided.
	  ........

2008-08-25 23:13 +0000 [r139981]  Tilghman Lesher <tlesher@digium.com>

	* Makefile, doc/asterisk.8, include/asterisk/options.h,
	  main/asterisk.c, main/term.c: Optional light colored background,
	  for those who use black on white terminals. (closes issue #13306)
	  Reported by: Corydon76 Patches: 20080814__bug13306__3.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: Corydon76, pkempgen

2008-08-25 21:48 +0000 [r139928]  Jeff Peeler <jpeeler@digium.com>

	* main/manager.c, /: Merged revisions 139927 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139927 | jpeeler | 2008-08-25 16:47:33 -0500 (Mon, 25 Aug 2008)
	  | 3 lines Fix a typo I made. Lesson learned, apply the patch if
	  one exists. ........

2008-08-25 21:32 +0000 [r139915]  Sean Bright <sean.bright@gmail.com>

	* build_tools/get_moduleinfo, /, build_tools/get_makeopts: Merged
	  revisions 139909 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139909 | seanbright | 2008-08-25 17:31:03 -0400 (Mon, 25 Aug
	  2008) | 9 lines Some versions of awk (nawk, for example) don't
	  like empty regular expressions so be slightly more verbose.
	  (closes issue #13374) Reported by: dougm Patches: 13374.diff
	  uploaded by seanbright (license 71) Tested by: dougm ........

2008-08-25 20:59 +0000 [r139870]  Terry Wilson <twilson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 139869 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139869 | twilson | 2008-08-25 15:46:10 -0500 (Mon, 25 Aug 2008)
	  | 2 lines Make SIPADDHEADER() propagate indefinitely ........

2008-08-25 17:24 +0000 [r139832]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Add output of variables to AgentRingNoAnswer
	  manager event if eventwhencalled is set to "vars" in queues.conf.
	  Yay for consistency. (closes issue #13369) Reported by: srt
	  Patches: 13369_agentringnoanswer_variables.diff uploaded by srt
	  (license 378)

2008-08-25 16:02 +0000 [r139775]  Tilghman Lesher <tlesher@digium.com>

	* doc/followme.txt (added), apps/app_followme.c: Realtime
	  capabilities for the Find-Me-Follow-Me application. (closes issue
	  #13295) Reported by: Corydon76 Patches:
	  20080813__followme_realtime_enabled.diff.txt uploaded by
	  Corydon76 (license 14) Tested by: dferrer

2008-08-25 15:54 +0000 [r139770]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /, main/features.c: Merged revisions 139764 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139764 | murf | 2008-08-25 09:33:14 -0600 (Mon, 25 Aug 2008) | 9
	  lines This patch reverts the changes made via 139347, and 139635,
	  as users are seeing adverse difference. I will un-close 13251.
	  Back to the drawing board/ concept/ beginning/ whatever! ........

2008-08-24 16:26 +0000 [r139704-139707]  Tilghman Lesher <tlesher@digium.com>

	* cdr/cdr_pgsql.c: Memory leak

	* cdr/cdr_pgsql.c: Eliminate open coding of ast_str

2008-08-22 22:32 +0000 [r139627-139662]  Steve Murphy <murf@digium.com>

	* /, main/features.c: Merged revisions 139635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139635 | murf | 2008-08-22 16:24:02 -0600 (Fri, 22 Aug 2008) | 6
	  lines I found some problems with the code I committed earlier,
	  when I merged them into trunk, so I'm coming back to clean up.
	  And, in the process, I found an error in the code I added to
	  trunk and 1.6.x, that I'll fix using this patch also. ........

	* apps/app_dial.c, main/pbx.c, /, main/features.c: Merged revisions
	  139347 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139347 | murf | 2008-08-21 17:03:50 -0600 (Thu, 21 Aug 2008) |
	  47 lines (closes issue #13251) Reported by: sergee Tested by:
	  murf THis is a bold move for a static release fix, but I wouldn't
	  have made it if I didn't feel confident (at least a *bit*
	  confident) that it wouldn't mess everyone up. The reasoning goes
	  something like this: 1. We simply cannot do anything with CDR's
	  at the current point (in pbx.c, after the __ast_pbx_run loop).
	  It's way too late to have any affect on the CDRs. The CDR is
	  already posted and gone, and the remnants have been cleared. 2. I
	  was very much afraid that moving the running of the 'h' extension
	  down into the bridge code (where it would be now practical to do
	  it), would result in a lot more calls to the 'h' exten, so I
	  implemented it as another exten under another name, but found, to
	  my pleasant surprise, that there was a 1:1 correspondence to the
	  running of the 'h' exten in the pbx_run loop, and the new spot at
	  the end of the bridge. So, I ifdef'd out the current 'h' loop,
	  and moved it into the bridge code. The only difference I can see
	  is the stuff about the AST_PBX_KEEPALIVE, and hopefully, if this
	  is still an important decision point, I can replicate it if there
	  are complaints. To be perfectly honest, the KEEPALIVE situation
	  is not totally clear to me, and how it relates to a post-bridge
	  situation is less clear. I suspect the users will point out
	  everything in total clarity if this steps on anyone's toes! 3. I
	  temporarily swap the bridge_cdr into the channel before running
	  the 'h' exten, which makes it possible for users to edit the cdr
	  before it goes out the door. And, of course, with the
	  endbeforehexten config var set, the users can also get at the
	  billsec/duration vals. After the h exten finishes, the cdr is
	  swapped back and processing continues as normal. Please, all who
	  deal with CDR's, please test this version of Asterisk, and file
	  bug reports as appropriate! ........ I also made a little fix to
	  the app_dial's 'e' option, that is related to my updates.

2008-08-22 21:57 +0000 [r139622-139624]  Jeff Peeler <jpeeler@digium.com>

	* main/manager.c, /: Merged revisions 139621 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139621 | jpeeler | 2008-08-22 16:36:13 -0500 (Fri, 22 Aug 2008)
	  | 5 lines (closes issue #13359) Reported by: Laureano Patches:
	  originate_channel_check.patch uploaded by Laureano (license 265)
	  ........

	* main/features.c: remove extra comma typo

2008-08-22 20:20 +0000 [r139457-139563]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: The -1 return value from incomplete or
	  improper headers for the SipNotify manager command was causing
	  the current manager session to become disconnected. Change the
	  return value to 0 for these cases. Also change a test for a NULL
	  pointer to be ast_strlen_zero instead. (closes issue #13351)
	  Reported by: Laureano Patches: sipnotify_action_fix.patch
	  uploaded by Laureano (license 265)

	* main/features.c: Add missing unique id to ParkedCallGiveUp and
	  ParkedCallTimeOut manager events (closes issue #13358) Reported
	  by: srt Patches: 13358_parking_events.diff uploaded by srt
	  (license 378)

	* /, include/asterisk/threadstorage.h: Merged revisions 139553 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139553 | mmichelson | 2008-08-22 14:45:19 -0500 (Fri, 22 Aug
	  2008) | 8 lines Fix compilation when DEBUG_THREAD_LOCALS is
	  selected (closes issue #13298) Reported by: snuffy Patches:
	  bug13298_20080822.diff uploaded by snuffy (license 35) ........

	* /, channels/chan_iax2.c: Merged revisions 139466 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r139466 | mmichelson | 2008-08-22 12:24:47 -0500 (Fri,
	  22 Aug 2008) | 3 lines Fix the build. Thanks, mvanbaak! ........

	* /, channels/chan_iax2.c: Merged revisions 139456 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r139456 | mmichelson | 2008-08-22 11:57:38 -0500 (Fri,
	  22 Aug 2008) | 7 lines Prevent a deadlock in chan_iax2 resulting
	  from incorrect locking order between iax2_pvt and ast_channel
	  structures. AST-13 ........

2008-08-21 23:41 +0000 [r139391]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 139387 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r139387 | jpeeler | 2008-08-21 18:39:31 -0500 (Thu, 21
	  Aug 2008) | 3 lines Fixes loop that could possibly never exit in
	  the event of a channel never being able to be opened or specify
	  after a restart. (closes issue #11017) ........

2008-08-21 23:00 +0000 [r139345-139346]  Dwayne M. Hubbard <dwayne.hubbard@gmail.com>

	* apps/app_receivefax.c (removed), apps/app_sendfax.c (removed):
	  oops

	* apps/app_receivefax.c (added), apps/app_sendfax.c (added):
	  initiate T38 negotiation in FaxSend; use channel variables; other
	  stuff too

2008-08-21 09:55 +0000 [r139281]  Philippe Sultan <philippe.sultan@gmail.com>

	* channels/chan_gtalk.c: Fix two memory leaks in chan_gtalk, thanks
	  Eliel! (closes issue #13310) Reported by: eliel Patches:
	  chan_gtalk.c.patch uploaded by eliel (license 64)

2008-08-20 22:16 +0000 [r139215]  Russell Bryant <russell@digium.com>

	* /, apps/app_chanspy.c: Merged revisions 139213 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139213 | russell | 2008-08-20 17:14:35 -0500 (Wed, 20 Aug 2008)
	  | 11 lines Fix a crash in the ChanSpy application. The issue here
	  is that if you call ChanSpy and specify a spy group, and sit in
	  the application long enough looping through the channel list, you
	  will eventually run out of stack space and the application with
	  exit with a seg fault. The backtrace was always inside of a
	  harmless snprintf() call, so it was tricky to track down.
	  However, it turned out that the call to snprintf() was just the
	  biggest stack consumer in this code path, so it would always be
	  the first one to hit the boundary. (closes issue #13338) Reported
	  by: ruddy ........

2008-08-20 22:06 +0000 [r139210]  Jason Parker <jparker@digium.com>

	* channels/chan_sip.c: Fix output of sipshowpeer manager response.
	  (closes issue #13346) Reported by: srt Patches:
	  13346_malformed_sip_show_peer_response.diff uploaded by srt
	  (license 378)

2008-08-20 20:03 +0000 [r139153-139154]  Shaun Ruffell <sruffell@digium.com>

	* codecs/codec_dahdi.c: Remove extraneous debugging messages.

	* codecs/codec_dahdi.c: Fix bug where the samples were not accurate
	  when in G723 mode, which would cause the timestamp field of the
	  RTP header to be invalid.

2008-08-20 17:25 +0000 [r139083]  Steve Murphy <murf@digium.com>

	* main/cdr.c, /: Merged revisions 139074 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139074 | murf | 2008-08-20 11:14:55 -0600 (Wed, 20 Aug 2008) |
	  12 lines (closes issue #13263) Reported by: brainy Tested by:
	  murf The specialized reset routine is tromping on the flags field
	  of the CDR. I made a change to not reset the DISABLED bit. This
	  should get rid of this problem. ........

2008-08-20 16:16 +0000 [r139020]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: fix unholding phones after hangup on
	  older cisco phones. Patch by wedhorn.

2008-08-20 15:38 +0000 [r138887-139016]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_sip.c: Merged revisions 139015 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r139015 | mmichelson | 2008-08-20 10:37:56 -0500 (Wed, 20 Aug
	  2008) | 6 lines sip_read should properly handle a NULL return
	  from sip_rtp_read. (closes issue #13257) Reported by: travishein
	  ........

	* /, channels/chan_agent.c: Merged revisions 138942 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r138942 | mmichelson | 2008-08-19 18:17:17 -0500 (Tue,
	  19 Aug 2008) | 11 lines Reset agent_pvt variables back to the
	  values in agents.conf (from what the corresponding channel
	  variables were set to) when the agent logs out. (closes issue
	  #13098) Reported by: davidw Patches:
	  20080731__issue13098_agent_ackcall_not_reset.diff uploaded by
	  bbryant (license 36) Tested by: davidw ........

	* /, apps/app_chanspy.c: Merged revisions 138886 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138886 | mmichelson | 2008-08-19 13:50:53 -0500 (Tue, 19 Aug
	  2008) | 23 lines Add a lock and unlock prior to the destruction
	  of the chanspy_ds lock to ensure that no other threads still have
	  it locked. While this should not happen under normal
	  circumstances, it appears that if the spyer and spyee hang up at
	  nearly the same time, the following may occur. 1.
	  ast_channel_free is called on the spyee's channel. 2. The chanspy
	  datastore is removed from the spyee's channel in
	  ast_channel_free. 3. In the spyer's thread, the spyer attempts to
	  remove and destroy the datastore from the spyee channel, but the
	  datastore has already been removed in step 2, so the spyer
	  continues in the code. 4. The spyee's thread continues and calls
	  the datastore's destroy callback, chanspy_ds_destroy. This
	  involves locking the chanspy_ds. 5. Now the spyer attempts to
	  destroy the chanspy_ds lock. The problem is that in step 4, the
	  spyee has locked this lock, meaning that the spyer is attempting
	  to destroy a lock which is currently locked by another thread.
	  The backtrace provided in issue #12969 supports the idea that
	  this is possible (and has even occurred). This commit does not
	  close the issue, but should help in preventing one type of crash
	  associated with the use of app_chanspy. ........

2008-08-19 16:56 +0000 [r138851]  Michiel van Baak <michiel@vanbaak.info>

	* channels/chan_skinny.c: chan_skinny now respects callwaiting=no
	  (closes issue #12691) Reported by: sbisker Patches:
	  callwaitingv1.diff uploaded by wedhorn (license 30) Tested by:
	  wedhorn on old skinny phones, mvanbaak on 7960 and 7905 with
	  latest firmware

2008-08-19 16:31 +0000 [r138815-138845]  Steve Murphy <murf@digium.com>

	* res/ael/ael.tab.c, res/ael/ael.y, res/ael/ael.tab.h,
	  utils/ael_main.c, utils/conf2ael.c: Oops. put a decl in a
	  generated file. My bad, but fixed now.

	* main/pbx.c, res/ael/ael.tab.c, res/ael/ael.y, res/ael/ael.tab.h:
	  These changes are in regards to bug 13249, where users are being
	  surprised by the changes made to the Set app in trunk/1.6.x, as
	  they come from the 1.4 world. They are only bitten if they write
	  their AEL dialplan in the 1.4 world, and then carry it over to a
	  trunk/1.6.x installation where a "make samples" was executed, or
	  where they hand-edited the asterisk.conf file and added the
	  [compat] category with app_set = 1.6 (or higher). (this commit
	  does not totally solve 13249, at least not yet) The change
	  involves issueing a single warning while the AEL file is loading,
	  if: 1. app_set is present in the config file, and set to 1.6 or
	  higher. 2. there are double quotes in an assignment statement (eg
	  x = "hi there";) 3. the warning was not already issued. The
	  standalone app, aelparse, does not (yet) issue this warning. I'd
	  have to have it read in the asterisk.conf file, and that's a bit
	  of hassle. I'll add it if users request it, tho.

2008-08-19 15:58 +0000 [r138814]  Philippe Sultan <philippe.sultan@gmail.com>

	* res/res_jabber.c: Mention JID rather than SreenName in help
	  messages

2008-08-19 00:10 +0000 [r138775-138780]  Sean Bright <sean.bright@gmail.com>

	* channels/chan_sip.c: Let it compile now, too (woops)

	* channels/chan_sip.c: And remove code we don't need anymore.

	* channels/chan_sip.c: While we're at it, make this machine
	  parseable too.

	* channels/chan_sip.c: Change event header to RegistrationTime to
	  be more consistent (and avoid breaking existing frameworks).
	  Pointed out by Laureano on #asterisk-dev.

2008-08-18 21:07 +0000 [r138738]  Richard Mudgett <rmudgett@digium.com>

	* channels/misdn/isdn_lib_intern.h, channels/misdn/isdn_lib.h,
	  doc/tex/misdn.tex, channels/chan_misdn.c,
	  configs/misdn.conf.sample, channels/misdn/isdn_lib.c,
	  channels/misdn_config.c: channels/chan_misdn.c * Made
	  bearer2str() use allowed_bearers_array[] * Made use the causes.h
	  defines instead of hardcoded numbers. * Made use Asterisk
	  presentation indicator values if either of the mISDN presentation
	  or screen options are negative. * Updated the misdn_set_opt
	  application option descriptions. * Renamed the awkward Caller ID
	  presentation misdn_set_opt application option value not_screened
	  to restricted. Deprecated the not_screened option value.
	  channels/misdn/isdn_lib.c * Made use the causes.h defines instead
	  of hardcoded numbers. * Fixed some spelling errors and typos. *
	  Added all defined facility code strings to fac2str().
	  channels/misdn/isdn_lib.h * Added doxygen comments to struct
	  misdn_bchannel. channels/misdn/isdn_lib_intern.h * Added doxygen
	  comments to struct misdn_stack. channels/misdn_config.c
	  configs/misdn.conf.sample * Updated the mISDN presentation and
	  screen parameter descriptions. doc/tex/misdn.tex * Updated the
	  misdn_set_opt application option descriptions. * Fixed some
	  spelling errors and typos.

2008-08-18 20:23 +0000 [r138687-138694]  Mark Michelson <mmichelson@digium.com>

	* configs/queues.conf.sample, apps/app_queue.c: Change the queue
	  timeout priority logic into less ugly and confusing code pieces.
	  Clarify the logic within queues.conf.sample. (closes issue
	  #12690) Reported by: atis Patches: queue_timeoutpriority.patch
	  uploaded by atis (license 242)

	* apps/app_queue.c: Merged revisions 138685 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138685 | mmichelson | 2008-08-18 15:01:14 -0500 (Mon, 18 Aug
	  2008) | 10 lines Change the inequalities used in app_queue with
	  regards to timeouts from being strict to non-strict for more
	  accuracy. (closes issue #13239) Reported by: atis Patches:
	  app_queue_timeouts_v2.patch uploaded by atis (license 242)
	  ........

2008-08-18 15:54 +0000 [r138631]  Jason Parker <jparker@digium.com>

	* Makefile: Remove option that isn't valid here.

2008-08-18 02:13 +0000 [r138518]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: add missing define for SS7 in
	  dahdi_restart

2008-08-17 14:12 +0000 [r138442-138482]  Sean Bright <sean.bright@gmail.com>

	* main/features.c: Move Uniqueid to the end of the event for those
	  that rely on the position of the name/value pairs, pointed out by
	  snuffy-home on #asterisk-commits. For those of you who rely on
	  the position of name/value pairs in manager events... stop...
	  that is why associative arrays were invented.

	* main/features.c: Add Uniqueid header to ParkedCall manager event.
	  (closes issue #13323) Reported by: srt Patches:
	  13323_unique_id_for_parkedcalls_event.diff uploaded by srt
	  (license 378)

	* main/rtp.c: Add missing colons to RTCPReceived and RTCPSent
	  manager events. (closes issue #13319) Reported by: srt Patches:
	  13319_rtcp_manager_event_headers.diff uploaded by srt (license
	  378)

	* channels/chan_iax2.c: Fix the output of the JitterBufStats
	  manager event. (closes issue #13324) Reported by: srt Patches:
	  13324_missing_nl_in_jitterbufstats_event_2.diff uploaded by srt
	  (license 378)

	* configs/cdr_tds.conf.sample: Since it's introduction in revision
	  3497, cdr_tds has *never* read the port configuration option from
	  cdr_tds.conf. So go ahead and remove it from the sample config.

2008-08-16 13:07 +0000 [r138409-138412]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c: Fix compilation warnings (found with
	  dev-mode)

	* main/pbx.c: Also make sure hinting won't crash on reload. (Closes
	  issue #13312)

2008-08-16 01:13 +0000 [r138311-138361]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 138360 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r138360 | jpeeler | 2008-08-15 20:12:18 -0500 (Fri, 15
	  Aug 2008) | 1 line fixes use count to properly decrement if an
	  active dahdi channel is destroyed allowing module to be unloaded
	  ........

	* channels/chan_dahdi.c, /: Merged revisions 138119,138151,138238
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138119 | jpeeler | 2008-08-15 14:21:51 -0500 (Fri, 15 Aug 2008)
	  | 4 lines Fixes the dahdi restart functionality. Dahdi restart
	  allows one to restart all DAHDI channels, even if they are
	  currently in use. This is different from unloading and then
	  loading the module since unloading requires the use count to be
	  zero. Reloading the module is different in that the signalling is
	  not changed from what it was originally configured. Also, this
	  fixes not closing all the file descriptors for D-channels upon
	  module unload (which would prevent loading the module
	  afterwards). (closes issue #11017) ........ r138151 | jpeeler |
	  2008-08-15 14:41:29 -0500 (Fri, 15 Aug 2008) | 1 line declared
	  static mutexes using AST_MUTEX_DEFINE_STATIC macro ........
	  r138238 | jpeeler | 2008-08-15 16:28:26 -0500 (Fri, 15 Aug 2008)
	  | 1 line initialize condition variable ss_thread_complete using
	  ast_cond_init ........

2008-08-15 22:54 +0000 [r138206-138260]  Tilghman Lesher <tlesher@digium.com>

	* /, channels/chan_sip.c, configs/sip.conf.sample: Merged revisions
	  138258 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138258 | tilghman | 2008-08-15 17:33:42 -0500 (Fri, 15 Aug 2008)
	  | 8 lines More fixes for realtime peers. (closes issue #12921)
	  Reported by: Nuitari Patches: 20080804__bug12921.diff.txt
	  uploaded by Corydon76 (license 14) 20080815__bug12921.diff.txt
	  uploaded by Corydon76 (license 14) Tested by: Corydon76 ........

	* main/pbx.c, configs/extensions.conf.sample: Remove deprecated
	  syntax from sample config file (closes issue #13314) Reported by:
	  kue

2008-08-15 20:12 +0000 [r138155]  Jeff Peeler <jpeeler@digium.com>

	* channels/chan_dahdi.c: rename all zfd instances in chan_dahdi to
	  dfd to match 1.4 (left over from DAHDI transition)

2008-08-15 19:36 +0000 [r138086-138148]  Tilghman Lesher <tlesher@digium.com>

	* main/pbx.c: Change free to ast_free_ptr, too

	* main/pbx.c: e->data can be NULL, so use the safe version of
	  ast_strdup() (closes issue #13312) Reported by: pj

	* channels/chan_sip.c: regseconds is actually stored as the epoch
	  time, not registration length

2008-08-15 15:09 +0000 [r138028]  Russell Bryant <russell@digium.com>

	* main/autoservice.c, /: Merged revisions 138027 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r138027 | russell | 2008-08-15 10:07:16 -0500 (Fri, 15 Aug 2008)
	  | 9 lines Ensure that when a hangup occurs in autoservice, that a
	  hangup frame gets properly deferred to be read from the channel
	  owner when it gets taken out of autoservice. (closes issue
	  #12874) Reported by: dimas Patches: v1-12874.patch uploaded by
	  dimas (license 88) ........

2008-08-15 15:03 +0000 [r138024]  Tilghman Lesher <tlesher@digium.com>

	* /, funcs/func_strings.c: Merged revisions 138023 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r138023 | tilghman | 2008-08-15 09:51:12 -0500 (Fri, 15
	  Aug 2008) | 8 lines Additional check for more string specifiers
	  than arguments. (closes issue #13299) Reported by: adomjan
	  Patches: 20080813__bug13299.diff.txt uploaded by Corydon76
	  (license 14) func_strings.c-sprintf.patch uploaded by adomjan
	  (license 487) Tested by: adomjan ........

2008-08-14 22:43 +0000 [r137987]  Russell Bryant <russell@digium.com>

	* doc/tex/Makefile: Fix a bashism that causes an error when trying
	  to build the pdf on ubuntu

2008-08-14 18:47 +0000 [r137933]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_sqlite3_custom.c: Fix memory leak in cdr_sqlite3_custom.
	  (closes issue #13304) Reported by: eliel Patches: sqlite.patch
	  uploaded by eliel (license 64) (Slightly modified by me)

2008-08-14 18:12 +0000 [r137901]  Russell Bryant <russell@digium.com>

	* CHANGES: Prepare for adding 1.6.2 changes

2008-08-14 16:52 +0000 [r137848]  Tilghman Lesher <tlesher@digium.com>

	* channels/chan_dahdi.c, /: Merged revisions 137847 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r137847 | tilghman | 2008-08-14 11:47:30 -0500 (Thu, 14
	  Aug 2008) | 9 lines When creating the secondary subchannel name,
	  it is necessary to compare to the existing channel name without
	  the "Zap/" or "DAHDI/" prefix, since our test string is also
	  without that prefix. (closes issue #13027) Reported by: dferrer
	  Patches: chan_zap-1.4.21.1_fix2.patch uploaded by dferrer
	  (license 525) (Slightly modified by me, to compensate for both
	  names) ........

2008-08-14 15:32 +0000 [r137812]  Jason Parker <jparker@digium.com>

	* channels/chan_sip.c: Make sure we set the socket port, so we
	  don't try to use <ip address>:0. (closes issue #13255) Reported
	  by: falves11 Patches: 13255-socketport.diff uploaded by qwell
	  (license 4) Tested by: falves11

2008-08-14 15:03 +0000 [r137780]  Sean Bright <sean.bright@gmail.com>

	* cdr/cdr_tds.c: If we detect that we are no longer connected, try
	  to reconnect a few times before giving up. This relies on the
	  timeout settings in the freetds.conf file and, unfortunately, on
	  a recent version of FreeTDS (0.82 or newer). I either need to
	  change the current execs to be non-blocking (which I do not want
	  to do) or we have to force people to run with the latest and
	  greatest of FreeTDS. I'm on the fence...

2008-08-14 14:15 +0000 [r137732]  Russell Bryant <russell@digium.com>

	* /, configs/sip.conf.sample: Merged revisions 137731 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.4
	  ........ r137731 | russell | 2008-08-14 09:05:23 -0500 (Thu, 14
	  Aug 2008) | 4 lines Comments in this config file were aligned
	  only if your tab size was set to 8. So, convert tabs to spaces so
	  that things should be aligned regardless of what tab size you use
	  in your editor. ........

2008-08-14 02:03 +0000 [r137680]  Kevin P. Fleming <kpfleming@digium.com>

	* /, Zaptel-to-DAHDI.txt: Merged revisions 137679 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.4 ........
	  r137679 | kpfleming | 2008-08-13 21:03:04 -0500 (Wed, 13 Aug
	  2008) | 1 line forgot one module name that changed ........

